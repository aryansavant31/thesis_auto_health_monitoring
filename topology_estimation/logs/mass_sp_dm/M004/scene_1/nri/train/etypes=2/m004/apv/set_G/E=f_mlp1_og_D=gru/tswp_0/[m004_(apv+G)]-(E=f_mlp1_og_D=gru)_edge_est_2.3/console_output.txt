=== SCRIPT EXECUTION LOG ===
Script: topology_estimation.train.py
Base Name: [m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3
Start Time: 2025-09-15 10:56:44
End Time: 2025-09-15 10:58:41

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting nri model training...

'Train' type dataset selected:


Dataset selections:
---------------------------------------------
*_(<ds_subtype_num>) <ds_subtype> : [<augments>]_*

- **Healthy configs**
  (1) series_tp    : [OG]

- **Unhealthy configs**

- **Unknown configs**


Node and signal types:
---------------------------------------------
*_(<node_num>) <node_type> : [<signal_types>]_*

  (1) mass_1   : [acc, pos, vel]
  (2) mass_2   : [acc, pos, vel]
  (3) mass_3   : [acc, pos, vel]
  (4) mass_4   : [acc, pos, vel]

Node group name: m004
Signal group name: apv


For ds_type 'OK' and others....
---------------------------------------------
Maximum timesteps across all node types: 500,001

No data interpolation applied.

'fs' is updated in data_config as given in loaded healthy (or unknown) data.
New fs:
[[500., 500., 500.],
 [500., 500., 500.],
 [500., 500., 500.],
 [500., 500., 500.]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
------------------------------------------------------------
Total samples: 5000 
Train: 4000/4000 [OK=4000, NOK=0, UK=0], Test: 500/500 [OK=500, NOK=0, UK=0], Val: 500/500 [OK=500, NOK=0, UK=0],
Remainder: 0 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 80
torch.Size([50, 4, 100, 3])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 10
torch.Size([50, 4, 100, 3]) 

val_data_loader statistics:
Number of batches: 10
torch.Size([50, 4, 100, 3]) 

---------------------------------------------------------------------------

Loading Relation Matrices...

Relation Matrices loaded successfully.

## Relation Matrices Summary 

**Adjacency matrix for input** => shape: (4, 4)
     n1   n2   n3   n4
n1  0.0  1.0  1.0  1.0
n2  1.0  0.0  1.0  1.0
n3  1.0  1.0  0.0  1.0
n4  1.0  1.0  1.0  0.0


**Receiver relation matrix** => shape: (12, 4)
      n1   n2   n3   n4
e12  0.0  1.0  0.0  0.0
e13  0.0  0.0  1.0  0.0
e14  0.0  0.0  0.0  1.0
e21  1.0  0.0  0.0  0.0
e23  0.0  0.0  1.0  0.0
e24  0.0  0.0  0.0  1.0
e31  1.0  0.0  0.0  0.0
e32  0.0  1.0  0.0  0.0
e34  0.0  0.0  0.0  1.0
e41  1.0  0.0  0.0  0.0
e42  0.0  1.0  0.0  0.0
e43  0.0  0.0  1.0  0.0


**Sender relation matrix:** => shape: (12, 4)
      n1   n2   n3   n4
e12  1.0  0.0  0.0  0.0
e13  1.0  0.0  0.0  0.0
e14  1.0  0.0  0.0  0.0
e21  0.0  1.0  0.0  0.0
e23  0.0  1.0  0.0  0.0
e24  0.0  1.0  0.0  0.0
e31  0.0  0.0  1.0  0.0
e32  0.0  0.0  1.0  0.0
e34  0.0  0.0  1.0  0.0
e41  0.0  0.0  0.0  1.0
e42  0.0  0.0  0.0  1.0
e43  0.0  0.0  0.0  1.0


---------------------------------------------------------------------------

<<<<<< ENCODER PARAMETERS >>>>>>
Encoder model parameters:
-------------------------
n_edge_types: 2
is_residual_connection: False
do_prob: {'mlp': 0.0, 'cnn': 0.0}
is_batch_norm: {'mlp': True, 'cnn': False}
is_xavier_weights: True
attention_output_size: 5
domain_config: {'type': 'time', 'cutoff_freq': 0}
raw_data_norm: min_max
feat_configs: []
reduc_config: None
feat_norm: None
pipeline: [['1/node_emd.1', 'mlp'], ['1/pairwise_op', 'concat'], ['1/edge_emd.1.@', 'mlp'], ['2/aggregate', 'mean'], ['2/node_emd.1', 'mlp'], ['2/pairwise_op', 'concat'], ['2/edge_emd.1', 'mlp']]
edge_emb_configs: {'mlp': [[256, 'elu'], [256, 'elu']], 'cnn': [[5, 2, 64], [8]]}
node_emb_configs: {'mlp': [[256, 'elu'], [256, 'elu']], 'cnn': [[5, 2, 64], [8]]}
n_comps: 100
n_dims: 3

<<<<<< DECODER PARAMETERS >>>>>>

Decoder model parameters:
-------------------------
n_edge_types: 2
msg_out_size: 16
edge_mlp_config: [[16, 'tanh'], [16, 'tanh']]
out_mlp_config: [[16, 'relu'], [16, 'relu']]
do_prob: 0.5
is_batch_norm: False
is_xavier_weights: False
recur_emb_type: gru
domain_config: {'type': 'time', 'cutoff_freq': 0}
raw_data_norm: min_max
feat_configs: []
feat_norm: None
reduc_config: None
n_dims: 3

Decoder run parameters:
-------------------------
is_hard: False
skip_first_edge_type: True
pred_steps: 10
is_burn_in: True
final_pred_steps: 30
is_dynamic_graph: False
show_conf_band: False

Training parameters set to: 
lr_enc=1e-05, 
lr_dec=0.0001, 
final_beta=0.1, 
warmup_frac=0.6, 
optimizer=adam, 
loss_type_encoder=kld, 
loss_type_decoder=mse, 
prior=tensor([0.5000, 0.5000]), 
add_const_kld=True

---------------------------------------------------------------------------

NRI Model Initialized with the following configurations:
----- NRI Model Summary -----
-- Encoder Summary
Encoder(
  (emb_fn_dict): ModuleDict(
    (1/node_emd1): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=300, out_features=256, bias=True)
        (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ELU(alpha=1.0)
        (3): Dropout(p=0.0, inplace=False)
        (4): Linear(in_features=256, out_features=256, bias=True)
        (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (6): ELU(alpha=1.0)
      )
    )
    (1/edge_emd1@): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ELU(alpha=1.0)
        (3): Dropout(p=0.0, inplace=False)
        (4): Linear(in_features=256, out_features=256, bias=True)
        (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (6): ELU(alpha=1.0)
      )
    )
    (2/node_emd1): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=256, out_features=256, bias=True)
        (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ELU(alpha=1.0)
        (3): Dropout(p=0.0, inplace=False)
        (4): Linear(in_features=256, out_features=256, bias=True)
        (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (6): ELU(alpha=1.0)
      )
    )
    (2/edge_emd1): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=512, out_features=256, bias=True)
        (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ELU(alpha=1.0)
        (3): Dropout(p=0.0, inplace=False)
        (4): Linear(in_features=256, out_features=256, bias=True)
        (5): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (6): ELU(alpha=1.0)
      )
    )
  )
  (attention_layer_dict): ModuleDict()
  (output_layer): Linear(in_features=256, out_features=2, bias=True)
)
-- Decoder Summary
Decoder(
  (edge_mlp_fn): ModuleList(
    (0-1): 2 x MLP(
      (layers): ModuleList(
        (0): Linear(in_features=32, out_features=16, bias=True)
        (1): Tanh()
        (2): Dropout(p=0.5, inplace=False)
        (3): Linear(in_features=16, out_features=16, bias=True)
        (4): Tanh()
      )
    )
  )
  (recurrent_emb_fn): GRU(
    (input_u): Linear(in_features=3, out_features=16, bias=True)
    (hidden_u): Linear(in_features=16, out_features=16, bias=True)
    (input_r): Linear(in_features=3, out_features=16, bias=True)
    (hidden_r): Linear(in_features=16, out_features=16, bias=True)
    (input_h): Linear(in_features=3, out_features=16, bias=True)
    (hidden_h): Linear(in_features=16, out_features=16, bias=True)
  )
  (mean_mlp): MLP(
    (layers): ModuleList(
      (0): Linear(in_features=16, out_features=16, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
      (3): Linear(in_features=16, out_features=16, bias=True)
      (4): ReLU()
    )
  )
  (var_mlp): MLP(
    (layers): ModuleList(
      (0): Linear(in_features=16, out_features=16, bias=True)
      (1): ReLU()
      (2): Dropout(p=0.5, inplace=False)
      (3): Linear(in_features=16, out_features=16, bias=True)
      (4): ReLU()
    )
  )
  (mean_output_layer): Linear(in_features=16, out_features=3, bias=True)
  (var_output_layer): Linear(in_features=16, out_features=3, bias=True)
)

---------------------------------------------------------------------------

'[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3' already exists in the log path 'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Are you sure you want to remove the '[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3' from the log path C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3? (y/n): Overwrote '[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3' from the log path C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3.
Model parameters saved to C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3

---------------------------------------------------------------------------
C:\Anaconda3\envs\afd_env\Lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py:425: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=19` in the `DataLoader` to improve performance.
C:\Anaconda3\envs\afd_env\Lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py:425: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=19` in the `DataLoader` to improve performance.

Initializing input processors for encoder model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No time feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Initializing input processors for decoder model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No time feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------
Edge pred tensor([[0.9184, 0.0816],
        [0.8150, 0.1850],
        [0.3692, 0.6308],
        [0.1230, 0.8770],
        [0.1440, 0.8560],
        [0.0472, 0.9528],
        [0.1930, 0.8070],
        [0.5746, 0.4254],
        [0.1319, 0.8681],
        [0.8287, 0.1713],
        [0.9553, 0.0447],
        [0.9593, 0.0407]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.6026, -0.8182],
        [ 1.3008, -0.1818],
        [-0.4485,  0.0873],
        [ 0.6177,  2.5823],
        [-0.3444,  1.4381],
        [-2.1218,  0.8834],
        [ 0.0297,  1.4605],
        [-0.3502, -0.6509],
        [-1.4267,  0.4575],
        [ 1.4046, -0.1721],
        [ 0.7289, -2.3336],
        [ 1.3594, -1.8004]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.9141, 0.0859],
        [0.7520, 0.2480],
        [0.6997, 0.3003],
        [0.0816, 0.9184],
        [0.5922, 0.4078],
        [0.0584, 0.9416],
        [0.3073, 0.6927],
        [0.4708, 0.5292],
        [0.9539, 0.0461],
        [0.6146, 0.3854],
        [0.7871, 0.2129],
        [0.9717, 0.0283]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 0, Epoch 1/3, Batch 0/80
temp: 0.9990, beta: 0.0000, 
nri_train_loss: 4.9194, enc_train_loss: 1.7986, enc_train_entropy: 0.5433, dec_train_loss: 4.4848, enc_train_edge_accuracy: 0.4967

Edge pred tensor([[0.1649, 0.8351],
        [0.2354, 0.7646],
        [0.1367, 0.8633],
        [0.5947, 0.4053],
        [0.8155, 0.1845],
        [0.6794, 0.3206],
        [0.5971, 0.4029],
        [0.6566, 0.3434],
        [0.7500, 0.2500],
        [0.4898, 0.5102],
        [0.4234, 0.5766],
        [0.6968, 0.3032]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.1471,  1.4753],
        [ 0.3241,  1.5023],
        [ 0.1850,  2.0279],
        [ 1.0122,  0.6289],
        [ 1.6724,  0.1860],
        [ 1.3649,  0.6138],
        [ 0.3242, -0.0691],
        [ 0.3751, -0.2732],
        [ 0.7792, -0.3195],
        [ 0.9989,  1.0397],
        [ 0.8195,  1.1284],
        [ 1.7579,  0.9255]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.1830, 0.8170],
        [0.2738, 0.7262],
        [0.1493, 0.8507],
        [0.8901, 0.1099],
        [0.6407, 0.3593],
        [0.3099, 0.6901],
        [0.9605, 0.0395],
        [0.7896, 0.2104],
        [0.7456, 0.2544],
        [0.2490, 0.7510],
        [0.0212, 0.9788],
        [0.8259, 0.1741]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.4986, 0.5014],
        [0.8138, 0.1862],
        [0.4303, 0.5697],
        [0.1671, 0.8329],
        [0.3759, 0.6241],
        [0.1257, 0.8743],
        [0.0472, 0.9528],
        [0.1972, 0.8028],
        [0.0341, 0.9659],
        [0.7847, 0.2153],
        [0.8656, 0.1344],
        [0.9658, 0.0342]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.2918,  0.2973],
        [ 0.4252, -1.0500],
        [-0.8599, -0.5794],
        [-1.0929,  0.5136],
        [-0.5448, -0.0378],
        [-1.9169,  0.0225],
        [-2.7558,  0.2487],
        [-0.8452,  0.5589],
        [-3.2345,  0.1103],
        [ 0.5398, -0.7536],
        [ 1.5434, -0.3195],
        [ 1.2209, -2.1191]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.3438, 0.6562],
        [0.9495, 0.0505],
        [0.3754, 0.6246],
        [0.9741, 0.0259],
        [0.5512, 0.4488],
        [0.0745, 0.9255],
        [0.0527, 0.9473],
        [0.2596, 0.7404],
        [0.0021, 0.9979],
        [0.9715, 0.0285],
        [0.9965, 0.0035],
        [0.7634, 0.2366]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.1946, 0.8054],
        [0.2868, 0.7132],
        [0.0887, 0.9113],
        [0.9349, 0.0651],
        [0.6311, 0.3689],
        [0.3204, 0.6796],
        [0.9668, 0.0332],
        [0.8934, 0.1066],
        [0.5949, 0.4051],
        [0.8567, 0.1433],
        [0.5313, 0.4687],
        [0.6900, 0.3100]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.9281,  0.4922],
        [ 0.7711,  1.6821],
        [-0.7136,  1.6164],
        [ 0.9850, -1.6798],
        [ 1.0092,  0.4724],
        [-0.6717,  0.0802],
        [ 3.0628, -0.3096],
        [ 2.4799,  0.3538],
        [ 2.0919,  1.7077],
        [ 1.6438, -0.1441],
        [ 0.5524,  0.4271],
        [ 2.2745,  1.4746]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.0094, 0.9906],
        [0.1916, 0.8084],
        [0.0116, 0.9884],
        [0.9382, 0.0618],
        [0.5579, 0.4421],
        [0.2418, 0.7582],
        [0.9857, 0.0143],
        [0.5883, 0.4117],
        [0.8459, 0.1541],
        [0.7183, 0.2817],
        [0.5686, 0.4314],
        [0.7506, 0.2494]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.1117, 0.8883],
        [0.5243, 0.4757],
        [0.1845, 0.8155],
        [0.8629, 0.1371],
        [0.7044, 0.2956],
        [0.2260, 0.7740],
        [0.9376, 0.0624],
        [0.3992, 0.6008],
        [0.1698, 0.8302],
        [0.9806, 0.0194],
        [0.6633, 0.3367],
        [0.9411, 0.0589]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.8771,  1.1965],
        [ 0.6709,  0.5735],
        [ 0.2522,  1.7383],
        [ 1.2436, -0.5959],
        [ 0.7345, -0.1338],
        [-0.1695,  1.0616],
        [ 1.7698, -0.9401],
        [ 0.2096,  0.6186],
        [ 0.3326,  1.9199],
        [ 1.5996, -2.3256],
        [-0.2825, -0.9607],
        [ 1.3643, -1.4063]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.0819e-01, 8.9181e-01],
        [8.6687e-01, 1.3313e-01],
        [5.4194e-02, 9.4581e-01],
        [2.1845e-01, 7.8155e-01],
        [9.9954e-01, 4.5909e-04],
        [1.0384e-01, 8.9616e-01],
        [9.3693e-01, 6.3067e-02],
        [3.0972e-01, 6.9028e-01],
        [5.1897e-01, 4.8103e-01],
        [9.5596e-01, 4.4036e-02],
        [9.3389e-02, 9.0661e-01],
        [9.0338e-01, 9.6623e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.4457, 0.5543],
        [0.3036, 0.6964],
        [0.0361, 0.9639],
        [0.9466, 0.0534],
        [0.7832, 0.2168],
        [0.2336, 0.7664],
        [0.6575, 0.3425],
        [0.7211, 0.2789],
        [0.0389, 0.9611],
        [0.8465, 0.1535],
        [0.8467, 0.1533],
        [0.6072, 0.3928]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.0706,  0.2888],
        [-1.2242, -0.3940],
        [-1.5442,  1.7407],
        [ 1.5291, -1.3467],
        [ 0.7502, -0.5341],
        [ 0.4801,  1.6680],
        [ 0.2144, -0.4377],
        [ 1.0345,  0.0846],
        [-1.3240,  1.8829],
        [ 1.2375, -0.4696],
        [ 1.6009, -0.1084],
        [ 0.0891, -0.3463]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.3810, 0.6190],
        [0.4203, 0.5797],
        [0.2147, 0.7853],
        [0.9254, 0.0746],
        [0.8800, 0.1200],
        [0.2953, 0.7047],
        [0.9208, 0.0792],
        [0.8840, 0.1160],
        [0.0867, 0.9133],
        [0.7782, 0.2218],
        [0.7767, 0.2233],
        [0.8514, 0.1486]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 5, Epoch 1/3, Batch 5/80
temp: 0.9940, beta: 0.0035, 
nri_train_loss: 4.6332, enc_train_loss: 2.7148, enc_train_entropy: 0.4669, dec_train_loss: 4.2502, enc_train_edge_accuracy: 0.5000

Edge pred tensor([[0.5338, 0.4662],
        [0.7960, 0.2040],
        [0.2025, 0.7975],
        [0.2946, 0.7054],
        [0.5796, 0.4204],
        [0.0493, 0.9507],
        [0.5232, 0.4768],
        [0.3413, 0.6587],
        [0.0814, 0.9186],
        [0.9735, 0.0265],
        [0.9771, 0.0229],
        [0.9928, 0.0072]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.6905, -0.8260],
        [-0.1262, -1.4875],
        [-1.6662, -0.2954],
        [ 0.3196,  1.1929],
        [ 0.3773,  0.0561],
        [-1.3812,  1.5775],
        [ 0.4532,  0.3605],
        [ 0.1740,  0.8316],
        [-1.3192,  1.1048],
        [ 2.9589, -0.6454],
        [ 3.2989, -0.4547],
        [ 3.2314, -1.6999]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.4651, 0.5349],
        [0.8873, 0.1127],
        [0.5859, 0.4141],
        [0.9902, 0.0098],
        [0.5231, 0.4769],
        [0.0241, 0.9759],
        [0.6649, 0.3351],
        [0.4213, 0.5787],
        [0.0961, 0.9039],
        [0.9931, 0.0069],
        [0.9861, 0.0139],
        [0.9818, 0.0182]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.1960, 0.8040],
        [0.1541, 0.8459],
        [0.0169, 0.9831],
        [0.9383, 0.0617],
        [0.8202, 0.1798],
        [0.1424, 0.8576],
        [0.6722, 0.3278],
        [0.5407, 0.4593],
        [0.1037, 0.8963],
        [0.9504, 0.0496],
        [0.9081, 0.0919],
        [0.8555, 0.1445]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.9757,  2.3872],
        [-0.8227,  0.8803],
        [-1.9809,  2.0821],
        [ 2.4418, -0.2800],
        [ 1.0961, -0.4217],
        [-0.1337,  1.6617],
        [ 0.4109, -0.3071],
        [ 1.1505,  0.9871],
        [-1.2224,  0.9345],
        [ 1.9059, -1.0471],
        [ 2.7975,  0.5072],
        [ 0.7191, -1.0595]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.1729, 0.8271],
        [0.1782, 0.8218],
        [0.0182, 0.9818],
        [0.9904, 0.0096],
        [0.9318, 0.0682],
        [0.1184, 0.8816],
        [0.7564, 0.2436],
        [0.0164, 0.9836],
        [0.2988, 0.7012],
        [0.4512, 0.5488],
        [0.8234, 0.1766],
        [0.7076, 0.2924]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.4588, 0.5412],
        [0.5618, 0.4382],
        [0.2488, 0.7512],
        [0.8068, 0.1932],
        [0.7291, 0.2709],
        [0.3082, 0.6918],
        [0.7971, 0.2029],
        [0.4851, 0.5149],
        [0.3072, 0.6928],
        [0.9046, 0.0954],
        [0.4956, 0.5044],
        [0.5040, 0.4960]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.5209, -0.3558],
        [ 0.5628,  0.3143],
        [-0.0796,  1.0255],
        [-0.5969, -2.0263],
        [ 0.7464, -0.2437],
        [-0.7371,  0.0715],
        [ 0.4838, -0.8846],
        [ 0.0640,  0.1234],
        [ 0.5994,  1.4126],
        [ 0.3273, -1.9215],
        [-1.0974, -1.0797],
        [ 0.4223,  0.4064]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.1674, 0.8326],
        [0.9803, 0.0197],
        [0.0956, 0.9044],
        [0.9832, 0.0168],
        [0.6540, 0.3460],
        [0.1243, 0.8757],
        [0.7528, 0.2472],
        [0.4941, 0.5059],
        [0.0706, 0.9294],
        [0.7095, 0.2905],
        [0.3830, 0.6170],
        [0.1592, 0.8408]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.9839, 0.0161],
        [0.8916, 0.1084],
        [0.1539, 0.8461],
        [0.2657, 0.7343],
        [0.7549, 0.2451],
        [0.1073, 0.8927],
        [0.0535, 0.9465],
        [0.4298, 0.5702],
        [0.0146, 0.9854],
        [0.7375, 0.2625],
        [0.9846, 0.0154],
        [0.9247, 0.0753]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.6275, -2.4853],
        [ 1.1875, -0.9201],
        [-0.8725,  0.8317],
        [-1.5730, -0.5566],
        [ 0.7175, -0.4076],
        [-0.6943,  1.4244],
        [-1.8963,  0.9775],
        [ 0.1264,  0.4092],
        [-1.4453,  2.7676],
        [-0.2954, -1.3282],
        [ 2.2543, -1.9041],
        [ 1.8211, -0.6866]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9442e-01, 5.5790e-03],
        [9.9989e-01, 1.0890e-04],
        [6.0723e-01, 3.9277e-01],
        [9.1477e-01, 8.5230e-02],
        [7.8317e-01, 2.1683e-01],
        [8.0184e-02, 9.1982e-01],
        [6.0963e-02, 9.3904e-01],
        [4.1666e-01, 5.8334e-01],
        [9.3642e-03, 9.9064e-01],
        [6.7688e-01, 3.2312e-01],
        [9.9687e-01, 3.1317e-03],
        [8.9681e-01, 1.0319e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.1444, 0.8556],
        [0.5069, 0.4931],
        [0.1172, 0.8828],
        [0.0898, 0.9102],
        [0.4684, 0.5316],
        [0.0833, 0.9167],
        [0.2384, 0.7616],
        [0.1935, 0.8065],
        [0.1467, 0.8533],
        [0.8670, 0.1330],
        [0.7373, 0.2627],
        [0.9594, 0.0406]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.9856,  2.7651],
        [ 0.6371,  0.6093],
        [-0.3876,  1.6321],
        [-0.0460,  2.2705],
        [ 0.1356,  0.2623],
        [-1.2190,  1.1793],
        [-0.1456,  1.0160],
        [-0.1114,  1.3158],
        [-0.9678,  0.7930],
        [ 1.7700, -0.1047],
        [ 1.5955,  0.5633],
        [ 1.7037, -1.4591]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.0381, 0.9619],
        [0.0485, 0.9515],
        [0.1857, 0.8143],
        [0.1413, 0.8587],
        [0.6900, 0.3100],
        [0.0722, 0.9278],
        [0.2227, 0.7773],
        [0.6226, 0.3774],
        [0.0631, 0.9369],
        [0.9885, 0.0115],
        [0.6146, 0.3854],
        [0.9367, 0.0633]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 10, Epoch 1/3, Batch 10/80
temp: 0.9891, beta: 0.0069, 
nri_train_loss: 4.3814, enc_train_loss: 3.5696, enc_train_entropy: 0.3957, dec_train_loss: 4.0401, enc_train_edge_accuracy: 0.4850

Edge pred tensor([[0.9232, 0.0768],
        [0.9694, 0.0306],
        [0.4354, 0.5646],
        [0.3499, 0.6501],
        [0.7547, 0.2453],
        [0.0347, 0.9653],
        [0.3759, 0.6241],
        [0.4012, 0.5988],
        [0.0429, 0.9571],
        [0.9610, 0.0390],
        [0.9847, 0.0153],
        [0.9969, 0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.5896, -1.8975],
        [ 0.9790, -2.4773],
        [-0.8171, -0.5572],
        [-0.1929,  0.4267],
        [-0.2246, -1.3485],
        [-2.0917,  1.2330],
        [-0.5568, -0.0500],
        [-0.2182,  0.1824],
        [-1.9316,  1.1733],
        [ 2.3947, -0.8107],
        [ 3.2719, -0.8918],
        [ 3.3617, -2.4112]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.9723, 0.0277],
        [0.8987, 0.1013],
        [0.7460, 0.2540],
        [0.6273, 0.3727],
        [0.9737, 0.0263],
        [0.0935, 0.9065],
        [0.7926, 0.2074],
        [0.6204, 0.3796],
        [0.1408, 0.8592],
        [0.9986, 0.0014],
        [0.9429, 0.0571],
        [0.9970, 0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.6770, 0.3230],
        [0.7428, 0.2572],
        [0.0239, 0.9761],
        [0.4704, 0.5296],
        [0.7518, 0.2482],
        [0.0483, 0.9517],
        [0.5345, 0.4655],
        [0.6367, 0.3633],
        [0.0331, 0.9669],
        [0.8625, 0.1375],
        [0.9040, 0.0960],
        [0.9426, 0.0574]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.2985, -1.0386],
        [ 1.4608,  0.4001],
        [-1.4140,  2.2967],
        [-0.5802, -0.4616],
        [ 0.7664, -0.3417],
        [-1.8418,  1.1383],
        [ 0.9112,  0.7729],
        [ 0.4813, -0.0798],
        [-0.2796,  3.0962],
        [ 0.6115, -1.2246],
        [ 0.4364, -1.8064],
        [ 2.1895, -0.6084]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.8521, 0.1479],
        [0.5088, 0.4912],
        [0.0271, 0.9729],
        [0.8755, 0.1245],
        [0.6725, 0.3275],
        [0.1214, 0.8786],
        [0.0390, 0.9610],
        [0.4784, 0.5216],
        [0.0550, 0.9450],
        [0.8447, 0.1553],
        [0.6262, 0.3738],
        [0.9259, 0.0741]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.1413, 0.8587],
        [0.2602, 0.7398],
        [0.0660, 0.9340],
        [0.1439, 0.8561],
        [0.2798, 0.7202],
        [0.0663, 0.9337],
        [0.3851, 0.6149],
        [0.3690, 0.6310],
        [0.1160, 0.8840],
        [0.8776, 0.1224],
        [0.8384, 0.1616],
        [0.9047, 0.0953]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.5139,  3.3182],
        [ 0.9030,  1.9481],
        [-0.0826,  2.5672],
        [ 0.8284,  2.6115],
        [ 0.4453,  1.3907],
        [-0.6068,  2.0385],
        [ 0.7515,  1.2194],
        [ 0.5608,  1.0972],
        [-1.1143,  0.9162],
        [ 1.8018, -0.1683],
        [ 1.7862,  0.1399],
        [ 0.9490, -1.3014]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.1039, 0.8961],
        [0.1533, 0.8467],
        [0.0044, 0.9956],
        [0.0360, 0.9640],
        [0.0750, 0.9250],
        [0.0639, 0.9361],
        [0.6434, 0.3566],
        [0.9893, 0.0107],
        [0.7315, 0.2685],
        [0.1966, 0.8034],
        [0.9516, 0.0484],
        [0.8666, 0.1334]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.0440, 0.9560],
        [0.0881, 0.9119],
        [0.1121, 0.8879],
        [0.8343, 0.1657],
        [0.5239, 0.4761],
        [0.2712, 0.7288],
        [0.5597, 0.4403],
        [0.1071, 0.8929],
        [0.1917, 0.8083],
        [0.9850, 0.0150],
        [0.7375, 0.2625],
        [0.8505, 0.1495]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.0441,  2.0350],
        [-1.3223,  1.0144],
        [-0.4026,  1.6666],
        [ 2.1795,  0.5630],
        [ 1.1048,  1.0092],
        [ 0.8779,  1.8666],
        [ 0.8245,  0.5845],
        [-0.1401,  1.9804],
        [-0.1668,  1.2724],
        [ 2.0829, -2.0995],
        [ 0.5845, -0.4484],
        [ 0.1391, -1.5991]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.0481, 0.9519],
        [0.3359, 0.6641],
        [0.0363, 0.9637],
        [0.6211, 0.3789],
        [0.0696, 0.9304],
        [0.2117, 0.7883],
        [0.8389, 0.1611],
        [0.3582, 0.6418],
        [0.3060, 0.6940],
        [0.9871, 0.0129],
        [0.8296, 0.1704],
        [0.3535, 0.6465]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.1119, 0.8881],
        [0.1026, 0.8974],
        [0.0092, 0.9908],
        [0.6790, 0.3210],
        [0.6333, 0.3667],
        [0.1503, 0.8497],
        [0.9633, 0.0367],
        [0.9748, 0.0252],
        [0.7105, 0.2895],
        [0.9766, 0.0234],
        [0.9842, 0.0158],
        [0.9781, 0.0219]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.8786,  1.1924],
        [-1.1191,  1.0501],
        [-2.2176,  2.4630],
        [-0.1985, -0.9478],
        [-0.1161, -0.6625],
        [-1.4347,  0.2974],
        [ 1.8124, -1.4557],
        [ 2.4918, -1.1650],
        [ 0.6963, -0.2015],
        [ 2.5594, -1.1710],
        [ 2.9862, -1.1439],
        [ 3.0347, -0.7644]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.0798, 0.9202],
        [0.0368, 0.9632],
        [0.0015, 0.9985],
        [0.9123, 0.0877],
        [0.6267, 0.3733],
        [0.7903, 0.2097],
        [0.8738, 0.1262],
        [0.9748, 0.0252],
        [0.7383, 0.2617],
        [0.8248, 0.1752],
        [0.9614, 0.0386],
        [0.9968, 0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 15, Epoch 1/3, Batch 15/80
temp: 0.9841, beta: 0.0104, 
nri_train_loss: 4.2345, enc_train_loss: 4.1451, enc_train_entropy: 0.3477, dec_train_loss: 3.9132, enc_train_edge_accuracy: 0.4633

Edge pred tensor([[0.7544, 0.2456],
        [0.6622, 0.3378],
        [0.0164, 0.9836],
        [0.9920, 0.0080],
        [0.9502, 0.0498],
        [0.1694, 0.8306],
        [0.8192, 0.1808],
        [0.5992, 0.4008],
        [0.0126, 0.9874],
        [0.9566, 0.0434],
        [0.8371, 0.1629],
        [0.6076, 0.3924]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.3607,  0.2384],
        [ 0.4938, -0.1795],
        [-1.8684,  2.2263],
        [ 1.3902, -3.4336],
        [ 1.3311, -1.6179],
        [-0.9779,  0.6122],
        [-0.3644, -1.8756],
        [ 0.4516,  0.0496],
        [-2.4244,  1.9398],
        [ 0.8373, -2.2561],
        [ 1.7336,  0.0966],
        [ 0.5207,  0.0835]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.2866, 0.7134],
        [0.0479, 0.9521],
        [0.0161, 0.9839],
        [0.9669, 0.0331],
        [0.9875, 0.0125],
        [0.0526, 0.9474],
        [0.9902, 0.0098],
        [0.2680, 0.7320],
        [0.0087, 0.9913],
        [0.9611, 0.0389],
        [0.8482, 0.1518],
        [0.8799, 0.1201]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.9869, 0.0131],
        [0.9582, 0.0418],
        [0.5551, 0.4449],
        [0.6765, 0.3235],
        [0.4949, 0.5051],
        [0.0618, 0.9382],
        [0.7161, 0.2839],
        [0.9127, 0.0873],
        [0.0507, 0.9493],
        [0.9873, 0.0127],
        [0.9959, 0.0041],
        [0.9834, 0.0166]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.3026, -3.0165],
        [ 0.9470, -2.1862],
        [-0.5682, -0.7894],
        [ 0.5146, -0.2231],
        [-0.3610, -0.3407],
        [-2.0040,  0.7161],
        [ 0.3019, -0.6233],
        [ 0.5879, -1.7595],
        [-2.0341,  0.8961],
        [ 2.2500, -2.1012],
        [ 2.7294, -2.7570],
        [ 2.2908, -1.7923]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.8936e-01, 1.0643e-02],
        [9.9896e-01, 1.0447e-03],
        [8.2340e-01, 1.7660e-01],
        [4.1816e-01, 5.8184e-01],
        [9.4740e-02, 9.0526e-01],
        [6.8238e-02, 9.3176e-01],
        [3.9942e-01, 6.0058e-01],
        [9.0786e-01, 9.2136e-02],
        [1.7481e-02, 9.8252e-01],
        [9.9840e-01, 1.6025e-03],
        [9.9969e-01, 3.1346e-04],
        [7.4553e-01, 2.5447e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[8.3054e-01, 1.6946e-01],
        [5.9439e-01, 4.0561e-01],
        [2.1051e-02, 9.7895e-01],
        [3.5922e-01, 6.4078e-01],
        [1.2372e-01, 8.7628e-01],
        [3.8103e-03, 9.9619e-01],
        [1.5499e-01, 8.4501e-01],
        [5.6345e-02, 9.4366e-01],
        [9.9745e-04, 9.9900e-01],
        [9.8482e-01, 1.5176e-02],
        [9.9071e-01, 9.2869e-03],
        [9.7203e-01, 2.7971e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.5515, -0.0380],
        [ 0.1895, -0.1927],
        [-1.8233,  2.0162],
        [ 1.5533,  2.1320],
        [-0.6180,  1.3397],
        [-2.5953,  2.9710],
        [ 0.6607,  2.3566],
        [-1.0059,  1.8124],
        [-3.8994,  3.0099],
        [ 3.9223, -0.2505],
        [ 3.2563, -1.4135],
        [ 1.7173, -1.8309]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.9495e-01, 1.0505e-01],
        [3.4821e-02, 9.6518e-01],
        [2.4774e-03, 9.9752e-01],
        [4.9641e-01, 5.0359e-01],
        [1.7400e-01, 8.2600e-01],
        [1.6724e-03, 9.9833e-01],
        [4.2231e-01, 5.7769e-01],
        [1.9908e-02, 9.8009e-01],
        [5.9677e-06, 9.9999e-01],
        [9.3199e-01, 6.8014e-02],
        [9.5664e-01, 4.3362e-02],
        [9.4197e-01, 5.8035e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.8374, 0.1626],
        [0.9749, 0.0251],
        [0.2790, 0.7210],
        [0.9838, 0.0162],
        [0.9944, 0.0056],
        [0.5978, 0.4022],
        [0.8554, 0.1446],
        [0.6923, 0.3077],
        [0.0186, 0.9814],
        [0.9939, 0.0061],
        [0.9688, 0.0312],
        [0.9858, 0.0142]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.4169, -0.2223],
        [ 2.4211, -1.2370],
        [-0.0566,  0.8926],
        [ 2.5925, -1.5108],
        [ 3.2424, -1.9395],
        [ 0.8880,  0.4917],
        [ 1.0568, -0.7209],
        [ 0.9844,  0.1733],
        [-1.2658,  2.7011],
        [ 2.5689, -2.5296],
        [ 1.5498, -1.8845],
        [ 2.0453, -2.1934]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.8437, 0.1563],
        [0.9736, 0.0264],
        [0.5452, 0.4548],
        [0.9846, 0.0154],
        [0.9989, 0.0011],
        [0.7728, 0.2272],
        [0.8872, 0.1128],
        [0.7949, 0.2051],
        [0.0271, 0.9729],
        [0.9956, 0.0044],
        [0.9827, 0.0173],
        [0.9943, 0.0057]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.3683, 0.6317],
        [0.3265, 0.6735],
        [0.0054, 0.9946],
        [0.9142, 0.0858],
        [0.8179, 0.1821],
        [0.0434, 0.9566],
        [0.9490, 0.0510],
        [0.9636, 0.0364],
        [0.0234, 0.9766],
        [0.9802, 0.0198],
        [0.9688, 0.0312],
        [0.9366, 0.0634]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.8563, -0.3168],
        [-0.5068,  0.2173],
        [-2.3026,  2.9139],
        [ 1.3622, -1.0039],
        [ 1.3503, -0.1518],
        [-0.4708,  2.6211],
        [ 1.9195, -1.0048],
        [ 2.3173, -0.9575],
        [-0.3122,  3.4204],
        [ 2.3113, -1.5921],
        [ 1.7095, -1.7275],
        [ 1.6593, -1.0341]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.1772, 0.8228],
        [0.2327, 0.7673],
        [0.0073, 0.9927],
        [0.9608, 0.0392],
        [0.2672, 0.7328],
        [0.3654, 0.6346],
        [0.9832, 0.0168],
        [0.9805, 0.0195],
        [0.0892, 0.9108],
        [0.9952, 0.0048],
        [0.9972, 0.0028],
        [0.9568, 0.0432]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 20, Epoch 1/3, Batch 20/80
temp: 0.9792, beta: 0.0139, 
nri_train_loss: 3.9427, enc_train_loss: 4.9507, enc_train_entropy: 0.2806, dec_train_loss: 3.6494, enc_train_edge_accuracy: 0.4983

Edge pred tensor([[0.0965, 0.9035],
        [0.2520, 0.7480],
        [0.0044, 0.9956],
        [0.6192, 0.3808],
        [0.8447, 0.1553],
        [0.0338, 0.9662],
        [0.4765, 0.5235],
        [0.5414, 0.4586],
        [0.0245, 0.9755],
        [0.3804, 0.6196],
        [0.4619, 0.5381],
        [0.6887, 0.3113]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-5.2174e-01,  1.7151e+00],
        [-4.1583e-01,  6.7226e-01],
        [-2.1044e+00,  3.3229e+00],
        [-3.4221e-01, -8.2844e-01],
        [ 1.0934e+00, -5.9989e-01],
        [-1.2587e+00,  2.0948e+00],
        [-8.0662e-01, -7.1268e-01],
        [ 2.1009e-01,  4.4290e-02],
        [-1.6404e+00,  2.0448e+00],
        [ 2.3065e-03,  4.9013e-01],
        [ 9.9599e-01,  1.1487e+00],
        [ 1.4159e+00,  6.2168e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.0050, 0.9950],
        [0.2110, 0.7890],
        [0.0031, 0.9969],
        [0.6998, 0.3002],
        [0.9784, 0.0216],
        [0.0046, 0.9954],
        [0.4403, 0.5597],
        [0.0055, 0.9945],
        [0.0136, 0.9864],
        [0.1705, 0.8295],
        [0.9376, 0.0624],
        [0.2598, 0.7402]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.2540, 0.7460],
        [0.2358, 0.7642],
        [0.0035, 0.9965],
        [0.9082, 0.0918],
        [0.9141, 0.0859],
        [0.1504, 0.8496],
        [0.3371, 0.6629],
        [0.3692, 0.6308],
        [0.0109, 0.9891],
        [0.9394, 0.0606],
        [0.9721, 0.0279],
        [0.9045, 0.0955]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.3314,  0.7461],
        [-0.0432,  1.1328],
        [-2.0316,  3.6279],
        [ 1.0564, -1.2357],
        [ 1.9176, -0.4467],
        [ 0.6208,  2.3524],
        [-0.5872,  0.0891],
        [-0.0077,  0.5278],
        [-1.3775,  3.1268],
        [ 1.1302, -1.6116],
        [ 2.3439, -1.2054],
        [ 2.1751, -0.0730]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.2316, 0.7684],
        [0.6191, 0.3809],
        [0.0247, 0.9753],
        [0.9789, 0.0211],
        [0.9144, 0.0856],
        [0.0589, 0.9411],
        [0.5281, 0.4719],
        [0.2681, 0.7319],
        [0.0155, 0.9845],
        [0.5809, 0.4191],
        [0.9257, 0.0743],
        [0.2515, 0.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.9741, 0.0259],
        [0.8710, 0.1290],
        [0.0434, 0.9566],
        [0.9085, 0.0915],
        [0.8275, 0.1725],
        [0.0203, 0.9797],
        [0.9205, 0.0795],
        [0.9886, 0.0114],
        [0.0094, 0.9906],
        [0.9956, 0.0044],
        [0.9983, 0.0017],
        [0.9793, 0.0207]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.1191, -2.5100],
        [ 0.5236, -1.3864],
        [-1.6657,  1.4261],
        [ 1.0270, -1.2679],
        [ 0.5695, -0.9982],
        [-1.4758,  2.3993],
        [ 0.9809, -1.4679],
        [ 1.7596, -2.7020],
        [-1.8471,  2.8085],
        [ 2.9387, -2.4734],
        [ 2.7621, -3.5928],
        [ 1.7246, -2.1326]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.0896e-01, 9.1036e-02],
        [9.4046e-01, 5.9545e-02],
        [3.2532e-03, 9.9675e-01],
        [9.1663e-01, 8.3374e-02],
        [6.9367e-01, 3.0633e-01],
        [8.6378e-05, 9.9991e-01],
        [9.8236e-01, 1.7637e-02],
        [9.9984e-01, 1.5738e-04],
        [5.6462e-03, 9.9435e-01],
        [9.9989e-01, 1.1407e-04],
        [9.8556e-01, 1.4437e-02],
        [9.8999e-01, 1.0008e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.0369, 0.9631],
        [0.3732, 0.6268],
        [0.0069, 0.9931],
        [0.3226, 0.6774],
        [0.3614, 0.6386],
        [0.0097, 0.9903],
        [0.6483, 0.3517],
        [0.1423, 0.8577],
        [0.0664, 0.9336],
        [0.9424, 0.0576],
        [0.5620, 0.4380],
        [0.9166, 0.0834]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.8439,  1.4191],
        [ 1.0322,  1.5507],
        [-1.1513,  3.8251],
        [-1.5607, -0.8188],
        [ 0.3166,  0.8861],
        [-2.2922,  2.3386],
        [-0.4494, -1.0612],
        [-1.4046,  0.3920],
        [-0.5954,  2.0486],
        [ 0.5569, -2.2389],
        [-0.9038, -1.1529],
        [ 2.0857, -0.3117]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.0042, 0.9958],
        [0.7428, 0.2572],
        [0.0041, 0.9959],
        [0.8527, 0.1473],
        [0.1472, 0.8528],
        [0.0099, 0.9901],
        [0.7577, 0.2423],
        [0.2377, 0.7623],
        [0.1124, 0.8876],
        [0.9922, 0.0078],
        [0.0919, 0.9081],
        [0.5049, 0.4951]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.7503, 0.2497],
        [0.7805, 0.2195],
        [0.0086, 0.9914],
        [0.9669, 0.0331],
        [0.9680, 0.0320],
        [0.0203, 0.9797],
        [0.9006, 0.0994],
        [0.9357, 0.0643],
        [0.0081, 0.9919],
        [0.9900, 0.0100],
        [0.9928, 0.0072],
        [0.9945, 0.0055]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.3334, -1.4338],
        [-0.0697, -1.3384],
        [-1.8145,  2.9371],
        [ 1.7131, -1.6599],
        [ 0.9438, -2.4662],
        [-1.5436,  2.3332],
        [ 1.4873, -0.7162],
        [ 0.9408, -1.7372],
        [-1.4000,  3.4136],
        [ 3.0272, -1.5643],
        [ 1.8285, -3.0968],
        [ 2.2276, -2.9670]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.8180, 0.1820],
        [0.8156, 0.1844],
        [0.1211, 0.8789],
        [0.5041, 0.4959],
        [0.9926, 0.0074],
        [0.0238, 0.9762],
        [0.9287, 0.0713],
        [0.9137, 0.0863],
        [0.0247, 0.9753],
        [0.9953, 0.0047],
        [0.8315, 0.1685],
        [0.9441, 0.0559]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 25, Epoch 1/3, Batch 25/80
temp: 0.9743, beta: 0.0174, 
nri_train_loss: 3.8446, enc_train_loss: 5.1241, enc_train_entropy: 0.2661, dec_train_loss: 3.5427, enc_train_edge_accuracy: 0.5017

Edge pred tensor([[0.1078, 0.8922],
        [0.2559, 0.7441],
        [0.0079, 0.9921],
        [0.5456, 0.4544],
        [0.7636, 0.2364],
        [0.0622, 0.9378],
        [0.8274, 0.1726],
        [0.7342, 0.2658],
        [0.1094, 0.8906],
        [0.8308, 0.1692],
        [0.5585, 0.4415],
        [0.6839, 0.3161]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.9617,  1.1518],
        [ 0.2698,  1.3374],
        [-1.1133,  3.7135],
        [-0.7521, -0.9349],
        [-0.0774, -1.2499],
        [-1.7311,  0.9815],
        [ 1.4647, -0.1027],
        [ 0.8141, -0.2018],
        [ 0.3507,  2.4477],
        [ 0.8729, -0.7185],
        [-0.5382, -0.7734],
        [ 0.8924,  0.1205]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[6.7531e-01, 3.2469e-01],
        [3.5550e-01, 6.4450e-01],
        [1.4890e-02, 9.8511e-01],
        [8.0158e-01, 1.9842e-01],
        [9.2020e-01, 7.9798e-02],
        [2.2750e-02, 9.7725e-01],
        [3.9102e-01, 6.0898e-01],
        [9.4329e-01, 5.6712e-02],
        [6.8849e-04, 9.9931e-01],
        [8.3240e-01, 1.6760e-01],
        [7.9981e-01, 2.0019e-01],
        [3.5483e-01, 6.4517e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.4448e-01, 5.5522e-02],
        [9.8378e-01, 1.6216e-02],
        [1.2865e-01, 8.7135e-01],
        [1.0057e-02, 9.8994e-01],
        [2.2207e-01, 7.7793e-01],
        [1.2619e-03, 9.9874e-01],
        [1.3792e-02, 9.8621e-01],
        [1.1395e-01, 8.8605e-01],
        [9.9942e-04, 9.9900e-01],
        [9.9261e-01, 7.3946e-03],
        [9.9725e-01, 2.7495e-03],
        [9.9947e-01, 5.3474e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.9243, -0.9095],
        [ 2.7900, -1.3154],
        [-1.4568,  0.4561],
        [-2.5405,  2.0488],
        [-0.3470,  0.9066],
        [-4.2752,  2.3987],
        [-2.0388,  2.2310],
        [-0.7362,  1.3148],
        [-3.5162,  3.3911],
        [ 1.7374, -3.1622],
        [ 2.5198, -3.3738],
        [ 3.5156, -4.0176]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.7626e-01, 1.2374e-01],
        [9.8791e-01, 1.2086e-02],
        [1.9117e-02, 9.8088e-01],
        [7.8553e-03, 9.9214e-01],
        [7.5929e-01, 2.4071e-01],
        [9.6587e-04, 9.9903e-01],
        [6.2768e-03, 9.9372e-01],
        [2.6662e-01, 7.3338e-01],
        [1.0774e-03, 9.9892e-01],
        [9.9651e-01, 3.4940e-03],
        [9.9833e-01, 1.6670e-03],
        [9.9452e-01, 5.4819e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.6760e-01, 3.2404e-02],
        [9.9185e-01, 8.1503e-03],
        [3.1503e-02, 9.6850e-01],
        [8.9802e-01, 1.0198e-01],
        [9.9109e-01, 8.9058e-03],
        [3.1253e-02, 9.6875e-01],
        [5.6777e-01, 4.3223e-01],
        [8.6904e-01, 1.3096e-01],
        [8.1358e-03, 9.9186e-01],
        [9.9751e-01, 2.4914e-03],
        [9.9874e-01, 1.2610e-03],
        [9.9923e-01, 7.7354e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.6873, -1.7092],
        [ 1.8576, -2.9439],
        [-1.2439,  2.1818],
        [ 1.0552, -1.1202],
        [ 2.1950, -2.5171],
        [-0.5014,  2.9325],
        [-0.5972, -0.8699],
        [ 0.2992, -1.5934],
        [-2.1656,  2.6377],
        [ 3.3950, -2.5974],
        [ 3.9356, -2.7390],
        [ 3.8791, -3.2846]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.4484e-01, 5.5162e-02],
        [7.1597e-01, 2.8403e-01],
        [1.1306e-02, 9.8869e-01],
        [9.1805e-01, 8.1949e-02],
        [9.9233e-01, 7.6664e-03],
        [8.2127e-02, 9.1787e-01],
        [5.3684e-01, 4.6316e-01],
        [6.7224e-01, 3.2776e-01],
        [1.5907e-03, 9.9841e-01],
        [9.9968e-01, 3.2411e-04],
        [9.9934e-01, 6.5614e-04],
        [9.9767e-01, 2.3318e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.5675e-02, 9.8432e-01],
        [2.4358e-02, 9.7564e-01],
        [7.6295e-04, 9.9924e-01],
        [2.0795e-01, 7.9205e-01],
        [1.9252e-01, 8.0748e-01],
        [3.4315e-03, 9.9657e-01],
        [7.7222e-02, 9.2278e-01],
        [1.0381e-01, 8.9619e-01],
        [2.6598e-03, 9.9734e-01],
        [9.7646e-01, 2.3541e-02],
        [9.8575e-01, 1.4254e-02],
        [9.8017e-01, 1.9834e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.7483,  3.3916],
        [-1.6338,  2.0564],
        [-3.2462,  3.9314],
        [-0.0442,  1.2931],
        [-0.3319,  1.1018],
        [-2.3939,  3.2774],
        [-1.8856,  0.5951],
        [-1.2436,  0.9120],
        [-3.7855,  2.1413],
        [ 1.6773, -2.0479],
        [ 3.0831, -1.1533],
        [ 1.7932, -2.1071]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.3884e-03, 9.9161e-01],
        [2.2443e-02, 9.7756e-01],
        [5.6874e-04, 9.9943e-01],
        [4.5654e-02, 9.5435e-01],
        [4.9176e-01, 5.0824e-01],
        [3.4830e-02, 9.6517e-01],
        [3.0466e-02, 9.6953e-01],
        [4.6307e-01, 5.3693e-01],
        [1.0305e-02, 9.8969e-01],
        [9.5960e-01, 4.0399e-02],
        [9.9631e-01, 3.6899e-03],
        [9.9722e-01, 2.7845e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9848e-01, 1.5187e-03],
        [9.9835e-01, 1.6478e-03],
        [7.3264e-01, 2.6736e-01],
        [6.0699e-02, 9.3930e-01],
        [2.9383e-01, 7.0617e-01],
        [2.5583e-03, 9.9744e-01],
        [2.2632e-01, 7.7368e-01],
        [9.1216e-01, 8.7839e-02],
        [4.6241e-03, 9.9538e-01],
        [9.9589e-01, 4.1122e-03],
        [9.9983e-01, 1.7383e-04],
        [9.9913e-01, 8.6970e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.2266, -3.2618],
        [ 4.0528, -2.3539],
        [ 0.2820, -0.7260],
        [-0.1905,  2.5487],
        [ 0.1725,  1.0493],
        [-3.1263,  2.8395],
        [ 0.3166,  1.5458],
        [ 0.9820, -1.3583],
        [-2.5990,  2.7728],
        [ 3.0707, -2.4189],
        [ 3.8734, -4.7838],
        [ 3.7030, -3.3435]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9971e-01, 2.9038e-04],
        [9.9942e-01, 5.7744e-04],
        [5.6748e-01, 4.3252e-01],
        [7.0501e-02, 9.2950e-01],
        [4.6269e-01, 5.3731e-01],
        [9.0345e-04, 9.9910e-01],
        [4.4788e-01, 5.5212e-01],
        [9.3867e-01, 6.1328e-02],
        [1.8150e-03, 9.9818e-01],
        [9.6737e-01, 3.2628e-02],
        [1.0000e+00, 2.6931e-06],
        [9.8840e-01, 1.1598e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 30, Epoch 1/3, Batch 30/80
temp: 0.9695, beta: 0.0208, 
nri_train_loss: 3.6266, enc_train_loss: 5.5276, enc_train_entropy: 0.2325, dec_train_loss: 3.3255, enc_train_edge_accuracy: 0.4917

Edge pred tensor([[9.7939e-01, 2.0612e-02],
        [9.7398e-01, 2.6016e-02],
        [1.2025e-01, 8.7975e-01],
        [2.3595e-01, 7.6405e-01],
        [4.5688e-02, 9.5431e-01],
        [4.6630e-04, 9.9953e-01],
        [6.0135e-01, 3.9865e-01],
        [1.9037e-01, 8.0963e-01],
        [4.3444e-03, 9.9566e-01],
        [9.9857e-01, 1.4319e-03],
        [9.9575e-01, 4.2507e-03],
        [9.9795e-01, 2.0516e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.0458e+00, -1.8153e+00],
        [ 1.9390e+00, -1.6837e+00],
        [ 3.1705e-03,  1.9932e+00],
        [ 3.1731e-01,  1.4923e+00],
        [-1.7840e+00,  1.2551e+00],
        [-3.8406e+00,  3.8296e+00],
        [ 1.3799e+00,  9.6878e-01],
        [-1.1114e+00,  3.3624e-01],
        [-2.9474e+00,  2.4871e+00],
        [ 4.9223e+00, -1.6250e+00],
        [ 2.5307e+00, -2.9257e+00],
        [ 3.1799e+00, -3.0072e+00]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.8262e-01, 1.7377e-02],
        [9.9743e-01, 2.5739e-03],
        [2.3957e-01, 7.6043e-01],
        [7.8635e-01, 2.1365e-01],
        [6.8178e-02, 9.3182e-01],
        [1.0794e-06, 1.0000e+00],
        [2.4014e-01, 7.5986e-01],
        [7.7277e-01, 2.2723e-01],
        [3.0985e-03, 9.9690e-01],
        [9.9976e-01, 2.4362e-04],
        [9.8943e-01, 1.0570e-02],
        [9.9969e-01, 3.0812e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.5206e-01, 3.4794e-01],
        [7.7789e-01, 2.2211e-01],
        [4.5818e-03, 9.9542e-01],
        [4.8841e-01, 5.1159e-01],
        [4.5473e-01, 5.4527e-01],
        [1.4427e-03, 9.9856e-01],
        [1.0359e-01, 8.9641e-01],
        [1.4330e-01, 8.5670e-01],
        [2.8715e-04, 9.9971e-01],
        [9.9088e-01, 9.1227e-03],
        [9.9432e-01, 5.6786e-03],
        [9.9638e-01, 3.6237e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.3662, -0.9943],
        [ 1.2966,  0.0432],
        [-2.4546,  2.9265],
        [-0.2750, -0.2287],
        [ 0.0688,  0.2504],
        [-3.6236,  2.9162],
        [-0.4551,  1.7029],
        [-0.9105,  0.8776],
        [-3.2040,  4.9512],
        [ 2.1947, -2.4931],
        [ 1.4725, -3.6928],
        [ 2.9538, -2.6629]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.8207e-01, 7.1793e-01],
        [8.1640e-02, 9.1836e-01],
        [1.1560e-03, 9.9884e-01],
        [3.9759e-01, 6.0241e-01],
        [5.1764e-01, 4.8236e-01],
        [1.1572e-03, 9.9884e-01],
        [6.9193e-02, 9.3081e-01],
        [1.9285e-02, 9.8072e-01],
        [1.6546e-04, 9.9983e-01],
        [9.8741e-01, 1.2591e-02],
        [9.7832e-01, 2.1684e-02],
        [9.9963e-01, 3.7127e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.9201e-01, 3.0799e-01],
        [8.9216e-01, 1.0784e-01],
        [1.5457e-02, 9.8454e-01],
        [8.9394e-02, 9.1061e-01],
        [2.6451e-01, 7.3549e-01],
        [3.7432e-04, 9.9963e-01],
        [6.1695e-01, 3.8305e-01],
        [5.3628e-01, 4.6372e-01],
        [2.5760e-03, 9.9742e-01],
        [9.9907e-01, 9.3455e-04],
        [9.9955e-01, 4.5271e-04],
        [9.9982e-01, 1.7994e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.0516, -0.7580],
        [ 0.8301, -1.2829],
        [-2.8568,  1.2973],
        [-0.7005,  1.6206],
        [-0.4022,  0.6205],
        [-4.5051,  3.3849],
        [ 0.2677, -0.2090],
        [ 0.1230, -0.0224],
        [-3.5607,  2.3983],
        [ 4.3457, -2.6288],
        [ 4.8002, -2.8996],
        [ 5.1658, -3.4569]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.1255e-01, 4.8745e-01],
        [4.7151e-01, 5.2849e-01],
        [1.2265e-02, 9.8773e-01],
        [3.0972e-01, 6.9028e-01],
        [2.3716e-01, 7.6284e-01],
        [1.6363e-03, 9.9836e-01],
        [6.6060e-01, 3.3940e-01],
        [9.4924e-01, 5.0762e-02],
        [3.8629e-04, 9.9961e-01],
        [9.9981e-01, 1.9077e-04],
        [9.9632e-01, 3.6796e-03],
        [9.9591e-01, 4.0934e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.5510e-01, 4.4899e-02],
        [8.4853e-01, 1.5147e-01],
        [1.2066e-02, 9.8793e-01],
        [9.9580e-01, 4.2046e-03],
        [9.8887e-01, 1.1129e-02],
        [1.1478e-01, 8.8522e-01],
        [9.9064e-01, 9.3557e-03],
        [9.6322e-01, 3.6778e-02],
        [5.5821e-03, 9.9442e-01],
        [9.9905e-01, 9.4984e-04],
        [9.9729e-01, 2.7140e-03],
        [9.8626e-01, 1.3742e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.4408, -1.6166],
        [ 0.4029, -1.3202],
        [-2.2385,  2.1667],
        [ 1.7643, -3.7031],
        [ 1.9773, -2.5098],
        [-0.7429,  1.3000],
        [ 1.0984, -3.5640],
        [ 1.2724, -1.9930],
        [-2.5977,  2.5849],
        [ 3.0285, -3.9298],
        [ 3.1878, -2.7188],
        [ 2.2869, -1.9865]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.7679e-01, 2.3209e-02],
        [5.6041e-01, 4.3959e-01],
        [1.6453e-02, 9.8355e-01],
        [9.9988e-01, 1.2164e-04],
        [9.9942e-01, 5.7785e-04],
        [3.8576e-01, 6.1424e-01],
        [9.9263e-01, 7.3745e-03],
        [9.9704e-01, 2.9634e-03],
        [1.7730e-02, 9.8227e-01],
        [9.9987e-01, 1.2668e-04],
        [9.9795e-01, 2.0476e-03],
        [6.0285e-01, 3.9715e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.3323e-01, 8.6677e-01],
        [3.7049e-01, 6.2951e-01],
        [1.3432e-03, 9.9866e-01],
        [6.4813e-01, 3.5187e-01],
        [8.6447e-01, 1.3553e-01],
        [7.5434e-03, 9.9246e-01],
        [3.2773e-01, 6.7227e-01],
        [3.8386e-01, 6.1614e-01],
        [4.7382e-03, 9.9526e-01],
        [9.9829e-01, 1.7088e-03],
        [9.9843e-01, 1.5743e-03],
        [9.9949e-01, 5.0599e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.7076,  1.1651],
        [-0.7390, -0.2089],
        [-3.9065,  2.7049],
        [ 0.4718, -0.1390],
        [ 0.6868, -1.1661],
        [-3.2338,  1.6457],
        [-0.7265, -0.0080],
        [ 0.2579,  0.7312],
        [-3.3846,  1.9627],
        [ 3.4436, -2.9266],
        [ 4.8367, -1.6157],
        [ 4.2703, -3.3182]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.9327e-02, 9.8067e-01],
        [4.2704e-01, 5.7296e-01],
        [1.2448e-03, 9.9876e-01],
        [2.4923e-01, 7.5077e-01],
        [9.5733e-01, 4.2666e-02],
        [3.0656e-02, 9.6934e-01],
        [3.5901e-01, 6.4099e-01],
        [4.5208e-01, 5.4792e-01],
        [9.6144e-02, 9.0386e-01],
        [9.9709e-01, 2.9137e-03],
        [9.9989e-01, 1.1113e-04],
        [9.9971e-01, 2.9410e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 35, Epoch 1/3, Batch 35/80
temp: 0.9646, beta: 0.0243, 
nri_train_loss: 3.5031, enc_train_loss: 5.9518, enc_train_entropy: 0.1972, dec_train_loss: 3.2007, enc_train_edge_accuracy: 0.4917

Edge pred tensor([[9.9301e-01, 6.9923e-03],
        [9.9633e-01, 3.6669e-03],
        [2.0967e-01, 7.9033e-01],
        [9.3683e-01, 6.3166e-02],
        [9.7315e-01, 2.6852e-02],
        [2.0931e-02, 9.7907e-01],
        [7.1487e-01, 2.8513e-01],
        [7.5309e-01, 2.4691e-01],
        [3.3447e-03, 9.9666e-01],
        [9.9924e-01, 7.6503e-04],
        [9.9942e-01, 5.7633e-04],
        [9.9933e-01, 6.7106e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.6560, -2.2999],
        [ 3.0622, -2.5425],
        [-1.0480,  0.2789],
        [ 0.7644, -1.9323],
        [ 1.5320, -2.0582],
        [-2.9162,  0.9292],
        [ 0.0437, -0.8754],
        [ 0.2575, -0.8576],
        [-3.0279,  2.6691],
        [ 3.2117, -3.9631],
        [ 3.7206, -3.7377],
        [ 3.7811, -3.5249]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.7691e-01, 2.3089e-02],
        [9.9905e-01, 9.5418e-04],
        [4.3895e-01, 5.6105e-01],
        [9.9709e-01, 2.9128e-03],
        [9.9679e-01, 3.2093e-03],
        [4.3977e-01, 5.6023e-01],
        [9.0016e-01, 9.9845e-02],
        [7.4099e-01, 2.5901e-01],
        [1.7822e-03, 9.9822e-01],
        [9.9417e-01, 5.8254e-03],
        [9.9913e-01, 8.7184e-04],
        [9.9974e-01, 2.5734e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.6936e-02, 9.8306e-01],
        [3.3390e-03, 9.9666e-01],
        [7.9212e-05, 9.9992e-01],
        [9.9270e-01, 7.3002e-03],
        [8.0137e-01, 1.9863e-01],
        [2.0215e-02, 9.7978e-01],
        [5.2984e-01, 4.7016e-01],
        [7.1921e-02, 9.2808e-01],
        [1.9683e-04, 9.9980e-01],
        [9.9871e-01, 1.2876e-03],
        [9.8992e-01, 1.0084e-02],
        [9.5279e-01, 4.7207e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-3.5166e-01,  3.7096e+00],
        [-2.9998e+00,  2.6989e+00],
        [-4.3663e+00,  5.0770e+00],
        [ 3.0992e+00, -1.8134e+00],
        [ 1.1113e+00, -2.8362e-01],
        [-6.5210e-01,  3.2288e+00],
        [ 9.7343e-04, -1.1853e-01],
        [ 1.7198e-01,  2.7295e+00],
        [-4.0188e+00,  4.5142e+00],
        [ 2.8742e+00, -3.7795e+00],
        [ 3.5369e+00, -1.0498e+00],
        [ 9.8873e-01, -2.0161e+00]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.4729e-02, 9.6527e-01],
        [1.4559e-03, 9.9854e-01],
        [1.3387e-05, 9.9999e-01],
        [9.9131e-01, 8.6937e-03],
        [5.7958e-02, 9.4204e-01],
        [2.1009e-02, 9.7899e-01],
        [5.8797e-01, 4.1203e-01],
        [1.5940e-01, 8.4060e-01],
        [2.3152e-06, 1.0000e+00],
        [9.8481e-01, 1.5190e-02],
        [9.9989e-01, 1.0772e-04],
        [9.1731e-01, 8.2687e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[5.1031e-01, 4.8969e-01],
        [5.5251e-01, 4.4749e-01],
        [8.6507e-03, 9.9135e-01],
        [1.0174e-01, 8.9826e-01],
        [5.5001e-01, 4.4999e-01],
        [5.0471e-03, 9.9495e-01],
        [1.0950e-01, 8.9050e-01],
        [4.3819e-01, 5.6181e-01],
        [5.0219e-03, 9.9498e-01],
        [9.8788e-01, 1.2118e-02],
        [9.9765e-01, 2.3466e-03],
        [9.9929e-01, 7.1262e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.1343,  1.0931],
        [ 0.9640,  0.7532],
        [-1.2373,  3.5041],
        [-0.4137,  1.7644],
        [ 0.7552,  0.5545],
        [-2.0564,  3.2275],
        [-0.7712,  1.3247],
        [-0.2789, -0.0304],
        [-2.0686,  3.2204],
        [ 2.2754, -2.1255],
        [ 2.7830, -3.2695],
        [ 4.4503, -2.7955]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.0623e-01, 8.9377e-01],
        [3.5476e-01, 6.4524e-01],
        [1.3183e-02, 9.8682e-01],
        [7.0194e-01, 2.9806e-01],
        [7.0789e-01, 2.9211e-01],
        [7.4951e-05, 9.9993e-01],
        [3.4050e-01, 6.5950e-01],
        [2.1100e-01, 7.8900e-01],
        [2.7548e-02, 9.7245e-01],
        [9.9779e-01, 2.2146e-03],
        [7.0008e-01, 2.9992e-01],
        [9.9506e-01, 4.9357e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[8.7506e-01, 1.2494e-01],
        [9.1660e-01, 8.3400e-02],
        [1.5613e-02, 9.8439e-01],
        [1.0658e-02, 9.8934e-01],
        [1.7977e-01, 8.2023e-01],
        [5.1660e-04, 9.9948e-01],
        [4.4582e-03, 9.9554e-01],
        [4.0749e-02, 9.5925e-01],
        [2.1790e-04, 9.9978e-01],
        [9.8952e-01, 1.0477e-02],
        [9.9901e-01, 9.8643e-04],
        [9.9916e-01, 8.4253e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.1531, -0.7933],
        [ 1.7418, -0.6552],
        [-2.3910,  1.7528],
        [-2.6139,  1.9169],
        [-0.4875,  1.0304],
        [-4.1769,  3.3908],
        [-2.9188,  2.4897],
        [-1.3458,  1.8129],
        [-3.8983,  4.5330],
        [ 1.3695, -3.1785],
        [ 2.9614, -3.9591],
        [ 2.9664, -4.1119]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.6810e-01, 3.1904e-02],
        [6.8348e-01, 3.1652e-01],
        [2.1526e-03, 9.9785e-01],
        [3.9853e-03, 9.9601e-01],
        [2.0220e-02, 9.7978e-01],
        [1.8092e-04, 9.9982e-01],
        [7.1463e-04, 9.9929e-01],
        [4.2584e-01, 5.7416e-01],
        [2.1815e-05, 9.9998e-01],
        [9.7807e-01, 2.1933e-02],
        [9.4303e-01, 5.6966e-02],
        [9.9587e-01, 4.1325e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[8.3452e-01, 1.6548e-01],
        [9.6313e-01, 3.6871e-02],
        [9.9476e-03, 9.9005e-01],
        [4.2097e-02, 9.5790e-01],
        [4.7132e-01, 5.2868e-01],
        [2.0250e-04, 9.9980e-01],
        [3.9198e-01, 6.0802e-01],
        [2.9091e-01, 7.0909e-01],
        [1.3139e-03, 9.9869e-01],
        [9.9927e-01, 7.3488e-04],
        [9.9957e-01, 4.3210e-04],
        [9.9964e-01, 3.6044e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.7455,  0.1275],
        [ 2.8094, -0.4534],
        [-2.0815,  2.5189],
        [-0.1050,  3.0198],
        [ 1.0675,  1.1823],
        [-3.7963,  4.7082],
        [ 0.3323,  0.7712],
        [ 0.5460,  1.4370],
        [-3.4679,  3.1655],
        [ 4.7193, -2.4958],
        [ 5.6162, -2.1302],
        [ 5.0184, -2.9094]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.2683e-01, 2.7317e-01],
        [8.9391e-01, 1.0609e-01],
        [1.0006e-01, 8.9994e-01],
        [3.0701e-02, 9.6930e-01],
        [9.0196e-01, 9.8038e-02],
        [1.8326e-05, 9.9998e-01],
        [1.4026e-01, 8.5974e-01],
        [2.8395e-01, 7.1605e-01],
        [4.6367e-04, 9.9954e-01],
        [9.8932e-01, 1.0681e-02],
        [9.9990e-01, 1.0109e-04],
        [9.9969e-01, 3.1488e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 40, Epoch 1/3, Batch 40/80
temp: 0.9598, beta: 0.0278, 
nri_train_loss: 3.3967, enc_train_loss: 6.0733, enc_train_entropy: 0.1870, dec_train_loss: 3.0784, enc_train_edge_accuracy: 0.5017

Edge pred tensor([[6.5818e-01, 3.4182e-01],
        [4.6962e-01, 5.3038e-01],
        [6.9605e-03, 9.9304e-01],
        [3.7875e-01, 6.2125e-01],
        [5.7596e-01, 4.2404e-01],
        [5.7212e-03, 9.9428e-01],
        [9.8293e-01, 1.7073e-02],
        [9.7923e-01, 2.0774e-02],
        [1.5075e-01, 8.4925e-01],
        [9.9939e-01, 6.1491e-04],
        [9.9883e-01, 1.1678e-03],
        [9.9854e-01, 1.4567e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.8591,  0.2039],
        [ 0.8460,  0.9677],
        [-1.7767,  3.1838],
        [ 0.3737,  0.8685],
        [ 1.2446,  0.9384],
        [-2.1489,  3.0089],
        [ 3.5465, -0.5066],
        [ 2.8050, -1.0481],
        [ 0.7125,  2.4412],
        [ 4.4894, -2.9041],
        [ 2.8425, -3.9090],
        [ 4.2269, -2.3032]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.7222e-01, 1.2778e-01],
        [6.9320e-01, 3.0680e-01],
        [7.8404e-03, 9.9216e-01],
        [2.5327e-01, 7.4673e-01],
        [6.7689e-01, 3.2311e-01],
        [7.0888e-04, 9.9929e-01],
        [9.9440e-01, 5.6027e-03],
        [4.1355e-01, 5.8645e-01],
        [1.4700e-01, 8.5300e-01],
        [9.9987e-01, 1.3097e-04],
        [9.9934e-01, 6.5758e-04],
        [9.9979e-01, 2.1107e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.0301, 0.9699],
        [0.1986, 0.8014],
        [0.0081, 0.9919],
        [0.1167, 0.8833],
        [0.0757, 0.9243],
        [0.0012, 0.9988],
        [0.0355, 0.9645],
        [0.0059, 0.9941],
        [0.0013, 0.9987],
        [0.9935, 0.0065],
        [0.9677, 0.0323],
        [0.9923, 0.0077]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.8280,  1.6461],
        [-0.5840,  0.8114],
        [-2.4868,  2.3261],
        [-1.5663,  0.4580],
        [-0.3828,  2.1190],
        [-3.2805,  3.4419],
        [-1.3212,  1.9818],
        [-1.4566,  3.6725],
        [-2.2577,  4.3499],
        [ 1.0982, -3.9360],
        [ 1.0537, -2.3460],
        [ 2.1137, -2.7434]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.3521e-02, 9.5648e-01],
        [4.9361e-02, 9.5064e-01],
        [7.9344e-04, 9.9921e-01],
        [3.4473e-01, 6.5527e-01],
        [9.4256e-02, 9.0574e-01],
        [7.9142e-03, 9.9209e-01],
        [2.3248e-02, 9.7675e-01],
        [6.2918e-03, 9.9371e-01],
        [1.2672e-05, 9.9999e-01],
        [9.8798e-01, 1.2019e-02],
        [9.6495e-01, 3.5049e-02],
        [9.9912e-01, 8.7970e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.9078e-01, 3.0922e-01],
        [8.2950e-01, 1.7050e-01],
        [8.5546e-03, 9.9145e-01],
        [1.7167e-01, 8.2833e-01],
        [2.6564e-01, 7.3436e-01],
        [9.8707e-04, 9.9901e-01],
        [2.2336e-01, 7.7664e-01],
        [5.8312e-01, 4.1688e-01],
        [1.0311e-03, 9.9897e-01],
        [9.7793e-01, 2.2068e-02],
        [9.9296e-01, 7.0396e-03],
        [9.9573e-01, 4.2716e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.9935,  0.1897],
        [ 0.4888, -1.0932],
        [-1.7498,  3.0029],
        [-0.7421,  0.8317],
        [-0.8150,  0.2018],
        [-3.2028,  3.7170],
        [-0.9041,  0.3421],
        [-0.2677, -0.6033],
        [-3.2246,  3.6516],
        [ 2.5600, -1.2313],
        [ 3.0636, -1.8856],
        [ 3.0883, -2.3632]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.6916e-01, 3.0836e-02],
        [7.0346e-01, 2.9654e-01],
        [4.2213e-02, 9.5779e-01],
        [3.1025e-02, 9.6897e-01],
        [1.8266e-01, 8.1734e-01],
        [5.8783e-04, 9.9941e-01],
        [1.9451e-01, 8.0549e-01],
        [6.4803e-01, 3.5197e-01],
        [1.3622e-03, 9.9864e-01],
        [9.5743e-01, 4.2569e-02],
        [9.9979e-01, 2.1094e-04],
        [9.5972e-01, 4.0276e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.3238e-01, 6.6762e-01],
        [3.2769e-01, 6.7231e-01],
        [1.8731e-03, 9.9813e-01],
        [5.2356e-01, 4.7644e-01],
        [4.5375e-01, 5.4625e-01],
        [6.5495e-03, 9.9345e-01],
        [9.5902e-01, 4.0978e-02],
        [9.8525e-01, 1.4754e-02],
        [1.1271e-01, 8.8729e-01],
        [9.9831e-01, 1.6931e-03],
        [9.9922e-01, 7.8480e-04],
        [9.9849e-01, 1.5087e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.1176,  0.8151],
        [ 0.2359,  0.9545],
        [-3.1725,  3.1058],
        [-0.9699, -1.0642],
        [-0.2025, -0.0170],
        [-3.2620,  1.7598],
        [ 1.1380, -2.0149],
        [ 2.5580, -1.6434],
        [-1.0774,  0.9859],
        [ 3.4494, -2.9301],
        [ 4.4271, -2.7222],
        [ 4.8476, -1.6474]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.1016e-02, 9.4898e-01],
        [3.1605e-01, 6.8395e-01],
        [5.1235e-02, 9.4876e-01],
        [5.8608e-01, 4.1392e-01],
        [6.0637e-01, 3.9363e-01],
        [4.4195e-04, 9.9956e-01],
        [7.3300e-01, 2.6700e-01],
        [9.9064e-01, 9.3622e-03],
        [9.3604e-01, 6.3960e-02],
        [9.9516e-01, 4.8440e-03],
        [9.9994e-01, 5.8568e-05],
        [9.9634e-01, 3.6615e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.2235e-01, 8.7765e-01],
        [2.4015e-01, 7.5985e-01],
        [4.6709e-04, 9.9953e-01],
        [6.6083e-03, 9.9339e-01],
        [8.6115e-02, 9.1388e-01],
        [2.0708e-04, 9.9979e-01],
        [1.1106e-02, 9.8889e-01],
        [3.6674e-02, 9.6333e-01],
        [1.9698e-04, 9.9980e-01],
        [9.6496e-01, 3.5037e-02],
        [9.9363e-01, 6.3660e-03],
        [9.9888e-01, 1.1182e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.5686,  2.5390],
        [ 0.4837,  1.6355],
        [-3.3846,  4.2840],
        [-1.8676,  3.1452],
        [-0.9357,  1.4263],
        [-4.3947,  4.0875],
        [-2.0151,  2.4740],
        [-1.3931,  1.8752],
        [-4.1784,  4.3538],
        [ 1.3705, -1.9452],
        [ 2.4046, -2.6458],
        [ 3.4256, -3.3693]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.5306e-01, 6.4694e-01],
        [2.8725e-01, 7.1275e-01],
        [8.1986e-05, 9.9992e-01],
        [5.0405e-04, 9.9950e-01],
        [3.8482e-03, 9.9615e-01],
        [6.7602e-03, 9.9324e-01],
        [5.1946e-03, 9.9481e-01],
        [3.2898e-01, 6.7102e-01],
        [2.0079e-05, 9.9998e-01],
        [9.8531e-01, 1.4688e-02],
        [9.6434e-01, 3.5658e-02],
        [9.9465e-01, 5.3482e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 45, Epoch 1/3, Batch 45/80
temp: 0.9550, beta: 0.0312, 
nri_train_loss: 3.1923, enc_train_loss: 6.2060, enc_train_entropy: 0.1760, dec_train_loss: 2.8576, enc_train_edge_accuracy: 0.5083

Edge pred tensor([[9.4392e-01, 5.6080e-02],
        [9.8500e-01, 1.5004e-02],
        [3.9145e-02, 9.6085e-01],
        [6.1834e-02, 9.3817e-01],
        [3.8402e-01, 6.1598e-01],
        [1.3978e-03, 9.9860e-01],
        [6.5904e-01, 3.4096e-01],
        [9.3037e-01, 6.9628e-02],
        [2.0312e-02, 9.7969e-01],
        [9.9941e-01, 5.8823e-04],
        [9.9986e-01, 1.3680e-04],
        [9.9995e-01, 5.3395e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.8837, -0.9396],
        [ 2.1812, -2.0031],
        [-1.3149,  1.8857],
        [-0.7315,  1.9879],
        [-0.4442,  0.0283],
        [-3.7104,  2.8611],
        [ 0.0879, -0.5711],
        [ 0.5825, -2.0100],
        [-2.6620,  1.2140],
        [ 4.4775, -2.9603],
        [ 4.9553, -3.9415],
        [ 5.5715, -4.2662]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.3005e-01, 6.9952e-02],
        [9.9993e-01, 6.7028e-05],
        [5.2958e-02, 9.4704e-01],
        [1.0554e-01, 8.9446e-01],
        [7.8630e-01, 2.1370e-01],
        [2.3564e-04, 9.9976e-01],
        [8.4333e-01, 1.5667e-01],
        [7.4832e-01, 2.5168e-01],
        [1.0807e-02, 9.8919e-01],
        [9.9999e-01, 1.0668e-05],
        [9.9994e-01, 5.9100e-05],
        [9.9999e-01, 1.4865e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.5244e-02, 9.8476e-01],
        [2.1090e-02, 9.7891e-01],
        [1.8656e-04, 9.9981e-01],
        [7.4158e-01, 2.5842e-01],
        [1.0947e-01, 8.9053e-01],
        [3.6997e-04, 9.9963e-01],
        [1.6727e-01, 8.3273e-01],
        [8.6529e-03, 9.9135e-01],
        [9.4431e-05, 9.9991e-01],
        [9.9887e-01, 1.1329e-03],
        [9.7177e-01, 2.8232e-02],
        [9.9121e-01, 8.7883e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.4639,  2.7043],
        [-1.5892,  2.2485],
        [-4.0017,  4.5848],
        [ 1.4165,  0.3623],
        [-0.6787,  1.4175],
        [-3.4320,  4.4698],
        [-0.1012,  1.5039],
        [-1.6437,  3.0975],
        [-3.9274,  5.3402],
        [ 3.0964, -3.6854],
        [ 1.2812, -2.2575],
        [ 1.6174, -3.1081]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.8972e-02, 9.6103e-01],
        [1.4673e-02, 9.8533e-01],
        [1.5025e-04, 9.9985e-01],
        [9.0928e-01, 9.0718e-02],
        [1.4418e-01, 8.5582e-01],
        [7.9576e-05, 9.9992e-01],
        [1.7230e-01, 8.2770e-01],
        [2.4519e-01, 7.5482e-01],
        [7.1046e-05, 9.9993e-01],
        [9.9924e-01, 7.5563e-04],
        [9.9896e-01, 1.0392e-03],
        [9.9150e-01, 8.4964e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.0269e-01, 8.9731e-01],
        [2.4744e-01, 7.5256e-01],
        [1.8584e-03, 9.9814e-01],
        [1.7884e-01, 8.2116e-01],
        [8.3503e-02, 9.1650e-01],
        [6.6321e-04, 9.9934e-01],
        [5.4179e-02, 9.4582e-01],
        [1.3447e-02, 9.8655e-01],
        [3.3439e-04, 9.9967e-01],
        [9.9914e-01, 8.5885e-04],
        [9.9365e-01, 6.3491e-03],
        [9.9879e-01, 1.2109e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.9214,  1.2463],
        [-0.7162,  0.3961],
        [-3.4324,  2.8537],
        [-0.8392,  0.6851],
        [-0.7183,  1.6774],
        [-3.8499,  3.4679],
        [-1.0927,  1.7670],
        [-0.7863,  3.5092],
        [-3.3592,  4.6436],
        [ 3.0206, -4.0384],
        [ 3.0161, -2.0370],
        [ 3.2627, -3.4525]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.0885e-01, 7.9115e-01],
        [1.9254e-01, 8.0746e-01],
        [1.4495e-03, 9.9855e-01],
        [8.5731e-02, 9.1427e-01],
        [1.8741e-02, 9.8126e-01],
        [9.3191e-04, 9.9907e-01],
        [7.2564e-02, 9.2744e-01],
        [7.5902e-04, 9.9924e-01],
        [7.4019e-05, 9.9993e-01],
        [9.9998e-01, 1.6913e-05],
        [9.9946e-01, 5.4101e-04],
        [9.9892e-01, 1.0824e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.3540e-03, 9.9565e-01],
        [4.8440e-03, 9.9516e-01],
        [7.2557e-05, 9.9993e-01],
        [6.6676e-01, 3.3324e-01],
        [1.5097e-01, 8.4903e-01],
        [1.0355e-03, 9.9896e-01],
        [8.9054e-01, 1.0946e-01],
        [3.4583e-01, 6.5417e-01],
        [2.0660e-03, 9.9793e-01],
        [9.9826e-01, 1.7363e-03],
        [9.7808e-01, 2.1925e-02],
        [9.8910e-01, 1.0903e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.1266,  3.3057],
        [-1.9980,  3.3272],
        [-4.4123,  5.1188],
        [ 1.3784,  0.6848],
        [-0.0813,  1.6457],
        [-3.0777,  3.7941],
        [ 2.1906,  0.0943],
        [ 0.6417,  1.2791],
        [-2.1395,  4.0406],
        [ 3.3093, -3.0449],
        [ 1.8512, -1.9468],
        [ 2.6710, -1.8367]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.0150e-02, 9.7985e-01],
        [1.5883e-02, 9.8412e-01],
        [4.5542e-05, 9.9995e-01],
        [8.1439e-01, 1.8561e-01],
        [1.9722e-02, 9.8028e-01],
        [7.3983e-04, 9.9926e-01],
        [8.4227e-01, 1.5773e-01],
        [3.3759e-02, 9.6624e-01],
        [3.6890e-04, 9.9963e-01],
        [9.9970e-01, 2.9674e-04],
        [9.9464e-01, 5.3579e-03],
        [9.8088e-01, 1.9121e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[8.7204e-01, 1.2796e-01],
        [9.8247e-01, 1.7528e-02],
        [1.2830e-02, 9.8717e-01],
        [9.0295e-01, 9.7047e-02],
        [9.9548e-01, 4.5151e-03],
        [1.6435e-02, 9.8356e-01],
        [5.6832e-01, 4.3168e-01],
        [9.0560e-01, 9.4400e-02],
        [2.9134e-03, 9.9709e-01],
        [9.9613e-01, 3.8748e-03],
        [9.9932e-01, 6.7676e-04],
        [9.9982e-01, 1.8196e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.0085,  0.0894],
        [ 1.6589, -2.3673],
        [-2.0830,  2.2601],
        [ 1.1578, -1.0726],
        [ 2.5508, -2.8450],
        [-1.6964,  2.3953],
        [-0.4990, -0.7740],
        [ 0.9560, -1.3050],
        [-3.1083,  2.7272],
        [ 3.0332, -2.5161],
        [ 4.9938, -2.3037],
        [ 4.7084, -3.9032]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.6490e-01, 3.5098e-02],
        [9.9626e-01, 3.7399e-03],
        [3.2731e-01, 6.7269e-01],
        [8.5392e-01, 1.4608e-01],
        [9.9269e-01, 7.3124e-03],
        [1.8953e-02, 9.8105e-01],
        [5.9571e-02, 9.4043e-01],
        [9.9779e-01, 2.2143e-03],
        [5.2704e-03, 9.9473e-01],
        [9.9185e-01, 8.1528e-03],
        [9.9977e-01, 2.2761e-04],
        [9.9993e-01, 6.6543e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 50, Epoch 1/3, Batch 50/80
temp: 0.9503, beta: 0.0347, 
nri_train_loss: 3.0960, enc_train_loss: 6.2732, enc_train_entropy: 0.1704, dec_train_loss: 2.7418, enc_train_edge_accuracy: 0.4917

Edge pred tensor([[2.7753e-01, 7.2247e-01],
        [3.0948e-01, 6.9052e-01],
        [1.8147e-03, 9.9819e-01],
        [3.3398e-02, 9.6660e-01],
        [7.7226e-03, 9.9228e-01],
        [1.6341e-04, 9.9984e-01],
        [5.1405e-03, 9.9486e-01],
        [3.9286e-03, 9.9607e-01],
        [4.2048e-05, 9.9996e-01],
        [9.9754e-01, 2.4563e-03],
        [9.9080e-01, 9.2016e-03],
        [9.9814e-01, 1.8550e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.6232,  1.5800],
        [ 1.1218,  1.9243],
        [-2.1321,  4.1779],
        [-0.5920,  2.7733],
        [-1.1840,  3.6719],
        [-3.7981,  4.9210],
        [-1.2018,  4.0637],
        [-1.4933,  4.0423],
        [-3.7795,  6.2972],
        [ 3.1979, -2.8087],
        [ 2.1023, -2.5769],
        [ 3.4496, -2.8384]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.2449e-01, 7.7551e-01],
        [1.0379e-01, 8.9621e-01],
        [3.4536e-05, 9.9997e-01],
        [8.2096e-01, 1.7904e-01],
        [3.2428e-03, 9.9676e-01],
        [3.1062e-04, 9.9969e-01],
        [8.3681e-04, 9.9916e-01],
        [1.4352e-04, 9.9986e-01],
        [3.6680e-06, 1.0000e+00],
        [9.9278e-01, 7.2166e-03],
        [9.9356e-01, 6.4405e-03],
        [9.9508e-01, 4.9168e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9738e-01, 2.6205e-03],
        [9.9766e-01, 2.3440e-03],
        [2.0058e-01, 7.9942e-01],
        [9.9359e-01, 6.4114e-03],
        [9.9498e-01, 5.0245e-03],
        [4.2986e-02, 9.5701e-01],
        [7.6405e-01, 2.3595e-01],
        [7.1730e-01, 2.8270e-01],
        [1.0910e-03, 9.9891e-01],
        [9.9982e-01, 1.8056e-04],
        [9.9975e-01, 2.4881e-04],
        [9.9991e-01, 8.9993e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.5167, -3.4251],
        [ 2.4016, -3.6519],
        [-1.4406, -0.0579],
        [ 1.8444, -3.1988],
        [ 1.8861, -3.4023],
        [-2.4962,  0.6067],
        [-0.3293, -1.5043],
        [ 0.1917, -0.7394],
        [-4.0437,  2.7758],
        [ 3.8962, -4.7231],
        [ 4.8275, -3.4711],
        [ 4.8204, -4.4953]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9794e-01, 2.0602e-03],
        [9.9968e-01, 3.1869e-04],
        [5.9823e-01, 4.0177e-01],
        [9.9989e-01, 1.1424e-04],
        [9.9938e-01, 6.2341e-04],
        [3.9101e-02, 9.6090e-01],
        [9.8535e-01, 1.4650e-02],
        [8.3019e-01, 1.6981e-01],
        [4.2531e-05, 9.9996e-01],
        [9.9999e-01, 9.5094e-06],
        [9.9928e-01, 7.2285e-04],
        [9.9992e-01, 7.8388e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9446e-01, 5.5400e-03],
        [9.7314e-01, 2.6859e-02],
        [1.3637e-02, 9.8636e-01],
        [8.5238e-01, 1.4762e-01],
        [8.6028e-01, 1.3972e-01],
        [2.1040e-03, 9.9790e-01],
        [9.3090e-01, 6.9101e-02],
        [9.9062e-01, 9.3784e-03],
        [3.8060e-03, 9.9619e-01],
        [9.9946e-01, 5.4170e-04],
        [9.9988e-01, 1.1779e-04],
        [9.9887e-01, 1.1309e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.0369, -3.1534],
        [ 1.9439, -1.6460],
        [-1.8033,  2.4779],
        [-0.2528, -2.0062],
        [ 0.5329, -1.2846],
        [-3.1249,  3.0370],
        [ 0.9729, -1.6277],
        [ 2.3295, -2.3304],
        [-2.1335,  3.4338],
        [ 3.7615, -3.7588],
        [ 4.3138, -4.7326],
        [ 4.0515, -2.7321]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9875e-01, 1.2530e-03],
        [9.8116e-01, 1.8845e-02],
        [1.3799e-02, 9.8620e-01],
        [8.9449e-01, 1.0551e-01],
        [6.0711e-01, 3.9289e-01],
        [1.8993e-03, 9.9810e-01],
        [8.1668e-01, 1.8332e-01],
        [9.4384e-01, 5.6160e-02],
        [1.7862e-01, 8.2138e-01],
        [9.9971e-01, 2.8834e-04],
        [9.9988e-01, 1.1964e-04],
        [9.9983e-01, 1.6728e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.0301e-02, 9.7970e-01],
        [1.9113e-02, 9.8089e-01],
        [1.2460e-04, 9.9988e-01],
        [9.1775e-01, 8.2248e-02],
        [7.3745e-01, 2.6255e-01],
        [4.9351e-03, 9.9506e-01],
        [7.4306e-01, 2.5694e-01],
        [2.6041e-01, 7.3959e-01],
        [5.5018e-04, 9.9945e-01],
        [9.9738e-01, 2.6203e-03],
        [9.8846e-01, 1.1543e-02],
        [9.9373e-01, 6.2741e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.3316,  2.5450],
        [-1.6859,  2.2522],
        [-3.6399,  5.3504],
        [ 1.8838, -0.5284],
        [ 0.7475, -0.2853],
        [-2.1361,  3.1703],
        [ 0.7244, -0.3375],
        [-0.1879,  0.8560],
        [-3.3982,  4.1065],
        [ 2.9900, -2.9519],
        [ 2.3925, -2.0575],
        [ 2.8059, -2.2591]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.4259e-02, 9.6574e-01],
        [1.2641e-02, 9.8736e-01],
        [3.3012e-05, 9.9997e-01],
        [9.9452e-01, 5.4787e-03],
        [7.4810e-01, 2.5190e-01],
        [4.1649e-03, 9.9584e-01],
        [8.3054e-01, 1.6946e-01],
        [2.0676e-01, 7.9324e-01],
        [5.2282e-04, 9.9948e-01],
        [9.9998e-01, 2.2755e-05],
        [9.4723e-01, 5.2766e-02],
        [9.4552e-01, 5.4480e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[7.0327e-01, 2.9673e-01],
        [5.5001e-01, 4.4999e-01],
        [3.1946e-03, 9.9681e-01],
        [6.4205e-03, 9.9358e-01],
        [9.1384e-03, 9.9086e-01],
        [3.4825e-05, 9.9997e-01],
        [7.2854e-04, 9.9927e-01],
        [1.7662e-03, 9.9823e-01],
        [7.8140e-06, 9.9999e-01],
        [9.9066e-01, 9.3437e-03],
        [9.9778e-01, 2.2163e-03],
        [9.9575e-01, 4.2477e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.3162, -0.5467],
        [-0.0236, -0.2243],
        [-2.8963,  2.8467],
        [-2.4348,  2.6070],
        [-2.0797,  2.6064],
        [-4.9641,  5.3010],
        [-3.3697,  3.8541],
        [-2.7949,  3.5422],
        [-5.4556,  6.3040],
        [ 1.6170, -3.0467],
        [ 2.2717, -3.8380],
        [ 1.7038, -3.7533]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.1394e-01, 8.6059e-02],
        [5.4048e-01, 4.5952e-01],
        [1.5749e-03, 9.9843e-01],
        [2.6019e-03, 9.9740e-01],
        [1.1589e-01, 8.8411e-01],
        [8.9892e-04, 9.9910e-01],
        [4.7891e-04, 9.9952e-01],
        [2.1809e-02, 9.7819e-01],
        [8.8586e-06, 9.9999e-01],
        [9.9730e-01, 2.7016e-03],
        [9.9891e-01, 1.0879e-03],
        [9.9443e-01, 5.5712e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 55, Epoch 1/3, Batch 55/80
temp: 0.9455, beta: 0.0382, 
nri_train_loss: 3.0344, enc_train_loss: 6.3662, enc_train_entropy: 0.1626, dec_train_loss: 2.6612, enc_train_edge_accuracy: 0.4950

Edge pred tensor([[6.6878e-01, 3.3122e-01],
        [6.9670e-01, 3.0330e-01],
        [3.7860e-03, 9.9621e-01],
        [9.2173e-01, 7.8267e-02],
        [9.1398e-01, 8.6024e-02],
        [4.6555e-03, 9.9534e-01],
        [9.9206e-01, 7.9405e-03],
        [9.8989e-01, 1.0114e-02],
        [2.4972e-02, 9.7503e-01],
        [9.9960e-01, 4.0130e-04],
        [9.9886e-01, 1.1438e-03],
        [9.9866e-01, 1.3442e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.5238, -0.1789],
        [ 0.6728, -0.1588],
        [-3.0379,  2.5348],
        [ 0.1864, -2.2797],
        [ 1.3757, -0.9875],
        [-3.1616,  2.2034],
        [ 2.8605, -1.9673],
        [ 3.3423, -1.2414],
        [-0.9848,  2.6799],
        [ 4.4206, -3.3998],
        [ 3.9168, -2.8554],
        [ 4.7133, -1.8973]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.3353e-01, 4.6647e-01],
        [9.9849e-01, 1.5137e-03],
        [7.4148e-04, 9.9926e-01],
        [7.5104e-01, 2.4896e-01],
        [9.1144e-01, 8.8563e-02],
        [1.5483e-01, 8.4517e-01],
        [9.8801e-01, 1.1992e-02],
        [9.9919e-01, 8.1456e-04],
        [2.4438e-02, 9.7556e-01],
        [9.9997e-01, 3.2441e-05],
        [9.9941e-01, 5.8596e-04],
        [9.9999e-01, 1.1736e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.3640e-01, 8.6360e-01],
        [1.3049e-01, 8.6951e-01],
        [7.2039e-04, 9.9928e-01],
        [7.5398e-01, 2.4602e-01],
        [3.8677e-01, 6.1323e-01],
        [5.6511e-04, 9.9943e-01],
        [3.7185e-02, 9.6281e-01],
        [1.2174e-02, 9.8783e-01],
        [3.0154e-05, 9.9997e-01],
        [9.9876e-01, 1.2436e-03],
        [9.9585e-01, 4.1483e-03],
        [9.9679e-01, 3.2123e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.1810,  0.6644],
        [-1.7243,  0.1724],
        [-3.8325,  3.4025],
        [-0.0433, -1.1633],
        [-0.8124, -0.3514],
        [-3.8159,  3.6621],
        [-1.1898,  2.0642],
        [-1.4403,  2.9559],
        [-4.6776,  5.7316],
        [ 3.3590, -3.3295],
        [ 2.6646, -2.8163],
        [ 2.3051, -3.4325]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.7645e-02, 9.8235e-01],
        [1.2441e-01, 8.7559e-01],
        [2.7130e-02, 9.7287e-01],
        [4.5721e-01, 5.4279e-01],
        [9.1974e-01, 8.0256e-02],
        [1.8427e-04, 9.9982e-01],
        [7.4632e-01, 2.5368e-01],
        [2.2897e-03, 9.9771e-01],
        [4.8113e-05, 9.9995e-01],
        [9.9845e-01, 1.5512e-03],
        [9.9914e-01, 8.5860e-04],
        [9.9123e-01, 8.7674e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.4224e-03, 9.9558e-01],
        [7.1168e-02, 9.2883e-01],
        [9.0268e-04, 9.9910e-01],
        [8.7887e-04, 9.9912e-01],
        [1.1411e-02, 9.8859e-01],
        [1.9033e-04, 9.9981e-01],
        [2.8305e-03, 9.9717e-01],
        [3.6998e-03, 9.9630e-01],
        [1.0760e-03, 9.9892e-01],
        [9.0878e-01, 9.1218e-02],
        [9.5463e-01, 4.5369e-02],
        [9.9647e-01, 3.5258e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.6143,  3.8024],
        [-0.6377,  1.9312],
        [-2.6769,  4.3323],
        [-2.6375,  4.3985],
        [-1.6510,  2.8107],
        [-4.0159,  4.5507],
        [-2.6132,  3.2513],
        [-2.3397,  3.2561],
        [-3.2546,  3.5788],
        [ 1.0303, -1.2686],
        [ 1.0381, -2.0084],
        [ 2.4145, -3.2297]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.2643e-02, 9.7736e-01],
        [8.5714e-03, 9.9143e-01],
        [1.3277e-03, 9.9867e-01],
        [5.0037e-02, 9.4996e-01],
        [2.0425e-01, 7.9575e-01],
        [7.8500e-05, 9.9992e-01],
        [1.8222e-03, 9.9818e-01],
        [3.5333e-04, 9.9965e-01],
        [6.6529e-03, 9.9335e-01],
        [9.2404e-01, 7.5956e-02],
        [9.0582e-01, 9.4184e-02],
        [9.9806e-01, 1.9427e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.6348e-01, 7.3652e-01],
        [5.8680e-01, 4.1320e-01],
        [5.1275e-04, 9.9949e-01],
        [9.8753e-01, 1.2469e-02],
        [9.9805e-01, 1.9543e-03],
        [6.6883e-02, 9.3312e-01],
        [9.8314e-01, 1.6859e-02],
        [9.7388e-01, 2.6120e-02],
        [2.1780e-02, 9.7822e-01],
        [9.9902e-01, 9.7925e-04],
        [9.9551e-01, 4.4887e-03],
        [9.9923e-01, 7.6575e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.3695,  1.3974],
        [ 0.8199,  0.4691],
        [-3.4552,  4.1200],
        [ 3.1348, -1.2372],
        [ 4.2751, -1.9607],
        [ 0.0330,  2.6686],
        [ 2.2600, -1.8059],
        [ 2.5708, -1.0478],
        [-0.9170,  2.8877],
        [ 3.9533, -2.9745],
        [ 3.7966, -1.6051],
        [ 4.1915, -2.9824]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.5938e-01, 8.4062e-01],
        [3.8384e-01, 6.1616e-01],
        [3.9042e-04, 9.9961e-01],
        [7.9249e-01, 2.0751e-01],
        [9.9902e-01, 9.7681e-04],
        [1.9168e-02, 9.8083e-01],
        [9.9799e-01, 2.0142e-03],
        [9.8975e-01, 1.0246e-02],
        [8.3720e-02, 9.1628e-01],
        [9.9883e-01, 1.1698e-03],
        [9.9694e-01, 3.0587e-03],
        [9.9884e-01, 1.1582e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.1269e-01, 7.8731e-01],
        [4.3002e-01, 5.6998e-01],
        [1.7145e-03, 9.9829e-01],
        [9.8538e-01, 1.4619e-02],
        [9.4849e-01, 5.1506e-02],
        [4.7727e-02, 9.5227e-01],
        [9.6705e-01, 3.2953e-02],
        [7.4254e-01, 2.5746e-01],
        [4.2413e-03, 9.9576e-01],
        [9.9949e-01, 5.1197e-04],
        [9.9064e-01, 9.3598e-03],
        [9.9493e-01, 5.0747e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.4739,  0.8349],
        [ 0.2008,  0.4826],
        [-3.5759,  2.7911],
        [ 2.3358, -1.8750],
        [ 2.7766, -0.1366],
        [-1.3789,  1.6144],
        [ 2.9102, -0.4690],
        [ 2.5455,  1.4863],
        [-1.2882,  4.1705],
        [ 3.5535, -4.0232],
        [ 2.0880, -2.5739],
        [ 2.9133, -2.3651]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[6.5306e-02, 9.3469e-01],
        [3.0401e-02, 9.6960e-01],
        [1.5663e-03, 9.9843e-01],
        [9.9643e-01, 3.5662e-03],
        [2.7999e-01, 7.2001e-01],
        [1.3604e-02, 9.8640e-01],
        [9.9426e-01, 5.7358e-03],
        [8.3471e-01, 1.6529e-01],
        [1.0787e-02, 9.8921e-01],
        [9.9957e-01, 4.3435e-04],
        [9.8137e-01, 1.8628e-02],
        [9.8058e-01, 1.9416e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 60, Epoch 1/3, Batch 60/80
temp: 0.9408, beta: 0.0417, 
nri_train_loss: 2.9160, enc_train_loss: 6.5173, enc_train_entropy: 0.1500, dec_train_loss: 2.5244, enc_train_edge_accuracy: 0.4967

Edge pred tensor([[9.9474e-01, 5.2633e-03],
        [9.9198e-01, 8.0220e-03],
        [2.4566e-02, 9.7543e-01],
        [9.1280e-01, 8.7199e-02],
        [9.5224e-01, 4.7755e-02],
        [4.0480e-03, 9.9595e-01],
        [9.7963e-01, 2.0369e-02],
        [9.9286e-01, 7.1436e-03],
        [1.4012e-02, 9.8599e-01],
        [9.9880e-01, 1.2013e-03],
        [9.9946e-01, 5.4153e-04],
        [9.9936e-01, 6.4434e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.2101, -3.0316],
        [ 2.3991, -2.4184],
        [-2.0505,  1.6310],
        [ 1.4371, -0.9113],
        [ 1.2981, -1.6947],
        [-2.8948,  2.6107],
        [ 1.9422, -1.9309],
        [ 2.1139, -2.8205],
        [-1.7529,  2.5009],
        [ 3.8895, -2.8337],
        [ 3.4814, -4.0392],
        [ 4.3244, -3.0223]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9955e-01, 4.4772e-04],
        [9.9688e-01, 3.1160e-03],
        [7.7046e-02, 9.2295e-01],
        [8.0665e-01, 1.9335e-01],
        [8.9908e-01, 1.0092e-01],
        [2.1111e-03, 9.9789e-01],
        [9.9853e-01, 1.4673e-03],
        [9.9056e-01, 9.4373e-03],
        [2.4308e-02, 9.7569e-01],
        [9.9952e-01, 4.8481e-04],
        [9.9985e-01, 1.4797e-04],
        [9.9779e-01, 2.2077e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.3650e-01, 5.6350e-01],
        [8.9589e-01, 1.0411e-01],
        [2.0878e-03, 9.9791e-01],
        [9.4641e-01, 5.3586e-02],
        [9.9236e-01, 7.6367e-03],
        [2.4279e-02, 9.7572e-01],
        [9.5764e-01, 4.2355e-02],
        [9.7325e-01, 2.6751e-02],
        [2.9935e-02, 9.7006e-01],
        [9.9973e-01, 2.6950e-04],
        [9.9968e-01, 3.1802e-04],
        [9.9985e-01, 1.5156e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.4022,  1.6576],
        [ 1.6628, -0.4895],
        [-2.2507,  3.9188],
        [ 2.0241, -0.8473],
        [ 3.8218, -1.0453],
        [-0.3990,  3.2945],
        [ 1.2852, -1.8332],
        [ 2.8441, -0.7499],
        [-1.3747,  2.1036],
        [ 4.6648, -3.5539],
        [ 5.7378, -2.3153],
        [ 5.5628, -3.2316]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.4015e-01, 5.5985e-01],
        [7.9136e-01, 2.0864e-01],
        [6.5995e-04, 9.9934e-01],
        [9.2375e-01, 7.6251e-02],
        [9.9721e-01, 2.7912e-03],
        [4.6537e-02, 9.5346e-01],
        [8.4116e-01, 1.5884e-01],
        [7.8886e-01, 2.1114e-01],
        [3.3796e-01, 6.6204e-01],
        [9.9992e-01, 8.4190e-05],
        [9.9950e-01, 4.9876e-04],
        [9.9991e-01, 9.4746e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[7.8946e-01, 2.1054e-01],
        [8.9145e-01, 1.0855e-01],
        [2.8616e-03, 9.9714e-01],
        [9.7551e-01, 2.4489e-02],
        [9.6491e-01, 3.5085e-02],
        [3.6377e-03, 9.9636e-01],
        [4.9839e-01, 5.0161e-01],
        [4.6470e-01, 5.3530e-01],
        [5.2142e-04, 9.9948e-01],
        [9.9970e-01, 2.9553e-04],
        [9.9863e-01, 1.3671e-03],
        [9.9972e-01, 2.7716e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.0630, -1.3846],
        [ 0.1980, -1.9076],
        [-2.5682,  3.2854],
        [ 1.6642, -2.0205],
        [ 0.6753, -2.6390],
        [-3.0885,  2.5243],
        [ 0.5954,  0.6018],
        [ 0.1108,  0.2522],
        [-3.1859,  4.3726],
        [ 4.9865, -3.1400],
        [ 2.8580, -3.7357],
        [ 3.8281, -4.3626]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.7027e-01, 2.2973e-01],
        [9.4758e-01, 5.2418e-02],
        [1.4138e-03, 9.9859e-01],
        [9.4273e-01, 5.7269e-02],
        [9.5964e-01, 4.0359e-02],
        [3.6114e-02, 9.6389e-01],
        [5.0602e-01, 4.9398e-01],
        [5.3624e-01, 4.6376e-01],
        [4.1095e-06, 1.0000e+00],
        [9.9995e-01, 4.8351e-05],
        [9.9985e-01, 1.4835e-04],
        [9.9137e-01, 8.6293e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.9179e-01, 6.0821e-01],
        [3.6880e-01, 6.3120e-01],
        [9.0193e-04, 9.9910e-01],
        [2.4264e-03, 9.9757e-01],
        [1.3733e-03, 9.9863e-01],
        [9.6290e-06, 9.9999e-01],
        [4.8928e-03, 9.9511e-01],
        [7.6827e-03, 9.9232e-01],
        [3.2465e-05, 9.9997e-01],
        [9.9626e-01, 3.7375e-03],
        [9.9774e-01, 2.2578e-03],
        [9.9624e-01, 3.7621e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.4972,  0.9370],
        [ 0.9191,  1.4565],
        [-2.9862,  4.0238],
        [-1.6897,  4.3292],
        [-1.9185,  4.6707],
        [-5.1283,  6.4225],
        [-1.8006,  3.5145],
        [-1.9785,  2.8826],
        [-4.7122,  5.6231],
        [ 3.4154, -2.1701],
        [ 2.7690, -3.3221],
        [ 3.1124, -2.4667]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.3722e-02, 9.1628e-01],
        [3.7671e-02, 9.6233e-01],
        [1.7230e-05, 9.9998e-01],
        [6.2847e-04, 9.9937e-01],
        [9.5248e-05, 9.9990e-01],
        [2.9283e-05, 9.9997e-01],
        [9.6693e-03, 9.9033e-01],
        [9.3239e-03, 9.9068e-01],
        [7.2985e-06, 9.9999e-01],
        [1.0000e+00, 3.4351e-06],
        [9.8010e-01, 1.9896e-02],
        [9.9508e-01, 4.9233e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[8.1421e-02, 9.1858e-01],
        [1.9040e-01, 8.0960e-01],
        [5.7274e-04, 9.9943e-01],
        [1.8087e-01, 8.1913e-01],
        [1.6678e-01, 8.3322e-01],
        [9.4993e-04, 9.9905e-01],
        [2.4952e-02, 9.7505e-01],
        [1.4396e-02, 9.8560e-01],
        [4.9782e-05, 9.9995e-01],
        [9.9822e-01, 1.7849e-03],
        [9.8901e-01, 1.0994e-02],
        [9.9695e-01, 3.0455e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.8954,  1.5278],
        [ 0.1876,  1.6351],
        [-3.2815,  4.1830],
        [-0.7796,  0.7309],
        [-0.0746,  1.5340],
        [-3.4639,  3.4942],
        [-1.4286,  2.2370],
        [-1.5458,  2.6805],
        [-4.1515,  5.7563],
        [ 2.7550, -3.5717],
        [ 1.1449, -3.3544],
        [ 2.4964, -3.2946]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.0404e-02, 9.2960e-01],
        [1.4475e-01, 8.5525e-01],
        [4.1168e-04, 9.9959e-01],
        [2.1931e-01, 7.8069e-01],
        [6.9436e-01, 3.0564e-01],
        [1.1382e-03, 9.9886e-01],
        [1.0666e-01, 8.9334e-01],
        [2.2236e-01, 7.7764e-01],
        [2.5544e-06, 1.0000e+00],
        [9.9357e-01, 6.4327e-03],
        [9.9533e-01, 4.6721e-03],
        [9.9734e-01, 2.6604e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 65, Epoch 1/3, Batch 65/80
temp: 0.9361, beta: 0.0451, 
nri_train_loss: 2.7956, enc_train_loss: 6.5474, enc_train_entropy: 0.1475, dec_train_loss: 2.3820, enc_train_edge_accuracy: 0.5083

Edge pred tensor([[9.8010e-01, 1.9897e-02],
        [9.9356e-01, 6.4447e-03],
        [5.3684e-02, 9.4632e-01],
        [3.4367e-03, 9.9656e-01],
        [1.4155e-01, 8.5845e-01],
        [1.5342e-04, 9.9985e-01],
        [7.6391e-03, 9.9236e-01],
        [3.2246e-01, 6.7754e-01],
        [4.2725e-04, 9.9957e-01],
        [9.9441e-01, 5.5945e-03],
        [9.9981e-01, 1.9122e-04],
        [9.9994e-01, 6.3402e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.2031, -0.6940],
        [ 3.5064, -1.5317],
        [-0.9277,  1.9418],
        [-2.8475,  2.8223],
        [-0.8174,  0.9851],
        [-4.9016,  3.8806],
        [-2.6975,  2.1693],
        [-0.8221, -0.0796],
        [-4.2076,  3.5501],
        [ 2.6291, -2.5513],
        [ 4.5055, -4.0564],
        [ 5.5235, -4.1424]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9153e-01, 8.4695e-03],
        [9.7383e-01, 2.6169e-02],
        [1.2748e-02, 9.8725e-01],
        [3.0907e-02, 9.6909e-01],
        [8.3587e-03, 9.9164e-01],
        [7.0820e-04, 9.9929e-01],
        [6.0791e-03, 9.9392e-01],
        [2.0308e-01, 7.9692e-01],
        [3.5790e-04, 9.9964e-01],
        [9.9078e-01, 9.2245e-03],
        [9.9982e-01, 1.8175e-04],
        [9.9980e-01, 2.0304e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.3186e-01, 5.6814e-01],
        [5.2753e-01, 4.7247e-01],
        [2.9516e-03, 9.9705e-01],
        [7.4174e-01, 2.5826e-01],
        [4.1177e-01, 5.8823e-01],
        [3.1796e-03, 9.9682e-01],
        [9.7329e-01, 2.6713e-02],
        [9.4620e-01, 5.3803e-02],
        [9.3728e-03, 9.9063e-01],
        [9.9948e-01, 5.2315e-04],
        [9.9725e-01, 2.7460e-03],
        [9.9445e-01, 5.5505e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.4613, -0.1870],
        [ 0.2754,  0.1651],
        [-3.5574,  2.2650],
        [ 1.2175,  0.1625],
        [ 1.6229,  1.9796],
        [-2.1616,  3.5862],
        [ 2.9609, -0.6346],
        [ 3.0840,  0.2169],
        [-0.9018,  3.7587],
        [ 4.0501, -3.5050],
        [ 2.9299, -2.9649],
        [ 3.0956, -2.0927]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.4771e-01, 4.5229e-01],
        [3.8424e-01, 6.1576e-01],
        [9.8192e-04, 9.9902e-01],
        [2.9107e-01, 7.0893e-01],
        [9.4087e-01, 5.9128e-02],
        [2.1146e-04, 9.9979e-01],
        [9.9402e-01, 5.9781e-03],
        [9.1269e-01, 8.7314e-02],
        [6.5294e-04, 9.9935e-01],
        [9.9955e-01, 4.4561e-04],
        [9.9787e-01, 2.1305e-03],
        [9.8194e-01, 1.8064e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.4323e-03, 9.9857e-01],
        [9.8185e-03, 9.9018e-01],
        [2.7100e-04, 9.9973e-01],
        [5.1566e-03, 9.9484e-01],
        [1.3184e-02, 9.8682e-01],
        [3.0469e-04, 9.9970e-01],
        [3.3620e-02, 9.6638e-01],
        [7.1466e-03, 9.9285e-01],
        [2.3687e-03, 9.9763e-01],
        [9.6669e-01, 3.3307e-02],
        [9.0057e-01, 9.9431e-02],
        [9.8428e-01, 1.5716e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.7354,  3.8117],
        [-1.1879,  3.4258],
        [-2.8964,  5.3167],
        [-2.8970,  2.3653],
        [-1.6637,  2.6517],
        [-4.1144,  3.9815],
        [-1.7106,  1.6478],
        [-2.5706,  2.3634],
        [-2.5884,  3.4547],
        [ 0.8755, -2.4926],
        [-0.0383, -2.2418],
        [ 2.2009, -1.9363]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.1043e-04, 9.9979e-01],
        [1.5584e-02, 9.8442e-01],
        [8.3519e-04, 9.9916e-01],
        [5.1440e-03, 9.9486e-01],
        [3.1661e-03, 9.9683e-01],
        [3.7300e-04, 9.9963e-01],
        [2.8598e-01, 7.1402e-01],
        [3.5362e-03, 9.9646e-01],
        [5.3884e-03, 9.9461e-01],
        [8.7560e-01, 1.2440e-01],
        [9.9669e-01, 3.3144e-03],
        [9.9946e-01, 5.4066e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.0278e-01, 9.7221e-02],
        [7.3378e-01, 2.6622e-01],
        [7.6939e-04, 9.9923e-01],
        [9.0045e-01, 9.9550e-02],
        [9.1513e-01, 8.4868e-02],
        [3.8485e-03, 9.9615e-01],
        [4.6767e-01, 5.3233e-01],
        [6.5014e-01, 3.4986e-01],
        [5.5921e-04, 9.9944e-01],
        [9.9842e-01, 1.5779e-03],
        [9.9909e-01, 9.1262e-04],
        [9.9864e-01, 1.3592e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.0957, -1.1328],
        [ 0.3641, -0.6498],
        [-3.3840,  3.7851],
        [ 0.9658, -1.2364],
        [ 1.0553, -1.3227],
        [-2.1163,  3.4399],
        [-0.3529, -0.2234],
        [ 0.4151, -0.2046],
        [-3.5645,  3.9239],
        [ 3.3471, -3.1030],
        [ 4.0357, -2.9626],
        [ 3.6974, -2.9021]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.9391e-01, 7.0609e-01],
        [2.5684e-01, 7.4316e-01],
        [8.5373e-03, 9.9146e-01],
        [1.6219e-01, 8.3781e-01],
        [9.8119e-01, 1.8812e-02],
        [2.1956e-03, 9.9780e-01],
        [5.2704e-01, 4.7296e-01],
        [8.7952e-01, 1.2048e-01],
        [1.8171e-03, 9.9818e-01],
        [9.9997e-01, 2.5878e-05],
        [9.9701e-01, 2.9894e-03],
        [9.8787e-01, 1.2132e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.4908e-01, 3.5092e-01],
        [6.2290e-01, 3.7710e-01],
        [7.1056e-04, 9.9929e-01],
        [9.8734e-01, 1.2665e-02],
        [9.8635e-01, 1.3647e-02],
        [8.6376e-03, 9.9136e-01],
        [9.3893e-01, 6.1074e-02],
        [9.6877e-01, 3.1233e-02],
        [4.1466e-03, 9.9585e-01],
        [9.9758e-01, 2.4212e-03],
        [9.9846e-01, 1.5402e-03],
        [9.9858e-01, 1.4227e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.8533,  0.2383],
        [ 0.3023, -0.1996],
        [-3.6453,  3.6034],
        [ 2.8739, -1.4823],
        [ 2.2894, -1.9911],
        [-1.9170,  2.8259],
        [ 2.1764, -0.5562],
        [ 2.2804, -1.1542],
        [-1.9575,  3.5239],
        [ 3.8579, -2.1631],
        [ 4.1133, -2.3610],
        [ 3.9438, -2.6099]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.0264e-01, 4.9736e-01],
        [3.2838e-02, 9.6716e-01],
        [5.7941e-05, 9.9994e-01],
        [9.9877e-01, 1.2324e-03],
        [9.8876e-01, 1.1243e-02],
        [1.4061e-03, 9.9859e-01],
        [7.4770e-01, 2.5230e-01],
        [9.9077e-01, 9.2259e-03],
        [1.2617e-01, 8.7383e-01],
        [9.8991e-01, 1.0088e-02],
        [9.9841e-01, 1.5911e-03],
        [9.9661e-01, 3.3915e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 70, Epoch 1/3, Batch 70/80
temp: 0.9314, beta: 0.0486, 
nri_train_loss: 2.7267, enc_train_loss: 6.5204, enc_train_entropy: 0.1498, dec_train_loss: 2.2899, enc_train_edge_accuracy: 0.4767

Edge pred tensor([[1.4883e-02, 9.8512e-01],
        [7.7432e-03, 9.9226e-01],
        [2.1050e-05, 9.9998e-01],
        [6.1341e-01, 3.8659e-01],
        [3.9370e-01, 6.0630e-01],
        [9.6132e-04, 9.9904e-01],
        [5.3393e-01, 4.6607e-01],
        [3.3395e-01, 6.6605e-01],
        [6.8959e-04, 9.9931e-01],
        [9.9907e-01, 9.3089e-04],
        [9.9652e-01, 3.4801e-03],
        [9.9566e-01, 4.3391e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.4452,  2.7474],
        [-1.9592,  2.8939],
        [-5.3078,  5.4608],
        [ 0.2515, -0.2102],
        [-0.1370,  0.2947],
        [-3.9593,  2.9869],
        [ 0.7429,  0.6070],
        [ 0.2901,  0.9805],
        [-3.5028,  3.7759],
        [ 3.7027, -3.2757],
        [ 3.4762, -2.1810],
        [ 3.1946, -2.2412]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9645e-02, 9.0035e-01],
        [2.3167e-02, 9.7683e-01],
        [7.1982e-04, 9.9928e-01],
        [1.4838e-01, 8.5162e-01],
        [1.1325e-01, 8.8675e-01],
        [1.7681e-04, 9.9982e-01],
        [1.7742e-01, 8.2258e-01],
        [1.2974e-01, 8.7026e-01],
        [1.7282e-03, 9.9827e-01],
        [9.9937e-01, 6.2679e-04],
        [9.9957e-01, 4.3492e-04],
        [9.8036e-01, 1.9641e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9638e-01, 3.6244e-03],
        [9.9952e-01, 4.8262e-04],
        [1.2605e-02, 9.8740e-01],
        [9.8891e-01, 1.1091e-02],
        [9.9951e-01, 4.9485e-04],
        [8.2626e-03, 9.9174e-01],
        [8.3740e-01, 1.6260e-01],
        [9.7792e-01, 2.2079e-02],
        [1.9194e-03, 9.9808e-01],
        [9.9979e-01, 2.0605e-04],
        [9.9993e-01, 7.3118e-05],
        [9.9998e-01, 1.9308e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.5991, -3.0173],
        [ 3.0218, -4.6140],
        [-1.9836,  2.3774],
        [ 2.1617, -2.3288],
        [ 3.3759, -4.2348],
        [-1.3687,  3.4191],
        [ 0.1012, -1.5378],
        [ 1.6360, -2.1548],
        [-2.9243,  3.3295],
        [ 4.4557, -4.0315],
        [ 5.1752, -4.3481],
        [ 5.3372, -5.5178]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9905e-01, 9.4810e-04],
        [9.9994e-01, 6.4743e-05],
        [9.0827e-02, 9.0917e-01],
        [9.8284e-01, 1.7162e-02],
        [9.9992e-01, 7.5436e-05],
        [3.4823e-02, 9.6518e-01],
        [6.4590e-01, 3.5410e-01],
        [9.9551e-01, 4.4909e-03],
        [1.1079e-03, 9.9889e-01],
        [9.9949e-01, 5.0919e-04],
        [9.9995e-01, 5.2656e-05],
        [9.9985e-01, 1.5500e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.8056e-01, 1.9445e-02],
        [9.9762e-01, 2.3793e-03],
        [1.9117e-02, 9.8088e-01],
        [9.3979e-01, 6.0207e-02],
        [9.9553e-01, 4.4690e-03],
        [4.9117e-03, 9.9509e-01],
        [4.2720e-01, 5.7280e-01],
        [3.4926e-01, 6.5074e-01],
        [2.5117e-04, 9.9975e-01],
        [9.9993e-01, 6.6470e-05],
        [9.9996e-01, 4.2708e-05],
        [9.9999e-01, 1.1331e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.6948, -2.2257],
        [ 2.0205, -4.0180],
        [-2.2834,  1.6545],
        [ 2.2604, -0.4874],
        [ 2.3407, -3.0654],
        [-2.1310,  3.1802],
        [-0.0125,  0.2808],
        [ 0.4474,  1.0697],
        [-4.0210,  4.2681],
        [ 5.7626, -3.8561],
        [ 6.5239, -3.5372],
        [ 5.6476, -5.7404]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9453e-01, 5.4658e-03],
        [9.9954e-01, 4.6480e-04],
        [1.0762e-02, 9.8924e-01],
        [9.8781e-01, 1.2194e-02],
        [9.9383e-01, 6.1655e-03],
        [2.3906e-03, 9.9761e-01],
        [3.9357e-02, 9.6064e-01],
        [5.9928e-01, 4.0072e-01],
        [3.4891e-05, 9.9997e-01],
        [9.9852e-01, 1.4831e-03],
        [9.9989e-01, 1.1452e-04],
        [1.0000e+00, 1.7577e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9906e-01, 9.4377e-04],
        [9.9947e-01, 5.3471e-04],
        [3.8636e-02, 9.6136e-01],
        [7.5446e-01, 2.4554e-01],
        [9.9370e-01, 6.2994e-03],
        [4.4090e-03, 9.9559e-01],
        [3.3599e-01, 6.6401e-01],
        [9.4978e-01, 5.0223e-02],
        [1.0190e-03, 9.9898e-01],
        [9.9932e-01, 6.8133e-04],
        [9.9996e-01, 4.4084e-05],
        [9.9998e-01, 1.4962e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.0468, -3.9179],
        [ 3.6773, -3.8559],
        [-1.3434,  1.8708],
        [ 1.0252, -0.0973],
        [ 2.2005, -2.8605],
        [-2.3681,  3.0515],
        [ 0.0257,  0.7069],
        [ 0.8082, -2.1315],
        [-2.7281,  4.1598],
        [ 4.4089, -2.8819],
        [ 4.5147, -5.5147],
        [ 5.7960, -5.3140]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9980e-01, 1.9677e-04],
        [9.9949e-01, 5.1301e-04],
        [6.3025e-02, 9.3698e-01],
        [8.6008e-01, 1.3992e-01],
        [9.8296e-01, 1.7039e-02],
        [3.8732e-03, 9.9613e-01],
        [8.1243e-01, 1.8757e-01],
        [8.6094e-01, 1.3906e-01],
        [1.0555e-02, 9.8945e-01],
        [9.9922e-01, 7.8079e-04],
        [9.9999e-01, 9.2855e-06],
        [1.0000e+00, 2.4295e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.6215e-01, 7.3785e-01],
        [7.6507e-01, 2.3493e-01],
        [4.4046e-03, 9.9560e-01],
        [2.8603e-02, 9.7140e-01],
        [5.1781e-01, 4.8219e-01],
        [6.8144e-04, 9.9932e-01],
        [4.9267e-03, 9.9507e-01],
        [1.0203e-02, 9.8980e-01],
        [5.3130e-04, 9.9947e-01],
        [9.5326e-01, 4.6737e-02],
        [9.8963e-01, 1.0369e-02],
        [9.9896e-01, 1.0427e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.2544,  0.7804],
        [ 0.7031, -0.4775],
        [-1.6704,  3.7503],
        [-1.8635,  1.6617],
        [ 0.1250,  0.0538],
        [-2.7985,  4.4921],
        [-3.9097,  1.3984],
        [-2.8121,  1.7628],
        [-4.0775,  3.4621],
        [ 1.1327, -1.8826],
        [ 2.2977, -2.2608],
        [ 3.2288, -3.6362]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.6630e-01, 2.3370e-01],
        [9.1166e-01, 8.8339e-02],
        [2.6190e-02, 9.7381e-01],
        [4.0881e-02, 9.5912e-01],
        [5.0550e-01, 4.9450e-01],
        [4.1304e-07, 1.0000e+00],
        [6.1228e-03, 9.9388e-01],
        [6.0753e-03, 9.9392e-01],
        [2.5618e-03, 9.9744e-01],
        [9.9294e-01, 7.0558e-03],
        [9.9451e-01, 5.4944e-03],
        [9.9852e-01, 1.4839e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 75, Epoch 1/3, Batch 75/80
temp: 0.9268, beta: 0.0521, 
nri_train_loss: 2.6296, enc_train_loss: 6.6090, enc_train_entropy: 0.1424, dec_train_loss: 2.1714, enc_train_edge_accuracy: 0.5017

Edge pred tensor([[6.1638e-01, 3.8362e-01],
        [6.0624e-01, 3.9376e-01],
        [2.7103e-03, 9.9729e-01],
        [1.4683e-03, 9.9853e-01],
        [3.5797e-03, 9.9642e-01],
        [2.5939e-05, 9.9997e-01],
        [5.1949e-04, 9.9948e-01],
        [4.3897e-03, 9.9561e-01],
        [1.3292e-05, 9.9999e-01],
        [9.8027e-01, 1.9735e-02],
        [9.9480e-01, 5.1976e-03],
        [9.9592e-01, 4.0796e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.5788, -1.0530],
        [ 0.5338,  0.1023],
        [-3.0342,  2.8737],
        [-2.7447,  3.7775],
        [-2.3582,  3.2707],
        [-5.5189,  5.0408],
        [-2.6771,  4.8851],
        [-2.3957,  3.0284],
        [-4.5766,  6.6517],
        [ 1.6990, -2.2064],
        [ 1.4594, -3.7949],
        [ 2.3647, -3.1329]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.7824e-01, 7.2176e-01],
        [7.0129e-01, 2.9871e-01],
        [6.5131e-05, 9.9993e-01],
        [4.8980e-06, 1.0000e+00],
        [6.9607e-03, 9.9304e-01],
        [1.2878e-06, 1.0000e+00],
        [1.0868e-03, 9.9891e-01],
        [1.3058e-02, 9.8694e-01],
        [2.3433e-05, 9.9998e-01],
        [8.5126e-01, 1.4874e-01],
        [9.9412e-01, 5.8809e-03],
        [9.9897e-01, 1.0321e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[8.8251e-01, 1.1749e-01],
        [7.1958e-01, 2.8042e-01],
        [3.5275e-04, 9.9965e-01],
        [9.5530e-01, 4.4700e-02],
        [9.2554e-01, 7.4457e-02],
        [5.2015e-03, 9.9480e-01],
        [9.7822e-01, 2.1780e-02],
        [9.8141e-01, 1.8586e-02],
        [3.3075e-03, 9.9669e-01],
        [9.9944e-01, 5.5849e-04],
        [9.9947e-01, 5.2828e-04],
        [9.9844e-01, 1.5581e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.9276, -1.0888],
        [ 1.2139,  0.2715],
        [-3.4913,  4.4581],
        [ 0.5764, -2.4856],
        [ 1.6271, -0.8931],
        [-2.3850,  2.8685],
        [ 2.3498, -1.4549],
        [ 2.8477, -1.1189],
        [-1.2999,  4.4083],
        [ 3.8269, -3.6628],
        [ 4.2658, -3.2796],
        [ 4.5937, -1.8691]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.6629e-01, 3.3712e-02],
        [8.9380e-01, 1.0620e-01],
        [4.1535e-03, 9.9585e-01],
        [9.9813e-01, 1.8718e-03],
        [1.2394e-01, 8.7606e-01],
        [2.6872e-04, 9.9973e-01],
        [9.9698e-01, 3.0211e-03],
        [9.9603e-01, 3.9683e-03],
        [9.9560e-05, 9.9990e-01],
        [9.9967e-01, 3.2595e-04],
        [9.9988e-01, 1.2355e-04],
        [9.9890e-01, 1.1007e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9303e-01, 6.9655e-03],
        [9.8264e-01, 1.7357e-02],
        [1.2399e-02, 9.8760e-01],
        [9.9563e-01, 4.3691e-03],
        [9.9026e-01, 9.7364e-03],
        [3.0295e-02, 9.6970e-01],
        [9.9605e-01, 3.9546e-03],
        [9.9855e-01, 1.4474e-03],
        [2.2474e-02, 9.7753e-01],
        [9.9995e-01, 4.8203e-05],
        [9.9994e-01, 5.7534e-05],
        [9.9981e-01, 1.8796e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.7695, -3.1903],
        [ 1.5890, -2.4473],
        [-3.1189,  1.2588],
        [ 3.1754, -2.2534],
        [ 3.2476, -1.3745],
        [-1.4598,  2.0062],
        [ 3.0286, -2.5004],
        [ 3.5079, -3.0286],
        [-1.3238,  2.4488],
        [ 5.5778, -4.3622],
        [ 4.9187, -4.8444],
        [ 4.6362, -3.9429]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9928e-01, 7.2152e-04],
        [9.9805e-01, 1.9454e-03],
        [5.7634e-03, 9.9424e-01],
        [9.5518e-01, 4.4815e-02],
        [9.9085e-01, 9.1471e-03],
        [9.2618e-02, 9.0738e-01],
        [9.9879e-01, 1.2058e-03],
        [9.9970e-01, 3.0284e-04],
        [5.5512e-02, 9.4449e-01],
        [9.9993e-01, 7.3670e-05],
        [9.9996e-01, 4.1426e-05],
        [9.9977e-01, 2.3490e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[7.4080e-01, 2.5920e-01],
        [8.4297e-01, 1.5703e-01],
        [1.2054e-03, 9.9879e-01],
        [1.6342e-01, 8.3658e-01],
        [4.5825e-01, 5.4175e-01],
        [2.5162e-04, 9.9975e-01],
        [9.3458e-01, 6.5421e-02],
        [9.9029e-01, 9.7091e-03],
        [1.4722e-02, 9.8528e-01],
        [9.9983e-01, 1.7079e-04],
        [9.9993e-01, 7.0711e-05],
        [9.9996e-01, 4.2459e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.3166,  0.2665],
        [ 1.2575, -0.4229],
        [-3.5220,  3.1977],
        [-0.9178,  0.7152],
        [-0.1012,  0.0662],
        [-4.8588,  3.4286],
        [ 0.7506, -1.9086],
        [ 2.4855, -2.1395],
        [-2.6915,  1.5120],
        [ 4.6284, -4.0465],
        [ 6.1039, -3.4530],
        [ 6.2300, -3.8369]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.4152e-01, 5.8484e-02],
        [8.6863e-01, 1.3137e-01],
        [7.6204e-04, 9.9924e-01],
        [8.8782e-01, 1.1218e-01],
        [1.1090e-01, 8.8910e-01],
        [1.4076e-04, 9.9986e-01],
        [9.3640e-01, 6.3601e-02],
        [9.9967e-01, 3.3143e-04],
        [5.6367e-03, 9.9436e-01],
        [9.9989e-01, 1.1457e-04],
        [9.9999e-01, 1.0084e-05],
        [1.0000e+00, 6.6267e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9486e-01, 5.1429e-03],
        [9.9852e-01, 1.4803e-03],
        [1.2879e-02, 9.8712e-01],
        [3.6306e-01, 6.3694e-01],
        [9.7722e-01, 2.2776e-02],
        [1.1591e-03, 9.9884e-01],
        [5.5231e-01, 4.4769e-01],
        [9.1981e-01, 8.0186e-02],
        [1.6255e-03, 9.9837e-01],
        [9.9987e-01, 1.2592e-04],
        [9.9998e-01, 1.7845e-05],
        [9.9999e-01, 1.1634e-05]], device='cuda:0')
logits tensor([[ 3.0295, -2.2355],
        [ 3.3285, -3.1855],
        [-1.9845,  2.3547],
        [ 0.3932,  0.9553],
        [ 1.8154, -1.9436],
        [-3.1688,  3.5902],
        [ 0.4796,  0.2695],
        [ 1.4107, -1.0292],
        [-3.2668,  3.1535],
        [ 5.4053, -3.5745],
        [ 6.5757, -4.3580],
        [ 5.9722, -5.3894]], device='cuda:0')
Edge matrix from gumble tensor([[9.9189e-01, 8.1089e-03],
        [8.8194e-01, 1.1806e-01],
        [3.5241e-02, 9.6476e-01],
        [5.4674e-01, 4.5326e-01],
        [9.9505e-01, 4.9524e-03],
        [3.3393e-04, 9.9967e-01],
        [8.9576e-01, 1.0424e-01],
        [8.8426e-01, 1.1574e-01],
        [4.9884e-04, 9.9950e-01],
        [9.9616e-01, 3.8373e-03],
        [1.0000e+00, 5.1642e-07],
        [1.0000e+00, 7.2534e-07]], device='cuda:0')
Edge pred tensor([[2.4469e-02, 9.7553e-01],
        [4.3177e-02, 9.5682e-01],
        [6.3560e-04, 9.9936e-01],
        [4.4353e-04, 9.9956e-01],
        [1.5633e-03, 9.9844e-01],
        [5.6388e-05, 9.9994e-01],
        [4.4409e-04, 9.9956e-01],
        [4.9087e-04, 9.9951e-01],
        [4.0689e-05, 9.9996e-01],
        [9.9176e-01, 8.2412e-03],
        [9.9489e-01, 5.1082e-03],
        [9.9664e-01, 3.3598e-03]], device='cuda:0')
logits tensor([[-0.0446,  3.6410],
        [ 0.0240,  3.1224],
        [-3.0049,  4.3554],
        [-2.3396,  5.3807],
        [-2.2713,  4.1881],
        [-5.1089,  4.6743],
        [-2.1934,  5.5257],
        [-2.8906,  4.7283],
        [-4.7541,  5.3554],
        [ 3.1209, -1.6694],
        [ 2.4227, -2.8491],
        [ 2.8748, -2.8177]], device='cuda:0')
Edge matrix from gumble tensor([[1.8826e-02, 9.8117e-01],
        [9.5438e-03, 9.9046e-01],
        [2.0124e-03, 9.9799e-01],
        [1.0923e-05, 9.9999e-01],
        [5.7206e-04, 9.9943e-01],
        [1.7812e-05, 9.9998e-01],
        [2.2671e-05, 9.9998e-01],
        [2.6638e-04, 9.9973e-01],
        [1.6632e-05, 9.9998e-01],
        [9.9979e-01, 2.1417e-04],
        [9.9840e-01, 1.6040e-03],
        [9.9843e-01, 1.5687e-03]], device='cuda:0')
Edge pred tensor([[9.9650e-01, 3.5004e-03],
        [9.9880e-01, 1.1955e-03],
        [2.2544e-02, 9.7746e-01],
        [6.6716e-01, 3.3284e-01],
        [9.8378e-01, 1.6218e-02],
        [2.3860e-03, 9.9761e-01],
        [9.5276e-01, 4.7238e-02],
        [9.8195e-01, 1.8046e-02],
        [6.1698e-03, 9.9383e-01],
        [9.9979e-01, 2.1342e-04],
        [9.9995e-01, 4.5760e-05],
        [9.9998e-01, 1.7954e-05]], device='cuda:0')
logits tensor([[ 2.1595, -3.4919],
        [ 2.6169, -4.1111],
        [-1.8800,  1.8895],
        [ 0.2398, -0.4556],
        [ 1.4327, -2.6726],
        [-3.4795,  2.5563],
        [ 1.5818, -1.4224],
        [ 1.2790, -2.7176],
        [-2.6741,  2.4078],
        [ 5.0415, -3.4105],
        [ 5.1623, -4.8297],
        [ 6.1377, -4.7900]], device='cuda:0')
Edge matrix from gumble tensor([[9.9469e-01, 5.3095e-03],
        [9.9484e-01, 5.1578e-03],
        [8.1478e-07, 1.0000e+00],
        [7.8451e-01, 2.1549e-01],
        [9.7294e-01, 2.7055e-02],
        [4.6481e-03, 9.9535e-01],
        [9.9998e-01, 2.1380e-05],
        [7.9976e-01, 2.0024e-01],
        [2.0390e-03, 9.9796e-01],
        [9.9991e-01, 9.4788e-05],
        [9.9999e-01, 6.5291e-06],
        [9.9999e-01, 1.3814e-05]], device='cuda:0')
Edge pred tensor([[9.7447e-01, 2.5533e-02],
        [9.3055e-01, 6.9446e-02],
        [1.1422e-02, 9.8858e-01],
        [2.7891e-03, 9.9721e-01],
        [1.4664e-02, 9.8534e-01],
        [4.7644e-05, 9.9995e-01],
        [3.2549e-02, 9.6745e-01],
        [2.2405e-01, 7.7595e-01],
        [3.1821e-04, 9.9968e-01],
        [9.9876e-01, 1.2395e-03],
        [9.9982e-01, 1.8269e-04],
        [9.9975e-01, 2.4770e-04]], device='cuda:0')
logits tensor([[ 3.0592, -0.5827],
        [ 2.4947, -0.1006],
        [-1.8601,  2.6007],
        [-2.3681,  3.5111],
        [-1.3075,  2.9001],
        [-4.9097,  5.0420],
        [-1.6128,  1.7791],
        [-0.1045,  1.1377],
        [-3.9641,  4.0884],
        [ 3.6745, -3.0173],
        [ 5.1266, -3.4809],
        [ 5.3336, -2.9695]], device='cuda:0')
Edge matrix from gumble tensor([[7.8704e-01, 2.1296e-01],
        [9.9931e-01, 6.8853e-04],
        [1.9472e-02, 9.8053e-01],
        [2.7769e-04, 9.9972e-01],
        [3.4022e-03, 9.9660e-01],
        [1.8550e-04, 9.9981e-01],
        [8.7557e-02, 9.1244e-01],
        [7.7660e-01, 2.2340e-01],
        [2.3062e-04, 9.9977e-01],
        [9.9950e-01, 4.9582e-04],
        [9.9998e-01, 1.5094e-05],
        [9.9996e-01, 3.5245e-05]], device='cuda:0')
Edge pred tensor([[2.6907e-02, 9.7309e-01],
        [1.1807e-01, 8.8193e-01],
        [5.7660e-04, 9.9942e-01],
        [1.6358e-01, 8.3642e-01],
        [6.0772e-02, 9.3923e-01],
        [5.1028e-04, 9.9949e-01],
        [7.9401e-02, 9.2060e-01],
        [1.0613e-02, 9.8939e-01],
        [1.1174e-04, 9.9989e-01],
        [9.9857e-01, 1.4265e-03],
        [9.8117e-01, 1.8830e-02],
        [9.9203e-01, 7.9720e-03]], device='cuda:0')
logits tensor([[-1.7823,  1.8057],
        [-0.5276,  1.4832],
        [-3.9087,  3.5491],
        [-0.5860,  1.0458],
        [-0.4098,  2.3281],
        [-3.7326,  3.8475],
        [-0.2147,  2.2359],
        [-0.8299,  3.7050],
        [-3.2252,  5.8740],
        [ 3.1840, -3.3672],
        [ 1.5219, -2.4313],
        [ 2.1599, -2.6639]], device='cuda:0')
Edge matrix from gumble tensor([[6.2625e-02, 9.3737e-01],
        [3.3081e-02, 9.6692e-01],
        [7.3020e-04, 9.9927e-01],
        [7.1472e-02, 9.2853e-01],
        [1.0357e-01, 8.9643e-01],
        [1.9439e-04, 9.9981e-01],
        [2.1392e-01, 7.8608e-01],
        [3.9802e-04, 9.9960e-01],
        [5.9398e-05, 9.9994e-01],
        [9.9861e-01, 1.3872e-03],
        [9.7325e-01, 2.6750e-02],
        [9.8806e-01, 1.1939e-02]], device='cuda:0')
Edge pred tensor([[9.9833e-01, 1.6691e-03],
        [9.9957e-01, 4.2750e-04],
        [2.3432e-01, 7.6568e-01],
        [8.0725e-01, 1.9275e-01],
        [9.1382e-01, 8.6182e-02],
        [2.2717e-03, 9.9773e-01],
        [9.1132e-01, 8.8677e-02],
        [9.7777e-01, 2.2229e-02],
        [2.6960e-03, 9.9730e-01],
        [9.9983e-01, 1.7500e-04],
        [9.9988e-01, 1.2461e-04],
        [9.9994e-01, 5.9664e-05]], device='cuda:0')
logits tensor([[ 3.9255, -2.4683],
        [ 4.5485, -3.2086],
        [-0.7386,  0.4454],
        [ 0.0574, -1.3748],
        [ 0.9889, -1.3723],
        [-4.2570,  1.8279],
        [ 0.5268, -1.8031],
        [ 2.1015, -1.6824],
        [-3.4855,  2.4278],
        [ 4.0444, -4.6061],
        [ 5.3094, -3.6809],
        [ 5.7002, -4.0265]], device='cuda:0')
Edge matrix from gumble tensor([[9.9928e-01, 7.1855e-04],
        [9.9994e-01, 6.4141e-05],
        [3.3325e-02, 9.6668e-01],
        [9.1543e-01, 8.4569e-02],
        [9.6660e-02, 9.0334e-01],
        [3.3750e-03, 9.9663e-01],
        [9.6692e-01, 3.3083e-02],
        [9.6767e-01, 3.2333e-02],
        [7.9604e-03, 9.9204e-01],
        [9.9999e-01, 1.1923e-05],
        [9.9944e-01, 5.5957e-04],
        [9.9980e-01, 1.9551e-04]], device='cuda:0')
Edge pred tensor([[6.6046e-01, 3.3954e-01],
        [9.2348e-01, 7.6520e-02],
        [1.3505e-03, 9.9865e-01],
        [9.8998e-01, 1.0025e-02],
        [9.9714e-01, 2.8585e-03],
        [1.1739e-02, 9.8826e-01],
        [9.0507e-01, 9.4931e-02],
        [9.4932e-01, 5.0684e-02],
        [2.8663e-03, 9.9713e-01],
        [9.9988e-01, 1.1736e-04],
        [9.9989e-01, 1.1062e-04],
        [9.9996e-01, 4.2880e-05]], device='cuda:0')
logits tensor([[ 0.8340,  0.1687],
        [ 1.2709, -1.2196],
        [-3.6231,  2.9828],
        [ 1.4566, -3.1360],
        [ 2.9584, -2.8962],
        [-2.8251,  1.6079],
        [-0.3898, -2.6447],
        [ 1.3993, -1.5308],
        [-4.2550,  1.5969],
        [ 4.4007, -4.6494],
        [ 6.4222, -2.6871],
        [ 6.2074, -3.8497]], device='cuda:0')
Edge matrix from gumble tensor([[3.2503e-01, 6.7497e-01],
        [9.5655e-01, 4.3450e-02],
        [1.2413e-03, 9.9876e-01],
        [9.8828e-01, 1.1722e-02],
        [9.9653e-01, 3.4730e-03],
        [7.1943e-03, 9.9281e-01],
        [8.6175e-01, 1.3825e-01],
        [9.9947e-01, 5.2657e-04],
        [5.6761e-03, 9.9432e-01],
        [9.9990e-01, 1.0118e-04],
        [9.9996e-01, 3.5354e-05],
        [9.9996e-01, 4.0455e-05]], device='cuda:0')
Edge pred tensor([[9.7995e-01, 2.0052e-02],
        [9.8901e-01, 1.0994e-02],
        [6.2633e-03, 9.9374e-01],
        [8.9400e-01, 1.0600e-01],
        [9.8700e-01, 1.2999e-02],
        [6.7906e-03, 9.9321e-01],
        [9.8603e-01, 1.3967e-02],
        [9.9420e-01, 5.8024e-03],
        [2.3230e-02, 9.7677e-01],
        [9.9995e-01, 5.0365e-05],
        [9.9997e-01, 2.5121e-05],
        [9.9998e-01, 2.4296e-05]], device='cuda:0')
logits tensor([[ 2.0673, -1.8219],
        [ 2.0541, -2.4452],
        [-2.2468,  2.8200],
        [ 1.5875, -0.5447],
        [ 2.3915, -1.9383],
        [-1.9939,  2.9915],
        [ 2.2682, -1.9888],
        [ 2.5693, -2.5744],
        [-1.6477,  2.0911],
        [ 5.9949, -3.9013],
        [ 6.1028, -4.4890],
        [ 6.3115, -4.3137]], device='cuda:0')
Edge matrix from gumble tensor([[8.4476e-01, 1.5524e-01],
        [9.9709e-01, 2.9055e-03],
        [5.8149e-03, 9.9419e-01],
        [9.7350e-01, 2.6502e-02],
        [9.9598e-01, 4.0205e-03],
        [5.2870e-03, 9.9471e-01],
        [9.9069e-01, 9.3051e-03],
        [9.6240e-01, 3.7600e-02],
        [1.4565e-02, 9.8543e-01],
        [1.0000e+00, 3.2901e-06],
        [9.9999e-01, 6.7530e-06],
        [9.9997e-01, 2.6528e-05]], device='cuda:0')
Edge pred tensor([[3.7143e-01, 6.2857e-01],
        [6.0744e-01, 3.9256e-01],
        [3.4666e-04, 9.9965e-01],
        [9.9092e-01, 9.0832e-03],
        [9.9531e-01, 4.6878e-03],
        [2.1752e-02, 9.7825e-01],
        [9.6129e-01, 3.8708e-02],
        [9.4503e-01, 5.4968e-02],
        [3.0198e-03, 9.9698e-01],
        [9.9885e-01, 1.1547e-03],
        [9.9641e-01, 3.5890e-03],
        [9.9917e-01, 8.2814e-04]], device='cuda:0')
logits tensor([[ 0.4852,  1.0113],
        [ 0.1449, -0.2917],
        [-3.8424,  4.1244],
        [ 3.0274, -1.6648],
        [ 3.0547, -2.3034],
        [-0.7897,  3.0164],
        [ 2.1108, -1.1014],
        [ 2.3129, -0.5315],
        [-1.8758,  3.9237],
        [ 3.7728, -2.9900],
        [ 3.8994, -1.7269],
        [ 3.8949, -3.2006]], device='cuda:0')
Edge matrix from gumble tensor([[3.8844e-01, 6.1156e-01],
        [6.5435e-01, 3.4565e-01],
        [6.3400e-03, 9.9366e-01],
        [9.9071e-01, 9.2896e-03],
        [9.8864e-01, 1.1362e-02],
        [2.7233e-02, 9.7277e-01],
        [9.9621e-01, 3.7894e-03],
        [5.5504e-01, 4.4496e-01],
        [8.6970e-03, 9.9130e-01],
        [9.9948e-01, 5.2161e-04],
        [9.9968e-01, 3.2424e-04],
        [9.9971e-01, 2.8846e-04]], device='cuda:0')
Edge pred tensor([[8.3706e-01, 1.6294e-01],
        [8.4605e-01, 1.5395e-01],
        [3.3808e-03, 9.9662e-01],
        [8.4408e-01, 1.5592e-01],
        [7.2406e-01, 2.7594e-01],
        [1.8558e-03, 9.9814e-01],
        [9.6713e-01, 3.2870e-02],
        [8.7732e-01, 1.2268e-01],
        [8.9419e-03, 9.9106e-01],
        [9.9971e-01, 2.9069e-04],
        [9.9842e-01, 1.5759e-03],
        [9.9734e-01, 2.6575e-03]], device='cuda:0')
logits tensor([[ 0.4150, -1.2216],
        [ 0.9876, -0.7163],
        [-1.9544,  3.7318],
        [ 1.0753, -0.6136],
        [ 1.2762,  0.3115],
        [-2.2782,  4.0094],
        [ 1.0970, -2.2847],
        [-0.0274, -1.9947],
        [-1.9902,  2.7178],
        [ 4.1852, -3.9578],
        [ 2.4461, -4.0053],
        [ 3.2481, -2.6797]], device='cuda:0')
Edge matrix from gumble tensor([[4.9559e-01, 5.0441e-01],
        [8.3922e-01, 1.6078e-01],
        [2.0343e-04, 9.9980e-01],
        [9.8610e-01, 1.3905e-02],
        [9.9845e-01, 1.5489e-03],
        [1.2176e-04, 9.9988e-01],
        [9.9384e-01, 6.1550e-03],
        [9.2268e-01, 7.7321e-02],
        [4.6231e-04, 9.9954e-01],
        [9.9989e-01, 1.0787e-04],
        [9.9001e-01, 9.9935e-03],
        [9.1654e-01, 8.3457e-02]], device='cuda:0')

Epoch 1/3 completed, Global Step: 80
nri_train_loss: 2.6296, enc_train_loss: 6.6090, enc_train_entropy: 0.1424, dec_train_loss: 2.1714, enc_train_edge_accuracy: 0.5017
nri_val_loss: 2.2669, enc_val_loss: 6.7626, enc_val_entropy: 0.1296, dec_val_loss: 1.7875, enc_val_edge_accuracy: 0.4987

---------------------------------------------------------------------------

Edge pred tensor([[9.8528e-01, 1.4717e-02],
        [9.9922e-01, 7.8016e-04],
        [4.9723e-02, 9.5028e-01],
        [8.7460e-01, 1.2540e-01],
        [9.9591e-01, 4.0947e-03],
        [1.3063e-02, 9.8694e-01],
        [3.9226e-01, 6.0774e-01],
        [4.6816e-01, 5.3184e-01],
        [1.0593e-03, 9.9894e-01],
        [9.9532e-01, 4.6848e-03],
        [9.9891e-01, 1.0899e-03],
        [9.9991e-01, 9.2190e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.3349, -1.8690],
        [ 3.1611, -3.9941],
        [-1.0400,  1.9103],
        [ 2.0491,  0.1068],
        [ 2.5327, -2.9612],
        [-1.5937,  2.7312],
        [ 0.2079,  0.6457],
        [-0.4582, -0.3307],
        [-3.2783,  3.5708],
        [ 4.1212, -1.2376],
        [ 4.2544, -2.5662],
        [ 5.0806, -4.2110]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9127e-01, 8.7261e-03],
        [9.9980e-01, 1.9586e-04],
        [5.7152e-05, 9.9994e-01],
        [9.4099e-01, 5.9007e-02],
        [9.9358e-01, 6.4219e-03],
        [9.7113e-02, 9.0289e-01],
        [1.2940e-01, 8.7060e-01],
        [3.0580e-01, 6.9420e-01],
        [8.4038e-04, 9.9916e-01],
        [9.9997e-01, 2.8265e-05],
        [9.9888e-01, 1.1156e-03],
        [9.9996e-01, 4.0213e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 80, Epoch 2/3, Batch 0/80
temp: 0.9130, beta: 0.0556, 
nri_train_loss: 2.5372, enc_train_loss: 6.7232, enc_train_entropy: 0.1329, dec_train_loss: 2.0574, enc_train_edge_accuracy: 0.5050

Edge pred tensor([[3.3573e-02, 9.6643e-01],
        [9.1452e-02, 9.0855e-01],
        [1.0362e-03, 9.9896e-01],
        [3.2180e-04, 9.9968e-01],
        [1.3553e-03, 9.9864e-01],
        [9.4837e-05, 9.9991e-01],
        [8.1809e-04, 9.9918e-01],
        [8.5207e-04, 9.9915e-01],
        [1.1766e-04, 9.9988e-01],
        [9.8626e-01, 1.3739e-02],
        [9.8901e-01, 1.0986e-02],
        [9.9761e-01, 2.3928e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.3916,  3.7514],
        [ 0.1397,  2.4358],
        [-2.8595,  4.0116],
        [-3.0593,  4.9820],
        [-2.9171,  3.6853],
        [-4.8537,  4.4096],
        [-2.5092,  4.5985],
        [-2.4846,  4.5824],
        [-4.3287,  4.7188],
        [ 1.9683, -2.3054],
        [ 2.2149, -2.2852],
        [ 2.5130, -3.5199]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.3468e-01, 5.6532e-01],
        [2.7400e-02, 9.7260e-01],
        [1.0144e-03, 9.9899e-01],
        [3.3093e-04, 9.9967e-01],
        [6.0001e-04, 9.9940e-01],
        [7.7745e-06, 9.9999e-01],
        [2.6620e-03, 9.9734e-01],
        [6.3068e-04, 9.9937e-01],
        [5.6681e-05, 9.9994e-01],
        [9.7887e-01, 2.1125e-02],
        [9.3010e-01, 6.9899e-02],
        [9.9231e-01, 7.6890e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.6915e-03, 9.9831e-01],
        [3.1847e-03, 9.9682e-01],
        [3.0577e-04, 9.9969e-01],
        [5.2892e-04, 9.9947e-01],
        [1.5729e-03, 9.9843e-01],
        [9.4949e-05, 9.9990e-01],
        [5.2663e-04, 9.9947e-01],
        [6.7571e-04, 9.9932e-01],
        [1.1480e-04, 9.9989e-01],
        [9.8165e-01, 1.8349e-02],
        [9.9064e-01, 9.3562e-03],
        [9.9296e-01, 7.0398e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.4776,  4.9029],
        [-1.9461,  3.8001],
        [-3.4700,  4.6224],
        [-2.5105,  5.0336],
        [-2.9755,  3.4777],
        [-4.7091,  4.5530],
        [-2.4667,  5.0817],
        [-2.2172,  5.0819],
        [-4.1570,  4.9152],
        [ 2.3072, -1.6725],
        [ 2.4048, -2.2576],
        [ 1.7779, -3.1712]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[6.7501e-05, 9.9993e-01],
        [1.3403e-03, 9.9866e-01],
        [2.3925e-04, 9.9976e-01],
        [3.8544e-04, 9.9961e-01],
        [8.8478e-05, 9.9991e-01],
        [1.1161e-04, 9.9989e-01],
        [7.3769e-04, 9.9926e-01],
        [2.6206e-05, 9.9997e-01],
        [2.7149e-03, 9.9729e-01],
        [9.9180e-01, 8.1980e-03],
        [9.9985e-01, 1.4502e-04],
        [9.9942e-01, 5.8427e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.8971e-01, 1.0290e-02],
        [9.9903e-01, 9.7058e-04],
        [8.5854e-02, 9.1415e-01],
        [1.0635e-01, 8.9365e-01],
        [6.0969e-01, 3.9031e-01],
        [8.0984e-04, 9.9919e-01],
        [2.3913e-01, 7.6087e-01],
        [4.3888e-01, 5.6112e-01],
        [1.7383e-03, 9.9826e-01],
        [9.9857e-01, 1.4326e-03],
        [9.9931e-01, 6.9484e-04],
        [9.9991e-01, 9.2221e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.9879, -1.5783],
        [ 3.9357, -3.0010],
        [ 0.0106,  2.3759],
        [-0.0783,  2.0504],
        [-0.3788, -0.8248],
        [-4.0126,  3.1052],
        [ 0.1030,  1.2605],
        [-1.0954, -0.8497],
        [-3.3052,  3.0479],
        [ 5.1757, -1.3711],
        [ 3.7459, -3.5253],
        [ 5.0475, -4.2437]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.8947e-01, 1.0525e-02],
        [9.8397e-01, 1.6034e-02],
        [2.5455e-01, 7.4545e-01],
        [1.5836e-02, 9.8416e-01],
        [8.4054e-01, 1.5946e-01],
        [3.9771e-04, 9.9960e-01],
        [1.5044e-01, 8.4956e-01],
        [2.6279e-01, 7.3721e-01],
        [1.2683e-03, 9.9873e-01],
        [9.9709e-01, 2.9127e-03],
        [9.9993e-01, 7.1242e-05],
        [9.9999e-01, 1.0818e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[7.3233e-01, 2.6767e-01],
        [9.1934e-01, 8.0663e-02],
        [1.5887e-03, 9.9841e-01],
        [9.6881e-01, 3.1187e-02],
        [9.8241e-01, 1.7588e-02],
        [4.8713e-03, 9.9513e-01],
        [9.9404e-01, 5.9640e-03],
        [9.9299e-01, 7.0130e-03],
        [2.2340e-02, 9.7766e-01],
        [9.9992e-01, 8.1386e-05],
        [9.9986e-01, 1.3897e-04],
        [9.9991e-01, 9.3900e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.0603,  0.0538],
        [ 1.2829, -1.1505],
        [-3.2248,  3.2184],
        [ 1.1231, -2.3129],
        [ 1.8006, -2.2222],
        [-2.8483,  2.4712],
        [ 2.1960, -2.9200],
        [ 3.2285, -1.7244],
        [-1.9113,  1.8675],
        [ 5.3276, -4.0887],
        [ 5.9177, -2.9635],
        [ 5.8830, -3.3902]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.3651e-01, 1.6349e-01],
        [9.9421e-01, 5.7903e-03],
        [1.8825e-05, 9.9998e-01],
        [9.7087e-01, 2.9132e-02],
        [8.5450e-01, 1.4550e-01],
        [9.2075e-04, 9.9908e-01],
        [9.4475e-01, 5.5254e-02],
        [9.9758e-01, 2.4159e-03],
        [5.5536e-03, 9.9445e-01],
        [9.9999e-01, 8.3133e-06],
        [9.9941e-01, 5.9360e-04],
        [9.9822e-01, 1.7818e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.4178e-01, 8.5822e-01],
        [2.3668e-01, 7.6332e-01],
        [8.6603e-05, 9.9991e-01],
        [5.2706e-01, 4.7294e-01],
        [9.1121e-01, 8.8787e-02],
        [3.4953e-03, 9.9650e-01],
        [9.6827e-02, 9.0317e-01],
        [4.8710e-01, 5.1290e-01],
        [7.3655e-04, 9.9926e-01],
        [9.9449e-01, 5.5140e-03],
        [9.9777e-01, 2.2339e-03],
        [9.9893e-01, 1.0676e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-5.0670e-01,  1.2939e+00],
        [ 2.8678e-03,  1.1738e+00],
        [-3.6757e+00,  5.6784e+00],
        [-4.5185e-01, -5.6019e-01],
        [ 1.1421e+00, -1.1864e+00],
        [-2.6739e+00,  2.9790e+00],
        [-1.6444e+00,  5.8858e-01],
        [-2.4087e-01, -1.8925e-01],
        [-3.2024e+00,  4.0104e+00],
        [ 2.2096e+00, -2.9853e+00],
        [ 3.4808e+00, -2.6210e+00],
        [ 4.0889e+00, -2.7524e+00]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.2326e-02, 9.0767e-01],
        [5.6318e-01, 4.3682e-01],
        [3.7484e-05, 9.9996e-01],
        [9.2512e-01, 7.4882e-02],
        [6.3520e-01, 3.6480e-01],
        [1.4787e-04, 9.9985e-01],
        [4.4851e-01, 5.5149e-01],
        [2.6069e-01, 7.3931e-01],
        [1.1964e-04, 9.9988e-01],
        [9.9983e-01, 1.7323e-04],
        [9.9938e-01, 6.2489e-04],
        [9.9799e-01, 2.0106e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 85, Epoch 2/3, Batch 5/80
temp: 0.9084, beta: 0.0590, 
nri_train_loss: 2.4752, enc_train_loss: 6.8001, enc_train_entropy: 0.1265, dec_train_loss: 1.9727, enc_train_edge_accuracy: 0.4950

Edge pred tensor([[4.6114e-03, 9.9539e-01],
        [2.0442e-03, 9.9796e-01],
        [1.2057e-04, 9.9988e-01],
        [1.8660e-01, 8.1340e-01],
        [1.2501e-02, 9.8750e-01],
        [3.0106e-04, 9.9970e-01],
        [8.5030e-01, 1.4970e-01],
        [5.6290e-01, 4.3710e-01],
        [6.4662e-03, 9.9353e-01],
        [9.9950e-01, 5.0262e-04],
        [9.9595e-01, 4.0506e-03],
        [9.9378e-01, 6.2248e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.2824,  3.0922],
        [-2.0871,  4.1036],
        [-4.2672,  4.7560],
        [-0.1399,  1.3324],
        [-0.7618,  3.6076],
        [-4.3298,  3.7781],
        [ 3.0208,  1.2838],
        [ 1.8173,  1.5643],
        [-1.1140,  3.9206],
        [ 4.5063, -3.0889],
        [ 2.9101, -2.5948],
        [ 3.7359, -1.3370]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.3046e-04, 9.9917e-01],
        [1.8688e-03, 9.9813e-01],
        [3.2756e-04, 9.9967e-01],
        [1.4673e-01, 8.5327e-01],
        [3.4279e-01, 6.5721e-01],
        [1.1571e-04, 9.9988e-01],
        [3.4134e-01, 6.5866e-01],
        [1.9710e-02, 9.8029e-01],
        [6.0740e-05, 9.9994e-01],
        [9.9977e-01, 2.3447e-04],
        [9.9933e-01, 6.6744e-04],
        [9.9461e-01, 5.3879e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[7.9808e-01, 2.0192e-01],
        [4.6762e-01, 5.3238e-01],
        [2.1439e-04, 9.9979e-01],
        [9.9670e-01, 3.2955e-03],
        [9.8809e-01, 1.1907e-02],
        [6.3483e-03, 9.9365e-01],
        [9.9737e-01, 2.6284e-03],
        [9.9731e-01, 2.6919e-03],
        [7.5084e-03, 9.9249e-01],
        [9.9989e-01, 1.1165e-04],
        [9.9977e-01, 2.2884e-04],
        [9.9920e-01, 7.9858e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.6419, -0.7324],
        [ 0.4808,  0.6105],
        [-3.9428,  4.5047],
        [ 2.2583, -3.4536],
        [ 2.6308, -1.7879],
        [-2.1621,  2.8911],
        [ 3.3360, -2.6028],
        [ 3.9433, -1.9715],
        [-0.9458,  3.9385],
        [ 4.6733, -4.4268],
        [ 4.5466, -3.8357],
        [ 4.8140, -2.3179]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.4048e-01, 1.5952e-01],
        [4.5208e-01, 5.4792e-01],
        [4.0939e-05, 9.9996e-01],
        [9.8799e-01, 1.2011e-02],
        [9.9496e-01, 5.0438e-03],
        [1.1870e-01, 8.8130e-01],
        [9.9779e-01, 2.2144e-03],
        [9.9996e-01, 4.0111e-05],
        [5.3840e-03, 9.9462e-01],
        [9.9997e-01, 2.9592e-05],
        [9.9999e-01, 1.3874e-05],
        [9.9949e-01, 5.0865e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[5.3394e-04, 9.9947e-01],
        [1.2921e-03, 9.9871e-01],
        [1.9833e-05, 9.9998e-01],
        [2.3963e-01, 7.6037e-01],
        [1.0707e-02, 9.8929e-01],
        [9.1145e-05, 9.9991e-01],
        [1.4536e-01, 8.5464e-01],
        [7.5534e-03, 9.9245e-01],
        [1.1718e-04, 9.9988e-01],
        [9.9864e-01, 1.3556e-03],
        [9.3327e-01, 6.6734e-02],
        [9.8789e-01, 1.2111e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-3.2981,  4.2366],
        [-2.1494,  4.5008],
        [-4.7962,  6.0319],
        [ 0.9332,  2.0879],
        [-1.1099,  3.4162],
        [-4.1657,  5.1372],
        [ 0.9623,  2.7338],
        [-1.7566,  3.1216],
        [-3.3387,  5.7130],
        [ 3.5125, -3.0896],
        [ 0.5587, -2.0793],
        [ 2.2361, -2.1654]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[6.8515e-04, 9.9931e-01],
        [5.2848e-03, 9.9472e-01],
        [2.0769e-06, 1.0000e+00],
        [4.6055e-01, 5.3945e-01],
        [9.7460e-01, 2.5401e-02],
        [6.2295e-04, 9.9938e-01],
        [9.7656e-03, 9.9023e-01],
        [2.5177e-03, 9.9748e-01],
        [3.4695e-06, 1.0000e+00],
        [9.9904e-01, 9.6200e-04],
        [9.6730e-01, 3.2700e-02],
        [9.9304e-01, 6.9637e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[8.3325e-01, 1.6675e-01],
        [8.9470e-01, 1.0530e-01],
        [5.2077e-04, 9.9948e-01],
        [9.9593e-01, 4.0698e-03],
        [9.9744e-01, 2.5613e-03],
        [1.8002e-02, 9.8200e-01],
        [9.9711e-01, 2.8860e-03],
        [9.9687e-01, 3.1267e-03],
        [8.6865e-03, 9.9131e-01],
        [9.9974e-01, 2.6228e-04],
        [9.9934e-01, 6.5647e-04],
        [9.9946e-01, 5.4457e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.7930, -0.8159],
        [ 1.8192, -0.3205],
        [-3.5236,  4.0361],
        [ 1.8391, -3.6610],
        [ 3.5723, -2.3924],
        [-1.7371,  2.2620],
        [ 2.9372, -2.9078],
        [ 3.3673, -2.3974],
        [-1.3941,  3.3432],
        [ 3.9296, -4.3162],
        [ 3.7731, -3.5549],
        [ 5.1903, -2.3247]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.5338e-01, 4.6624e-02],
        [2.0026e-01, 7.9974e-01],
        [3.9042e-05, 9.9996e-01],
        [9.9686e-01, 3.1418e-03],
        [9.7934e-01, 2.0661e-02],
        [4.5017e-02, 9.5498e-01],
        [9.9272e-01, 7.2827e-03],
        [9.9991e-01, 9.0940e-05],
        [1.8125e-03, 9.9819e-01],
        [1.0000e+00, 2.9611e-06],
        [9.9988e-01, 1.1931e-04],
        [9.9996e-01, 4.1891e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9871e-01, 1.2907e-03],
        [9.9712e-01, 2.8800e-03],
        [2.1137e-02, 9.7886e-01],
        [8.0769e-01, 1.9231e-01],
        [9.4018e-01, 5.9824e-02],
        [4.8358e-04, 9.9952e-01],
        [2.8936e-01, 7.1064e-01],
        [4.7571e-01, 5.2429e-01],
        [1.0248e-04, 9.9990e-01],
        [9.9984e-01, 1.5664e-04],
        [9.9991e-01, 8.5417e-05],
        [9.9992e-01, 7.7272e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.2081, -3.4433],
        [ 2.8412, -3.0059],
        [-1.8491,  1.9863],
        [ 0.7444, -0.6906],
        [ 1.0151, -1.7396],
        [-3.8145,  3.8193],
        [-0.3589,  0.5396],
        [-0.4566, -0.3593],
        [-5.0666,  4.1192],
        [ 5.0234, -3.7380],
        [ 4.8494, -4.5184],
        [ 4.8554, -4.6127]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9869e-01, 1.3054e-03],
        [9.7988e-01, 2.0122e-02],
        [2.7730e-02, 9.7227e-01],
        [9.4457e-01, 5.5431e-02],
        [5.3428e-01, 4.6572e-01],
        [1.8777e-05, 9.9998e-01],
        [6.7441e-01, 3.2559e-01],
        [8.6695e-01, 1.3305e-01],
        [4.2646e-05, 9.9996e-01],
        [9.9992e-01, 8.1266e-05],
        [9.9998e-01, 2.3518e-05],
        [9.9998e-01, 2.0886e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 90, Epoch 2/3, Batch 10/80
temp: 0.9039, beta: 0.0625, 
nri_train_loss: 2.4108, enc_train_loss: 6.8673, enc_train_entropy: 0.1209, dec_train_loss: 1.8849, enc_train_edge_accuracy: 0.5000

Edge pred tensor([[5.3253e-01, 4.6747e-01],
        [1.3725e-01, 8.6275e-01],
        [4.7769e-04, 9.9952e-01],
        [1.4200e-02, 9.8580e-01],
        [2.4392e-03, 9.9756e-01],
        [2.2768e-05, 9.9998e-01],
        [1.5453e-03, 9.9845e-01],
        [1.2975e-03, 9.9870e-01],
        [6.8861e-06, 9.9999e-01],
        [9.9682e-01, 3.1814e-03],
        [9.9903e-01, 9.7402e-04],
        [9.9629e-01, 3.7064e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.4099, -0.5402],
        [-1.7108,  0.1274],
        [-4.1470,  3.4990],
        [-0.7133,  3.5270],
        [-2.9169,  3.0968],
        [-5.1959,  5.4943],
        [-1.9470,  4.5240],
        [-3.1385,  3.5075],
        [-6.0278,  5.8582],
        [ 3.7423, -2.0049],
        [ 3.1687, -3.7644],
        [ 1.9359, -3.6580]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.1815e-01, 1.8185e-01],
        [5.6716e-01, 4.3284e-01],
        [5.2010e-03, 9.9480e-01],
        [2.9684e-03, 9.9703e-01],
        [1.1793e-03, 9.9882e-01],
        [1.2442e-04, 9.9988e-01],
        [2.8786e-03, 9.9712e-01],
        [8.5509e-04, 9.9914e-01],
        [2.7731e-06, 1.0000e+00],
        [9.9928e-01, 7.2406e-04],
        [9.9521e-01, 4.7878e-03],
        [9.9920e-01, 7.9504e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.5219e-01, 7.4781e-01],
        [2.9584e-01, 7.0416e-01],
        [1.7408e-04, 9.9983e-01],
        [7.7176e-01, 2.2824e-01],
        [9.4536e-01, 5.4644e-02],
        [1.0645e-02, 9.8935e-01],
        [4.2817e-02, 9.5718e-01],
        [5.9565e-02, 9.4044e-01],
        [1.2476e-04, 9.9988e-01],
        [9.8931e-01, 1.0689e-02],
        [9.9607e-01, 3.9319e-03],
        [9.9814e-01, 1.8608e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.3412,  0.7458],
        [-1.0930, -0.2258],
        [-4.6884,  3.9674],
        [ 0.4015, -0.8168],
        [ 1.3261, -1.5246],
        [-1.5298,  3.0021],
        [-2.3222,  0.7849],
        [-1.2081,  1.5511],
        [-4.8257,  4.1633],
        [ 1.9805, -2.5473],
        [ 3.7441, -1.7906],
        [ 3.2755, -3.0094]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.1561e-02, 9.4844e-01],
        [4.5724e-02, 9.5428e-01],
        [5.8080e-06, 9.9999e-01],
        [4.2353e-01, 5.7647e-01],
        [8.4901e-01, 1.5099e-01],
        [6.0072e-03, 9.9399e-01],
        [7.6587e-03, 9.9234e-01],
        [3.1900e-01, 6.8100e-01],
        [1.9794e-04, 9.9980e-01],
        [9.5546e-01, 4.4544e-02],
        [9.9944e-01, 5.5722e-04],
        [9.9986e-01, 1.4061e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9435e-01, 5.6486e-03],
        [9.9927e-01, 7.3328e-04],
        [9.4336e-02, 9.0566e-01],
        [9.9836e-01, 1.6438e-03],
        [9.9978e-01, 2.1969e-04],
        [1.1469e-01, 8.8531e-01],
        [9.2806e-01, 7.1938e-02],
        [9.4182e-01, 5.8179e-02],
        [5.8987e-03, 9.9410e-01],
        [9.9984e-01, 1.5670e-04],
        [9.9978e-01, 2.2299e-04],
        [9.9994e-01, 6.0112e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.7676, -1.4031],
        [ 4.1508, -3.0664],
        [-0.2068,  2.0550],
        [ 3.5435, -2.8656],
        [ 4.9437, -3.4794],
        [-0.1138,  1.9299],
        [ 0.8431, -1.7142],
        [ 1.6167, -1.1676],
        [-2.0626,  3.0645],
        [ 4.0628, -4.6983],
        [ 4.7791, -3.6291],
        [ 5.2551, -4.4641]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.6103e-01, 3.8972e-02],
        [9.9770e-01, 2.2981e-03],
        [1.3896e-03, 9.9861e-01],
        [9.9996e-01, 4.2121e-05],
        [9.9997e-01, 2.6131e-05],
        [4.3122e-02, 9.5688e-01],
        [7.8412e-01, 2.1588e-01],
        [9.5614e-01, 4.3859e-02],
        [7.9457e-04, 9.9921e-01],
        [9.9973e-01, 2.6801e-04],
        [9.9998e-01, 1.8133e-05],
        [9.9999e-01, 9.2093e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.7078e-01, 6.2922e-01],
        [4.3584e-01, 5.6416e-01],
        [9.2989e-04, 9.9907e-01],
        [2.4519e-03, 9.9755e-01],
        [1.1578e-03, 9.9884e-01],
        [3.5804e-05, 9.9996e-01],
        [2.1361e-03, 9.9786e-01],
        [2.4434e-03, 9.9756e-01],
        [1.4423e-05, 9.9999e-01],
        [9.9851e-01, 1.4918e-03],
        [9.9842e-01, 1.5793e-03],
        [9.9888e-01, 1.1233e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.8431,  1.3720],
        [ 1.2281,  1.4861],
        [-2.6223,  4.3572],
        [-1.1610,  4.8474],
        [-2.3754,  4.3847],
        [-5.2601,  4.9773],
        [-1.1529,  4.9937],
        [-2.4214,  3.5905],
        [-5.3416,  5.8051],
        [ 4.6451, -1.8612],
        [ 2.5590, -3.8902],
        [ 3.3714, -3.4190]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.5794e-01, 7.4206e-01],
        [7.9282e-01, 2.0718e-01],
        [8.9000e-04, 9.9911e-01],
        [2.8719e-03, 9.9713e-01],
        [2.0880e-03, 9.9791e-01],
        [3.6249e-05, 9.9996e-01],
        [1.9481e-03, 9.9805e-01],
        [1.1633e-03, 9.9884e-01],
        [4.4738e-07, 1.0000e+00],
        [9.9935e-01, 6.5418e-04],
        [9.8704e-01, 1.2965e-02],
        [9.9962e-01, 3.7641e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.2069e-03, 9.9779e-01],
        [5.1480e-03, 9.9485e-01],
        [6.0774e-05, 9.9994e-01],
        [1.2887e-01, 8.7113e-01],
        [4.3984e-03, 9.9560e-01],
        [2.8160e-05, 9.9997e-01],
        [3.4385e-02, 9.6561e-01],
        [1.2000e-03, 9.9880e-01],
        [1.2587e-05, 9.9999e-01],
        [9.9924e-01, 7.6218e-04],
        [9.6985e-01, 3.0147e-02],
        [9.9437e-01, 5.6329e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.9545,  3.1595],
        [-2.3521,  2.9119],
        [-4.8649,  4.8434],
        [ 0.2277,  2.1387],
        [-1.7314,  3.6907],
        [-4.9146,  5.5630],
        [-0.0706,  3.2645],
        [-2.4423,  4.2819],
        [-4.7147,  6.5682],
        [ 3.7590, -3.4196],
        [ 0.9148, -2.5563],
        [ 2.0465, -3.1270]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.4045e-03, 9.9760e-01],
        [6.6344e-04, 9.9934e-01],
        [1.7015e-06, 1.0000e+00],
        [1.0689e-01, 8.9311e-01],
        [5.9555e-02, 9.4045e-01],
        [7.2505e-06, 9.9999e-01],
        [8.0248e-01, 1.9752e-01],
        [2.0648e-03, 9.9794e-01],
        [2.0289e-05, 9.9998e-01],
        [9.9854e-01, 1.4552e-03],
        [9.2089e-01, 7.9114e-02],
        [9.9999e-01, 6.8169e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 95, Epoch 2/3, Batch 15/80
temp: 0.8994, beta: 0.0660, 
nri_train_loss: 2.2937, enc_train_loss: 6.8167, enc_train_entropy: 0.1251, dec_train_loss: 1.7439, enc_train_edge_accuracy: 0.5033

Edge pred tensor([[5.5007e-03, 9.9450e-01],
        [7.7188e-03, 9.9228e-01],
        [6.8804e-05, 9.9993e-01],
        [8.7596e-01, 1.2404e-01],
        [4.9106e-01, 5.0894e-01],
        [1.5030e-03, 9.9850e-01],
        [7.4205e-01, 2.5795e-01],
        [1.7389e-01, 8.2611e-01],
        [9.2827e-04, 9.9907e-01],
        [9.9901e-01, 9.9479e-04],
        [9.9023e-01, 9.7679e-03],
        [9.9675e-01, 3.2477e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.5843,  2.6131],
        [-1.8915,  2.9649],
        [-4.5200,  5.0642],
        [ 1.8004, -0.1544],
        [ 0.8178,  0.8535],
        [-2.8561,  3.6426],
        [ 0.8307, -0.2260],
        [-0.3956,  1.1628],
        [-2.8673,  4.1140],
        [ 3.2775, -3.6345],
        [ 1.9170, -2.7018],
        [ 3.0956, -2.6310]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.7150e-02, 9.8285e-01],
        [1.4618e-02, 9.8538e-01],
        [3.6199e-05, 9.9996e-01],
        [9.7020e-01, 2.9801e-02],
        [1.2076e-01, 8.7924e-01],
        [2.2403e-03, 9.9776e-01],
        [5.0147e-01, 4.9853e-01],
        [1.1144e-02, 9.8886e-01],
        [1.3814e-03, 9.9862e-01],
        [9.9994e-01, 6.0543e-05],
        [9.9920e-01, 7.9559e-04],
        [9.9550e-01, 4.4969e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.6889e-01, 3.1112e-02],
        [9.9373e-01, 6.2658e-03],
        [1.8770e-02, 9.8123e-01],
        [9.9705e-01, 2.9543e-03],
        [9.9775e-01, 2.2511e-03],
        [2.2893e-02, 9.7711e-01],
        [9.9269e-01, 7.3144e-03],
        [9.4718e-01, 5.2818e-02],
        [1.7630e-03, 9.9824e-01],
        [9.9992e-01, 7.7429e-05],
        [9.9931e-01, 6.8895e-04],
        [9.9980e-01, 2.0304e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.2410, -1.1976],
        [ 3.1478, -1.9186],
        [-1.6469,  2.3096],
        [ 2.8914, -2.9301],
        [ 3.6961, -2.3980],
        [-1.6093,  2.1444],
        [ 2.3683, -2.5423],
        [ 1.9524, -0.9343],
        [-2.4309,  3.9081],
        [ 4.0182, -5.4478],
        [ 3.4103, -3.8693],
        [ 4.3809, -4.1210]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9891e-01, 1.0897e-03],
        [6.9437e-01, 3.0563e-01],
        [7.4379e-03, 9.9256e-01],
        [9.9970e-01, 2.9894e-04],
        [9.9974e-01, 2.5796e-04],
        [1.4680e-03, 9.9853e-01],
        [9.7151e-01, 2.8494e-02],
        [7.6364e-01, 2.3636e-01],
        [2.1820e-04, 9.9978e-01],
        [9.9996e-01, 3.5929e-05],
        [9.9996e-01, 4.4602e-05],
        [9.9966e-01, 3.3638e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.3244e-01, 7.6756e-01],
        [1.4527e-01, 8.5473e-01],
        [2.4248e-04, 9.9976e-01],
        [8.6814e-01, 1.3186e-01],
        [5.6885e-01, 4.3115e-01],
        [1.7784e-03, 9.9822e-01],
        [9.9408e-01, 5.9186e-03],
        [9.9176e-01, 8.2436e-03],
        [2.2060e-02, 9.7794e-01],
        [9.9995e-01, 5.4103e-05],
        [9.9964e-01, 3.5949e-04],
        [9.9951e-01, 4.8697e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.4552,  0.7394],
        [-0.4216,  1.3506],
        [-4.0177,  4.3066],
        [ 1.2209, -0.6637],
        [ 0.8554,  0.5783],
        [-3.1909,  3.1393],
        [ 3.6542, -1.4695],
        [ 3.1115, -1.6785],
        [-1.4010,  2.3907],
        [ 5.7707, -4.0539],
        [ 4.1202, -3.8102],
        [ 4.5326, -3.0942]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.0969e-01, 4.9031e-01],
        [6.2995e-01, 3.7005e-01],
        [1.6619e-05, 9.9998e-01],
        [8.5073e-01, 1.4927e-01],
        [9.5946e-01, 4.0540e-02],
        [1.4924e-04, 9.9985e-01],
        [9.9972e-01, 2.7899e-04],
        [9.7614e-01, 2.3857e-02],
        [2.8443e-02, 9.7156e-01],
        [9.9963e-01, 3.6884e-04],
        [9.9947e-01, 5.2542e-04],
        [9.9773e-01, 2.2659e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.8319e-01, 6.1681e-01],
        [6.8148e-01, 3.1852e-01],
        [1.2642e-02, 9.8736e-01],
        [1.3721e-03, 9.9863e-01],
        [4.1054e-03, 9.9589e-01],
        [1.6943e-04, 9.9983e-01],
        [1.9888e-03, 9.9801e-01],
        [2.2697e-03, 9.9773e-01],
        [1.3444e-04, 9.9987e-01],
        [9.9158e-01, 8.4230e-03],
        [9.9450e-01, 5.5015e-03],
        [9.9756e-01, 2.4434e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.8475,  1.3235],
        [ 0.6265, -0.1341],
        [-1.5118,  2.8462],
        [-2.4316,  4.1585],
        [-3.2367,  2.2546],
        [-4.4865,  4.1964],
        [-2.0499,  4.1683],
        [-2.3698,  3.7160],
        [-4.3327,  4.5816],
        [ 3.1131, -1.6552],
        [ 2.6979, -2.4993],
        [ 1.8734, -4.1385]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.9752e-02, 9.5025e-01],
        [9.7246e-01, 2.7541e-02],
        [1.6878e-02, 9.8312e-01],
        [7.1293e-05, 9.9993e-01],
        [4.5189e-02, 9.5481e-01],
        [5.0390e-05, 9.9995e-01],
        [4.4530e-06, 1.0000e+00],
        [3.1179e-06, 1.0000e+00],
        [6.1491e-05, 9.9994e-01],
        [9.3217e-01, 6.7834e-02],
        [8.7998e-01, 1.2002e-01],
        [9.9734e-01, 2.6590e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.5846e-04, 9.9904e-01],
        [5.8827e-04, 9.9941e-01],
        [2.2692e-04, 9.9977e-01],
        [3.9109e-03, 9.9609e-01],
        [7.0874e-04, 9.9929e-01],
        [1.4151e-04, 9.9986e-01],
        [1.9905e-02, 9.8009e-01],
        [2.2008e-03, 9.9780e-01],
        [1.7921e-04, 9.9982e-01],
        [9.9560e-01, 4.4023e-03],
        [9.5782e-01, 4.2178e-02],
        [9.7439e-01, 2.5612e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.9697e+00,  4.9795e+00],
        [-1.9772e+00,  5.4605e+00],
        [-2.8995e+00,  5.4912e+00],
        [-1.3678e+00,  4.1723e+00],
        [-2.7397e+00,  4.5116e+00],
        [-4.2961e+00,  4.5669e+00],
        [ 4.4413e-03,  3.9011e+00],
        [-1.8184e+00,  4.2983e+00],
        [-3.5093e+00,  5.1175e+00],
        [ 3.0655e+00, -2.3558e+00],
        [ 1.2153e+00, -1.9075e+00],
        [ 1.5971e+00, -2.0417e+00]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.8301e-05, 9.9995e-01],
        [3.3443e-03, 9.9666e-01],
        [6.7736e-06, 9.9999e-01],
        [6.7758e-04, 9.9932e-01],
        [6.6917e-03, 9.9331e-01],
        [9.0522e-06, 9.9999e-01],
        [3.6759e-03, 9.9632e-01],
        [6.0961e-04, 9.9939e-01],
        [1.1039e-05, 9.9999e-01],
        [9.8926e-01, 1.0742e-02],
        [7.7164e-01, 2.2836e-01],
        [7.9046e-01, 2.0954e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 100, Epoch 2/3, Batch 20/80
temp: 0.8949, beta: 0.0694, 
nri_train_loss: 2.2740, enc_train_loss: 6.7813, enc_train_entropy: 0.1280, dec_train_loss: 1.7006, enc_train_edge_accuracy: 0.4817

Edge pred tensor([[9.6477e-01, 3.5227e-02],
        [9.7093e-01, 2.9066e-02],
        [3.5774e-03, 9.9642e-01],
        [9.8305e-01, 1.6947e-02],
        [9.9030e-01, 9.7048e-03],
        [1.1257e-02, 9.8874e-01],
        [7.4865e-01, 2.5135e-01],
        [4.8456e-01, 5.1544e-01],
        [5.5715e-04, 9.9944e-01],
        [9.9985e-01, 1.5326e-04],
        [9.9957e-01, 4.3146e-04],
        [9.9966e-01, 3.4098e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.7536, -1.5564],
        [ 1.5886, -1.9201],
        [-2.5448,  3.0847],
        [ 1.4168, -2.6437],
        [ 2.1754, -2.4500],
        [-1.6101,  2.8654],
        [-0.7394, -1.8308],
        [-0.2093, -0.1476],
        [-3.9330,  3.5591],
        [ 3.8886, -4.8946],
        [ 4.5833, -3.1646],
        [ 4.5312, -3.4522]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.8770e-01, 1.2297e-02],
        [9.9684e-01, 3.1593e-03],
        [1.4844e-04, 9.9985e-01],
        [9.8332e-01, 1.6679e-02],
        [9.9318e-01, 6.8218e-03],
        [6.4132e-04, 9.9936e-01],
        [9.0296e-01, 9.7043e-02],
        [3.5957e-01, 6.4043e-01],
        [1.3919e-07, 1.0000e+00],
        [9.9998e-01, 2.0493e-05],
        [9.9815e-01, 1.8495e-03],
        [9.9998e-01, 2.2753e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9715e-01, 2.8491e-03],
        [9.9797e-01, 2.0274e-03],
        [3.2089e-02, 9.6791e-01],
        [9.9298e-02, 9.0070e-01],
        [8.0659e-01, 1.9341e-01],
        [4.6945e-04, 9.9953e-01],
        [8.2164e-01, 1.7836e-01],
        [9.8756e-01, 1.2439e-02],
        [5.4841e-03, 9.9452e-01],
        [9.9990e-01, 1.0230e-04],
        [9.9999e-01, 1.2817e-05],
        [9.9999e-01, 9.0774e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.4078, -2.4501],
        [ 3.5183, -2.6807],
        [-1.0799,  2.3267],
        [-0.2378,  1.9673],
        [ 0.6126, -0.8154],
        [-4.1749,  3.4886],
        [ 0.9411, -0.5864],
        [ 1.1299, -3.2445],
        [-2.9598,  2.2406],
        [ 5.3801, -3.8074],
        [ 5.8578, -5.4069],
        [ 6.3827, -5.2270]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9984e-01, 1.5638e-04],
        [9.9260e-01, 7.4034e-03],
        [3.3088e-02, 9.6691e-01],
        [5.1336e-01, 4.8664e-01],
        [9.8823e-01, 1.1768e-02],
        [3.0497e-04, 9.9970e-01],
        [8.7656e-01, 1.2344e-01],
        [8.8490e-01, 1.1510e-01],
        [1.0639e-03, 9.9894e-01],
        [9.9997e-01, 3.1920e-05],
        [1.0000e+00, 4.6334e-06],
        [1.0000e+00, 4.4335e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.4133e-04, 9.9966e-01],
        [1.2687e-04, 9.9987e-01],
        [2.4674e-05, 9.9998e-01],
        [6.1591e-01, 3.8409e-01],
        [4.5674e-02, 9.5433e-01],
        [5.0469e-04, 9.9950e-01],
        [5.1783e-03, 9.9482e-01],
        [4.4541e-04, 9.9955e-01],
        [2.2477e-05, 9.9998e-01],
        [9.9769e-01, 2.3112e-03],
        [9.5827e-01, 4.1734e-02],
        [9.4167e-01, 5.8332e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.9247e+00,  6.0576e+00],
        [-4.2155e+00,  4.7567e+00],
        [-5.0498e+00,  5.5600e+00],
        [ 2.8467e+00,  2.3744e+00],
        [-3.7649e-01,  2.6630e+00],
        [-2.5250e+00,  5.0661e+00],
        [-1.5994e+00,  3.6587e+00],
        [-1.9248e+00,  5.7912e+00],
        [-5.2107e+00,  5.4923e+00],
        [ 3.3439e+00, -2.7238e+00],
        [ 3.1357e+00,  1.8432e-03],
        [ 9.1418e-01, -1.8673e+00]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.2623e-05, 9.9997e-01],
        [4.9390e-06, 1.0000e+00],
        [4.0302e-06, 1.0000e+00],
        [9.8303e-01, 1.6972e-02],
        [9.8353e-01, 1.6466e-02],
        [5.8006e-06, 9.9999e-01],
        [4.9363e-05, 9.9995e-01],
        [4.6059e-05, 9.9995e-01],
        [5.0140e-05, 9.9995e-01],
        [9.9806e-01, 1.9396e-03],
        [9.7310e-01, 2.6900e-02],
        [9.9666e-01, 3.3388e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.3041e-01, 6.9587e-02],
        [9.9762e-01, 2.3820e-03],
        [1.8988e-03, 9.9810e-01],
        [9.9898e-01, 1.0193e-03],
        [9.9990e-01, 9.6854e-05],
        [1.8560e-02, 9.8144e-01],
        [9.7159e-01, 2.8408e-02],
        [9.5809e-01, 4.1909e-02],
        [2.0595e-03, 9.9794e-01],
        [9.9996e-01, 3.8602e-05],
        [9.9983e-01, 1.6851e-04],
        [9.9999e-01, 1.4511e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.5813, -1.0117],
        [ 2.6606, -3.3769],
        [-2.9438,  3.3208],
        [ 3.5523, -3.3354],
        [ 5.1439, -4.0983],
        [-0.3577,  3.6104],
        [ 0.7729, -2.7594],
        [ 1.7453, -1.3841],
        [-2.6778,  3.5055],
        [ 4.8909, -5.2712],
        [ 4.8719, -3.8164],
        [ 5.6210, -5.5196]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.4645e-01, 5.3552e-02],
        [9.9983e-01, 1.6800e-04],
        [3.6128e-04, 9.9964e-01],
        [9.9955e-01, 4.5448e-04],
        [9.9999e-01, 9.1171e-06],
        [3.6288e-02, 9.6371e-01],
        [9.3410e-01, 6.5899e-02],
        [9.9570e-01, 4.3022e-03],
        [8.8060e-03, 9.9119e-01],
        [9.9983e-01, 1.6714e-04],
        [9.9997e-01, 3.4800e-05],
        [9.9999e-01, 5.3734e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[8.6400e-01, 1.3600e-01],
        [9.7120e-01, 2.8799e-02],
        [1.5913e-02, 9.8409e-01],
        [5.1458e-02, 9.4854e-01],
        [7.4957e-01, 2.5043e-01],
        [6.0461e-04, 9.9940e-01],
        [1.6534e-03, 9.9835e-01],
        [7.5475e-03, 9.9245e-01],
        [2.4073e-05, 9.9998e-01],
        [9.9104e-01, 8.9591e-03],
        [9.9759e-01, 2.4089e-03],
        [9.9936e-01, 6.4228e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.4780, -0.3710],
        [ 2.3271, -1.1910],
        [-1.6923,  2.4323],
        [-1.3970,  1.5172],
        [ 0.8593, -0.2370],
        [-3.9418,  3.4685],
        [-3.3972,  3.0061],
        [-2.5686,  2.3103],
        [-5.4792,  5.1552],
        [ 1.3205, -3.3856],
        [ 2.1028, -3.9233],
        [ 3.1029, -4.2469]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.4647e-01, 1.5353e-01],
        [9.9998e-01, 2.3857e-05],
        [4.7700e-03, 9.9523e-01],
        [8.3993e-03, 9.9160e-01],
        [9.1267e-01, 8.7332e-02],
        [3.6266e-05, 9.9996e-01],
        [1.0367e-03, 9.9896e-01],
        [8.1019e-02, 9.1898e-01],
        [3.8280e-08, 1.0000e+00],
        [9.9932e-01, 6.8254e-04],
        [9.5833e-01, 4.1674e-02],
        [9.9998e-01, 2.4158e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 105, Epoch 2/3, Batch 25/80
temp: 0.8904, beta: 0.0729, 
nri_train_loss: 2.1910, enc_train_loss: 6.8113, enc_train_entropy: 0.1255, dec_train_loss: 1.5939, enc_train_edge_accuracy: 0.4983

Edge pred tensor([[6.8369e-01, 3.1631e-01],
        [9.5643e-01, 4.3569e-02],
        [1.0641e-02, 9.8936e-01],
        [1.5405e-02, 9.8459e-01],
        [1.0395e-01, 8.9605e-01],
        [1.3116e-04, 9.9987e-01],
        [9.1632e-04, 9.9908e-01],
        [1.9040e-03, 9.9810e-01],
        [1.2325e-05, 9.9999e-01],
        [9.9607e-01, 3.9286e-03],
        [9.9846e-01, 1.5402e-03],
        [9.9949e-01, 5.0808e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.5982, -0.1726],
        [ 1.4823, -1.6065],
        [-1.4505,  3.0818],
        [-1.0494,  3.1081],
        [-1.2295,  0.9246],
        [-3.9176,  5.0214],
        [-2.3989,  4.5954],
        [-2.1034,  4.1585],
        [-4.9307,  6.3731],
        [ 4.1521, -1.3835],
        [ 4.3758, -2.0985],
        [ 3.7958, -3.7885]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.6637e-01, 1.3363e-01],
        [9.9334e-01, 6.6616e-03],
        [4.2899e-03, 9.9571e-01],
        [2.2722e-03, 9.9773e-01],
        [7.6054e-02, 9.2395e-01],
        [3.3569e-05, 9.9997e-01],
        [1.1689e-02, 9.8831e-01],
        [1.0546e-03, 9.9895e-01],
        [9.9449e-06, 9.9999e-01],
        [9.9862e-01, 1.3766e-03],
        [9.9983e-01, 1.7215e-04],
        [9.9998e-01, 1.7010e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.5594e-01, 3.4406e-01],
        [9.8150e-01, 1.8497e-02],
        [7.0026e-03, 9.9300e-01],
        [2.6672e-01, 7.3328e-01],
        [9.4374e-01, 5.6256e-02],
        [1.6026e-03, 9.9840e-01],
        [1.2972e-01, 8.7028e-01],
        [2.6393e-01, 7.3607e-01],
        [1.0366e-03, 9.9896e-01],
        [9.9609e-01, 3.9060e-03],
        [9.9847e-01, 1.5257e-03],
        [9.9984e-01, 1.6149e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.1553, -0.4900],
        [ 1.7336, -2.2379],
        [-2.2111,  2.7433],
        [-0.7968,  0.2145],
        [ 1.0746, -1.7454],
        [-3.2472,  3.1873],
        [-1.7391,  0.1643],
        [-0.8900,  0.1357],
        [-3.4061,  3.4647],
        [ 2.9218, -2.6195],
        [ 3.4741, -3.0097],
        [ 4.7024, -4.0285]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.7279e-01, 2.7206e-02],
        [9.8592e-01, 1.4080e-02],
        [1.1803e-02, 9.8820e-01],
        [5.4396e-01, 4.5604e-01],
        [9.6055e-01, 3.9454e-02],
        [2.6181e-04, 9.9974e-01],
        [6.9243e-01, 3.0757e-01],
        [1.8936e-01, 8.1064e-01],
        [1.3138e-03, 9.9869e-01],
        [9.9590e-01, 4.1002e-03],
        [9.9756e-01, 2.4432e-03],
        [9.9969e-01, 3.1202e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.1971e-01, 8.0290e-02],
        [9.7200e-01, 2.8000e-02],
        [1.1499e-03, 9.9885e-01],
        [9.9983e-01, 1.6793e-04],
        [9.9949e-01, 5.1152e-04],
        [2.5839e-02, 9.7416e-01],
        [9.9342e-01, 6.5810e-03],
        [9.1142e-01, 8.8575e-02],
        [5.7548e-04, 9.9942e-01],
        [9.9996e-01, 4.3511e-05],
        [9.9943e-01, 5.6765e-04],
        [9.9975e-01, 2.4547e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.7839, -0.6545],
        [ 1.9370, -1.6101],
        [-3.1365,  3.6304],
        [ 3.5653, -5.1265],
        [ 3.8463, -3.7313],
        [-1.0704,  2.5594],
        [ 1.4597, -3.5573],
        [ 1.4429, -0.8883],
        [-3.5707,  3.8891],
        [ 4.1785, -5.8640],
        [ 4.3515, -3.1220],
        [ 4.2694, -4.0427]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.4662e-01, 5.3381e-02],
        [9.9920e-01, 8.0358e-04],
        [2.8279e-03, 9.9717e-01],
        [9.9999e-01, 8.7738e-06],
        [9.9999e-01, 6.9241e-06],
        [7.9498e-03, 9.9205e-01],
        [9.9090e-01, 9.1015e-03],
        [8.3233e-01, 1.6767e-01],
        [1.6030e-03, 9.9840e-01],
        [1.0000e+00, 4.0119e-06],
        [9.9998e-01, 1.8635e-05],
        [9.9995e-01, 4.9376e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[5.9975e-01, 4.0025e-01],
        [9.7397e-01, 2.6034e-02],
        [4.3399e-03, 9.9566e-01],
        [5.2002e-01, 4.7998e-01],
        [9.5897e-01, 4.1025e-02],
        [5.0549e-03, 9.9495e-01],
        [3.0853e-01, 6.9147e-01],
        [4.0217e-01, 5.9783e-01],
        [1.3099e-03, 9.9869e-01],
        [9.9521e-01, 4.7872e-03],
        [9.9829e-01, 1.7064e-03],
        [9.9987e-01, 1.2650e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.7433,  0.3388],
        [ 1.7982, -1.8238],
        [-2.3350,  3.1006],
        [ 0.2709,  0.1908],
        [ 1.5821, -1.5695],
        [-2.5593,  2.7230],
        [-0.7639,  0.0432],
        [-0.3874,  0.0090],
        [-3.2807,  3.3558],
        [ 3.3719, -1.9651],
        [ 4.0407, -2.3310],
        [ 5.3590, -3.6161]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.5760e-01, 4.2402e-02],
        [9.8711e-01, 1.2891e-02],
        [8.3712e-03, 9.9163e-01],
        [6.3024e-01, 3.6976e-01],
        [9.9928e-01, 7.1617e-04],
        [2.3089e-04, 9.9977e-01],
        [9.5815e-01, 4.1853e-02],
        [9.1406e-01, 8.5936e-02],
        [2.5027e-04, 9.9975e-01],
        [9.9748e-01, 2.5234e-03],
        [9.9984e-01, 1.6004e-04],
        [9.9968e-01, 3.1992e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[7.7023e-03, 9.9230e-01],
        [1.6466e-02, 9.8353e-01],
        [1.6073e-04, 9.9984e-01],
        [4.2684e-04, 9.9957e-01],
        [4.0701e-03, 9.9593e-01],
        [7.1910e-05, 9.9993e-01],
        [1.2548e-04, 9.9987e-01],
        [1.6154e-03, 9.9838e-01],
        [9.5280e-05, 9.9990e-01],
        [9.5636e-01, 4.3639e-02],
        [9.9741e-01, 2.5882e-03],
        [9.9757e-01, 2.4263e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.7606,  3.0979],
        [-1.8908,  2.1990],
        [-4.7109,  4.0247],
        [-4.0698,  3.6889],
        [-2.7178,  2.7822],
        [-4.6270,  4.9131],
        [-4.9284,  4.0548],
        [-2.8041,  3.6224],
        [-4.7414,  4.5172],
        [ 0.0791, -3.0081],
        [ 2.8776, -3.0766],
        [ 2.1961, -3.8228]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.2812e-02, 9.7719e-01],
        [1.6882e-01, 8.3118e-01],
        [4.7649e-06, 1.0000e+00],
        [1.1593e-04, 9.9988e-01],
        [3.7426e-04, 9.9963e-01],
        [2.4890e-06, 1.0000e+00],
        [3.3694e-06, 1.0000e+00],
        [1.6335e-04, 9.9984e-01],
        [8.2706e-05, 9.9992e-01],
        [9.7490e-01, 2.5100e-02],
        [9.9966e-01, 3.3698e-04],
        [9.9943e-01, 5.7276e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 110, Epoch 2/3, Batch 30/80
temp: 0.8860, beta: 0.0764, 
nri_train_loss: 2.1350, enc_train_loss: 6.9737, enc_train_entropy: 0.1120, dec_train_loss: 1.5127, enc_train_edge_accuracy: 0.5000

Edge pred tensor([[8.0156e-04, 9.9920e-01],
        [8.8851e-03, 9.9111e-01],
        [2.2391e-04, 9.9978e-01],
        [2.5360e-03, 9.9746e-01],
        [2.7375e-02, 9.7263e-01],
        [5.0080e-04, 9.9950e-01],
        [1.5575e-03, 9.9844e-01],
        [8.7094e-04, 9.9913e-01],
        [2.3246e-04, 9.9977e-01],
        [9.8585e-01, 1.4150e-02],
        [9.7298e-01, 2.7024e-02],
        [9.9688e-01, 3.1209e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.5808,  4.5474],
        [-1.8657,  2.8488],
        [-3.6522,  4.7518],
        [-2.1093,  3.8653],
        [-1.2116,  2.3588],
        [-3.5426,  4.0562],
        [-3.1781,  3.2850],
        [-3.3166,  3.7285],
        [-4.3356,  4.0309],
        [ 1.7031, -2.5407],
        [ 2.0157, -1.5679],
        [ 2.9007, -2.8658]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.5278e-04, 9.9925e-01],
        [8.7877e-03, 9.9121e-01],
        [3.2920e-05, 9.9997e-01],
        [9.5514e-04, 9.9904e-01],
        [9.3593e-03, 9.9064e-01],
        [1.2958e-04, 9.9987e-01],
        [2.2926e-05, 9.9998e-01],
        [1.7068e-03, 9.9829e-01],
        [3.1647e-04, 9.9968e-01],
        [9.8432e-01, 1.5682e-02],
        [9.8631e-01, 1.3694e-02],
        [9.9947e-01, 5.3399e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9767e-01, 2.3278e-03],
        [9.9905e-01, 9.5294e-04],
        [4.9116e-02, 9.5088e-01],
        [9.6113e-01, 3.8875e-02],
        [9.9396e-01, 6.0367e-03],
        [8.2999e-03, 9.9170e-01],
        [9.6994e-01, 3.0064e-02],
        [9.9406e-01, 5.9422e-03],
        [5.8989e-03, 9.9410e-01],
        [9.9986e-01, 1.4392e-04],
        [9.9993e-01, 6.9117e-05],
        [9.9995e-01, 5.4668e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.0100, -3.0505],
        [ 3.5649, -3.3901],
        [-1.0645,  1.8987],
        [ 2.5152, -0.6926],
        [ 2.9301, -2.1738],
        [-1.2716,  3.5115],
        [ 2.3751, -1.0988],
        [ 2.5769, -2.5428],
        [-1.6004,  3.5266],
        [ 4.7731, -4.0731],
        [ 4.3046, -5.2751],
        [ 4.6652, -5.1490]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9770e-01, 2.3041e-03],
        [9.9876e-01, 1.2397e-03],
        [1.4975e-01, 8.5025e-01],
        [9.9264e-01, 7.3612e-03],
        [9.9829e-01, 1.7137e-03],
        [7.5834e-03, 9.9242e-01],
        [9.9624e-01, 3.7624e-03],
        [9.9855e-01, 1.4482e-03],
        [1.3136e-03, 9.9869e-01],
        [9.9998e-01, 2.1138e-05],
        [9.9978e-01, 2.2174e-04],
        [9.9999e-01, 6.3362e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.3942e-02, 9.7606e-01],
        [1.5604e-01, 8.4396e-01],
        [1.7408e-04, 9.9983e-01],
        [4.6550e-01, 5.3450e-01],
        [8.4520e-01, 1.5480e-01],
        [5.1417e-03, 9.9486e-01],
        [5.7920e-01, 4.2080e-01],
        [3.7942e-01, 6.2058e-01],
        [6.7904e-03, 9.9321e-01],
        [9.9429e-01, 5.7127e-03],
        [9.8558e-01, 1.4421e-02],
        [9.9846e-01, 1.5386e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.5788,  2.1291],
        [-0.1610,  1.5270],
        [-3.2140,  5.4418],
        [-0.5635, -0.4253],
        [ 1.2808, -0.4167],
        [-2.2773,  2.9879],
        [-0.5849, -0.9043],
        [-0.7351, -0.2431],
        [-2.0639,  2.9216],
        [ 2.5638, -2.5955],
        [ 2.1236, -2.1010],
        [ 4.4524, -2.0229]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.8120e-02, 9.8188e-01],
        [2.9589e-03, 9.9704e-01],
        [3.7426e-05, 9.9996e-01],
        [8.4877e-01, 1.5123e-01],
        [9.7106e-01, 2.8940e-02],
        [4.6569e-03, 9.9534e-01],
        [9.9939e-01, 6.1212e-04],
        [4.4655e-01, 5.5345e-01],
        [1.3219e-04, 9.9987e-01],
        [9.9984e-01, 1.6014e-04],
        [9.5750e-01, 4.2495e-02],
        [9.9669e-01, 3.3063e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.0303e-01, 9.6971e-02],
        [7.7478e-01, 2.2522e-01],
        [4.6315e-03, 9.9537e-01],
        [8.7914e-01, 1.2086e-01],
        [9.3718e-01, 6.2822e-02],
        [6.0059e-03, 9.9399e-01],
        [9.9436e-01, 5.6393e-03],
        [9.9825e-01, 1.7540e-03],
        [1.2361e-01, 8.7639e-01],
        [9.9970e-01, 2.9567e-04],
        [9.9975e-01, 2.5461e-04],
        [9.9954e-01, 4.6211e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.7322, -0.4991],
        [ 1.6761,  0.4406],
        [-2.4696,  2.9006],
        [ 1.0505, -0.9338],
        [ 2.3131, -0.3894],
        [-2.2144,  2.8946],
        [ 3.2076, -1.9648],
        [ 4.0918, -2.2523],
        [ 0.1974,  2.1561],
        [ 4.1325, -3.9935],
        [ 4.3554, -3.9202],
        [ 5.1007, -2.5786]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9726e-01, 2.7371e-03],
        [7.4681e-01, 2.5319e-01],
        [1.5944e-04, 9.9984e-01],
        [3.5099e-02, 9.6490e-01],
        [8.7869e-01, 1.2131e-01],
        [2.5194e-04, 9.9975e-01],
        [9.9865e-01, 1.3486e-03],
        [9.9865e-01, 1.3465e-03],
        [2.3344e-01, 7.6656e-01],
        [9.9985e-01, 1.5331e-04],
        [1.0000e+00, 4.9388e-06],
        [9.9954e-01, 4.5976e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.3703e-02, 9.7630e-01],
        [4.2112e-02, 9.5789e-01],
        [3.0215e-04, 9.9970e-01],
        [1.2108e-01, 8.7892e-01],
        [9.4564e-03, 9.9054e-01],
        [5.5775e-05, 9.9994e-01],
        [7.2537e-03, 9.9275e-01],
        [6.7610e-04, 9.9932e-01],
        [1.6989e-05, 9.9998e-01],
        [9.9869e-01, 1.3137e-03],
        [9.8541e-01, 1.4593e-02],
        [9.9704e-01, 2.9627e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.3662,  2.3519],
        [-1.1876,  1.9368],
        [-3.8871,  4.2172],
        [ 0.3265,  2.3088],
        [-1.8350,  2.8165],
        [-4.8928,  4.9014],
        [-0.7495,  4.1695],
        [-2.1342,  5.1643],
        [-4.6124,  6.3705],
        [ 3.6560, -2.9776],
        [ 1.6317, -2.5808],
        [ 2.2503, -3.5684]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[6.3014e-04, 9.9937e-01],
        [8.1438e-03, 9.9186e-01],
        [2.7584e-07, 1.0000e+00],
        [1.2650e-02, 9.8735e-01],
        [3.9939e-03, 9.9601e-01],
        [5.8033e-04, 9.9942e-01],
        [2.2563e-02, 9.7744e-01],
        [1.0283e-03, 9.9897e-01],
        [3.4560e-05, 9.9997e-01],
        [9.9760e-01, 2.4019e-03],
        [9.8440e-01, 1.5603e-02],
        [9.9967e-01, 3.3440e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 115, Epoch 2/3, Batch 35/80
temp: 0.8816, beta: 0.0799, 
nri_train_loss: 2.1028, enc_train_loss: 6.8474, enc_train_entropy: 0.1225, dec_train_loss: 1.4579, enc_train_edge_accuracy: 0.5067

Edge pred tensor([[9.8998e-01, 1.0016e-02],
        [9.9888e-01, 1.1202e-03],
        [1.3651e-02, 9.8635e-01],
        [9.1212e-01, 8.7879e-02],
        [9.9837e-01, 1.6345e-03],
        [5.9953e-03, 9.9400e-01],
        [3.3523e-01, 6.6477e-01],
        [8.8827e-01, 1.1173e-01],
        [1.4771e-03, 9.9852e-01],
        [9.9743e-01, 2.5651e-03],
        [9.9975e-01, 2.5162e-04],
        [9.9997e-01, 3.2301e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.0989, -1.4946],
        [ 3.3591, -3.4341],
        [-1.4338,  2.8464],
        [ 1.6287, -0.7111],
        [ 2.6198, -3.7950],
        [-1.9843,  3.1265],
        [ 0.1219,  0.8065],
        [ 1.6401, -0.4331],
        [-2.4095,  4.1067],
        [ 3.9743, -1.9889],
        [ 4.8100, -3.4774],
        [ 5.2216, -5.1188]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.5719e-01, 4.2813e-02],
        [9.9757e-01, 2.4270e-03],
        [7.4006e-03, 9.9260e-01],
        [9.4198e-01, 5.8021e-02],
        [9.9809e-01, 1.9101e-03],
        [4.7711e-03, 9.9523e-01],
        [5.9995e-02, 9.4001e-01],
        [6.3350e-01, 3.6650e-01],
        [5.2349e-05, 9.9995e-01],
        [8.9236e-01, 1.0764e-01],
        [9.9999e-01, 1.0389e-05],
        [9.9999e-01, 5.3723e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9892e-01, 1.0829e-03],
        [9.9865e-01, 1.3527e-03],
        [2.8052e-02, 9.7195e-01],
        [9.9958e-01, 4.2401e-04],
        [9.9948e-01, 5.1566e-04],
        [2.2983e-02, 9.7702e-01],
        [9.9934e-01, 6.5900e-04],
        [9.9962e-01, 3.7805e-04],
        [7.9031e-03, 9.9210e-01],
        [9.9998e-01, 2.0939e-05],
        [9.9998e-01, 1.9937e-05],
        [9.9996e-01, 4.3848e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.4853, -3.3417],
        [ 3.4490, -3.1553],
        [-1.6851,  1.8602],
        [ 3.6209, -4.1445],
        [ 4.5020, -3.0676],
        [-1.1137,  2.6360],
        [ 3.5899, -3.7343],
        [ 4.5085, -3.3716],
        [-1.2495,  3.5831],
        [ 5.3114, -5.4625],
        [ 5.2275, -5.5954],
        [ 5.1807, -4.8540]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9973e-01, 2.6501e-04],
        [9.9860e-01, 1.3985e-03],
        [1.5078e-02, 9.8492e-01],
        [9.9986e-01, 1.3573e-04],
        [9.9984e-01, 1.5853e-04],
        [1.9524e-02, 9.8048e-01],
        [9.9996e-01, 4.2639e-05],
        [9.9985e-01, 1.5411e-04],
        [1.2247e-03, 9.9878e-01],
        [1.0000e+00, 5.1885e-07],
        [9.9984e-01, 1.5720e-04],
        [9.9999e-01, 1.0652e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.8576e-01, 7.1424e-01],
        [9.1116e-01, 8.8839e-02],
        [4.9656e-03, 9.9503e-01],
        [6.4152e-01, 3.5848e-01],
        [9.8101e-01, 1.8992e-02],
        [6.4069e-03, 9.9359e-01],
        [1.4897e-01, 8.5103e-01],
        [8.0310e-02, 9.1969e-01],
        [1.0517e-03, 9.9895e-01],
        [9.9279e-01, 7.2116e-03],
        [9.9238e-01, 7.6195e-03],
        [9.9958e-01, 4.1863e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.3002,  0.6158],
        [ 1.0997, -1.2282],
        [-2.2075,  3.0927],
        [-0.0807, -0.6627],
        [ 1.9354, -2.0092],
        [-2.3849,  2.6591],
        [-1.8001, -0.0574],
        [-1.4044,  1.0337],
        [-3.1482,  3.7081],
        [ 2.6120, -2.3129],
        [ 3.1441, -1.7253],
        [ 4.4151, -3.3629]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.5785e-01, 2.4215e-01],
        [9.7884e-01, 2.1157e-02],
        [7.1557e-03, 9.9284e-01],
        [9.8748e-01, 1.2520e-02],
        [9.9830e-01, 1.6959e-03],
        [8.0027e-05, 9.9992e-01],
        [3.0969e-01, 6.9031e-01],
        [1.5876e-02, 9.8412e-01],
        [2.2120e-03, 9.9779e-01],
        [9.9930e-01, 7.0303e-04],
        [9.9976e-01, 2.3908e-04],
        [9.9972e-01, 2.8372e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9979e-01, 2.0521e-04],
        [9.9953e-01, 4.7453e-04],
        [2.1281e-01, 7.8719e-01],
        [9.6907e-01, 3.0926e-02],
        [9.6990e-01, 3.0104e-02],
        [3.5427e-03, 9.9646e-01],
        [9.7522e-01, 2.4778e-02],
        [9.9755e-01, 2.4458e-03],
        [3.0003e-03, 9.9700e-01],
        [9.9994e-01, 6.3947e-05],
        [9.9999e-01, 7.7533e-06],
        [9.9997e-01, 2.9423e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.7752, -4.7161],
        [ 3.6856, -3.9671],
        [-0.6647,  0.6434],
        [ 1.8073, -1.6374],
        [ 1.7246, -1.7479],
        [-3.2473,  2.3920],
        [ 1.9639, -1.7088],
        [ 2.8333, -3.1776],
        [-2.6989,  3.1071],
        [ 4.7492, -4.9082],
        [ 5.8031, -5.9642],
        [ 5.5304, -4.9033]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9986e-01, 1.4400e-04],
        [9.9797e-01, 2.0328e-03],
        [3.6462e-03, 9.9635e-01],
        [9.6558e-01, 3.4425e-02],
        [9.7007e-01, 2.9933e-02],
        [3.8695e-04, 9.9961e-01],
        [9.9733e-01, 2.6726e-03],
        [9.9759e-01, 2.4073e-03],
        [4.3999e-04, 9.9956e-01],
        [9.9998e-01, 2.0969e-05],
        [1.0000e+00, 1.1294e-06],
        [9.9998e-01, 2.2023e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[8.5513e-01, 1.4487e-01],
        [9.6400e-01, 3.5999e-02],
        [7.6948e-03, 9.9231e-01],
        [6.7895e-01, 3.2105e-01],
        [9.8771e-01, 1.2289e-02],
        [7.0024e-03, 9.9300e-01],
        [5.1539e-01, 4.8461e-01],
        [8.4510e-01, 1.5490e-01],
        [3.4396e-03, 9.9656e-01],
        [9.9980e-01, 2.0339e-04],
        [9.9994e-01, 6.1176e-05],
        [9.9997e-01, 2.6275e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.3704,  0.5950],
        [ 2.1133, -1.1743],
        [-1.9888,  2.8707],
        [ 0.7725,  0.0236],
        [ 2.6463, -1.7403],
        [-2.1977,  2.7568],
        [-0.5364, -0.5980],
        [ 0.9202, -0.7765],
        [-3.2652,  2.4038],
        [ 4.4709, -4.0293],
        [ 6.4653, -3.2364],
        [ 6.2305, -4.3163]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.7460e-01, 2.5397e-02],
        [9.4586e-01, 5.4137e-02],
        [9.2445e-04, 9.9908e-01],
        [9.8530e-01, 1.4702e-02],
        [9.8502e-01, 1.4983e-02],
        [1.0548e-03, 9.9895e-01],
        [7.2528e-01, 2.7472e-01],
        [8.4943e-01, 1.5057e-01],
        [3.2198e-03, 9.9678e-01],
        [9.9779e-01, 2.2123e-03],
        [9.9995e-01, 4.6807e-05],
        [9.9999e-01, 5.0320e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 120, Epoch 2/3, Batch 40/80
temp: 0.8772, beta: 0.0833, 
nri_train_loss: 2.0194, enc_train_loss: 6.7741, enc_train_entropy: 0.1286, dec_train_loss: 1.3520, enc_train_edge_accuracy: 0.4967

Edge pred tensor([[4.6505e-04, 9.9953e-01],
        [1.4666e-03, 9.9853e-01],
        [3.1719e-04, 9.9968e-01],
        [1.3246e-02, 9.8675e-01],
        [4.4206e-03, 9.9558e-01],
        [2.6123e-04, 9.9974e-01],
        [3.6278e-02, 9.6372e-01],
        [3.2642e-03, 9.9674e-01],
        [1.1437e-03, 9.9886e-01],
        [9.9827e-01, 1.7292e-03],
        [9.7568e-01, 2.4318e-02],
        [9.9305e-01, 6.9544e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-3.0175,  4.6554],
        [-2.3393,  4.1840],
        [-3.4972,  4.5585],
        [-1.3327,  2.9780],
        [-1.0645,  4.3525],
        [-3.7662,  4.4836],
        [-0.9611,  2.3185],
        [-1.9182,  3.8033],
        [-3.0547,  3.7177],
        [ 2.7981, -3.5602],
        [ 1.1894, -2.5026],
        [ 2.6064, -2.3551]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.2796e-05, 9.9999e-01],
        [3.2043e-04, 9.9968e-01],
        [2.4614e-04, 9.9975e-01],
        [4.3204e-03, 9.9568e-01],
        [1.4772e-03, 9.9852e-01],
        [1.6075e-02, 9.8393e-01],
        [1.9542e-01, 8.0458e-01],
        [7.1859e-03, 9.9281e-01],
        [1.3391e-03, 9.9866e-01],
        [9.9917e-01, 8.3251e-04],
        [9.8530e-01, 1.4701e-02],
        [9.9821e-01, 1.7938e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.7778e-03, 9.9822e-01],
        [1.2145e-03, 9.9879e-01],
        [3.0829e-04, 9.9969e-01],
        [8.1383e-03, 9.9186e-01],
        [1.5237e-03, 9.9848e-01],
        [2.6362e-04, 9.9974e-01],
        [1.0731e-02, 9.8927e-01],
        [1.9955e-03, 9.9800e-01],
        [2.7224e-04, 9.9973e-01],
        [9.9567e-01, 4.3293e-03],
        [9.7929e-01, 2.0710e-02],
        [9.7680e-01, 2.3204e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.5974,  4.7332],
        [-1.9907,  4.7215],
        [-2.7310,  5.3531],
        [-0.6279,  4.1751],
        [-2.1632,  4.3219],
        [-3.3468,  4.8940],
        [-0.4290,  4.0948],
        [-1.3187,  4.8962],
        [-3.2027,  5.0058],
        [ 3.4528, -1.9852],
        [ 2.3773, -1.4789],
        [ 2.0715, -1.6685]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.2508e-03, 9.9875e-01],
        [1.2067e-05, 9.9999e-01],
        [1.2059e-05, 9.9999e-01],
        [2.8754e-03, 9.9712e-01],
        [3.1958e-05, 9.9997e-01],
        [3.0973e-04, 9.9969e-01],
        [8.7078e-05, 9.9991e-01],
        [2.3653e-04, 9.9976e-01],
        [1.4638e-04, 9.9985e-01],
        [9.9922e-01, 7.7767e-04],
        [9.7984e-01, 2.0157e-02],
        [9.9849e-01, 1.5075e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.2102e-03, 9.9879e-01],
        [1.4528e-02, 9.8547e-01],
        [2.7575e-04, 9.9972e-01],
        [1.1300e-04, 9.9989e-01],
        [1.7848e-03, 9.9822e-01],
        [1.3534e-04, 9.9986e-01],
        [5.0554e-05, 9.9995e-01],
        [2.1205e-04, 9.9979e-01],
        [1.4351e-04, 9.9986e-01],
        [9.1354e-01, 8.6463e-02],
        [9.8544e-01, 1.4559e-02],
        [9.9680e-01, 3.2001e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.1782,  4.5376],
        [-1.4491,  2.7679],
        [-3.7674,  4.4283],
        [-4.4849,  4.6031],
        [-3.0282,  3.2985],
        [-4.3872,  4.5204],
        [-4.7334,  5.1591],
        [-3.4776,  4.9809],
        [-4.1116,  4.7374],
        [-0.0105, -2.3681],
        [ 1.9149, -2.3000],
        [ 2.0487, -3.6926]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.4451e-03, 9.9555e-01],
        [1.9439e-02, 9.8056e-01],
        [3.2255e-04, 9.9968e-01],
        [8.8761e-06, 9.9999e-01],
        [8.0198e-03, 9.9198e-01],
        [8.0239e-03, 9.9198e-01],
        [9.4293e-07, 1.0000e+00],
        [2.3559e-05, 9.9998e-01],
        [1.1047e-04, 9.9989e-01],
        [4.5811e-01, 5.4189e-01],
        [9.8970e-01, 1.0302e-02],
        [9.9389e-01, 6.1086e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.9440e-01, 6.0560e-01],
        [5.8438e-01, 4.1562e-01],
        [2.8248e-03, 9.9718e-01],
        [7.5134e-01, 2.4866e-01],
        [9.4731e-01, 5.2685e-02],
        [1.3732e-02, 9.8627e-01],
        [4.6136e-01, 5.3864e-01],
        [6.6416e-01, 3.3584e-01],
        [3.7632e-03, 9.9624e-01],
        [9.9951e-01, 4.9297e-04],
        [9.9976e-01, 2.3582e-04],
        [9.9981e-01, 1.9475e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.2552,  1.6840],
        [ 0.8332,  0.4924],
        [-2.4374,  3.4291],
        [ 1.2436,  0.1378],
        [ 2.4352, -0.4541],
        [-1.6446,  2.6296],
        [-0.4011, -0.2462],
        [ 0.8068,  0.1249],
        [-2.8298,  2.7489],
        [ 3.9414, -3.6731],
        [ 5.4826, -2.8696],
        [ 5.3881, -3.1555]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.1848e-01, 8.8152e-01],
        [9.3799e-01, 6.2007e-02],
        [5.0947e-03, 9.9491e-01],
        [2.9467e-01, 7.0533e-01],
        [9.8605e-01, 1.3949e-02],
        [9.7603e-03, 9.9024e-01],
        [6.9757e-01, 3.0243e-01],
        [5.9137e-02, 9.4086e-01],
        [2.3663e-04, 9.9976e-01],
        [9.9999e-01, 7.4060e-06],
        [1.0000e+00, 1.5087e-06],
        [9.9906e-01, 9.3945e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.8055e-05, 9.9990e-01],
        [5.1940e-04, 9.9948e-01],
        [1.0641e-04, 9.9989e-01],
        [9.0800e-04, 9.9909e-01],
        [3.0273e-03, 9.9697e-01],
        [3.7122e-04, 9.9963e-01],
        [1.0357e-02, 9.8964e-01],
        [1.4561e-03, 9.9854e-01],
        [1.5707e-03, 9.9843e-01],
        [9.7450e-01, 2.5503e-02],
        [7.5042e-01, 2.4958e-01],
        [9.7796e-01, 2.2040e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-3.7841,  5.4458],
        [-2.3678,  5.1945],
        [-3.8285,  5.3196],
        [-2.7392,  4.2642],
        [-1.9252,  3.8719],
        [-4.2982,  3.6002],
        [-1.5813,  2.9784],
        [-3.3785,  3.1520],
        [-3.2489,  3.2058],
        [ 1.5043, -2.1388],
        [-0.5863, -1.6872],
        [ 2.1844, -1.6082]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.4757e-07, 1.0000e+00],
        [1.3324e-04, 9.9987e-01],
        [2.2395e-04, 9.9978e-01],
        [4.9899e-04, 9.9950e-01],
        [1.2211e-03, 9.9878e-01],
        [7.5160e-05, 9.9992e-01],
        [1.9295e-02, 9.8070e-01],
        [1.0222e-02, 9.8978e-01],
        [2.4213e-04, 9.9976e-01],
        [9.7749e-01, 2.2509e-02],
        [8.0289e-01, 1.9711e-01],
        [9.4025e-01, 5.9745e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 125, Epoch 2/3, Batch 45/80
temp: 0.8728, beta: 0.0868, 
nri_train_loss: 1.9867, enc_train_loss: 6.8017, enc_train_entropy: 0.1263, dec_train_loss: 1.2952, enc_train_edge_accuracy: 0.4983

Edge pred tensor([[9.9679e-01, 3.2146e-03],
        [9.9754e-01, 2.4560e-03],
        [2.2836e-02, 9.7716e-01],
        [7.4625e-01, 2.5375e-01],
        [9.6500e-01, 3.5003e-02],
        [1.5523e-03, 9.9845e-01],
        [4.8231e-01, 5.1769e-01],
        [8.7660e-01, 1.2340e-01],
        [1.0088e-03, 9.9899e-01],
        [9.9912e-01, 8.7924e-04],
        [9.9987e-01, 1.2952e-04],
        [9.9994e-01, 5.6541e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.7951, -2.9417],
        [ 2.4478, -3.5589],
        [-1.7125,  2.0438],
        [ 1.8246,  0.7459],
        [ 1.2155, -2.1012],
        [-3.1901,  3.2764],
        [ 0.7636,  0.8344],
        [ 0.4625, -1.4982],
        [-3.5149,  3.3831],
        [ 5.1505, -1.8850],
        [ 4.8058, -4.1458],
        [ 4.9533, -4.8272]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9968e-01, 3.1803e-04],
        [9.9586e-01, 4.1352e-03],
        [3.1846e-02, 9.6815e-01],
        [8.5571e-01, 1.4429e-01],
        [9.9348e-01, 6.5171e-03],
        [1.5040e-02, 9.8496e-01],
        [2.9469e-01, 7.0531e-01],
        [8.9298e-01, 1.0702e-01],
        [2.9091e-04, 9.9971e-01],
        [9.9978e-01, 2.2369e-04],
        [9.9999e-01, 1.0147e-05],
        [9.9991e-01, 8.9020e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[5.9024e-01, 4.0976e-01],
        [6.5092e-01, 3.4908e-01],
        [7.2151e-04, 9.9928e-01],
        [3.7973e-01, 6.2027e-01],
        [7.1876e-01, 2.8124e-01],
        [1.3977e-03, 9.9860e-01],
        [7.4184e-01, 2.5816e-01],
        [9.5515e-01, 4.4854e-02],
        [6.5270e-03, 9.9347e-01],
        [9.9978e-01, 2.1870e-04],
        [9.9992e-01, 7.9466e-05],
        [9.9993e-01, 6.7317e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.5551,  1.1902],
        [ 1.0811,  0.4580],
        [-3.1396,  4.0939],
        [ 0.5000,  0.9907],
        [ 0.9266, -0.0118],
        [-3.2716,  3.3000],
        [ 0.6153, -0.4403],
        [ 2.0014, -1.0571],
        [-2.4298,  2.5955],
        [ 4.5563, -3.8713],
        [ 6.1648, -3.2753],
        [ 5.8156, -3.7905]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.0224e-01, 7.9776e-01],
        [4.7055e-01, 5.2945e-01],
        [7.7981e-04, 9.9922e-01],
        [8.5670e-02, 9.1433e-01],
        [8.2934e-01, 1.7066e-01],
        [5.9293e-03, 9.9407e-01],
        [4.3327e-01, 5.6673e-01],
        [9.6945e-01, 3.0547e-02],
        [2.7147e-04, 9.9973e-01],
        [9.9951e-01, 4.8692e-04],
        [9.9993e-01, 7.2235e-05],
        [9.9997e-01, 3.2578e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.6059e-02, 9.5394e-01],
        [7.1434e-01, 2.8566e-01],
        [3.4739e-04, 9.9965e-01],
        [9.8935e-01, 1.0646e-02],
        [9.9744e-01, 2.5588e-03],
        [9.8458e-03, 9.9015e-01],
        [8.2335e-01, 1.7665e-01],
        [4.5995e-01, 5.4005e-01],
        [1.1320e-03, 9.9887e-01],
        [9.9930e-01, 6.9679e-04],
        [9.9574e-01, 4.2620e-03],
        [9.9983e-01, 1.6920e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.9571,  2.0736],
        [ 0.5210, -0.3956],
        [-3.8218,  4.1429],
        [ 2.3042, -2.2277],
        [ 3.4728, -2.4929],
        [-1.2073,  3.4035],
        [ 0.0645, -1.4747],
        [ 0.7224,  0.8829],
        [-2.8936,  3.8891],
        [ 3.9976, -3.2708],
        [ 4.4096, -1.0441],
        [ 5.3095, -3.3747]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.4335e-02, 9.8567e-01],
        [7.6893e-01, 2.3107e-01],
        [9.1221e-04, 9.9909e-01],
        [9.9987e-01, 1.2689e-04],
        [9.9962e-01, 3.8463e-04],
        [2.4975e-04, 9.9975e-01],
        [9.9770e-01, 2.3044e-03],
        [9.8718e-01, 1.2824e-02],
        [1.9855e-04, 9.9980e-01],
        [9.9998e-01, 2.1270e-05],
        [9.9749e-01, 2.5147e-03],
        [9.9992e-01, 8.3938e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.2354e-02, 9.6765e-01],
        [1.2269e-02, 9.8773e-01],
        [2.3960e-04, 9.9976e-01],
        [4.4591e-02, 9.5541e-01],
        [2.1969e-02, 9.7803e-01],
        [2.9906e-04, 9.9970e-01],
        [3.8091e-03, 9.9619e-01],
        [1.6270e-03, 9.9837e-01],
        [2.8518e-05, 9.9997e-01],
        [9.8864e-01, 1.1361e-02],
        [9.9255e-01, 7.4526e-03],
        [9.9398e-01, 6.0191e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.7900,  2.6081],
        [-2.2633,  2.1250],
        [-4.0820,  4.2543],
        [-0.4543,  2.6103],
        [-1.5728,  2.2231],
        [-3.4037,  4.7109],
        [-2.1964,  3.3702],
        [-2.4773,  3.9421],
        [-4.8421,  5.6229],
        [ 1.8870, -2.5791],
        [ 2.4094, -2.4823],
        [ 1.7637, -3.3431]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.2026e-02, 9.6797e-01],
        [4.8348e-02, 9.5165e-01],
        [1.6658e-05, 9.9998e-01],
        [7.9387e-02, 9.2061e-01],
        [2.8523e-03, 9.9715e-01],
        [5.2062e-05, 9.9995e-01],
        [1.8213e-02, 9.8179e-01],
        [1.6948e-03, 9.9831e-01],
        [7.5705e-07, 1.0000e+00],
        [9.7297e-01, 2.7027e-02],
        [9.9959e-01, 4.1414e-04],
        [9.9490e-01, 5.0992e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9235e-01, 7.6466e-03],
        [9.9372e-01, 6.2831e-03],
        [8.2136e-03, 9.9179e-01],
        [9.9942e-01, 5.7862e-04],
        [9.9920e-01, 7.9526e-04],
        [3.1984e-02, 9.6802e-01],
        [9.9772e-01, 2.2764e-03],
        [9.9657e-01, 3.4337e-03],
        [9.7629e-03, 9.9024e-01],
        [9.9998e-01, 2.4435e-05],
        [9.9993e-01, 6.5744e-05],
        [9.9991e-01, 8.9715e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.7827, -2.0831],
        [ 2.8399, -2.2237],
        [-2.2188,  2.5749],
        [ 3.5028, -3.9515],
        [ 4.1207, -3.0153],
        [-1.0745,  2.3356],
        [ 2.1148, -3.9681],
        [ 2.6551, -3.0156],
        [-1.8291,  2.7903],
        [ 4.8040, -5.8154],
        [ 5.2709, -4.3588],
        [ 5.3324, -3.9864]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.7646e-01, 2.3541e-02],
        [9.9781e-01, 2.1870e-03],
        [1.3519e-01, 8.6481e-01],
        [9.9979e-01, 2.0679e-04],
        [9.9156e-01, 8.4381e-03],
        [8.6249e-01, 1.3751e-01],
        [9.9993e-01, 7.0704e-05],
        [9.9955e-01, 4.5175e-04],
        [1.2754e-03, 9.9872e-01],
        [1.0000e+00, 1.5460e-06],
        [1.0000e+00, 7.5578e-08],
        [9.9995e-01, 5.4246e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 130, Epoch 2/3, Batch 50/80
temp: 0.8684, beta: 0.0903, 
nri_train_loss: 1.9444, enc_train_loss: 6.6264, enc_train_entropy: 0.1409, dec_train_loss: 1.2335, enc_train_edge_accuracy: 0.4983

Edge pred tensor([[3.0198e-01, 6.9802e-01],
        [6.9676e-01, 3.0324e-01],
        [6.2287e-04, 9.9938e-01],
        [9.1893e-01, 8.1075e-02],
        [9.8700e-01, 1.3003e-02],
        [6.1495e-03, 9.9385e-01],
        [9.7198e-01, 2.8018e-02],
        [9.8406e-01, 1.5940e-02],
        [1.0996e-02, 9.8900e-01],
        [9.9993e-01, 6.9513e-05],
        [9.9992e-01, 8.0799e-05],
        [9.9996e-01, 3.8095e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.7153,  1.5532],
        [ 1.0480,  0.2161],
        [-3.3078,  4.0727],
        [ 0.7946, -1.6332],
        [ 2.8277, -1.5018],
        [-2.4420,  2.6432],
        [ 1.2045, -2.3420],
        [ 2.5716, -1.5513],
        [-2.4400,  2.0592],
        [ 5.0727, -4.5012],
        [ 6.3285, -3.0949],
        [ 6.6913, -3.4841]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.7596e-02, 9.2240e-01],
        [7.0331e-01, 2.9669e-01],
        [2.1895e-05, 9.9998e-01],
        [9.9823e-01, 1.7736e-03],
        [9.2488e-01, 7.5123e-02],
        [1.3935e-02, 9.8607e-01],
        [9.8424e-01, 1.5757e-02],
        [9.8005e-01, 1.9951e-02],
        [3.0365e-02, 9.6963e-01],
        [1.0000e+00, 3.1344e-06],
        [9.9988e-01, 1.1681e-04],
        [9.9999e-01, 7.0519e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.1852e-01, 3.8148e-01],
        [5.7604e-01, 4.2396e-01],
        [1.7619e-03, 9.9824e-01],
        [7.1809e-04, 9.9928e-01],
        [1.0238e-02, 9.8976e-01],
        [7.3405e-05, 9.9993e-01],
        [1.7174e-04, 9.9983e-01],
        [3.2430e-03, 9.9676e-01],
        [2.4256e-05, 9.9998e-01],
        [9.7697e-01, 2.3028e-02],
        [9.9927e-01, 7.3161e-04],
        [9.9682e-01, 3.1766e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.2060, -0.2773],
        [ 0.6197,  0.3132],
        [-3.6673,  2.6723],
        [-3.9012,  3.3370],
        [-1.7377,  2.8337],
        [-4.5673,  4.9522],
        [-4.7431,  3.9262],
        [-3.0578,  2.6703],
        [-5.2646,  5.3622],
        [ 0.6649, -3.0829],
        [ 2.5771, -4.6425],
        [ 2.5505, -3.1983]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.2590e-02, 9.1741e-01],
        [2.7432e-01, 7.2568e-01],
        [7.6311e-02, 9.2369e-01],
        [3.0618e-04, 9.9969e-01],
        [6.6934e-04, 9.9933e-01],
        [4.0743e-05, 9.9996e-01],
        [4.1085e-06, 1.0000e+00],
        [1.2099e-02, 9.8790e-01],
        [4.4298e-06, 1.0000e+00],
        [9.4386e-01, 5.6138e-02],
        [9.9378e-01, 6.2179e-03],
        [4.6812e-01, 5.3188e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.8092e-04, 9.9982e-01],
        [5.8601e-04, 9.9941e-01],
        [1.3276e-04, 9.9987e-01],
        [9.1992e-03, 9.9080e-01],
        [1.9193e-02, 9.8081e-01],
        [1.1862e-03, 9.9881e-01],
        [4.7220e-03, 9.9528e-01],
        [1.4399e-03, 9.9856e-01],
        [9.2433e-04, 9.9908e-01],
        [9.8808e-01, 1.1923e-02],
        [9.5198e-01, 4.8016e-02],
        [9.8362e-01, 1.6380e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.9264,  5.6909],
        [-2.6158,  4.8258],
        [-3.9181,  5.0087],
        [-0.6156,  4.0638],
        [-0.6262,  3.3076],
        [-2.9970,  3.7388],
        [-1.5243,  3.8265],
        [-2.4824,  4.0593],
        [-3.6393,  3.3462],
        [ 2.5246, -1.8927],
        [ 1.8320, -1.1550],
        [ 2.3669, -1.7283]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.5355e-04, 9.9985e-01],
        [7.8568e-04, 9.9921e-01],
        [1.1779e-04, 9.9988e-01],
        [2.2181e-02, 9.7782e-01],
        [3.0975e-03, 9.9690e-01],
        [1.0295e-04, 9.9990e-01],
        [1.3927e-03, 9.9861e-01],
        [2.0007e-04, 9.9980e-01],
        [6.7157e-05, 9.9993e-01],
        [9.9434e-01, 5.6562e-03],
        [9.6733e-01, 3.2673e-02],
        [9.9962e-01, 3.8351e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.3453e-02, 9.7655e-01],
        [3.8250e-01, 6.1750e-01],
        [1.4594e-04, 9.9985e-01],
        [8.3106e-01, 1.6894e-01],
        [9.6487e-01, 3.5132e-02],
        [1.1804e-02, 9.8820e-01],
        [4.5068e-01, 5.4932e-01],
        [2.1971e-01, 7.8029e-01],
        [2.3720e-03, 9.9763e-01],
        [9.9812e-01, 1.8835e-03],
        [9.9608e-01, 3.9230e-03],
        [9.9958e-01, 4.1645e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.1409,  1.5881],
        [ 0.2354,  0.7144],
        [-4.1715,  4.6607],
        [ 0.3074, -1.2857],
        [ 1.8875, -1.4253],
        [-2.2265,  2.2009],
        [-0.7840, -0.5861],
        [-0.8019,  0.4654],
        [-3.0537,  2.9880],
        [ 3.1254, -3.1474],
        [ 3.1726, -2.3644],
        [ 5.0130, -2.7704]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.9450e-02, 9.4055e-01],
        [5.4437e-01, 4.5563e-01],
        [9.8766e-06, 9.9999e-01],
        [9.2920e-01, 7.0795e-02],
        [3.8558e-01, 6.1442e-01],
        [1.1720e-02, 9.8828e-01],
        [9.1943e-01, 8.0569e-02],
        [6.8934e-02, 9.3107e-01],
        [6.2039e-05, 9.9994e-01],
        [9.9994e-01, 6.4640e-05],
        [8.8034e-01, 1.1966e-01],
        [9.9998e-01, 1.5930e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.5476e-01, 6.4524e-01],
        [9.0382e-01, 9.6182e-02],
        [1.9112e-03, 9.9809e-01],
        [9.9387e-01, 6.1283e-03],
        [9.9878e-01, 1.2197e-03],
        [4.8887e-02, 9.5111e-01],
        [8.7650e-01, 1.2350e-01],
        [9.0983e-01, 9.0172e-02],
        [8.9676e-03, 9.9103e-01],
        [9.9788e-01, 2.1247e-03],
        [9.9863e-01, 1.3722e-03],
        [9.9977e-01, 2.2518e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.4183,  2.0165],
        [ 1.1042, -1.1362],
        [-2.9268,  3.3313],
        [ 4.0457, -1.0430],
        [ 4.6813, -2.0266],
        [ 0.6778,  3.6459],
        [ 0.8637, -1.0959],
        [ 2.5038,  0.1923],
        [-1.4188,  3.2863],
        [ 4.0333, -2.1187],
        [ 5.4984, -1.0916],
        [ 4.9305, -3.4679]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.4156e-02, 9.7584e-01],
        [7.3298e-01, 2.6702e-01],
        [1.2378e-04, 9.9988e-01],
        [9.9901e-01, 9.9173e-04],
        [9.9888e-01, 1.1175e-03],
        [1.2820e-02, 9.8718e-01],
        [8.0285e-01, 1.9715e-01],
        [9.9453e-01, 5.4708e-03],
        [1.3731e-02, 9.8627e-01],
        [9.7008e-01, 2.9915e-02],
        [9.9654e-01, 3.4560e-03],
        [9.9943e-01, 5.7254e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 135, Epoch 2/3, Batch 55/80
temp: 0.8641, beta: 0.0938, 
nri_train_loss: 1.8740, enc_train_loss: 6.6391, enc_train_entropy: 0.1399, dec_train_loss: 1.1397, enc_train_edge_accuracy: 0.5050

Edge pred tensor([[9.6726e-01, 3.2745e-02],
        [9.8894e-01, 1.1056e-02],
        [1.7418e-02, 9.8258e-01],
        [3.9408e-01, 6.0592e-01],
        [9.5541e-01, 4.4588e-02],
        [4.0104e-03, 9.9599e-01],
        [6.8771e-01, 3.1229e-01],
        [9.5114e-01, 4.8863e-02],
        [9.0347e-03, 9.9097e-01],
        [9.9979e-01, 2.1046e-04],
        [9.9997e-01, 3.2905e-05],
        [9.9998e-01, 1.5839e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.7197, -1.6661],
        [ 2.4489, -2.0447],
        [-2.1300,  1.9026],
        [-0.9472, -0.5170],
        [ 1.6050, -1.4597],
        [-3.6801,  1.8348],
        [-0.7339, -1.5234],
        [ 0.8074, -2.1613],
        [-3.4158,  1.2818],
        [ 4.6172, -3.8488],
        [ 6.3318, -3.9901],
        [ 7.0383, -4.0147]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9087e-01, 9.1273e-03],
        [9.7330e-01, 2.6698e-02],
        [1.7570e-02, 9.8243e-01],
        [6.2496e-01, 3.7504e-01],
        [9.8629e-01, 1.3714e-02],
        [1.8125e-03, 9.9819e-01],
        [9.0300e-01, 9.6995e-02],
        [9.6564e-01, 3.4362e-02],
        [1.1340e-04, 9.9989e-01],
        [9.9979e-01, 2.0957e-04],
        [9.9993e-01, 6.5128e-05],
        [1.0000e+00, 9.8989e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.9483e-01, 3.0517e-01],
        [4.6969e-01, 5.3031e-01],
        [2.1893e-03, 9.9781e-01],
        [4.5037e-03, 9.9550e-01],
        [1.1912e-02, 9.8809e-01],
        [1.5168e-04, 9.9985e-01],
        [5.8507e-04, 9.9941e-01],
        [5.5362e-03, 9.9446e-01],
        [2.6103e-05, 9.9997e-01],
        [9.6934e-01, 3.0656e-02],
        [9.9766e-01, 2.3445e-03],
        [9.9721e-01, 2.7863e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.2239, -1.0467],
        [ 0.4915,  0.6129],
        [-3.6319,  2.4900],
        [-2.4899,  2.9084],
        [-1.7927,  2.6255],
        [-4.6826,  4.1109],
        [-2.9905,  4.4527],
        [-2.8284,  2.3625],
        [-4.9294,  5.6240],
        [ 1.3125, -2.1413],
        [ 1.5062, -4.5471],
        [ 2.9153, -2.9649]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9449e-01, 5.5121e-03],
        [2.7382e-02, 9.7262e-01],
        [1.0062e-04, 9.9990e-01],
        [2.4313e-02, 9.7569e-01],
        [5.2256e-04, 9.9948e-01],
        [2.9180e-05, 9.9997e-01],
        [2.2081e-05, 9.9998e-01],
        [1.2379e-04, 9.9988e-01],
        [3.4287e-05, 9.9997e-01],
        [9.9846e-01, 1.5440e-03],
        [9.9941e-01, 5.8976e-04],
        [9.9957e-01, 4.3104e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.7464e-01, 2.5364e-02],
        [9.8716e-01, 1.2840e-02],
        [9.0473e-03, 9.9095e-01],
        [9.9924e-01, 7.5888e-04],
        [9.9895e-01, 1.0476e-03],
        [4.1716e-02, 9.5828e-01],
        [9.9117e-01, 8.8280e-03],
        [9.5928e-01, 4.0725e-02],
        [2.3069e-03, 9.9769e-01],
        [9.9996e-01, 4.4103e-05],
        [9.9987e-01, 1.2668e-04],
        [9.9986e-01, 1.3742e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.1871, -1.4617],
        [ 2.2430, -2.0992],
        [-2.0680,  2.6282],
        [ 3.0451, -4.1378],
        [ 3.6389, -3.2213],
        [-1.1583,  1.9760],
        [ 1.2389, -3.4821],
        [ 1.2900, -1.8693],
        [-2.8658,  3.2037],
        [ 4.2362, -5.7927],
        [ 4.6236, -4.3501],
        [ 4.8579, -4.0344]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9962e-01, 3.8208e-04],
        [9.7513e-01, 2.4873e-02],
        [3.3629e-02, 9.6637e-01],
        [9.8890e-01, 1.1098e-02],
        [9.9978e-01, 2.1796e-04],
        [5.7143e-03, 9.9429e-01],
        [9.9882e-01, 1.1804e-03],
        [9.7770e-01, 2.2299e-02],
        [1.0150e-03, 9.9898e-01],
        [9.9995e-01, 5.3889e-05],
        [1.0000e+00, 1.9781e-06],
        [9.9990e-01, 1.0452e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.7557e-01, 2.4432e-02],
        [9.7695e-01, 2.3053e-02],
        [1.7417e-02, 9.8258e-01],
        [1.3737e-02, 9.8626e-01],
        [4.3147e-01, 5.6853e-01],
        [2.5342e-04, 9.9975e-01],
        [1.6810e-01, 8.3190e-01],
        [7.9919e-01, 2.0081e-01],
        [1.5197e-03, 9.9848e-01],
        [9.9965e-01, 3.5283e-04],
        [9.9997e-01, 3.3164e-05],
        [9.9997e-01, 2.8123e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.8634, -0.8237],
        [ 2.2932, -1.4534],
        [-1.8142,  2.2185],
        [-1.8323,  2.4415],
        [ 0.2790,  0.5548],
        [-4.4307,  3.8495],
        [-1.1434,  0.4558],
        [ 0.7123, -0.6689],
        [-3.6735,  2.8142],
        [ 4.6363, -3.3128],
        [ 6.7715, -3.5425],
        [ 6.4483, -4.0306]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.8613e-01, 1.3871e-02],
        [8.8830e-01, 1.1170e-01],
        [2.9087e-02, 9.7091e-01],
        [8.5373e-04, 9.9915e-01],
        [7.6021e-01, 2.3979e-01],
        [4.7436e-04, 9.9953e-01],
        [3.7949e-01, 6.2051e-01],
        [9.8151e-01, 1.8492e-02],
        [1.6407e-05, 9.9998e-01],
        [9.9948e-01, 5.2336e-04],
        [1.0000e+00, 4.0586e-06],
        [9.9998e-01, 2.1875e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.3791e-02, 9.7621e-01],
        [6.3672e-02, 9.3633e-01],
        [1.1377e-03, 9.9886e-01],
        [5.9501e-03, 9.9405e-01],
        [7.1660e-02, 9.2834e-01],
        [6.5325e-04, 9.9935e-01],
        [5.7137e-03, 9.9429e-01],
        [4.8611e-02, 9.5139e-01],
        [8.2449e-04, 9.9918e-01],
        [9.6261e-01, 3.7390e-02],
        [9.9392e-01, 6.0816e-03],
        [9.9608e-01, 3.9152e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.6024,  3.1119],
        [-1.6108,  1.0774],
        [-2.3833,  4.3943],
        [-2.1589,  2.9595],
        [-1.3417,  1.2198],
        [-3.0448,  4.2881],
        [-2.7859,  2.3733],
        [-1.1446,  1.8295],
        [-3.4619,  3.6380],
        [ 1.4936, -1.7546],
        [ 3.4282, -1.6682],
        [ 1.9007, -3.6383]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.3720e-01, 8.6280e-01],
        [8.2532e-04, 9.9917e-01],
        [5.2145e-04, 9.9948e-01],
        [1.6864e-04, 9.9983e-01],
        [5.3637e-02, 9.4636e-01],
        [3.6884e-04, 9.9963e-01],
        [6.0775e-05, 9.9994e-01],
        [1.3789e-03, 9.9862e-01],
        [7.5094e-05, 9.9992e-01],
        [9.8546e-01, 1.4541e-02],
        [9.9481e-01, 5.1895e-03],
        [9.8377e-01, 1.6231e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 140, Epoch 2/3, Batch 60/80
temp: 0.8598, beta: 0.0972, 
nri_train_loss: 1.8680, enc_train_loss: 6.6670, enc_train_entropy: 0.1376, dec_train_loss: 1.1097, enc_train_edge_accuracy: 0.5100

Edge pred tensor([[5.3866e-04, 9.9946e-01],
        [5.7502e-04, 9.9943e-01],
        [2.0755e-04, 9.9979e-01],
        [6.3788e-02, 9.3621e-01],
        [2.8682e-03, 9.9713e-01],
        [5.5304e-04, 9.9945e-01],
        [6.9175e-01, 3.0825e-01],
        [5.3865e-02, 9.4613e-01],
        [7.8045e-03, 9.9220e-01],
        [9.9928e-01, 7.2030e-04],
        [9.5484e-01, 4.5164e-02],
        [9.8167e-01, 1.8327e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-3.4007,  4.1252],
        [-2.0264,  5.4342],
        [-3.4909,  4.9890],
        [-0.6713,  2.0150],
        [-0.9523,  4.8989],
        [-3.7754,  3.7241],
        [ 2.3660,  1.5577],
        [-0.2307,  2.6352],
        [-0.8111,  4.0342],
        [ 3.2590, -3.9761],
        [ 0.5330, -2.5183],
        [ 2.9060, -1.0748]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.3518e-04, 9.9906e-01],
        [2.1441e-02, 9.7856e-01],
        [1.1265e-04, 9.9989e-01],
        [1.1526e-02, 9.8847e-01],
        [4.7043e-04, 9.9953e-01],
        [5.2617e-05, 9.9995e-01],
        [9.1968e-01, 8.0324e-02],
        [1.2926e-01, 8.7074e-01],
        [4.3880e-03, 9.9561e-01],
        [9.9987e-01, 1.2879e-04],
        [8.4176e-01, 1.5824e-01],
        [9.9968e-01, 3.1683e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.8965e-03, 9.9710e-01],
        [2.5234e-02, 9.7477e-01],
        [1.4699e-04, 9.9985e-01],
        [3.4431e-03, 9.9656e-01],
        [6.0157e-02, 9.3984e-01],
        [7.1430e-04, 9.9929e-01],
        [1.7895e-03, 9.9821e-01],
        [5.2865e-03, 9.9471e-01],
        [4.7078e-04, 9.9953e-01],
        [9.7044e-01, 2.9561e-02],
        [9.8132e-01, 1.8683e-02],
        [9.9844e-01, 1.5622e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.2302,  3.6112],
        [-1.5024,  2.1516],
        [-3.8122,  5.0128],
        [-3.1161,  2.5518],
        [-1.4690,  1.2797],
        [-3.8558,  3.3877],
        [-3.2248,  3.0992],
        [-2.4112,  2.8261],
        [-3.4312,  4.2295],
        [ 0.8587, -2.6326],
        [ 2.2065, -1.7547],
        [ 3.2131, -3.2470]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.0419e-03, 9.9096e-01],
        [1.1555e-02, 9.8844e-01],
        [1.5085e-03, 9.9849e-01],
        [2.8180e-03, 9.9718e-01],
        [2.2574e-01, 7.7426e-01],
        [3.5525e-04, 9.9964e-01],
        [3.8345e-03, 9.9617e-01],
        [5.3713e-04, 9.9946e-01],
        [1.4985e-04, 9.9985e-01],
        [9.8075e-01, 1.9255e-02],
        [9.7975e-01, 2.0254e-02],
        [9.9951e-01, 4.8774e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.8306e-02, 9.7169e-01],
        [8.7407e-03, 9.9126e-01],
        [4.2170e-04, 9.9958e-01],
        [7.2970e-01, 2.7030e-01],
        [1.5925e-01, 8.4075e-01],
        [4.1802e-03, 9.9582e-01],
        [5.3438e-02, 9.4656e-01],
        [1.6610e-02, 9.8339e-01],
        [1.5800e-04, 9.9984e-01],
        [9.9640e-01, 3.5988e-03],
        [9.9286e-01, 7.1369e-03],
        [9.7817e-01, 2.1832e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.2329,  2.3031],
        [-2.5370,  2.1940],
        [-3.7682,  4.0026],
        [-0.1751, -1.1682],
        [-0.8118,  0.8520],
        [-2.4161,  3.0571],
        [-1.2136,  1.6607],
        [-0.8781,  3.2028],
        [-3.6032,  5.1496],
        [ 2.0519, -3.5716],
        [ 2.5741, -2.3613],
        [ 1.2380, -2.5643]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.7914e-03, 9.9621e-01],
        [1.3590e-03, 9.9864e-01],
        [1.1225e-04, 9.9989e-01],
        [9.2819e-01, 7.1811e-02],
        [1.1702e-01, 8.8298e-01],
        [5.7888e-01, 4.2112e-01],
        [2.5465e-01, 7.4535e-01],
        [1.2198e-02, 9.8780e-01],
        [3.6323e-05, 9.9996e-01],
        [9.8597e-01, 1.4027e-02],
        [9.8983e-01, 1.0166e-02],
        [9.6368e-01, 3.6322e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9138e-01, 8.6244e-03],
        [9.9669e-01, 3.3087e-03],
        [3.3628e-02, 9.6637e-01],
        [9.9463e-01, 5.3676e-03],
        [9.9841e-01, 1.5914e-03],
        [2.5324e-02, 9.7468e-01],
        [9.1754e-01, 8.2462e-02],
        [9.2982e-01, 7.0178e-02],
        [9.2888e-04, 9.9907e-01],
        [9.9996e-01, 4.3484e-05],
        [9.9997e-01, 3.1692e-05],
        [9.9999e-01, 1.3677e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.7177, -3.0268],
        [ 1.9850, -3.7229],
        [-2.0388,  1.3194],
        [ 2.6758, -2.5462],
        [ 2.8052, -3.6364],
        [-1.5710,  2.0794],
        [ 0.8300, -1.5794],
        [ 0.8658, -1.7181],
        [-3.7553,  3.2253],
        [ 5.6504, -4.3927],
        [ 5.8437, -4.5157],
        [ 5.6814, -5.5184]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9966e-01, 3.4015e-04],
        [9.9927e-01, 7.3019e-04],
        [6.8341e-02, 9.3166e-01],
        [9.9991e-01, 9.1197e-05],
        [9.9929e-01, 7.0806e-04],
        [1.2528e-03, 9.9875e-01],
        [2.8077e-01, 7.1923e-01],
        [8.9515e-01, 1.0485e-01],
        [4.2919e-05, 9.9996e-01],
        [1.0000e+00, 4.0428e-07],
        [1.0000e+00, 2.6304e-07],
        [1.0000e+00, 1.5977e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.2729e-01, 7.2713e-02],
        [9.8810e-01, 1.1896e-02],
        [9.7500e-03, 9.9025e-01],
        [4.2150e-01, 5.7850e-01],
        [8.7459e-01, 1.2541e-01],
        [1.6864e-03, 9.9831e-01],
        [6.9455e-01, 3.0545e-01],
        [8.6668e-01, 1.3332e-01],
        [2.2188e-03, 9.9778e-01],
        [9.9979e-01, 2.1494e-04],
        [9.9994e-01, 6.4674e-05],
        [9.9998e-01, 1.8342e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.1693, -1.3764],
        [ 1.7178, -2.7018],
        [-2.7475,  1.8732],
        [-0.5454, -0.2288],
        [ 0.6225, -1.3197],
        [-3.8555,  2.5280],
        [ 0.0237, -0.7978],
        [ 0.6345, -1.2374],
        [-3.6594,  2.4492],
        [ 4.3134, -4.1315],
        [ 5.6828, -3.9633],
        [ 6.2642, -4.6421]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.8169e-01, 1.8313e-02],
        [9.9271e-01, 7.2873e-03],
        [1.0127e-03, 9.9899e-01],
        [7.0406e-01, 2.9594e-01],
        [9.6313e-01, 3.6870e-02],
        [4.5547e-05, 9.9995e-01],
        [4.2873e-01, 5.7127e-01],
        [9.6575e-01, 3.4247e-02],
        [9.9085e-04, 9.9901e-01],
        [9.9997e-01, 2.8243e-05],
        [1.0000e+00, 8.8213e-07],
        [1.0000e+00, 4.5964e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 145, Epoch 2/3, Batch 65/80
temp: 0.8555, beta: 0.1000, 
nri_train_loss: 1.8171, enc_train_loss: 6.5721, enc_train_entropy: 0.1455, dec_train_loss: 1.0435, enc_train_edge_accuracy: 0.5067

Edge pred tensor([[4.9925e-03, 9.9501e-01],
        [8.7345e-03, 9.9127e-01],
        [7.3788e-05, 9.9993e-01],
        [4.2455e-02, 9.5754e-01],
        [1.7382e-01, 8.2618e-01],
        [1.5856e-03, 9.9841e-01],
        [1.6794e-02, 9.8321e-01],
        [7.4132e-02, 9.2587e-01],
        [7.9964e-04, 9.9920e-01],
        [9.8729e-01, 1.2709e-02],
        [9.9229e-01, 7.7095e-03],
        [9.9394e-01, 6.0641e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.9688,  3.3260],
        [-1.1926,  3.5391],
        [-4.5387,  4.9755],
        [-1.6810,  1.4350],
        [-0.5212,  1.0376],
        [-3.7888,  2.6565],
        [-1.3660,  2.7037],
        [-0.7559,  1.7690],
        [-3.3081,  3.8224],
        [ 1.9163, -2.4364],
        [ 2.9504, -1.9072],
        [ 3.0137, -2.0856]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.0352e-03, 9.9596e-01],
        [9.9084e-03, 9.9009e-01],
        [1.2076e-05, 9.9999e-01],
        [2.5410e-01, 7.4590e-01],
        [2.5923e-01, 7.4077e-01],
        [6.3411e-05, 9.9994e-01],
        [2.0820e-04, 9.9979e-01],
        [1.4483e-01, 8.5517e-01],
        [4.2063e-03, 9.9579e-01],
        [9.6200e-01, 3.7998e-02],
        [9.6542e-01, 3.4576e-02],
        [9.9955e-01, 4.4548e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9814e-01, 1.8635e-03],
        [9.9110e-01, 8.9005e-03],
        [6.0644e-02, 9.3936e-01],
        [9.9401e-01, 5.9885e-03],
        [9.8631e-01, 1.3689e-02],
        [1.2835e-02, 9.8717e-01],
        [9.6800e-01, 3.2003e-02],
        [9.9058e-01, 9.4195e-03],
        [2.1856e-03, 9.9781e-01],
        [9.9997e-01, 3.2387e-05],
        [9.9999e-01, 1.2455e-05],
        [9.9996e-01, 4.0812e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.3092, -3.9742],
        [ 1.6571, -3.0556],
        [-1.0669,  1.6733],
        [ 1.9910, -3.1209],
        [ 1.8197, -2.4577],
        [-1.6572,  2.6854],
        [ 1.0946, -2.3148],
        [ 1.5601, -3.0954],
        [-2.7206,  3.4031],
        [ 5.3485, -4.9892],
        [ 5.6555, -5.6379],
        [ 5.3438, -4.7627]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9860e-01, 1.4039e-03],
        [9.9985e-01, 1.5159e-04],
        [1.6245e-02, 9.8375e-01],
        [9.9930e-01, 6.9809e-04],
        [9.7166e-01, 2.8341e-02],
        [1.0629e-02, 9.8937e-01],
        [9.9343e-01, 6.5744e-03],
        [9.8686e-01, 1.3142e-02],
        [1.1166e-02, 9.8883e-01],
        [9.9999e-01, 9.5588e-06],
        [1.0000e+00, 4.2041e-06],
        [1.0000e+00, 3.4660e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9809e-01, 1.9149e-03],
        [9.9928e-01, 7.1806e-04],
        [2.6866e-01, 7.3134e-01],
        [8.0701e-01, 1.9299e-01],
        [9.8964e-01, 1.0364e-02],
        [4.2309e-03, 9.9577e-01],
        [4.6308e-01, 5.3692e-01],
        [7.9939e-01, 2.0061e-01],
        [4.2909e-04, 9.9957e-01],
        [9.9965e-01, 3.4688e-04],
        [9.9989e-01, 1.1350e-04],
        [9.9991e-01, 9.3403e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 3.4585, -2.7977],
        [ 4.1337, -3.1045],
        [ 0.1286,  1.1300],
        [ 0.6177, -0.8130],
        [ 2.1044, -2.4545],
        [-2.9133,  2.5478],
        [-0.1966, -0.0487],
        [ 0.7040, -0.6785],
        [-3.4723,  4.2812],
        [ 3.9045, -4.0617],
        [ 4.5616, -4.5220],
        [ 4.8819, -4.3966]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9997e-01, 2.7546e-05],
        [9.9969e-01, 3.1314e-04],
        [4.3484e-01, 5.6516e-01],
        [5.7355e-01, 4.2645e-01],
        [9.4831e-01, 5.1692e-02],
        [7.5489e-04, 9.9925e-01],
        [9.9997e-01, 3.0977e-05],
        [4.1508e-01, 5.8492e-01],
        [1.2482e-05, 9.9999e-01],
        [9.9877e-01, 1.2328e-03],
        [9.9995e-01, 4.5252e-05],
        [9.9999e-01, 1.2037e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.3867e-01, 6.1332e-02],
        [9.8393e-01, 1.6065e-02],
        [1.4105e-01, 8.5895e-01],
        [6.7204e-03, 9.9328e-01],
        [1.0733e-02, 9.8927e-01],
        [3.0292e-04, 9.9970e-01],
        [2.3583e-02, 9.7642e-01],
        [4.4353e-02, 9.5565e-01],
        [6.9966e-04, 9.9930e-01],
        [9.9874e-01, 1.2632e-03],
        [9.9870e-01, 1.2984e-03],
        [9.9957e-01, 4.2668e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.9050, -1.8231],
        [ 2.3851, -1.7298],
        [-0.5225,  1.2841],
        [-1.8313,  3.1646],
        [-1.1888,  3.3348],
        [-3.7830,  4.3188],
        [-1.5230,  2.2003],
        [-1.2774,  1.7928],
        [-2.8538,  4.4104],
        [ 3.3844, -3.2884],
        [ 2.7965, -3.8488],
        [ 4.3173, -3.4417]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.5711e-01, 4.2894e-02],
        [9.9212e-01, 7.8757e-03],
        [1.8507e-01, 8.1493e-01],
        [3.0578e-02, 9.6942e-01],
        [9.7924e-04, 9.9902e-01],
        [4.8472e-05, 9.9995e-01],
        [2.6189e-01, 7.3811e-01],
        [3.1272e-02, 9.6873e-01],
        [9.5647e-05, 9.9990e-01],
        [9.9929e-01, 7.1421e-04],
        [9.9981e-01, 1.8656e-04],
        [9.9981e-01, 1.8628e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.4950e-03, 9.9351e-01],
        [3.3038e-02, 9.6696e-01],
        [3.8508e-04, 9.9961e-01],
        [3.2853e-02, 9.6715e-01],
        [8.8872e-02, 9.1113e-01],
        [7.1978e-04, 9.9928e-01],
        [3.0390e-02, 9.6961e-01],
        [2.2245e-02, 9.7775e-01],
        [5.3420e-04, 9.9947e-01],
        [9.9876e-01, 1.2403e-03],
        [9.9896e-01, 1.0379e-03],
        [9.9952e-01, 4.7505e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-2.1682,  2.8620],
        [-2.0428,  1.3336],
        [-4.5233,  3.3384],
        [-1.9797,  1.4026],
        [-1.6441,  0.6834],
        [-4.4643,  2.7716],
        [-1.8730,  1.5898],
        [-1.0411,  2.7420],
        [-4.3128,  3.2214],
        [ 3.2119, -3.4793],
        [ 4.6577, -2.2118],
        [ 3.8974, -3.7542]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.0515e-02, 9.8949e-01],
        [9.8964e-04, 9.9901e-01],
        [1.3301e-05, 9.9999e-01],
        [5.7860e-01, 4.2140e-01],
        [3.7154e-02, 9.6285e-01],
        [2.0299e-04, 9.9980e-01],
        [4.7586e-02, 9.5241e-01],
        [2.2598e-02, 9.7740e-01],
        [2.5214e-05, 9.9997e-01],
        [9.9873e-01, 1.2742e-03],
        [9.9731e-01, 2.6852e-03],
        [9.9994e-01, 5.7290e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 150, Epoch 2/3, Batch 70/80
temp: 0.8512, beta: 0.1000, 
nri_train_loss: 1.7446, enc_train_loss: 6.4683, enc_train_entropy: 0.1541, dec_train_loss: 0.9745, enc_train_edge_accuracy: 0.5167

Edge pred tensor([[9.9113e-01, 8.8733e-03],
        [9.6864e-01, 3.1363e-02],
        [1.3839e-02, 9.8616e-01],
        [6.7074e-01, 3.2926e-01],
        [6.5169e-01, 3.4831e-01],
        [6.2573e-04, 9.9937e-01],
        [5.4256e-01, 4.5744e-01],
        [7.4084e-01, 2.5916e-01],
        [5.6484e-04, 9.9944e-01],
        [9.9988e-01, 1.1618e-04],
        [9.9993e-01, 6.7714e-05],
        [9.9984e-01, 1.6219e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 2.3258, -2.3900],
        [ 2.2224, -1.2079],
        [-1.8340,  2.4323],
        [ 0.4643, -0.2472],
        [-0.0197, -0.6462],
        [-3.7999,  3.5761],
        [ 0.3105,  0.1398],
        [ 0.3583, -0.6920],
        [-3.6669,  3.8115],
        [ 5.1886, -3.8717],
        [ 4.7630, -4.8371],
        [ 4.8146, -3.9120]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9969e-01, 3.0543e-04],
        [9.6608e-01, 3.3923e-02],
        [7.1202e-03, 9.9288e-01],
        [5.5091e-01, 4.4909e-01],
        [2.9546e-02, 9.7045e-01],
        [3.5652e-04, 9.9964e-01],
        [8.6516e-01, 1.3484e-01],
        [8.1921e-01, 1.8079e-01],
        [2.0304e-02, 9.7970e-01],
        [9.9986e-01, 1.3728e-04],
        [9.9998e-01, 1.8159e-05],
        [9.9999e-01, 9.6419e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.5911e-01, 4.0891e-02],
        [9.5933e-01, 4.0667e-02],
        [4.1527e-02, 9.5847e-01],
        [1.4476e-01, 8.5524e-01],
        [9.8483e-02, 9.0152e-01],
        [4.3076e-04, 9.9957e-01],
        [7.9946e-02, 9.2005e-01],
        [1.0269e-01, 8.9731e-01],
        [3.6967e-04, 9.9963e-01],
        [9.9973e-01, 2.7212e-04],
        [9.9976e-01, 2.4250e-04],
        [9.9977e-01, 2.3328e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.5076, -2.6475],
        [ 1.4594, -1.7014],
        [-1.7380,  1.4010],
        [-0.9897,  0.7866],
        [-1.3450,  0.8692],
        [-4.4185,  3.3310],
        [-1.2058,  1.2373],
        [-1.7841,  0.3836],
        [-4.1315,  3.7711],
        [ 4.4377, -3.7713],
        [ 3.4114, -4.9128],
        [ 4.2916, -4.0714]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.8647e-01, 1.3530e-02],
        [9.9979e-01, 2.1475e-04],
        [2.0394e-02, 9.7961e-01],
        [5.3409e-01, 4.6591e-01],
        [3.2396e-02, 9.6760e-01],
        [3.6014e-04, 9.9964e-01],
        [3.5312e-02, 9.6469e-01],
        [6.5787e-03, 9.9342e-01],
        [9.3403e-06, 9.9999e-01],
        [9.9997e-01, 2.9879e-05],
        [9.8993e-01, 1.0074e-02],
        [9.9995e-01, 5.1580e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.0441e-02, 9.0956e-01],
        [3.3511e-01, 6.6489e-01],
        [3.5792e-03, 9.9642e-01],
        [8.2392e-03, 9.9176e-01],
        [7.8093e-02, 9.2191e-01],
        [7.4821e-04, 9.9925e-01],
        [5.4620e-03, 9.9454e-01],
        [1.2408e-02, 9.8759e-01],
        [5.8853e-04, 9.9941e-01],
        [9.9616e-01, 3.8445e-03],
        [9.9842e-01, 1.5813e-03],
        [9.9948e-01, 5.2239e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.1505,  1.1577],
        [ 0.0130,  0.6982],
        [-3.5136,  2.1155],
        [-2.7380,  2.0526],
        [-0.9590,  1.5095],
        [-4.4068,  2.7903],
        [-2.5728,  2.6316],
        [-1.8212,  2.5557],
        [-3.9115,  3.5257],
        [ 2.1552, -3.4021],
        [ 2.7444, -3.7035],
        [ 4.1828, -3.3738]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.0929e-01, 6.9071e-01],
        [4.5560e-01, 5.4440e-01],
        [7.7646e-04, 9.9922e-01],
        [2.4573e-03, 9.9754e-01],
        [1.4418e-01, 8.5582e-01],
        [6.2194e-03, 9.9378e-01],
        [9.8490e-03, 9.9015e-01],
        [2.3054e-02, 9.7695e-01],
        [1.2708e-04, 9.9987e-01],
        [9.9956e-01, 4.4239e-04],
        [9.9448e-01, 5.5172e-03],
        [9.9996e-01, 4.3468e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.6330e-01, 3.3670e-01],
        [6.7083e-01, 3.2917e-01],
        [3.8715e-03, 9.9613e-01],
        [9.0001e-01, 9.9987e-02],
        [5.5230e-01, 4.4770e-01],
        [1.7302e-03, 9.9827e-01],
        [9.6146e-02, 9.0385e-01],
        [4.0194e-02, 9.5981e-01],
        [1.4113e-04, 9.9986e-01],
        [9.9987e-01, 1.3368e-04],
        [9.9967e-01, 3.3185e-04],
        [9.9974e-01, 2.5749e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.3461, -0.3319],
        [-0.6402, -1.3521],
        [-3.0864,  2.4638],
        [ 1.2249, -0.9725],
        [-1.0196, -1.2296],
        [-3.5386,  2.8191],
        [-0.6623,  1.5784],
        [-1.2980,  1.8751],
        [-4.4793,  4.3864],
        [ 5.4958, -3.4241],
        [ 4.2864, -3.7241],
        [ 3.7385, -4.5258]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.2717e-01, 7.7283e-01],
        [7.0271e-01, 2.9729e-01],
        [2.1961e-05, 9.9998e-01],
        [9.9973e-01, 2.6816e-04],
        [1.3170e-01, 8.6830e-01],
        [4.4837e-04, 9.9955e-01],
        [1.5426e-01, 8.4574e-01],
        [1.6194e-02, 9.8381e-01],
        [1.4949e-04, 9.9985e-01],
        [9.9989e-01, 1.0568e-04],
        [1.0000e+00, 1.8604e-06],
        [9.9851e-01, 1.4883e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.9132e-01, 8.6769e-03],
        [9.9573e-01, 4.2699e-03],
        [7.8293e-02, 9.2171e-01],
        [3.5505e-01, 6.4495e-01],
        [7.8017e-01, 2.1983e-01],
        [1.5332e-03, 9.9847e-01],
        [3.1388e-01, 6.8612e-01],
        [5.3006e-01, 4.6994e-01],
        [6.0938e-04, 9.9939e-01],
        [9.9941e-01, 5.8596e-04],
        [9.9990e-01, 9.6816e-05],
        [9.9995e-01, 5.4684e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.4876, -3.2508],
        [ 1.7917, -3.6602],
        [-1.4192,  1.0466],
        [-1.1108, -0.5139],
        [-0.2837, -1.5504],
        [-3.9346,  2.5443],
        [-0.4854,  0.2966],
        [-0.6000, -0.7204],
        [-4.0047,  3.3977],
        [ 4.2958, -3.1458],
        [ 4.5986, -4.6440],
        [ 5.3489, -4.4650]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.8388e-01, 1.6115e-02],
        [9.9837e-01, 1.6268e-03],
        [8.9850e-02, 9.1015e-01],
        [4.8733e-01, 5.1267e-01],
        [3.0277e-03, 9.9697e-01],
        [1.5010e-03, 9.9850e-01],
        [5.6626e-01, 4.3374e-01],
        [2.2481e-01, 7.7519e-01],
        [3.4426e-04, 9.9966e-01],
        [9.9993e-01, 7.3190e-05],
        [9.9997e-01, 2.6600e-05],
        [9.9999e-01, 1.1759e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 155, Epoch 2/3, Batch 75/80
temp: 0.8470, beta: 0.1000, 
nri_train_loss: 1.6993, enc_train_loss: 6.2105, enc_train_entropy: 0.1756, dec_train_loss: 0.9377, enc_train_edge_accuracy: 0.5167

Edge pred tensor([[7.7979e-01, 2.2021e-01],
        [8.0843e-01, 1.9157e-01],
        [4.3213e-03, 9.9568e-01],
        [4.2488e-01, 5.7512e-01],
        [3.5871e-01, 6.4129e-01],
        [7.1116e-04, 9.9929e-01],
        [5.3196e-01, 4.6804e-01],
        [6.4884e-01, 3.5116e-01],
        [4.8682e-04, 9.9951e-01],
        [9.9972e-01, 2.7903e-04],
        [9.9969e-01, 3.1231e-04],
        [9.9974e-01, 2.5979e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.1998, -1.0647],
        [ 0.2929, -1.1469],
        [-3.0366,  2.4032],
        [-0.3714, -0.0686],
        [ 0.2988,  0.8797],
        [-4.0946,  3.1533],
        [ 1.0498,  0.9217],
        [ 1.1785,  0.5645],
        [-2.7159,  4.9112],
        [ 4.7797, -3.4042],
        [ 3.7951, -4.2761],
        [ 5.0376, -3.2178]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.1729e-01, 8.2708e-02],
        [9.9882e-01, 1.1776e-03],
        [2.6679e-04, 9.9973e-01],
        [8.4461e-01, 1.5539e-01],
        [3.8783e-01, 6.1217e-01],
        [1.2154e-05, 9.9999e-01],
        [1.2757e-01, 8.7243e-01],
        [8.6949e-01, 1.3051e-01],
        [5.6693e-06, 9.9999e-01],
        [1.0000e+00, 4.6729e-06],
        [9.9933e-01, 6.6631e-04],
        [9.9939e-01, 6.0687e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[5.3850e-01, 4.6150e-01],
        [4.6466e-01, 5.3534e-01],
        [3.1438e-03, 9.9686e-01],
        [1.8022e-02, 9.8198e-01],
        [1.1938e-01, 8.8062e-01],
        [8.4410e-04, 9.9916e-01],
        [1.0859e-02, 9.8914e-01],
        [7.0127e-02, 9.2987e-01],
        [4.2833e-04, 9.9957e-01],
        [9.9059e-01, 9.4051e-03],
        [9.9905e-01, 9.5102e-04],
        [9.9963e-01, 3.7265e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.3334,  1.1790],
        [ 0.2788,  0.4204],
        [-2.4912,  3.2680],
        [-1.7363,  2.2617],
        [-1.2436,  0.7547],
        [-3.5991,  3.4773],
        [-2.2544,  2.2574],
        [-1.2512,  1.3335],
        [-3.9245,  3.8307],
        [ 1.8415, -2.8155],
        [ 3.4708, -3.4862],
        [ 3.9035, -3.9910]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.8543e-01, 2.1457e-01],
        [9.9748e-01, 2.5158e-03],
        [7.0732e-04, 9.9929e-01],
        [2.2279e-02, 9.7772e-01],
        [2.6245e-02, 9.7375e-01],
        [2.4578e-06, 1.0000e+00],
        [2.2769e-01, 7.7231e-01],
        [2.7322e-01, 7.2678e-01],
        [1.0555e-04, 9.9989e-01],
        [9.9941e-01, 5.8695e-04],
        [9.9991e-01, 8.7626e-05],
        [9.9950e-01, 5.0126e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.3842e-01, 8.6158e-01],
        [1.5671e-01, 8.4329e-01],
        [3.0248e-03, 9.9698e-01],
        [6.0365e-02, 9.3963e-01],
        [1.5317e-02, 9.8468e-01],
        [2.2352e-04, 9.9978e-01],
        [8.4073e-03, 9.9159e-01],
        [3.4023e-03, 9.9660e-01],
        [9.2980e-05, 9.9991e-01],
        [9.9914e-01, 8.5824e-04],
        [9.9688e-01, 3.1181e-03],
        [9.9753e-01, 2.4710e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.7639,  1.0646],
        [-0.7996,  0.8832],
        [-2.8414,  2.9565],
        [-0.4546,  2.2905],
        [-1.2010,  2.9623],
        [-3.5962,  4.8096],
        [-2.1598,  2.6104],
        [-2.7563,  2.9235],
        [-4.5203,  4.7627],
        [ 3.2103, -3.8495],
        [ 2.2653, -3.5021],
        [ 2.2803, -3.7204]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.1583e-01, 1.8417e-01],
        [4.7314e-02, 9.5269e-01],
        [6.3645e-04, 9.9936e-01],
        [6.0958e-02, 9.3904e-01],
        [9.8845e-02, 9.0116e-01],
        [7.3029e-05, 9.9993e-01],
        [2.2118e-03, 9.9779e-01],
        [1.7639e-02, 9.8236e-01],
        [1.0052e-05, 9.9999e-01],
        [9.9975e-01, 2.5493e-04],
        [9.9794e-01, 2.0567e-03],
        [9.9971e-01, 2.9130e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.4952e-02, 9.6505e-01],
        [6.0146e-01, 3.9854e-01],
        [3.0506e-04, 9.9969e-01],
        [9.9515e-01, 4.8493e-03],
        [9.9835e-01, 1.6532e-03],
        [6.1826e-02, 9.3817e-01],
        [7.5350e-01, 2.4650e-01],
        [2.5516e-01, 7.4484e-01],
        [2.0484e-03, 9.9795e-01],
        [9.9915e-01, 8.5172e-04],
        [9.9207e-01, 7.9350e-03],
        [9.9963e-01, 3.7424e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.8462,  2.4720],
        [ 0.7651,  0.3536],
        [-3.7976,  4.2971],
        [ 2.9021, -2.4220],
        [ 4.3189, -2.0846],
        [ 0.1815,  2.9011],
        [-0.0067, -1.1241],
        [ 0.2187,  1.2900],
        [-2.7238,  3.4648],
        [ 3.8843, -3.1832],
        [ 4.4590, -0.3695],
        [ 5.2696, -2.6207]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.4785e-02, 9.6521e-01],
        [9.9511e-01, 4.8898e-03],
        [2.7652e-05, 9.9997e-01],
        [9.9531e-01, 4.6881e-03],
        [9.9886e-01, 1.1441e-03],
        [1.4095e-02, 9.8590e-01],
        [9.9691e-01, 3.0926e-03],
        [6.1179e-02, 9.3882e-01],
        [2.3802e-04, 9.9976e-01],
        [9.9984e-01, 1.5670e-04],
        [9.9316e-01, 6.8377e-03],
        [9.9998e-01, 1.5586e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.4866e-01, 5.1337e-02],
        [9.8997e-01, 1.0034e-02],
        [8.5551e-03, 9.9144e-01],
        [5.5014e-02, 9.4499e-01],
        [7.4140e-01, 2.5860e-01],
        [6.9945e-04, 9.9930e-01],
        [6.3760e-02, 9.3624e-01],
        [2.3312e-01, 7.6688e-01],
        [7.1982e-04, 9.9928e-01],
        [9.9964e-01, 3.6416e-04],
        [9.9994e-01, 6.4028e-05],
        [9.9997e-01, 2.9585e-05]], device='cuda:0')
logits tensor([[ 1.8477, -1.0689],
        [ 2.4178, -2.1739],
        [-2.2033,  2.5493],
        [-0.6378,  2.2057],
        [ 0.5672, -0.4861],
        [-3.2722,  3.9923],
        [-0.8155,  1.8713],
        [-0.1931,  0.9976],
        [-3.3193,  3.9165],
        [ 5.0897, -2.8279],
        [ 6.2040, -3.4522],
        [ 5.7271, -4.7011]], device='cuda:0')
Edge matrix from gumble tensor([[9.9203e-01, 7.9700e-03],
        [9.9252e-01, 7.4817e-03],
        [3.9411e-03, 9.9606e-01],
        [2.0827e-02, 9.7917e-01],
        [4.8340e-01, 5.1660e-01],
        [3.1559e-04, 9.9968e-01],
        [5.0227e-01, 4.9773e-01],
        [3.3314e-01, 6.6686e-01],
        [1.2210e-04, 9.9988e-01],
        [9.9978e-01, 2.2176e-04],
        [9.9998e-01, 1.7611e-05],
        [1.0000e+00, 1.7941e-06]], device='cuda:0')
Edge pred tensor([[3.3354e-01, 6.6646e-01],
        [5.7489e-01, 4.2511e-01],
        [1.6169e-02, 9.8383e-01],
        [7.3687e-03, 9.9263e-01],
        [3.5312e-02, 9.6469e-01],
        [1.6113e-03, 9.9839e-01],
        [9.3908e-03, 9.9061e-01],
        [9.6661e-03, 9.9033e-01],
        [1.3691e-03, 9.9863e-01],
        [9.9851e-01, 1.4913e-03],
        [9.9898e-01, 1.0187e-03],
        [9.9956e-01, 4.4496e-04]], device='cuda:0')
logits tensor([[ 1.2502,  1.9424],
        [ 1.3059,  1.0041],
        [-1.5480,  2.5604],
        [-0.9589,  3.9442],
        [-1.1558,  2.1518],
        [-3.5801,  2.8490],
        [-0.8361,  3.8225],
        [-1.7984,  2.8310],
        [-3.1395,  3.4527],
        [ 3.8194, -2.6872],
        [ 2.8249, -4.0633],
        [ 3.3131, -4.4040]], device='cuda:0')
Edge matrix from gumble tensor([[1.5011e-02, 9.8499e-01],
        [5.1476e-01, 4.8524e-01],
        [1.7876e-03, 9.9821e-01],
        [2.9540e-03, 9.9705e-01],
        [4.1536e-02, 9.5846e-01],
        [8.9500e-03, 9.9105e-01],
        [3.2380e-03, 9.9676e-01],
        [2.0111e-03, 9.9799e-01],
        [9.0789e-05, 9.9991e-01],
        [9.9986e-01, 1.3839e-04],
        [9.9978e-01, 2.1924e-04],
        [9.9988e-01, 1.2065e-04]], device='cuda:0')
Edge pred tensor([[9.5578e-01, 4.4216e-02],
        [9.8568e-01, 1.4316e-02],
        [1.6666e-02, 9.8333e-01],
        [8.0512e-02, 9.1949e-01],
        [6.0553e-01, 3.9447e-01],
        [1.1538e-03, 9.9885e-01],
        [3.3376e-01, 6.6624e-01],
        [5.5861e-01, 4.4139e-01],
        [1.8551e-03, 9.9814e-01],
        [9.9941e-01, 5.9065e-04],
        [9.9987e-01, 1.3337e-04],
        [9.9995e-01, 4.9091e-05]], device='cuda:0')
logits tensor([[ 0.9167, -2.1568],
        [ 1.4769, -2.7550],
        [-2.0942,  1.9833],
        [-1.0082,  1.4273],
        [-0.1486, -0.5772],
        [-3.5934,  3.1702],
        [-0.0196,  0.6716],
        [-0.5773, -0.8128],
        [-3.2453,  3.0427],
        [ 4.8037, -2.6300],
        [ 4.7950, -4.1272],
        [ 5.8251, -4.0967]], device='cuda:0')
Edge matrix from gumble tensor([[8.8393e-01, 1.1607e-01],
        [9.9774e-01, 2.2568e-03],
        [1.3873e-04, 9.9986e-01],
        [1.3312e-01, 8.6688e-01],
        [5.8761e-01, 4.1239e-01],
        [1.0841e-03, 9.9892e-01],
        [8.4581e-02, 9.1542e-01],
        [1.5770e-01, 8.4230e-01],
        [2.5292e-03, 9.9747e-01],
        [9.9973e-01, 2.7397e-04],
        [1.0000e+00, 4.4841e-06],
        [1.0000e+00, 4.4216e-07]], device='cuda:0')
Edge pred tensor([[9.4807e-01, 5.1926e-02],
        [9.0181e-01, 9.8188e-02],
        [2.6927e-02, 9.7307e-01],
        [2.2105e-03, 9.9779e-01],
        [1.5205e-02, 9.8479e-01],
        [1.7482e-04, 9.9983e-01],
        [3.4101e-02, 9.6590e-01],
        [1.8285e-01, 8.1715e-01],
        [1.3579e-03, 9.9864e-01],
        [9.9888e-01, 1.1205e-03],
        [9.9982e-01, 1.7902e-04],
        [9.9983e-01, 1.7187e-04]], device='cuda:0')
logits tensor([[ 2.6144, -0.2902],
        [ 2.0501, -0.1675],
        [-1.4727,  2.1146],
        [-2.4780,  3.6343],
        [-1.3550,  2.8158],
        [-4.2168,  4.4347],
        [-1.4677,  1.8760],
        [-0.1129,  1.3842],
        [-3.0133,  3.5871],
        [ 3.7195, -3.0734],
        [ 5.1434, -3.4844],
        [ 5.3937, -3.2749]], device='cuda:0')
Edge matrix from gumble tensor([[9.9394e-01, 6.0595e-03],
        [7.4787e-01, 2.5213e-01],
        [1.7320e-03, 9.9827e-01],
        [3.9597e-05, 9.9996e-01],
        [4.4550e-04, 9.9955e-01],
        [1.6503e-04, 9.9983e-01],
        [2.4077e-02, 9.7592e-01],
        [2.1281e-01, 7.8719e-01],
        [1.1742e-03, 9.9883e-01],
        [9.9797e-01, 2.0305e-03],
        [1.0000e+00, 7.6087e-07],
        [9.9996e-01, 3.5653e-05]], device='cuda:0')
Edge pred tensor([[9.0496e-02, 9.0950e-01],
        [2.7114e-01, 7.2886e-01],
        [2.3122e-03, 9.9769e-01],
        [3.4982e-01, 6.5018e-01],
        [1.7018e-01, 8.2982e-01],
        [3.1243e-03, 9.9688e-01],
        [1.8334e-01, 8.1666e-01],
        [3.4756e-02, 9.6524e-01],
        [3.9871e-04, 9.9960e-01],
        [9.9956e-01, 4.4255e-04],
        [9.9483e-01, 5.1663e-03],
        [9.9688e-01, 3.1223e-03]], device='cuda:0')
logits tensor([[-1.3646,  0.9430],
        [-0.1606,  0.8283],
        [-3.2557,  2.8116],
        [-0.2121,  0.4077],
        [ 0.1778,  1.7622],
        [-2.6224,  3.1430],
        [ 0.0358,  1.5297],
        [-0.2960,  3.0280],
        [-2.5811,  5.2458],
        [ 3.5236, -4.1989],
        [ 1.9724, -3.2880],
        [ 2.5497, -3.2164]], device='cuda:0')
Edge matrix from gumble tensor([[1.8250e-02, 9.8175e-01],
        [1.3975e-01, 8.6025e-01],
        [9.3114e-06, 9.9999e-01],
        [5.8474e-02, 9.4153e-01],
        [1.5256e-01, 8.4744e-01],
        [1.7450e-03, 9.9826e-01],
        [3.3496e-01, 6.6504e-01],
        [7.6145e-01, 2.3855e-01],
        [3.9823e-05, 9.9996e-01],
        [9.9990e-01, 9.9713e-05],
        [9.9810e-01, 1.8966e-03],
        [9.9246e-01, 7.5441e-03]], device='cuda:0')
Edge pred tensor([[9.8340e-01, 1.6596e-02],
        [9.9248e-01, 7.5168e-03],
        [1.1972e-01, 8.8028e-01],
        [3.4618e-01, 6.5382e-01],
        [3.4713e-01, 6.5287e-01],
        [1.1476e-03, 9.9885e-01],
        [4.6321e-01, 5.3679e-01],
        [7.8065e-01, 2.1935e-01],
        [1.1674e-03, 9.9883e-01],
        [9.9959e-01, 4.0590e-04],
        [9.9963e-01, 3.7484e-04],
        [9.9975e-01, 2.4948e-04]], device='cuda:0')
logits tensor([[ 2.8002, -1.2816],
        [ 3.2511, -1.6319],
        [-0.9242,  1.0709],
        [-0.7915, -0.1556],
        [-0.3221,  0.3096],
        [-4.3224,  2.4465],
        [-0.7896, -0.6422],
        [ 0.7809, -0.4885],
        [-3.8526,  2.8993],
        [ 3.9475, -3.8615],
        [ 4.9435, -2.9451],
        [ 5.1056, -3.1903]], device='cuda:0')
Edge matrix from gumble tensor([[9.9811e-01, 1.8945e-03],
        [9.8461e-01, 1.5387e-02],
        [1.5841e-03, 9.9842e-01],
        [2.0802e-02, 9.7920e-01],
        [4.4361e-01, 5.5639e-01],
        [4.8281e-05, 9.9995e-01],
        [7.2973e-02, 9.2703e-01],
        [6.0110e-01, 3.9890e-01],
        [3.7664e-04, 9.9962e-01],
        [9.9991e-01, 9.0389e-05],
        [9.9984e-01, 1.6136e-04],
        [9.9698e-01, 3.0165e-03]], device='cuda:0')
Edge pred tensor([[7.8840e-02, 9.2116e-01],
        [3.1618e-01, 6.8382e-01],
        [5.7197e-04, 9.9943e-01],
        [8.4029e-01, 1.5971e-01],
        [9.4279e-01, 5.7207e-02],
        [6.2796e-03, 9.9372e-01],
        [2.4590e-01, 7.5410e-01],
        [3.8917e-01, 6.1083e-01],
        [8.7442e-04, 9.9913e-01],
        [9.9942e-01, 5.7832e-04],
        [9.9944e-01, 5.5944e-04],
        [9.9983e-01, 1.7413e-04]], device='cuda:0')
logits tensor([[-0.4310,  2.0272],
        [-0.3697,  0.4017],
        [-3.7488,  3.7170],
        [ 0.0657, -1.5946],
        [ 1.3579, -1.4442],
        [-3.1190,  1.9452],
        [-1.8945, -0.7738],
        [-0.0184,  0.4324],
        [-4.6302,  2.4109],
        [ 3.9228, -3.5320],
        [ 5.8912, -1.5969],
        [ 5.4614, -3.1941]], device='cuda:0')
Edge matrix from gumble tensor([[1.0457e-01, 8.9543e-01],
        [1.6153e-01, 8.3847e-01],
        [1.0086e-05, 9.9999e-01],
        [9.4460e-01, 5.5398e-02],
        [9.9492e-01, 5.0839e-03],
        [1.9793e-03, 9.9802e-01],
        [3.9885e-02, 9.6011e-01],
        [3.2170e-01, 6.7830e-01],
        [1.0578e-03, 9.9894e-01],
        [9.9993e-01, 6.7567e-05],
        [9.9986e-01, 1.4424e-04],
        [9.9966e-01, 3.3842e-04]], device='cuda:0')
Edge pred tensor([[6.9457e-01, 3.0543e-01],
        [8.4566e-01, 1.5434e-01],
        [3.3806e-03, 9.9662e-01],
        [1.9106e-01, 8.0894e-01],
        [7.1035e-01, 2.8965e-01],
        [2.2786e-03, 9.9772e-01],
        [5.1333e-01, 4.8667e-01],
        [7.5284e-01, 2.4716e-01],
        [5.1364e-03, 9.9486e-01],
        [9.9971e-01, 2.8578e-04],
        [9.9988e-01, 1.2055e-04],
        [9.9992e-01, 8.0041e-05]], device='cuda:0')
logits tensor([[ 0.6433, -0.1782],
        [ 0.6797, -1.0213],
        [-2.5217,  3.1646],
        [-0.0191,  1.4241],
        [ 0.7634, -0.1337],
        [-2.4586,  3.6233],
        [ 0.4776,  0.4242],
        [ 0.7063, -0.4075],
        [-2.0753,  3.1909],
        [ 5.3777, -2.7823],
        [ 5.5353, -3.4880],
        [ 5.9442, -3.4887]], device='cuda:0')
Edge matrix from gumble tensor([[8.5683e-02, 9.1432e-01],
        [2.4719e-01, 7.5281e-01],
        [3.8904e-02, 9.6110e-01],
        [5.0649e-02, 9.4935e-01],
        [4.1782e-01, 5.8218e-01],
        [4.0102e-04, 9.9960e-01],
        [7.2649e-01, 2.7351e-01],
        [9.4631e-01, 5.3688e-02],
        [4.0156e-04, 9.9960e-01],
        [9.9887e-01, 1.1310e-03],
        [9.9984e-01, 1.6227e-04],
        [1.0000e+00, 7.4067e-07]], device='cuda:0')
Edge pred tensor([[4.3016e-01, 5.6984e-01],
        [6.3685e-01, 3.6315e-01],
        [1.4154e-03, 9.9858e-01],
        [9.7406e-01, 2.5943e-02],
        [9.9233e-01, 7.6689e-03],
        [5.6961e-02, 9.4304e-01],
        [8.8332e-01, 1.1668e-01],
        [9.1488e-01, 8.5117e-02],
        [9.1939e-03, 9.9081e-01],
        [9.9887e-01, 1.1347e-03],
        [9.9834e-01, 1.6631e-03],
        [9.9953e-01, 4.6959e-04]], device='cuda:0')
logits tensor([[ 0.5889,  0.8701],
        [ 0.1398, -0.4219],
        [-3.0286,  3.5303],
        [ 2.5218, -1.1037],
        [ 2.7898, -2.0731],
        [-0.3522,  2.4546],
        [ 1.5471, -0.4772],
        [ 2.0764, -0.2983],
        [-1.2854,  3.3946],
        [ 3.9750, -2.8053],
        [ 4.2638, -2.1336],
        [ 4.1299, -3.5333]], device='cuda:0')
Edge matrix from gumble tensor([[6.0518e-01, 3.9482e-01],
        [4.6938e-01, 5.3062e-01],
        [2.8836e-06, 1.0000e+00],
        [9.9638e-01, 3.6175e-03],
        [9.9971e-01, 2.9345e-04],
        [7.6803e-02, 9.2320e-01],
        [9.9912e-01, 8.8199e-04],
        [6.8505e-01, 3.1495e-01],
        [3.5478e-01, 6.4522e-01],
        [9.9154e-01, 8.4634e-03],
        [9.9950e-01, 4.9893e-04],
        [9.9941e-01, 5.8544e-04]], device='cuda:0')
Edge pred tensor([[8.7057e-01, 1.2943e-01],
        [8.6090e-01, 1.3910e-01],
        [1.9356e-02, 9.8064e-01],
        [7.7928e-01, 2.2072e-01],
        [6.7459e-01, 3.2541e-01],
        [7.9278e-03, 9.9207e-01],
        [9.4487e-01, 5.5134e-02],
        [8.8473e-01, 1.1527e-01],
        [2.9573e-02, 9.7043e-01],
        [9.9981e-01, 1.8966e-04],
        [9.9918e-01, 8.2484e-04],
        [9.9838e-01, 1.6150e-03]], device='cuda:0')
logits tensor([[ 0.3919, -1.5141],
        [ 0.9213, -0.9015],
        [-1.3298,  2.5954],
        [ 0.8477, -0.4138],
        [ 1.0533,  0.3243],
        [-1.6225,  3.2069],
        [ 0.8034, -2.0379],
        [-0.0759, -2.1139],
        [-1.5907,  1.9002],
        [ 4.4208, -4.1493],
        [ 2.7108, -4.3886],
        [ 3.3349, -3.0919]], device='cuda:0')
Edge matrix from gumble tensor([[8.2736e-01, 1.7264e-01],
        [1.7614e-01, 8.2386e-01],
        [3.1696e-03, 9.9683e-01],
        [3.1865e-02, 9.6814e-01],
        [3.2938e-01, 6.7062e-01],
        [1.1196e-02, 9.8880e-01],
        [4.9781e-01, 5.0219e-01],
        [5.3874e-01, 4.6126e-01],
        [1.4987e-03, 9.9850e-01],
        [1.0000e+00, 1.2634e-07],
        [9.9924e-01, 7.5826e-04],
        [9.9995e-01, 5.3325e-05]], device='cuda:0')

Epoch 2/3 completed, Global Step: 160
nri_train_loss: 1.6993, enc_train_loss: 6.2105, enc_train_entropy: 0.1756, dec_train_loss: 0.9377, enc_train_edge_accuracy: 0.5167
nri_val_loss: 1.5039, enc_val_loss: 5.9811, enc_val_entropy: 0.1947, dec_val_loss: 0.7500, enc_val_edge_accuracy: 0.5043

---------------------------------------------------------------------------

Edge pred tensor([[6.4372e-01, 3.5628e-01],
        [9.8592e-01, 1.4081e-02],
        [7.6294e-03, 9.9237e-01],
        [2.5250e-01, 7.4750e-01],
        [9.4145e-01, 5.8550e-02],
        [4.1994e-03, 9.9580e-01],
        [3.0688e-02, 9.6931e-01],
        [6.5562e-02, 9.3444e-01],
        [6.9808e-04, 9.9930e-01],
        [9.9966e-01, 3.3993e-04],
        [9.9987e-01, 1.2694e-04],
        [9.9998e-01, 2.1603e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.0586, -0.5330],
        [ 1.2098, -3.0390],
        [-2.2770,  2.5911],
        [-0.0439,  1.0415],
        [ 0.8293, -1.9483],
        [-2.5648,  2.9039],
        [-1.6126,  1.8401],
        [-1.4539,  1.2031],
        [-3.2647,  4.0017],
        [ 4.8563, -3.1301],
        [ 5.7641, -3.2076],
        [ 5.8751, -4.8676]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.9362e-01, 2.0638e-01],
        [9.9278e-01, 7.2213e-03],
        [4.1863e-04, 9.9958e-01],
        [5.5789e-01, 4.4211e-01],
        [9.6764e-01, 3.2356e-02],
        [1.9085e-02, 9.8091e-01],
        [3.3739e-02, 9.6626e-01],
        [9.4686e-02, 9.0531e-01],
        [4.4264e-06, 1.0000e+00],
        [9.9998e-01, 1.6334e-05],
        [9.9996e-01, 4.4523e-05],
        [1.0000e+00, 2.7558e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 160, Epoch 3/3, Batch 0/80
temp: 0.8344, beta: 0.1000, 
nri_train_loss: 1.6442, enc_train_loss: 6.0280, enc_train_entropy: 0.1908, dec_train_loss: 0.8888, enc_train_edge_accuracy: 0.5167

Edge pred tensor([[1.1540e-01, 8.8460e-01],
        [2.9640e-01, 7.0360e-01],
        [4.6378e-03, 9.9536e-01],
        [1.1907e-02, 9.8809e-01],
        [1.9314e-01, 8.0686e-01],
        [1.9180e-03, 9.9808e-01],
        [2.2674e-03, 9.9773e-01],
        [5.2810e-03, 9.9472e-01],
        [7.4785e-04, 9.9925e-01],
        [9.9153e-01, 8.4731e-03],
        [9.9882e-01, 1.1795e-03],
        [9.9934e-01, 6.5612e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.6311,  2.6679],
        [ 0.0125,  0.8770],
        [-2.4479,  2.9210],
        [-0.6080,  3.8106],
        [-0.4198,  1.0099],
        [-2.5366,  3.7180],
        [-2.5204,  3.5665],
        [-2.0348,  3.2036],
        [-3.8139,  3.3836],
        [ 2.3963, -2.3661],
        [ 3.8421, -2.8993],
        [ 3.1962, -4.1323]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.9902e-01, 6.0098e-01],
        [2.4473e-01, 7.5527e-01],
        [1.8168e-04, 9.9982e-01],
        [6.1898e-03, 9.9381e-01],
        [2.0470e-01, 7.9530e-01],
        [1.0086e-03, 9.9899e-01],
        [5.9208e-04, 9.9941e-01],
        [4.2115e-04, 9.9958e-01],
        [1.0744e-03, 9.9893e-01],
        [4.9466e-01, 5.0534e-01],
        [9.4663e-01, 5.3372e-02],
        [9.9976e-01, 2.4414e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.1823, 0.8177],
        [0.3250, 0.6750],
        [0.0381, 0.9619],
        [0.6708, 0.3292],
        [0.2502, 0.7498],
        [0.0082, 0.9918],
        [0.1300, 0.8700],
        [0.0217, 0.9783],
        [0.0026, 0.9974],
        [0.9984, 0.0016],
        [0.9922, 0.0078],
        [0.9955, 0.0045]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.0315,  0.4695],
        [-0.4725,  0.2584],
        [-1.9058,  1.3239],
        [-0.5226, -1.2342],
        [ 0.1221,  1.2197],
        [-1.9664,  2.8339],
        [-1.1144,  0.7864],
        [-1.1590,  2.6489],
        [-2.1155,  3.8263],
        [ 1.8386, -4.5904],
        [ 1.8406, -3.0021],
        [ 2.2783, -3.1151]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.7621e-01, 5.2379e-01],
        [8.7736e-01, 1.2264e-01],
        [2.6008e-01, 7.3992e-01],
        [3.0498e-01, 6.9502e-01],
        [5.9236e-02, 9.4076e-01],
        [3.2705e-03, 9.9673e-01],
        [2.8120e-02, 9.7188e-01],
        [7.5124e-04, 9.9925e-01],
        [4.1981e-05, 9.9996e-01],
        [9.9948e-01, 5.2002e-04],
        [9.3733e-01, 6.2667e-02],
        [9.9747e-01, 2.5255e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.2665e-02, 9.8733e-01],
        [6.3234e-03, 9.9368e-01],
        [6.7400e-04, 9.9933e-01],
        [7.0918e-01, 2.9082e-01],
        [3.8305e-01, 6.1695e-01],
        [9.5714e-03, 9.9043e-01],
        [3.8588e-02, 9.6141e-01],
        [9.6185e-03, 9.9038e-01],
        [5.3808e-04, 9.9946e-01],
        [9.9863e-01, 1.3734e-03],
        [9.9127e-01, 8.7320e-03],
        [9.9307e-01, 6.9331e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.3803,  3.9759],
        [-1.9156,  3.1415],
        [-2.7975,  4.5041],
        [ 3.0560,  2.1645],
        [ 1.2423,  1.7189],
        [-0.4728,  4.1666],
        [-0.5237,  2.6918],
        [-0.6529,  3.9815],
        [-3.1247,  4.4022],
        [ 3.7505, -2.8386],
        [ 3.5878, -1.1442],
        [ 2.4324, -2.5321]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.9702e-03, 9.9803e-01],
        [9.6558e-04, 9.9903e-01],
        [1.5650e-05, 9.9998e-01],
        [6.8123e-01, 3.1877e-01],
        [1.7591e-01, 8.2409e-01],
        [1.0181e-02, 9.8982e-01],
        [1.4234e-02, 9.8577e-01],
        [7.3109e-03, 9.9269e-01],
        [1.9834e-04, 9.9980e-01],
        [9.9875e-01, 1.2463e-03],
        [9.5135e-01, 4.8649e-02],
        [9.8390e-01, 1.6104e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[7.4161e-01, 2.5839e-01],
        [8.7133e-01, 1.2867e-01],
        [3.2811e-03, 9.9672e-01],
        [9.8514e-01, 1.4857e-02],
        [9.8695e-01, 1.3051e-02],
        [1.9709e-02, 9.8029e-01],
        [4.5354e-01, 5.4646e-01],
        [2.0424e-01, 7.9576e-01],
        [2.7663e-04, 9.9972e-01],
        [9.9979e-01, 2.0709e-04],
        [9.9906e-01, 9.3663e-04],
        [9.9962e-01, 3.7587e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.3033, -0.7510],
        [ 0.3988, -1.5140],
        [-3.3831,  2.3331],
        [ 2.4240, -1.7703],
        [ 2.9122, -1.4136],
        [-1.0141,  2.8927],
        [ 0.3594,  0.5458],
        [ 0.1893,  1.5493],
        [-2.9842,  5.2083],
        [ 4.3866, -4.0955],
        [ 3.7306, -3.2417],
        [ 3.9854, -3.9005]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[6.7611e-01, 3.2389e-01],
        [9.4288e-01, 5.7125e-02],
        [1.0798e-05, 9.9999e-01],
        [4.2301e-01, 5.7699e-01],
        [9.9042e-01, 9.5830e-03],
        [8.0772e-02, 9.1923e-01],
        [2.7792e-02, 9.7221e-01],
        [1.9096e-01, 8.0904e-01],
        [9.8172e-05, 9.9990e-01],
        [9.9999e-01, 6.8644e-06],
        [9.9988e-01, 1.2273e-04],
        [9.9967e-01, 3.3362e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.3252e-01, 7.6748e-01],
        [7.5077e-01, 2.4923e-01],
        [1.7076e-02, 9.8292e-01],
        [2.9409e-02, 9.7059e-01],
        [1.1491e-01, 8.8509e-01],
        [1.2570e-03, 9.9874e-01],
        [1.1422e-02, 9.8858e-01],
        [1.6814e-02, 9.8319e-01],
        [9.4573e-04, 9.9905e-01],
        [9.9390e-01, 6.1034e-03],
        [9.9718e-01, 2.8173e-03],
        [9.9945e-01, 5.5470e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.4887,  0.7055],
        [ 0.5335, -0.5693],
        [-1.6182,  2.4347],
        [-2.0467,  1.4499],
        [-1.7555,  0.2861],
        [-3.6451,  3.0326],
        [-2.5888,  1.8719],
        [-2.2313,  1.8373],
        [-3.3184,  3.6442],
        [ 2.5603, -2.5325],
        [ 3.2774, -2.5917],
        [ 3.4174, -4.0791]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.0043e-02, 9.0996e-01],
        [3.1846e-01, 6.8154e-01],
        [3.3532e-03, 9.9665e-01],
        [5.7724e-02, 9.4228e-01],
        [1.9964e-01, 8.0036e-01],
        [3.7971e-05, 9.9996e-01],
        [4.2088e-01, 5.7912e-01],
        [2.7236e-01, 7.2764e-01],
        [1.4243e-03, 9.9858e-01],
        [9.6574e-01, 3.4261e-02],
        [9.9697e-01, 3.0316e-03],
        [9.9859e-01, 1.4060e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 165, Epoch 3/3, Batch 5/80
temp: 0.8302, beta: 0.1000, 
nri_train_loss: 1.5848, enc_train_loss: 5.9823, enc_train_entropy: 0.1946, dec_train_loss: 0.8308, enc_train_edge_accuracy: 0.5133

Edge pred tensor([[1.8861e-01, 8.1139e-01],
        [9.8602e-02, 9.0140e-01],
        [1.6444e-03, 9.9836e-01],
        [2.7722e-01, 7.2278e-01],
        [2.4873e-02, 9.7513e-01],
        [4.1953e-04, 9.9958e-01],
        [7.9204e-01, 2.0796e-01],
        [6.5163e-01, 3.4837e-01],
        [2.9682e-03, 9.9703e-01],
        [9.9980e-01, 1.9614e-04],
        [9.9929e-01, 7.0855e-04],
        [9.9831e-01, 1.6877e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.9208,  0.5382],
        [-0.8978,  1.3151],
        [-3.1256,  3.2831],
        [-0.1583,  0.8000],
        [-0.7061,  2.9627],
        [-4.1510,  3.6250],
        [ 2.2825,  0.9452],
        [ 1.6758,  1.0496],
        [-1.3364,  4.4805],
        [ 4.8964, -3.6401],
        [ 3.5541, -3.6975],
        [ 4.3848, -1.9979]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.3097e-01, 2.6903e-01],
        [3.9769e-02, 9.6023e-01],
        [2.9797e-04, 9.9970e-01],
        [9.1686e-02, 9.0831e-01],
        [1.0798e-01, 8.9202e-01],
        [6.8419e-04, 9.9932e-01],
        [5.1693e-01, 4.8307e-01],
        [9.0827e-01, 9.1725e-02],
        [2.1180e-03, 9.9788e-01],
        [9.9722e-01, 2.7777e-03],
        [9.9998e-01, 1.5063e-05],
        [9.9921e-01, 7.9346e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.5979e-01, 7.4021e-01],
        [8.3013e-01, 1.6987e-01],
        [9.6800e-03, 9.9032e-01],
        [1.9207e-02, 9.8079e-01],
        [1.9153e-01, 8.0847e-01],
        [1.1069e-03, 9.9889e-01],
        [2.4556e-03, 9.9754e-01],
        [2.1893e-03, 9.9781e-01],
        [1.3769e-04, 9.9986e-01],
        [9.9899e-01, 1.0133e-03],
        [9.9936e-01, 6.4314e-04],
        [9.9975e-01, 2.4608e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.0338,  2.0809],
        [ 1.8731,  0.2865],
        [-2.2561,  2.3718],
        [-1.2641,  2.6690],
        [-0.1590,  1.2811],
        [-3.5265,  3.2786],
        [-2.5660,  3.4409],
        [-1.6049,  4.5171],
        [-4.3876,  4.5028],
        [ 4.0025, -2.8910],
        [ 5.3447, -2.0038],
        [ 4.8963, -3.4133]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.9630e-01, 7.0370e-01],
        [9.4901e-01, 5.0986e-02],
        [5.6927e-03, 9.9431e-01],
        [1.9440e-03, 9.9806e-01],
        [5.1489e-01, 4.8511e-01],
        [1.3259e-05, 9.9999e-01],
        [4.4643e-04, 9.9955e-01],
        [8.5775e-05, 9.9991e-01],
        [5.2930e-07, 1.0000e+00],
        [9.9736e-01, 2.6410e-03],
        [9.9983e-01, 1.7077e-04],
        [9.9994e-01, 5.7781e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.9776e-01, 5.0224e-01],
        [7.2100e-01, 2.7900e-01],
        [1.5184e-02, 9.8482e-01],
        [1.5791e-02, 9.8421e-01],
        [6.7021e-02, 9.3298e-01],
        [6.4463e-04, 9.9936e-01],
        [3.8513e-03, 9.9615e-01],
        [5.2334e-03, 9.9477e-01],
        [2.4186e-04, 9.9976e-01],
        [9.9782e-01, 2.1766e-03],
        [9.9902e-01, 9.8233e-04],
        [9.9944e-01, 5.5596e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.7919,  1.8008],
        [ 1.6962,  0.7467],
        [-1.4820,  2.6902],
        [-1.0796,  3.0528],
        [-0.4522,  2.1812],
        [-3.1542,  4.1920],
        [-2.0552,  3.5003],
        [-1.2640,  3.9834],
        [-3.8330,  4.4939],
        [ 3.3291, -2.7987],
        [ 4.4798, -2.4448],
        [ 4.1970, -3.2972]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.5803e-02, 9.1420e-01],
        [3.7215e-01, 6.2785e-01],
        [3.0186e-03, 9.9698e-01],
        [1.9190e-03, 9.9808e-01],
        [7.2247e-01, 2.7753e-01],
        [2.5506e-05, 9.9997e-01],
        [6.7733e-05, 9.9993e-01],
        [3.6879e-03, 9.9631e-01],
        [9.8435e-05, 9.9990e-01],
        [9.9798e-01, 2.0176e-03],
        [9.9518e-01, 4.8183e-03],
        [9.9994e-01, 5.8543e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.5614e-02, 9.6439e-01],
        [1.0730e-01, 8.9270e-01],
        [4.3701e-04, 9.9956e-01],
        [5.5086e-02, 9.4491e-01],
        [7.6819e-02, 9.2318e-01],
        [5.2059e-04, 9.9948e-01],
        [2.5076e-01, 7.4924e-01],
        [2.6728e-01, 7.3272e-01],
        [1.6713e-03, 9.9833e-01],
        [9.9856e-01, 1.4388e-03],
        [9.9788e-01, 2.1168e-03],
        [9.9981e-01, 1.9256e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.4704,  1.8284],
        [-0.9119,  1.2068],
        [-4.1444,  3.5907],
        [-1.5742,  1.2680],
        [-1.1107,  1.3757],
        [-4.4973,  3.0627],
        [ 0.0759,  1.1705],
        [ 0.4154,  1.4239],
        [-2.8749,  3.5176],
        [ 3.4177, -3.1248],
        [ 3.5476, -2.6082],
        [ 5.0615, -3.4934]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.5907e-03, 9.9741e-01],
        [6.2144e-01, 3.7856e-01],
        [1.7722e-03, 9.9823e-01],
        [1.0774e-01, 8.9226e-01],
        [6.6849e-02, 9.3315e-01],
        [1.0060e-06, 1.0000e+00],
        [8.5185e-01, 1.4815e-01],
        [5.1566e-02, 9.4843e-01],
        [3.8538e-04, 9.9961e-01],
        [9.9988e-01, 1.2397e-04],
        [9.9463e-01, 5.3698e-03],
        [9.9918e-01, 8.2319e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.8092e-02, 9.8191e-01],
        [5.5722e-02, 9.4428e-01],
        [2.5246e-04, 9.9975e-01],
        [4.1376e-01, 5.8624e-01],
        [6.8017e-01, 3.1983e-01],
        [1.3453e-03, 9.9865e-01],
        [3.5430e-01, 6.4570e-01],
        [4.5870e-01, 5.4130e-01],
        [1.3455e-03, 9.9865e-01],
        [9.9720e-01, 2.7970e-03],
        [9.9789e-01, 2.1142e-03],
        [9.9889e-01, 1.1128e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.9514,  3.0427],
        [-1.3663,  1.4638],
        [-4.0643,  4.2197],
        [-0.5583, -0.2098],
        [ 0.3636, -0.3909],
        [-3.2104,  3.3994],
        [-0.8970, -0.2968],
        [ 0.9024,  1.0680],
        [-3.2666,  3.3431],
        [ 3.6413, -2.2351],
        [ 5.3598, -0.7971],
        [ 4.7777, -2.0220]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.5969e-04, 9.9984e-01],
        [1.4415e-02, 9.8558e-01],
        [1.9588e-05, 9.9998e-01],
        [1.8653e-01, 8.1347e-01],
        [9.8858e-01, 1.1423e-02],
        [2.6152e-05, 9.9997e-01],
        [4.3279e-01, 5.6721e-01],
        [8.6894e-01, 1.3106e-01],
        [3.6449e-03, 9.9636e-01],
        [9.9980e-01, 2.0167e-04],
        [9.9994e-01, 6.2352e-05],
        [9.9889e-01, 1.1099e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 170, Epoch 3/3, Batch 10/80
temp: 0.8261, beta: 0.1000, 
nri_train_loss: 1.5323, enc_train_loss: 5.8027, enc_train_entropy: 0.2096, dec_train_loss: 0.7844, enc_train_edge_accuracy: 0.5150

Edge pred tensor([[8.5195e-01, 1.4805e-01],
        [9.6610e-01, 3.3896e-02],
        [1.2850e-02, 9.8715e-01],
        [9.1472e-02, 9.0853e-01],
        [5.7660e-01, 4.2340e-01],
        [1.8267e-03, 9.9817e-01],
        [7.1208e-02, 9.2879e-01],
        [1.9306e-01, 8.0694e-01],
        [1.1482e-03, 9.9885e-01],
        [9.9904e-01, 9.5695e-04],
        [9.9969e-01, 3.1387e-04],
        [9.9989e-01, 1.1398e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.5306, -0.2194],
        [ 1.6611, -1.6889],
        [-1.8198,  2.5217],
        [-0.6614,  1.6344],
        [ 0.5665,  0.2577],
        [-2.0045,  4.2989],
        [-0.9399,  1.6284],
        [ 0.0580,  1.4882],
        [-2.6120,  4.1564],
        [ 4.1051, -2.8457],
        [ 5.2483, -2.8179],
        [ 5.0473, -4.0321]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.4031e-02, 9.0597e-01],
        [9.9935e-01, 6.4858e-04],
        [5.8831e-04, 9.9941e-01],
        [1.9482e-01, 8.0518e-01],
        [2.6357e-02, 9.7364e-01],
        [4.2641e-05, 9.9996e-01],
        [1.3807e-02, 9.8619e-01],
        [3.9063e-03, 9.9609e-01],
        [1.5754e-02, 9.8425e-01],
        [9.9986e-01, 1.4179e-04],
        [9.9988e-01, 1.2206e-04],
        [9.9999e-01, 1.0560e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[8.4258e-01, 1.5742e-01],
        [7.8161e-01, 2.1839e-01],
        [7.8696e-03, 9.9213e-01],
        [2.7449e-02, 9.7255e-01],
        [4.5071e-01, 5.4929e-01],
        [4.1533e-03, 9.9585e-01],
        [7.0210e-03, 9.9298e-01],
        [1.4349e-01, 8.5651e-01],
        [1.7044e-03, 9.9830e-01],
        [9.8360e-01, 1.6404e-02],
        [9.9947e-01, 5.2727e-04],
        [9.9984e-01, 1.6256e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.8755,  0.1979],
        [ 0.8878, -0.3873],
        [-2.5600,  2.2768],
        [-1.0237,  2.5439],
        [-0.2296, -0.0318],
        [-3.2496,  2.2301],
        [-2.2520,  2.6998],
        [-1.1124,  0.6742],
        [-3.7200,  2.6528],
        [ 1.6398, -2.4539],
        [ 3.3406, -4.2067],
        [ 3.3837, -5.3406]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9463e-01, 5.3674e-03],
        [8.7507e-01, 1.2493e-01],
        [3.3402e-01, 6.6598e-01],
        [5.3684e-02, 9.4632e-01],
        [9.0680e-01, 9.3196e-02],
        [4.7247e-03, 9.9528e-01],
        [7.9441e-03, 9.9206e-01],
        [2.1635e-01, 7.8365e-01],
        [5.3965e-05, 9.9995e-01],
        [9.8611e-01, 1.3887e-02],
        [9.9840e-01, 1.6013e-03],
        [9.9966e-01, 3.3950e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.8235e-01, 3.1765e-01],
        [5.6966e-01, 4.3034e-01],
        [2.9490e-03, 9.9705e-01],
        [9.2028e-01, 7.9719e-02],
        [9.1055e-01, 8.9454e-02],
        [1.9855e-02, 9.8014e-01],
        [9.1203e-01, 8.7966e-02],
        [9.3467e-01, 6.5332e-02],
        [5.9975e-03, 9.9400e-01],
        [9.9981e-01, 1.9445e-04],
        [9.9957e-01, 4.3079e-04],
        [9.9901e-01, 9.9461e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.1585, -0.6061],
        [ 0.4972,  0.2167],
        [-2.5980,  3.2253],
        [ 0.3014, -2.1448],
        [ 1.8165, -0.5039],
        [-1.2672,  2.6320],
        [ 0.9602, -1.3785],
        [ 1.8011, -0.8596],
        [-1.4386,  3.6718],
        [ 4.0907, -4.4544],
        [ 4.0002, -3.7492],
        [ 4.1956, -2.7166]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[6.1071e-01, 3.8929e-01],
        [6.8061e-01, 3.1939e-01],
        [2.8923e-04, 9.9971e-01],
        [9.7670e-01, 2.3302e-02],
        [9.7445e-01, 2.5548e-02],
        [9.3970e-03, 9.9060e-01],
        [9.4140e-01, 5.8599e-02],
        [9.5826e-01, 4.1743e-02],
        [1.3252e-03, 9.9867e-01],
        [1.0000e+00, 4.1084e-06],
        [9.9981e-01, 1.8896e-04],
        [9.9997e-01, 3.2053e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[9.2489e-01, 7.5108e-02],
        [9.1833e-01, 8.1673e-02],
        [5.7327e-02, 9.4267e-01],
        [2.6998e-01, 7.3002e-01],
        [3.0704e-01, 6.9296e-01],
        [5.8149e-03, 9.9419e-01],
        [1.2060e-01, 8.7940e-01],
        [4.0122e-01, 5.9878e-01],
        [3.8044e-03, 9.9620e-01],
        [9.9889e-01, 1.1070e-03],
        [9.9967e-01, 3.3183e-04],
        [9.9965e-01, 3.5164e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.0476, -2.4631],
        [ 1.3002, -1.1196],
        [-1.9523,  0.8477],
        [-0.8810,  0.1137],
        [-0.8260, -0.0121],
        [-3.6585,  1.4830],
        [-0.6490,  1.3378],
        [-0.4393, -0.0389],
        [-2.4833,  3.0845],
        [ 3.2021, -3.6029],
        [ 2.8790, -5.1316],
        [ 3.7502, -4.2023]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.0252e-01, 9.7478e-02],
        [6.7836e-01, 3.2164e-01],
        [2.2156e-03, 9.9778e-01],
        [3.6846e-02, 9.6315e-01],
        [1.9450e-01, 8.0550e-01],
        [6.7590e-03, 9.9324e-01],
        [4.2118e-02, 9.5788e-01],
        [6.7354e-01, 3.2646e-01],
        [3.9601e-03, 9.9604e-01],
        [9.9961e-01, 3.9385e-04],
        [9.9999e-01, 9.0111e-06],
        [9.9991e-01, 9.0638e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.1219e-01, 5.8781e-01],
        [5.5831e-01, 4.4169e-01],
        [2.5156e-03, 9.9748e-01],
        [5.6255e-01, 4.3745e-01],
        [6.7976e-01, 3.2024e-01],
        [4.1499e-03, 9.9585e-01],
        [8.3305e-02, 9.1670e-01],
        [1.8823e-01, 8.1177e-01],
        [8.3333e-04, 9.9917e-01],
        [9.9669e-01, 3.3134e-03],
        [9.9780e-01, 2.1975e-03],
        [9.9718e-01, 2.8206e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.4817, -0.1268],
        [ 0.3606,  0.1262],
        [-2.7408,  3.2419],
        [-0.5426, -0.7942],
        [ 0.5525, -0.2001],
        [-2.6436,  2.8370],
        [-2.3235,  0.0748],
        [-1.1860,  0.2756],
        [-3.5343,  3.5550],
        [ 2.3084, -3.3980],
        [ 3.4934, -2.6249],
        [ 3.5287, -2.3393]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.6957e-01, 2.3043e-01],
        [9.6571e-01, 3.4289e-02],
        [1.2368e-03, 9.9876e-01],
        [3.1237e-01, 6.8763e-01],
        [4.5552e-01, 5.4448e-01],
        [3.5382e-03, 9.9646e-01],
        [5.7588e-02, 9.4241e-01],
        [1.6791e-01, 8.3209e-01],
        [1.0638e-04, 9.9989e-01],
        [9.5844e-01, 4.1564e-02],
        [9.9996e-01, 3.9775e-05],
        [9.9945e-01, 5.4617e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 175, Epoch 3/3, Batch 15/80
temp: 0.8219, beta: 0.1000, 
nri_train_loss: 1.4780, enc_train_loss: 5.4504, enc_train_entropy: 0.2390, dec_train_loss: 0.7418, enc_train_edge_accuracy: 0.5150

Edge pred tensor([[9.5083e-01, 4.9166e-02],
        [9.1605e-01, 8.3952e-02],
        [9.9603e-02, 9.0040e-01],
        [5.1558e-01, 4.8442e-01],
        [7.7268e-01, 2.2732e-01],
        [3.9267e-02, 9.6073e-01],
        [1.7600e-01, 8.2400e-01],
        [4.9115e-01, 5.0885e-01],
        [1.2007e-02, 9.8799e-01],
        [9.9841e-01, 1.5858e-03],
        [9.9946e-01, 5.4199e-04],
        [9.9951e-01, 4.8676e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.2650, -2.6971],
        [ 1.2292, -1.1607],
        [-0.6603,  1.5413],
        [-0.8852, -0.9476],
        [ 0.3975, -0.8260],
        [-1.4078,  1.7895],
        [-1.9614, -0.4177],
        [-1.1941, -1.1587],
        [-1.9665,  2.4437],
        [ 2.3599, -4.0852],
        [ 3.0090, -4.5108],
        [ 4.4652, -3.1620]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.6681e-01, 2.3319e-01],
        [9.2503e-01, 7.4970e-02],
        [4.0554e-01, 5.9446e-01],
        [3.3557e-01, 6.6443e-01],
        [9.2116e-01, 7.8841e-02],
        [5.2432e-02, 9.4757e-01],
        [1.7265e-02, 9.8274e-01],
        [6.5121e-02, 9.3488e-01],
        [1.2485e-03, 9.9875e-01],
        [9.9980e-01, 2.0447e-04],
        [9.9973e-01, 2.6895e-04],
        [9.9989e-01, 1.1127e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[5.4079e-02, 9.4592e-01],
        [9.8951e-02, 9.0105e-01],
        [2.8951e-04, 9.9971e-01],
        [4.0602e-01, 5.9398e-01],
        [5.8605e-01, 4.1395e-01],
        [7.2633e-04, 9.9927e-01],
        [1.9254e-01, 8.0746e-01],
        [4.0884e-01, 5.9116e-01],
        [6.7069e-04, 9.9933e-01],
        [9.9595e-01, 4.0492e-03],
        [9.9675e-01, 3.2478e-03],
        [9.9615e-01, 3.8550e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.6253,  2.2364],
        [-1.0791,  1.1298],
        [-4.1399,  4.0071],
        [-1.0580, -0.6775],
        [ 0.3653,  0.0176],
        [-3.8035,  3.4233],
        [-1.5101, -0.0765],
        [ 0.6074,  0.9762],
        [-3.8129,  3.4936],
        [ 2.8941, -2.6111],
        [ 4.5592, -1.1673],
        [ 3.8895, -1.6651]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[6.6937e-01, 3.3063e-01],
        [4.4778e-03, 9.9552e-01],
        [1.8861e-04, 9.9981e-01],
        [6.4490e-01, 3.5510e-01],
        [5.8430e-01, 4.1570e-01],
        [8.1402e-06, 9.9999e-01],
        [4.5183e-01, 5.4817e-01],
        [7.4169e-01, 2.5831e-01],
        [8.3175e-04, 9.9917e-01],
        [9.9993e-01, 7.2534e-05],
        [9.9993e-01, 7.4168e-05],
        [9.9720e-01, 2.7993e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.1248e-02, 9.3875e-01],
        [1.0341e-01, 8.9659e-01],
        [5.7172e-04, 9.9943e-01],
        [5.9846e-02, 9.4015e-01],
        [3.3054e-01, 6.6946e-01],
        [1.1055e-03, 9.9889e-01],
        [3.6551e-01, 6.3449e-01],
        [6.7666e-01, 3.2334e-01],
        [4.9496e-03, 9.9505e-01],
        [9.9878e-01, 1.2219e-03],
        [9.9934e-01, 6.6195e-04],
        [9.9944e-01, 5.6278e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.5078,  2.2218],
        [-0.9256,  1.2342],
        [-3.3223,  4.1440],
        [-1.3559,  1.3984],
        [-0.1431,  0.5626],
        [-3.6054,  3.2009],
        [-0.4098,  0.1417],
        [ 0.7585,  0.0200],
        [-2.7292,  2.5742],
        [ 4.0559, -2.6502],
        [ 5.3202, -1.9994],
        [ 4.9400, -2.5421]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.9943e-03, 9.9801e-01],
        [3.6742e-02, 9.6326e-01],
        [1.0315e-04, 9.9990e-01],
        [1.0156e-02, 9.8984e-01],
        [2.2276e-02, 9.7772e-01],
        [1.0356e-04, 9.9990e-01],
        [1.0937e-03, 9.9891e-01],
        [2.2730e-01, 7.7270e-01],
        [8.0666e-05, 9.9992e-01],
        [9.9995e-01, 4.7371e-05],
        [9.9987e-01, 1.2755e-04],
        [9.9977e-01, 2.2630e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.0966, 0.9034],
        [0.3619, 0.6381],
        [0.0065, 0.9935],
        [0.9125, 0.0875],
        [0.9339, 0.0661],
        [0.0510, 0.9490],
        [0.2422, 0.7578],
        [0.4308, 0.5692],
        [0.0202, 0.9798],
        [0.9960, 0.0040],
        [0.9960, 0.0040],
        [0.9969, 0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.3723,  2.6075],
        [-0.8976, -0.3303],
        [-2.5134,  2.5150],
        [ 3.4129,  1.0687],
        [ 2.2870, -0.3605],
        [ 0.4896,  3.4133],
        [-0.5954,  0.5452],
        [ 1.4220,  1.7006],
        [-1.5639,  2.3155],
        [ 4.2955, -1.2242],
        [ 5.3856, -0.1382],
        [ 3.2126, -2.5486]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.1496e-01, 6.8504e-01],
        [3.6679e-01, 6.3321e-01],
        [1.1945e-03, 9.9881e-01],
        [9.8470e-01, 1.5296e-02],
        [8.9112e-01, 1.0888e-01],
        [4.4957e-02, 9.5504e-01],
        [3.9754e-01, 6.0246e-01],
        [2.2629e-01, 7.7371e-01],
        [1.2489e-03, 9.9875e-01],
        [9.9970e-01, 3.0361e-04],
        [9.9508e-01, 4.9186e-03],
        [9.9995e-01, 5.4122e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.3496e-02, 9.5650e-01],
        [1.2974e-01, 8.7026e-01],
        [6.9960e-04, 9.9930e-01],
        [3.9414e-01, 6.0586e-01],
        [8.2604e-01, 1.7396e-01],
        [2.5039e-03, 9.9750e-01],
        [6.7064e-02, 9.3294e-01],
        [1.4701e-01, 8.5299e-01],
        [1.1593e-03, 9.9884e-01],
        [9.9923e-01, 7.6597e-04],
        [9.9916e-01, 8.4162e-04],
        [9.9950e-01, 4.9669e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.1553,  3.2459],
        [-0.7198,  1.1835],
        [-2.7332,  4.5311],
        [ 0.0905,  0.5205],
        [ 1.1197, -0.4381],
        [-2.4979,  3.4895],
        [-1.8697,  0.7630],
        [-0.3049,  1.4533],
        [-3.8628,  2.8960],
        [ 4.2998, -2.8738],
        [ 6.5203, -0.5590],
        [ 5.2162, -2.3909]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.6260e-04, 9.9964e-01],
        [1.1030e-02, 9.8897e-01],
        [3.9321e-04, 9.9961e-01],
        [5.1239e-03, 9.9488e-01],
        [9.8712e-01, 1.2884e-02],
        [9.5243e-04, 9.9905e-01],
        [5.1253e-02, 9.4875e-01],
        [7.9507e-01, 2.0493e-01],
        [2.1248e-05, 9.9998e-01],
        [9.9991e-01, 8.6827e-05],
        [9.9994e-01, 5.9233e-05],
        [9.9997e-01, 3.2244e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 180, Epoch 3/3, Batch 20/80
temp: 0.8178, beta: 0.1000, 
nri_train_loss: 1.3869, enc_train_loss: 5.2096, enc_train_entropy: 0.2590, dec_train_loss: 0.6587, enc_train_edge_accuracy: 0.5233

Edge pred tensor([[3.7509e-02, 9.6249e-01],
        [1.4491e-01, 8.5509e-01],
        [6.7952e-04, 9.9932e-01],
        [7.1663e-01, 2.8337e-01],
        [8.9126e-01, 1.0874e-01],
        [5.0569e-03, 9.9494e-01],
        [2.5434e-02, 9.7457e-01],
        [4.0982e-02, 9.5902e-01],
        [3.6460e-04, 9.9964e-01],
        [9.8990e-01, 1.0096e-02],
        [9.8679e-01, 1.3210e-02],
        [9.9483e-01, 5.1727e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.3114,  1.9335],
        [-0.7672,  1.0078],
        [-3.7991,  3.4943],
        [ 0.3098, -0.6180],
        [ 1.8279, -0.2758],
        [-2.1655,  3.1164],
        [-2.6863,  0.9596],
        [-1.2879,  1.8649],
        [-4.1731,  3.7432],
        [ 2.5901, -1.9954],
        [ 4.0599, -0.2536],
        [ 3.8612, -1.3980]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.6482e-01, 6.3518e-01],
        [2.2201e-02, 9.7780e-01],
        [1.2686e-05, 9.9999e-01],
        [9.4234e-01, 5.7660e-02],
        [9.1842e-01, 8.1581e-02],
        [5.4257e-03, 9.9457e-01],
        [1.0080e-01, 8.9920e-01],
        [9.1773e-03, 9.9082e-01],
        [8.4550e-04, 9.9915e-01],
        [9.9886e-01, 1.1421e-03],
        [9.9972e-01, 2.7565e-04],
        [9.9724e-01, 2.7561e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.3422e-01, 3.6578e-01],
        [8.9882e-01, 1.0118e-01],
        [6.3752e-03, 9.9362e-01],
        [5.7639e-02, 9.4236e-01],
        [2.7082e-01, 7.2918e-01],
        [8.6001e-04, 9.9914e-01],
        [7.2335e-02, 9.2766e-01],
        [9.4901e-02, 9.0510e-01],
        [9.4331e-04, 9.9906e-01],
        [9.9808e-01, 1.9201e-03],
        [9.9910e-01, 8.9648e-04],
        [9.9965e-01, 3.5365e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.5764,  0.0261],
        [ 0.9506, -1.2336],
        [-1.8346,  3.2143],
        [-0.8146,  1.9796],
        [-0.5689,  0.4216],
        [-2.9747,  4.0831],
        [-1.0363,  1.5151],
        [-1.4139,  0.8413],
        [-3.0964,  3.8688],
        [ 4.2250, -2.0285],
        [ 4.6182, -2.3979],
        [ 4.5637, -3.3832]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.0397e-01, 1.9603e-01],
        [9.9639e-01, 3.6059e-03],
        [2.0409e-03, 9.9796e-01],
        [7.2783e-03, 9.9272e-01],
        [7.2464e-02, 9.2754e-01],
        [2.8696e-04, 9.9971e-01],
        [2.4617e-02, 9.7538e-01],
        [4.1155e-02, 9.5885e-01],
        [5.8768e-02, 9.4123e-01],
        [9.9998e-01, 1.7979e-05],
        [9.9731e-01, 2.6931e-03],
        [9.9975e-01, 2.5187e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.0385e-02, 9.6961e-01],
        [5.4285e-02, 9.4571e-01],
        [2.0654e-03, 9.9793e-01],
        [5.8891e-01, 4.1109e-01],
        [4.6046e-01, 5.3954e-01],
        [1.5680e-02, 9.8432e-01],
        [3.5067e-01, 6.4933e-01],
        [1.4596e-01, 8.5404e-01],
        [8.8321e-03, 9.9117e-01],
        [9.9927e-01, 7.2761e-04],
        [9.9715e-01, 2.8490e-03],
        [9.9609e-01, 3.9060e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.7117,  2.7513],
        [-0.9707,  1.8870],
        [-2.5787,  3.6016],
        [ 2.4814,  2.1220],
        [ 1.6522,  1.8107],
        [-0.6728,  3.4668],
        [ 1.2452,  1.8613],
        [ 1.2400,  3.0067],
        [-1.2288,  3.4917],
        [ 5.0699, -2.1551],
        [ 4.4433, -1.4147],
        [ 3.8235, -1.7178]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.1388e-05, 9.9998e-01],
        [1.6049e-03, 9.9840e-01],
        [2.1025e-06, 1.0000e+00],
        [7.6491e-01, 2.3509e-01],
        [4.8969e-01, 5.1031e-01],
        [2.9931e-03, 9.9701e-01],
        [7.9226e-03, 9.9208e-01],
        [8.0171e-01, 1.9829e-01],
        [3.2003e-03, 9.9680e-01],
        [9.9997e-01, 3.1308e-05],
        [9.9960e-01, 4.0208e-04],
        [9.9819e-01, 1.8094e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.2860, 0.7140],
        [0.6274, 0.3726],
        [0.0120, 0.9880],
        [0.4902, 0.5098],
        [0.8558, 0.1442],
        [0.0112, 0.9888],
        [0.0321, 0.9679],
        [0.2044, 0.7956],
        [0.0023, 0.9977],
        [0.9947, 0.0053],
        [0.9945, 0.0055],
        [0.9970, 0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.7732,  1.6881],
        [ 0.4044, -0.1166],
        [-1.9758,  2.4355],
        [ 1.2769,  1.3162],
        [ 1.2806, -0.5005],
        [-1.5105,  2.9723],
        [-0.8303,  2.5747],
        [ 0.8908,  2.2497],
        [-2.3074,  3.7749],
        [ 4.0845, -1.1512],
        [ 3.8250, -1.3748],
        [ 2.9117, -2.8805]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.6808e-01, 6.3192e-01],
        [9.9790e-01, 2.1012e-03],
        [1.4098e-02, 9.8590e-01],
        [5.5851e-01, 4.4149e-01],
        [8.7042e-01, 1.2958e-01],
        [6.7995e-02, 9.3200e-01],
        [2.0168e-02, 9.7983e-01],
        [2.2450e-01, 7.7550e-01],
        [2.2765e-03, 9.9772e-01],
        [9.9957e-01, 4.2926e-04],
        [9.9920e-01, 7.9781e-04],
        [9.9993e-01, 7.1762e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.2404e-01, 3.7596e-01],
        [5.3876e-01, 4.6124e-01],
        [2.4008e-01, 7.5992e-01],
        [2.0419e-01, 7.9581e-01],
        [2.6139e-01, 7.3861e-01],
        [3.6916e-02, 9.6308e-01],
        [1.2283e-01, 8.7717e-01],
        [4.3050e-01, 5.6950e-01],
        [4.2318e-02, 9.5768e-01],
        [9.9884e-01, 1.1556e-03],
        [9.9909e-01, 9.0933e-04],
        [9.9715e-01, 2.8511e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.6133,  0.1065],
        [-0.3492, -0.5046],
        [-0.3766,  0.7756],
        [-0.1985,  1.1618],
        [-0.3639,  0.6748],
        [-1.0110,  2.2505],
        [-0.5564,  1.4095],
        [ 0.8652,  1.1450],
        [-1.2581,  1.8612],
        [ 3.2500, -3.5120],
        [ 3.1574, -3.8445],
        [ 1.6080, -4.2492]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.5148e-01, 4.8520e-02],
        [6.2843e-03, 9.9372e-01],
        [9.2417e-01, 7.5829e-02],
        [4.2499e-01, 5.7501e-01],
        [3.6258e-01, 6.3742e-01],
        [3.7256e-03, 9.9627e-01],
        [9.8348e-01, 1.6522e-02],
        [2.2102e-01, 7.7898e-01],
        [2.2036e-01, 7.7964e-01],
        [1.0000e+00, 2.0200e-06],
        [1.0000e+00, 2.9223e-06],
        [9.9669e-01, 3.3080e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 185, Epoch 3/3, Batch 25/80
temp: 0.8137, beta: 0.1000, 
nri_train_loss: 1.3734, enc_train_loss: 4.9416, enc_train_entropy: 0.2813, dec_train_loss: 0.6542, enc_train_edge_accuracy: 0.4983

Edge pred tensor([[6.7271e-01, 3.2729e-01],
        [6.2766e-01, 3.7234e-01],
        [2.2539e-02, 9.7746e-01],
        [5.8457e-01, 4.1543e-01],
        [7.0927e-01, 2.9073e-01],
        [2.1909e-02, 9.7809e-01],
        [2.7390e-01, 7.2610e-01],
        [3.3927e-01, 6.6073e-01],
        [1.1021e-02, 9.8898e-01],
        [9.9893e-01, 1.0727e-03],
        [9.9986e-01, 1.4376e-04],
        [9.9935e-01, 6.4656e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.6633, -0.0572],
        [ 0.4984, -0.0238],
        [-2.2296,  1.5401],
        [ 0.1701, -0.1714],
        [ 0.8090, -0.0828],
        [-1.9084,  1.8904],
        [-0.7015,  0.2734],
        [ 0.1975,  0.8641],
        [-2.3134,  2.1835],
        [ 2.9413, -3.8952],
        [ 5.0108, -3.8364],
        [ 3.7201, -3.6231]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.6879e-01, 5.3121e-01],
        [2.7216e-01, 7.2784e-01],
        [3.0356e-03, 9.9696e-01],
        [1.5611e-01, 8.4389e-01],
        [7.5151e-02, 9.2485e-01],
        [4.6968e-04, 9.9953e-01],
        [2.2704e-02, 9.7730e-01],
        [4.4109e-01, 5.5891e-01],
        [1.6257e-02, 9.8374e-01],
        [9.9981e-01, 1.8692e-04],
        [9.9969e-01, 3.0711e-04],
        [9.9947e-01, 5.3170e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[7.7627e-01, 2.2373e-01],
        [6.3602e-01, 3.6398e-01],
        [1.2456e-02, 9.8754e-01],
        [6.4409e-01, 3.5591e-01],
        [6.4108e-01, 3.5892e-01],
        [2.4571e-02, 9.7543e-01],
        [6.8005e-01, 3.1995e-01],
        [7.8582e-01, 2.1418e-01],
        [2.3834e-02, 9.7617e-01],
        [9.9918e-01, 8.2094e-04],
        [9.9922e-01, 7.7646e-04],
        [9.9918e-01, 8.1532e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.3029, -0.9412],
        [-0.3069, -0.8650],
        [-2.6613,  1.7118],
        [ 0.4853, -0.1078],
        [-0.1755, -0.7556],
        [-2.2713,  1.4100],
        [ 0.7707,  0.0167],
        [ 0.8712, -0.4287],
        [-1.6210,  2.0916],
        [ 3.9135, -3.1908],
        [ 3.6741, -3.4859],
        [ 3.5888, -3.5223]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9936e-01, 6.4425e-04],
        [9.8772e-01, 1.2275e-02],
        [4.2997e-03, 9.9570e-01],
        [3.8497e-01, 6.1503e-01],
        [9.1762e-01, 8.2379e-02],
        [5.5438e-02, 9.4456e-01],
        [2.5521e-01, 7.4479e-01],
        [9.9282e-01, 7.1759e-03],
        [1.6377e-02, 9.8362e-01],
        [9.9999e-01, 8.9086e-06],
        [9.9940e-01, 6.0063e-04],
        [9.9994e-01, 5.9840e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[7.8096e-01, 2.1904e-01],
        [4.4331e-01, 5.5669e-01],
        [2.3921e-02, 9.7608e-01],
        [3.4801e-01, 6.5199e-01],
        [5.7156e-01, 4.2844e-01],
        [2.8587e-02, 9.7141e-01],
        [2.8992e-01, 7.1008e-01],
        [4.7885e-01, 5.2115e-01],
        [1.7039e-02, 9.8296e-01],
        [9.9576e-01, 4.2426e-03],
        [9.9974e-01, 2.6065e-04],
        [9.9918e-01, 8.2352e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.1409, -0.1304],
        [ 0.0491,  0.2768],
        [-2.3446,  1.3642],
        [-0.0387,  0.5891],
        [ 0.4554,  0.1672],
        [-1.5388,  1.9870],
        [-0.8106,  0.0852],
        [-0.2602, -0.1755],
        [-2.7319,  1.3232],
        [ 2.0544, -3.4039],
        [ 4.0193, -4.2328],
        [ 3.1107, -3.9904]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.8698e-01, 2.1302e-01],
        [4.6529e-01, 5.3471e-01],
        [3.9502e-03, 9.9605e-01],
        [6.3489e-01, 3.6511e-01],
        [7.5381e-01, 2.4619e-01],
        [1.5940e-03, 9.9841e-01],
        [4.6492e-01, 5.3508e-01],
        [3.6090e-02, 9.6391e-01],
        [1.1816e-05, 9.9999e-01],
        [9.9529e-01, 4.7080e-03],
        [1.0000e+00, 2.5109e-06],
        [9.9991e-01, 9.2484e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[5.2376e-01, 4.7624e-01],
        [5.1457e-01, 4.8543e-01],
        [1.9956e-03, 9.9800e-01],
        [5.0608e-01, 4.9392e-01],
        [7.7891e-01, 2.2109e-01],
        [2.3803e-03, 9.9762e-01],
        [1.7390e-01, 8.2610e-01],
        [4.9046e-01, 5.0954e-01],
        [3.6404e-04, 9.9964e-01],
        [9.9916e-01, 8.3827e-04],
        [9.9919e-01, 8.0719e-04],
        [9.9923e-01, 7.6983e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.8654,  0.7702],
        [ 0.9874,  0.9291],
        [-1.7354,  4.4794],
        [ 0.1636,  0.1393],
        [ 1.4028,  0.1434],
        [-2.3651,  3.6730],
        [-1.1248,  0.4334],
        [-0.0729, -0.0348],
        [-3.3108,  4.6071],
        [ 3.3241, -3.7592],
        [ 3.6480, -3.4731],
        [ 4.2224, -2.9461]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.4300e-01, 5.7001e-02],
        [3.2291e-01, 6.7709e-01],
        [1.0802e-04, 9.9989e-01],
        [1.8900e-01, 8.1100e-01],
        [9.6566e-01, 3.4341e-02],
        [2.8507e-04, 9.9971e-01],
        [2.8713e-02, 9.7129e-01],
        [2.8362e-02, 9.7164e-01],
        [2.3699e-05, 9.9998e-01],
        [9.9752e-01, 2.4752e-03],
        [9.9940e-01, 6.0088e-04],
        [9.9996e-01, 4.2593e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.8843e-01, 5.1157e-01],
        [6.0550e-01, 3.9450e-01],
        [1.0046e-01, 8.9954e-01],
        [2.6403e-01, 7.3597e-01],
        [3.6771e-01, 6.3229e-01],
        [1.1749e-02, 9.8825e-01],
        [2.4482e-01, 7.5518e-01],
        [2.4128e-01, 7.5872e-01],
        [2.5373e-02, 9.7463e-01],
        [9.9924e-01, 7.5736e-04],
        [9.9762e-01, 2.3797e-03],
        [9.9902e-01, 9.7790e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.1112, -1.0649],
        [ 0.0341, -0.3944],
        [-0.9791,  1.2130],
        [-0.5645,  0.4606],
        [ 0.3072,  0.8493],
        [-2.1544,  2.2778],
        [-0.1478,  0.9786],
        [-1.0295,  0.1161],
        [-1.0690,  2.5793],
        [ 3.8023, -3.3826],
        [ 1.8793, -4.1591],
        [ 3.5733, -3.3559]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.6892e-01, 5.3108e-01],
        [1.0187e-01, 8.9814e-01],
        [5.5610e-02, 9.4439e-01],
        [6.2420e-01, 3.7580e-01],
        [6.1432e-02, 9.3857e-01],
        [3.7777e-02, 9.6222e-01],
        [5.0241e-01, 4.9759e-01],
        [4.1951e-01, 5.8049e-01],
        [4.8097e-02, 9.5190e-01],
        [9.9997e-01, 2.6233e-05],
        [9.7851e-01, 2.1487e-02],
        [9.9961e-01, 3.8673e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 190, Epoch 3/3, Batch 30/80
temp: 0.8097, beta: 0.1000, 
nri_train_loss: 1.3309, enc_train_loss: 4.6773, enc_train_entropy: 0.3034, dec_train_loss: 0.6205, enc_train_edge_accuracy: 0.5083

Edge pred tensor([[0.4254, 0.5746],
        [0.5628, 0.4372],
        [0.0540, 0.9460],
        [0.5019, 0.4981],
        [0.8388, 0.1612],
        [0.2298, 0.7702],
        [0.2108, 0.7892],
        [0.3226, 0.6774],
        [0.0973, 0.9027],
        [0.9981, 0.0019],
        [0.9976, 0.0024],
        [0.9988, 0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.3046,  0.6055],
        [ 0.7330,  0.4804],
        [-0.5863,  2.2772],
        [ 0.1015,  0.0939],
        [ 1.0869, -0.5628],
        [-0.3469,  0.8625],
        [-0.6383,  0.6816],
        [-0.3927,  0.3492],
        [-1.2190,  1.0089],
        [ 3.0704, -3.2130],
        [ 3.1696, -2.8633],
        [ 3.8462, -2.8834]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.4603e-01, 6.5397e-01],
        [9.7202e-01, 2.7982e-02],
        [1.9584e-02, 9.8042e-01],
        [9.1493e-01, 8.5070e-02],
        [7.6107e-01, 2.3893e-01],
        [1.6267e-01, 8.3733e-01],
        [3.3678e-02, 9.6632e-01],
        [1.9379e-02, 9.8062e-01],
        [9.7866e-02, 9.0213e-01],
        [1.0000e+00, 4.8831e-06],
        [9.9904e-01, 9.6428e-04],
        [9.9997e-01, 3.4476e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.3786e-01, 7.6214e-01],
        [3.9100e-01, 6.0900e-01],
        [1.6117e-03, 9.9839e-01],
        [1.1984e-01, 8.8016e-01],
        [2.8185e-01, 7.1815e-01],
        [9.2920e-04, 9.9907e-01],
        [7.9347e-02, 9.2065e-01],
        [1.5894e-01, 8.4106e-01],
        [7.9558e-04, 9.9920e-01],
        [9.9281e-01, 7.1934e-03],
        [9.9580e-01, 4.2016e-03],
        [9.9844e-01, 1.5631e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.0880,  1.0765],
        [-0.2703,  0.1728],
        [-2.6110,  3.8179],
        [-0.7776,  1.2164],
        [-0.8298,  0.1055],
        [-3.0723,  3.9079],
        [-1.2709,  1.1804],
        [-1.0918,  0.5743],
        [-3.4553,  3.6804],
        [ 3.5348, -1.3926],
        [ 3.9529, -1.5152],
        [ 4.0756, -2.3839]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.4090e-02, 9.1591e-01],
        [4.0786e-01, 5.9214e-01],
        [5.8273e-05, 9.9994e-01],
        [1.0444e-02, 9.8956e-01],
        [3.9495e-01, 6.0505e-01],
        [7.5781e-05, 9.9992e-01],
        [1.2137e-02, 9.8786e-01],
        [7.0894e-01, 2.9106e-01],
        [1.2398e-03, 9.9876e-01],
        [9.5136e-01, 4.8637e-02],
        [1.0000e+00, 3.1501e-06],
        [9.9981e-01, 1.9403e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[1.5340e-01, 8.4660e-01],
        [5.6286e-01, 4.3714e-01],
        [1.3076e-02, 9.8692e-01],
        [5.7635e-01, 4.2365e-01],
        [4.3768e-01, 5.6232e-01],
        [1.6998e-02, 9.8300e-01],
        [5.4111e-01, 4.5889e-01],
        [1.5978e-01, 8.4022e-01],
        [3.4328e-03, 9.9657e-01],
        [9.9983e-01, 1.7068e-04],
        [9.9834e-01, 1.6626e-03],
        [9.9846e-01, 1.5405e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.9784,  0.7298],
        [ 0.3304,  0.0776],
        [-2.4088,  1.9149],
        [ 0.3652,  0.0574],
        [ 1.0961,  1.3467],
        [-1.6859,  2.3716],
        [ 0.9199,  0.7551],
        [ 0.7882,  2.4480],
        [-1.2251,  4.4458],
        [ 3.6792, -4.9963],
        [ 2.8789, -3.5189],
        [ 3.0428, -3.4313]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.4694e-01, 7.5306e-01],
        [9.2028e-02, 9.0797e-01],
        [3.2501e-01, 6.7499e-01],
        [9.3843e-01, 6.1575e-02],
        [1.3141e-01, 8.6859e-01],
        [2.1079e-04, 9.9979e-01],
        [1.4863e-02, 9.8514e-01],
        [8.6220e-02, 9.1378e-01],
        [7.5331e-03, 9.9247e-01],
        [1.0000e+00, 1.6248e-06],
        [9.9939e-01, 6.1127e-04],
        [9.9727e-01, 2.7306e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.9086, 0.0914],
        [0.8883, 0.1117],
        [0.5699, 0.4301],
        [0.5214, 0.4786],
        [0.5754, 0.4246],
        [0.1069, 0.8931],
        [0.3074, 0.6926],
        [0.3804, 0.6196],
        [0.1129, 0.8871],
        [0.9988, 0.0012],
        [0.9986, 0.0014],
        [0.9982, 0.0018]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.7170, -1.5796],
        [ 0.5871, -1.4859],
        [ 0.0869, -0.1944],
        [-1.1423, -1.2279],
        [ 0.1193, -0.1847],
        [-0.6879,  1.4347],
        [-1.2354, -0.4233],
        [-0.2697,  0.2184],
        [-0.5610,  1.5001],
        [ 1.8495, -4.8516],
        [ 2.0873, -4.4560],
        [ 2.3412, -3.9854]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.4479e-01, 5.5212e-02],
        [9.9903e-01, 9.6862e-04],
        [8.0023e-01, 1.9977e-01],
        [3.2439e-01, 6.7561e-01],
        [7.2596e-01, 2.7404e-01],
        [3.7929e-02, 9.6207e-01],
        [1.1635e-01, 8.8365e-01],
        [2.0522e-01, 7.9478e-01],
        [4.3891e-03, 9.9561e-01],
        [1.0000e+00, 1.4094e-06],
        [9.9600e-01, 4.0023e-03],
        [9.8584e-01, 1.4159e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.3190, 0.6810],
        [0.5155, 0.4845],
        [0.0286, 0.9714],
        [0.2856, 0.7144],
        [0.2936, 0.7064],
        [0.0127, 0.9873],
        [0.1948, 0.8052],
        [0.0748, 0.9252],
        [0.0031, 0.9969],
        [0.9942, 0.0058],
        [0.9854, 0.0146],
        [0.9957, 0.0043]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.5864,  0.1720],
        [-0.2497, -0.3117],
        [-1.4380,  2.0889],
        [-0.8034,  0.1134],
        [-0.8095,  0.0684],
        [-2.7542,  1.5967],
        [-0.6588,  0.7605],
        [-1.3584,  1.1575],
        [-2.6412,  3.1261],
        [ 3.1798, -1.9629],
        [ 2.3451, -1.8660],
        [ 3.1978, -2.2553]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.5231e-01, 6.4769e-01],
        [8.5229e-01, 1.4771e-01],
        [1.6432e-02, 9.8357e-01],
        [8.3866e-01, 1.6134e-01],
        [6.6883e-01, 3.3117e-01],
        [2.3342e-03, 9.9767e-01],
        [3.6352e-01, 6.3648e-01],
        [5.7265e-02, 9.4274e-01],
        [2.4242e-04, 9.9976e-01],
        [9.9060e-01, 9.3998e-03],
        [9.8868e-01, 1.1323e-02],
        [9.9646e-01, 3.5405e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 195, Epoch 3/3, Batch 35/80
temp: 0.8056, beta: 0.1000, 
nri_train_loss: 1.2874, enc_train_loss: 4.4364, enc_train_entropy: 0.3234, dec_train_loss: 0.5850, enc_train_edge_accuracy: 0.5167

Edge pred tensor([[5.5516e-01, 4.4484e-01],
        [8.1852e-01, 1.8148e-01],
        [4.9592e-02, 9.5041e-01],
        [7.1989e-01, 2.8011e-01],
        [5.0609e-01, 4.9391e-01],
        [2.2380e-02, 9.7762e-01],
        [5.1762e-01, 4.8238e-01],
        [1.8061e-01, 8.1939e-01],
        [4.6007e-03, 9.9540e-01],
        [9.9972e-01, 2.8205e-04],
        [9.9823e-01, 1.7744e-03],
        [9.9946e-01, 5.4098e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.1558, -0.0657],
        [ 0.9031, -0.6033],
        [-2.2030,  0.7501],
        [ 0.8822, -0.0617],
        [ 0.9780,  0.9536],
        [-2.0962,  1.6808],
        [ 1.0469,  0.9764],
        [ 0.3361,  1.8484],
        [-1.9629,  3.4140],
        [ 4.8217, -3.3514],
        [ 3.9185, -2.4141],
        [ 5.1938, -2.3278]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.8344e-01, 4.1656e-01],
        [9.7498e-01, 2.5021e-02],
        [3.8623e-03, 9.9614e-01],
        [7.3823e-01, 2.6177e-01],
        [8.2478e-01, 1.7522e-01],
        [2.3163e-03, 9.9768e-01],
        [9.9505e-03, 9.9005e-01],
        [4.9929e-03, 9.9501e-01],
        [1.2114e-02, 9.8789e-01],
        [9.9999e-01, 1.4282e-05],
        [9.9988e-01, 1.2098e-04],
        [9.9982e-01, 1.8447e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[6.9054e-01, 3.0946e-01],
        [4.8017e-01, 5.1983e-01],
        [5.6251e-02, 9.4375e-01],
        [6.0886e-01, 3.9114e-01],
        [2.8778e-01, 7.1222e-01],
        [2.4248e-02, 9.7575e-01],
        [5.4008e-01, 4.5992e-01],
        [4.9993e-01, 5.0007e-01],
        [3.1513e-02, 9.6849e-01],
        [9.9796e-01, 2.0419e-03],
        [9.9946e-01, 5.3899e-04],
        [9.9922e-01, 7.7847e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.8550,  0.0524],
        [ 0.2850,  0.3643],
        [-2.0856,  0.7344],
        [ 0.9958,  0.5533],
        [-0.2030,  0.7032],
        [-1.9413,  1.7536],
        [ 0.4284,  0.2678],
        [-0.2775, -0.2772],
        [-2.0659,  1.3595],
        [ 3.1295, -3.0623],
        [ 3.3828, -4.1425],
        [ 3.1972, -3.9602]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[6.2808e-01, 3.7192e-01],
        [8.8663e-01, 1.1337e-01],
        [2.5699e-04, 9.9974e-01],
        [3.2980e-01, 6.7020e-01],
        [1.8771e-01, 8.1229e-01],
        [7.3982e-01, 2.6018e-01],
        [5.5559e-01, 4.4441e-01],
        [1.2968e-01, 8.7032e-01],
        [3.7504e-02, 9.6250e-01],
        [9.9997e-01, 2.6099e-05],
        [9.9969e-01, 3.0530e-04],
        [9.9993e-01, 6.6530e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.5023e-01, 7.4977e-01],
        [4.0715e-01, 5.9285e-01],
        [1.9309e-02, 9.8069e-01],
        [4.2514e-01, 5.7486e-01],
        [5.9619e-01, 4.0381e-01],
        [7.2076e-02, 9.2792e-01],
        [2.8580e-01, 7.1420e-01],
        [2.6800e-01, 7.3200e-01],
        [3.6761e-02, 9.6324e-01],
        [9.9552e-01, 4.4806e-03],
        [9.9728e-01, 2.7233e-03],
        [9.9930e-01, 6.9894e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.8742,  1.9716],
        [ 0.0398,  0.4155],
        [-1.6547,  2.2731],
        [ 0.0899,  0.3916],
        [-0.0431, -0.4327],
        [-1.3875,  1.1678],
        [-0.6247,  0.2911],
        [-0.8266,  0.1782],
        [-2.5326,  0.7333],
        [ 2.7118, -2.6917],
        [ 2.9548, -2.9484],
        [ 3.2336, -4.0316]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.9056e-04, 9.9981e-01],
        [5.7835e-01, 4.2165e-01],
        [5.8221e-04, 9.9942e-01],
        [2.4693e-02, 9.7531e-01],
        [7.8305e-01, 2.1695e-01],
        [1.1539e-01, 8.8461e-01],
        [1.0619e-01, 8.9381e-01],
        [3.6389e-01, 6.3611e-01],
        [3.6449e-03, 9.9636e-01],
        [9.9957e-01, 4.3017e-04],
        [9.8844e-01, 1.1565e-02],
        [9.9963e-01, 3.7412e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.4544e-01, 5.5456e-01],
        [3.3712e-01, 6.6288e-01],
        [1.1182e-03, 9.9888e-01],
        [5.4594e-01, 4.5406e-01],
        [4.0543e-01, 5.9457e-01],
        [6.8796e-04, 9.9931e-01],
        [3.2752e-01, 6.7248e-01],
        [2.1733e-01, 7.8267e-01],
        [4.1572e-04, 9.9958e-01],
        [9.9917e-01, 8.3391e-04],
        [9.9866e-01, 1.3448e-03],
        [9.9738e-01, 2.6183e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.2753, -0.0562],
        [-0.5393,  0.1369],
        [-2.4002,  4.3947],
        [-0.1372, -0.3215],
        [-0.3942, -0.0114],
        [-3.0062,  4.2749],
        [-1.1620, -0.4426],
        [-0.9744,  0.3069],
        [-3.2615,  4.5236],
        [ 3.4455, -3.6431],
        [ 3.4803, -3.1299],
        [ 3.4702, -2.4724]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.2189e-01, 8.7811e-01],
        [8.9181e-01, 1.0819e-01],
        [1.3498e-04, 9.9987e-01],
        [9.4430e-01, 5.5703e-02],
        [8.7232e-01, 1.2768e-01],
        [1.9077e-04, 9.9981e-01],
        [1.2338e-01, 8.7662e-01],
        [8.0421e-01, 1.9579e-01],
        [1.4312e-05, 9.9999e-01],
        [9.9959e-01, 4.1311e-04],
        [9.9994e-01, 5.8982e-05],
        [9.9977e-01, 2.2531e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.3968, 0.6032],
        [0.6745, 0.3255],
        [0.0610, 0.9390],
        [0.1241, 0.8759],
        [0.5687, 0.4313],
        [0.0295, 0.9705],
        [0.0786, 0.9214],
        [0.1988, 0.8012],
        [0.0153, 0.9847],
        [0.9875, 0.0125],
        [0.9736, 0.0264],
        [0.9878, 0.0122]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.3464,  0.0726],
        [ 1.0000,  0.2714],
        [-0.4265,  2.3070],
        [-1.5990,  0.3548],
        [-0.4625, -0.7392],
        [-2.1127,  1.3814],
        [-0.6158,  1.8453],
        [-0.8968,  0.4969],
        [-1.0119,  3.1558],
        [ 2.4610, -1.9106],
        [ 1.2039, -2.4036],
        [ 2.7442, -1.6461]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.1917, 0.8083],
        [0.3706, 0.6294],
        [0.0745, 0.9255],
        [0.1730, 0.8270],
        [0.5899, 0.4101],
        [0.0609, 0.9391],
        [0.0973, 0.9027],
        [0.0315, 0.9685],
        [0.0024, 0.9976],
        [0.9968, 0.0032],
        [0.9988, 0.0012],
        [0.9929, 0.0071]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 200, Epoch 3/3, Batch 40/80
temp: 0.8016, beta: 0.1000, 
nri_train_loss: 1.2430, enc_train_loss: 4.2168, enc_train_entropy: 0.3417, dec_train_loss: 0.5479, enc_train_edge_accuracy: 0.5183

Edge pred tensor([[0.3355, 0.6645],
        [0.4133, 0.5867],
        [0.0309, 0.9691],
        [0.3074, 0.6926],
        [0.5267, 0.4733],
        [0.0217, 0.9783],
        [0.0712, 0.9288],
        [0.2311, 0.7689],
        [0.0067, 0.9933],
        [0.9883, 0.0117],
        [0.9867, 0.0133],
        [0.9725, 0.0275]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.2185,  0.9020],
        [-0.2469,  0.1033],
        [-1.1834,  2.2617],
        [ 0.7707,  1.5831],
        [ 0.6925,  0.5855],
        [-0.0467,  3.7636],
        [-0.7656,  1.8030],
        [ 0.1975,  1.3994],
        [-1.9163,  3.0873],
        [ 3.1528, -1.2834],
        [ 3.5903, -0.7170],
        [ 2.1560, -1.4083]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.6481e-01, 7.3519e-01],
        [1.8258e-01, 8.1742e-01],
        [1.7527e-01, 8.2473e-01],
        [4.6909e-01, 5.3091e-01],
        [9.8457e-01, 1.5433e-02],
        [1.2377e-03, 9.9876e-01],
        [1.5023e-01, 8.4977e-01],
        [8.1697e-01, 1.8303e-01],
        [2.6317e-02, 9.7368e-01],
        [9.9930e-01, 7.0036e-04],
        [9.9963e-01, 3.7111e-04],
        [9.9298e-01, 7.0166e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[4.9289e-01, 5.0711e-01],
        [5.9567e-01, 4.0433e-01],
        [1.0850e-01, 8.9150e-01],
        [2.9464e-01, 7.0536e-01],
        [2.8624e-01, 7.1376e-01],
        [5.9483e-02, 9.4052e-01],
        [3.2493e-01, 6.7507e-01],
        [2.8235e-01, 7.1765e-01],
        [2.6311e-02, 9.7369e-01],
        [9.9962e-01, 3.7988e-04],
        [9.9814e-01, 1.8594e-03],
        [9.9821e-01, 1.7853e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.0056,  0.0229],
        [ 0.7384,  0.3509],
        [-1.7334,  0.3728],
        [-0.5270,  0.3460],
        [ 0.6157,  1.5294],
        [-1.8572,  0.9035],
        [-0.1281,  0.6031],
        [ 0.3816,  1.3145],
        [-1.3827,  2.2284],
        [ 3.6985, -4.1768],
        [ 3.0970, -3.1886],
        [ 3.9973, -2.3291]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.9892e-01, 1.0771e-03],
        [9.3259e-01, 6.7412e-02],
        [1.7774e-02, 9.8223e-01],
        [6.2270e-01, 3.7730e-01],
        [6.4148e-01, 3.5852e-01],
        [1.2043e-02, 9.8796e-01],
        [3.8690e-01, 6.1310e-01],
        [2.3478e-01, 7.6522e-01],
        [1.0538e-01, 8.9462e-01],
        [9.9982e-01, 1.7724e-04],
        [9.9918e-01, 8.1650e-04],
        [9.9999e-01, 7.3127e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.3117, 0.6883],
        [0.3366, 0.6634],
        [0.0727, 0.9273],
        [0.5887, 0.4113],
        [0.6542, 0.3458],
        [0.1660, 0.8340],
        [0.4338, 0.5662],
        [0.3953, 0.6047],
        [0.0720, 0.9280],
        [0.9959, 0.0041],
        [0.9964, 0.0036],
        [0.9966, 0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.8063,  1.5984],
        [-0.0913,  0.5871],
        [-1.0173,  1.5285],
        [ 1.0294,  0.6706],
        [ 0.7535,  0.1160],
        [-0.2284,  1.3858],
        [-0.0155,  0.2510],
        [ 0.1158,  0.5409],
        [-1.7261,  0.8297],
        [ 3.0630, -2.4181],
        [ 3.6123, -2.0182],
        [ 2.9795, -2.6956]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.2377e-01, 7.7623e-01],
        [3.3924e-03, 9.9661e-01],
        [1.0994e-03, 9.9890e-01],
        [3.6554e-01, 6.3446e-01],
        [2.5550e-01, 7.4450e-01],
        [2.3246e-01, 7.6754e-01],
        [4.1485e-02, 9.5851e-01],
        [7.5527e-01, 2.4473e-01],
        [5.2359e-02, 9.4764e-01],
        [1.0000e+00, 9.9666e-07],
        [9.9975e-01, 2.4801e-04],
        [9.9826e-01, 1.7378e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.7656, 0.2344],
        [0.8749, 0.1251],
        [0.4396, 0.5604],
        [0.0775, 0.9225],
        [0.5918, 0.4082],
        [0.1717, 0.8283],
        [0.1614, 0.8386],
        [0.2087, 0.7913],
        [0.0781, 0.9219],
        [0.9842, 0.0158],
        [0.9833, 0.0167],
        [0.9974, 0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.7801,  0.5965],
        [ 1.5556, -0.3891],
        [ 0.4743,  0.7173],
        [-0.1271,  2.3496],
        [ 0.7277,  0.3564],
        [-0.7117,  0.8621],
        [ 0.2438,  1.8915],
        [ 0.2527,  1.5855],
        [-1.0464,  1.4217],
        [ 2.9055, -1.2255],
        [ 2.7713, -1.3052],
        [ 3.4948, -2.4442]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.2171e-04, 9.9968e-01],
        [9.5436e-01, 4.5642e-02],
        [1.2586e-02, 9.8741e-01],
        [7.2770e-02, 9.2723e-01],
        [8.3589e-01, 1.6411e-01],
        [2.2231e-02, 9.7777e-01],
        [1.2478e-01, 8.7522e-01],
        [3.5765e-01, 6.4235e-01],
        [7.7777e-04, 9.9922e-01],
        [6.0562e-01, 3.9438e-01],
        [9.7664e-01, 2.3360e-02],
        [9.9919e-01, 8.0890e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[2.8603e-01, 7.1397e-01],
        [1.9747e-01, 8.0253e-01],
        [5.3369e-04, 9.9947e-01],
        [4.9777e-01, 5.0223e-01],
        [3.8674e-01, 6.1326e-01],
        [1.0440e-03, 9.9896e-01],
        [3.4950e-01, 6.5050e-01],
        [2.5232e-01, 7.4768e-01],
        [1.1760e-03, 9.9882e-01],
        [9.9849e-01, 1.5079e-03],
        [9.9787e-01, 2.1252e-03],
        [9.9556e-01, 4.4398e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.4304,  0.4844],
        [-0.5907,  0.8115],
        [-2.7903,  4.7449],
        [-0.3396, -0.3307],
        [-0.5990, -0.1379],
        [-3.1344,  3.7292],
        [-0.6460, -0.0248],
        [-1.0440,  0.0423],
        [-3.0000,  3.7445],
        [ 3.3939, -3.1016],
        [ 3.2961, -2.8557],
        [ 3.1797, -2.2330]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.0818e-01, 8.9182e-01],
        [8.8686e-03, 9.9113e-01],
        [9.9140e-04, 9.9901e-01],
        [9.9532e-02, 9.0047e-01],
        [8.5121e-01, 1.4879e-01],
        [7.7605e-06, 9.9999e-01],
        [1.9162e-02, 9.8084e-01],
        [1.1693e-01, 8.8307e-01],
        [1.3404e-03, 9.9866e-01],
        [9.9989e-01, 1.0841e-04],
        [9.9787e-01, 2.1318e-03],
        [9.9935e-01, 6.5502e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 205, Epoch 3/3, Batch 45/80
temp: 0.7976, beta: 0.1000, 
nri_train_loss: 1.2018, enc_train_loss: 3.8817, enc_train_entropy: 0.3697, dec_train_loss: 0.5179, enc_train_edge_accuracy: 0.5400

Edge pred tensor([[0.4747, 0.5253],
        [0.6970, 0.3030],
        [0.5487, 0.4513],
        [0.5953, 0.4047],
        [0.6995, 0.3005],
        [0.5544, 0.4456],
        [0.1880, 0.8120],
        [0.2467, 0.7533],
        [0.4126, 0.5874],
        [0.9964, 0.0036],
        [0.9983, 0.0017],
        [0.9981, 0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.0745,  0.1758],
        [ 0.4735, -0.3594],
        [-0.4145, -0.6101],
        [-0.0819, -0.4679],
        [ 0.6819, -0.1632],
        [-0.0673, -0.2857],
        [-1.1126,  0.3506],
        [-0.2246,  0.8914],
        [-0.3924, -0.0393],
        [ 2.0960, -3.5225],
        [ 3.1914, -3.1794],
        [ 3.1936, -3.0597]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.3607e-01, 6.3933e-02],
        [9.6501e-01, 3.4989e-02],
        [9.5276e-01, 4.7236e-02],
        [6.0734e-01, 3.9266e-01],
        [4.8052e-02, 9.5195e-01],
        [1.1257e-02, 9.8874e-01],
        [4.6089e-04, 9.9954e-01],
        [1.5828e-01, 8.4172e-01],
        [6.6152e-01, 3.3848e-01],
        [9.9955e-01, 4.4530e-04],
        [9.9993e-01, 6.5901e-05],
        [9.9995e-01, 4.5081e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.5743, 0.4257],
        [0.7207, 0.2793],
        [0.4072, 0.5928],
        [0.6005, 0.3995],
        [0.7264, 0.2736],
        [0.1779, 0.8221],
        [0.2383, 0.7617],
        [0.1227, 0.8773],
        [0.0709, 0.9291],
        [0.9925, 0.0075],
        [0.9492, 0.0508],
        [0.9751, 0.0249]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.2914, -0.5908],
        [ 0.0259, -0.9220],
        [-0.3219,  0.0535],
        [-0.8378, -1.2452],
        [-0.5195, -1.4959],
        [-1.5986, -0.0679],
        [-0.3543,  0.8075],
        [-1.0937,  0.8737],
        [-0.9911,  1.5825],
        [ 2.8421, -2.0458],
        [ 1.1538, -1.7733],
        [ 2.1324, -1.5345]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.8914, 0.1086],
        [0.9874, 0.0126],
        [0.3603, 0.6397],
        [0.9043, 0.0957],
        [0.0626, 0.9374],
        [0.5166, 0.4834],
        [0.5251, 0.4749],
        [0.1655, 0.8345],
        [0.0246, 0.9754],
        [0.9989, 0.0011],
        [0.1288, 0.8712],
        [0.9870, 0.0130]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[3.4165e-01, 6.5835e-01],
        [3.6363e-01, 6.3637e-01],
        [2.5502e-03, 9.9745e-01],
        [3.4795e-02, 9.6521e-01],
        [3.8821e-01, 6.1179e-01],
        [2.1107e-03, 9.9789e-01],
        [1.2084e-01, 8.7916e-01],
        [5.7030e-01, 4.2970e-01],
        [9.5203e-04, 9.9905e-01],
        [9.7995e-01, 2.0046e-02],
        [9.9290e-01, 7.0966e-03],
        [9.8748e-01, 1.2523e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.7272, -0.0713],
        [-0.1459,  0.4137],
        [-2.7613,  3.2077],
        [-1.6128,  1.7101],
        [ 0.5883,  1.0431],
        [-2.2223,  3.9363],
        [-0.9438,  1.0408],
        [ 0.8701,  0.5870],
        [-2.4099,  4.5461],
        [ 1.9988, -1.8907],
        [ 2.8804, -2.0607],
        [ 2.8048, -1.5627]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.9674e-01, 6.0326e-01],
        [4.3238e-01, 5.6762e-01],
        [6.2509e-04, 9.9937e-01],
        [2.4320e-02, 9.7568e-01],
        [2.4209e-01, 7.5791e-01],
        [4.5519e-04, 9.9954e-01],
        [7.4048e-02, 9.2595e-01],
        [9.4885e-01, 5.1152e-02],
        [5.9099e-04, 9.9941e-01],
        [9.4870e-01, 5.1297e-02],
        [9.9926e-01, 7.4121e-04],
        [9.9979e-01, 2.1101e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[5.2526e-01, 4.7474e-01],
        [2.5682e-01, 7.4318e-01],
        [9.8207e-04, 9.9902e-01],
        [1.1507e-01, 8.8493e-01],
        [1.7332e-01, 8.2668e-01],
        [2.6025e-04, 9.9974e-01],
        [3.1538e-01, 6.8462e-01],
        [8.2132e-01, 1.7868e-01],
        [1.7256e-03, 9.9827e-01],
        [9.7843e-01, 2.1571e-02],
        [9.9696e-01, 3.0383e-03],
        [9.8974e-01, 1.0260e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.0444, -0.1455],
        [-1.2523, -0.1898],
        [-3.2178,  3.7071],
        [-0.6996,  1.3403],
        [-1.0707,  0.4917],
        [-3.3036,  4.9500],
        [-0.6170,  0.1581],
        [ 0.2536, -1.2717],
        [-3.0782,  3.2823],
        [ 2.2177, -1.5969],
        [ 2.8304, -2.9630],
        [ 1.9932, -2.5759]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.6889e-01, 6.3111e-01],
        [8.0141e-01, 1.9859e-01],
        [9.8347e-04, 9.9902e-01],
        [1.0186e-01, 8.9814e-01],
        [7.5089e-01, 2.4911e-01],
        [7.9337e-05, 9.9992e-01],
        [1.8696e-03, 9.9813e-01],
        [5.1196e-01, 4.8804e-01],
        [4.9431e-07, 1.0000e+00],
        [9.9885e-01, 1.1540e-03],
        [9.9832e-01, 1.6836e-03],
        [9.5862e-01, 4.1377e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.2752, 0.7248],
        [0.4514, 0.5486],
        [0.0082, 0.9918],
        [0.2205, 0.7795],
        [0.3399, 0.6601],
        [0.0057, 0.9943],
        [0.2385, 0.7615],
        [0.3923, 0.6077],
        [0.0102, 0.9898],
        [0.9575, 0.0425],
        [0.9834, 0.0166],
        [0.9903, 0.0097]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.2466,  1.2151],
        [-0.7600, -0.5649],
        [-2.0239,  2.7680],
        [-0.4845,  0.7780],
        [-0.7322, -0.0684],
        [-2.6619,  2.5064],
        [-0.7737,  0.3870],
        [ 0.1184,  0.5562],
        [-2.3586,  2.2160],
        [ 2.9218, -0.1927],
        [ 3.8410, -0.2402],
        [ 3.0263, -1.6012]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.0017e-01, 7.9983e-01],
        [6.1641e-01, 3.8359e-01],
        [3.7642e-03, 9.9624e-01],
        [9.8731e-02, 9.0127e-01],
        [6.7419e-01, 3.2581e-01],
        [2.4230e-04, 9.9976e-01],
        [1.0322e-02, 9.8968e-01],
        [9.7072e-01, 2.9276e-02],
        [1.6689e-02, 9.8331e-01],
        [9.5092e-01, 4.9081e-02],
        [9.9084e-01, 9.1630e-03],
        [9.9857e-01, 1.4274e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 210, Epoch 3/3, Batch 50/80
temp: 0.7936, beta: 0.1000, 
nri_train_loss: 1.1490, enc_train_loss: 3.6744, enc_train_entropy: 0.3869, dec_train_loss: 0.4720, enc_train_edge_accuracy: 0.5117

Edge pred tensor([[0.5729, 0.4271],
        [0.2287, 0.7713],
        [0.0879, 0.9121],
        [0.7752, 0.2248],
        [0.4504, 0.5496],
        [0.2073, 0.7927],
        [0.4928, 0.5072],
        [0.6627, 0.3373],
        [0.1155, 0.8845],
        [0.9931, 0.0069],
        [0.9936, 0.0064],
        [0.9720, 0.0280]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.5126,  1.2190],
        [-1.2450, -0.0293],
        [-0.7365,  1.6025],
        [ 1.4954,  0.2575],
        [ 0.5472,  0.7463],
        [ 0.9295,  2.2705],
        [-0.3296, -0.3008],
        [ 1.4632,  0.7880],
        [-0.9789,  1.0573],
        [ 2.5714, -2.4025],
        [ 4.3653, -0.6800],
        [ 1.7617, -1.7864]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.5415e-01, 7.4585e-01],
        [2.2215e-01, 7.7785e-01],
        [2.8023e-02, 9.7198e-01],
        [1.3844e-02, 9.8616e-01],
        [4.4173e-01, 5.5827e-01],
        [3.0049e-01, 6.9951e-01],
        [1.6827e-01, 8.3173e-01],
        [2.8250e-01, 7.1750e-01],
        [9.6188e-02, 9.0381e-01],
        [9.9992e-01, 8.2896e-05],
        [9.9403e-01, 5.9696e-03],
        [8.9114e-01, 1.0886e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.1972, 0.8028],
        [0.3143, 0.6857],
        [0.0032, 0.9968],
        [0.3760, 0.6240],
        [0.3188, 0.6812],
        [0.0028, 0.9972],
        [0.2837, 0.7163],
        [0.2119, 0.7881],
        [0.0024, 0.9976],
        [0.9954, 0.0046],
        [0.9923, 0.0077],
        [0.9927, 0.0073]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.3372,  1.7409],
        [-0.5306,  0.2497],
        [-2.4318,  3.3197],
        [ 0.3211,  0.8279],
        [ 0.7840,  1.5435],
        [-0.9430,  4.9436],
        [-1.0370, -0.1109],
        [-0.4063,  0.9075],
        [-2.6200,  3.4033],
        [ 2.2800, -3.0874],
        [ 2.9054, -1.9585],
        [ 2.1020, -2.8102]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[6.9159e-02, 9.3084e-01],
        [4.7829e-01, 5.2171e-01],
        [9.4479e-04, 9.9906e-01],
        [8.2987e-02, 9.1701e-01],
        [5.6656e-01, 4.3344e-01],
        [2.1096e-03, 9.9789e-01],
        [2.7905e-01, 7.2095e-01],
        [5.6455e-01, 4.3545e-01],
        [1.1896e-04, 9.9988e-01],
        [9.9905e-01, 9.5447e-04],
        [9.9546e-01, 4.5372e-03],
        [9.9879e-01, 1.2145e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.2104, 0.7896],
        [0.2578, 0.7422],
        [0.0897, 0.9103],
        [0.3451, 0.6549],
        [0.2587, 0.7413],
        [0.0810, 0.9190],
        [0.3943, 0.6057],
        [0.1701, 0.8299],
        [0.0583, 0.9417],
        [0.9977, 0.0023],
        [0.9885, 0.0115],
        [0.9906, 0.0094]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.2002,  1.1222],
        [-0.0380,  1.0195],
        [-0.9624,  1.3552],
        [-0.6234,  0.0172],
        [ 0.1254,  1.1780],
        [-0.3580,  2.0703],
        [-0.7404, -0.3112],
        [-0.7769,  0.8083],
        [-1.3187,  1.4632],
        [ 2.1246, -3.9454],
        [ 1.9179, -2.5362],
        [ 1.9445, -2.7112]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[1.2209e-02, 9.8779e-01],
        [1.8682e-02, 9.8132e-01],
        [6.9816e-02, 9.3018e-01],
        [9.4434e-01, 5.5658e-02],
        [6.8767e-02, 9.3123e-01],
        [9.8319e-01, 1.6807e-02],
        [9.7569e-02, 9.0243e-01],
        [1.6914e-01, 8.3086e-01],
        [2.9655e-02, 9.7034e-01],
        [9.9982e-01, 1.8136e-04],
        [9.9821e-01, 1.7899e-03],
        [9.8312e-01, 1.6877e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.6427, 0.3573],
        [0.4212, 0.5788],
        [0.0070, 0.9930],
        [0.7330, 0.2670],
        [0.4866, 0.5134],
        [0.0160, 0.9840],
        [0.3384, 0.6616],
        [0.2804, 0.7196],
        [0.0106, 0.9894],
        [0.9944, 0.0056],
        [0.9885, 0.0115],
        [0.9932, 0.0068]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.0578, -0.6448],
        [-0.1927,  0.1251],
        [-2.0545,  2.8947],
        [ 1.0036, -0.0063],
        [ 0.2586,  0.3124],
        [-1.3501,  2.7719],
        [ 0.7372,  1.4074],
        [-0.1901,  0.7526],
        [-0.8569,  3.6798],
        [ 3.8072, -1.3709],
        [ 2.5554, -1.8977],
        [ 3.7126, -1.2697]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.3297e-01, 2.6703e-01],
        [2.2340e-01, 7.7660e-01],
        [1.1983e-02, 9.8802e-01],
        [8.1127e-01, 1.8873e-01],
        [1.6125e-01, 8.3875e-01],
        [2.9526e-03, 9.9705e-01],
        [3.3446e-01, 6.6554e-01],
        [9.6379e-01, 3.6209e-02],
        [1.5969e-02, 9.8403e-01],
        [9.6644e-01, 3.3565e-02],
        [9.9994e-01, 6.1987e-05],
        [9.9948e-01, 5.1811e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.2944, 0.7056],
        [0.4308, 0.5692],
        [0.5376, 0.4624],
        [0.7795, 0.2205],
        [0.5400, 0.4600],
        [0.3734, 0.6266],
        [0.4546, 0.5454],
        [0.1823, 0.8177],
        [0.2414, 0.7586],
        [0.9924, 0.0076],
        [0.9802, 0.0198],
        [0.9902, 0.0098]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.7997,  1.6739],
        [ 0.8807,  1.1594],
        [ 0.2216,  0.0709],
        [ 2.0387,  0.7761],
        [ 0.5082,  0.3479],
        [-0.2095,  0.3084],
        [ 0.4199,  0.6022],
        [-0.1575,  1.3435],
        [-0.9003,  0.2447],
        [ 2.6347, -2.2421],
        [ 1.8618, -2.0378],
        [ 1.4574, -3.1610]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.0541, 0.9458],
        [0.8880, 0.1120],
        [0.7351, 0.2649],
        [0.9646, 0.0354],
        [0.0090, 0.9910],
        [0.0242, 0.9758],
        [0.0639, 0.9361],
        [0.1809, 0.8191],
        [0.9163, 0.0837],
        [0.7815, 0.2185],
        [0.9901, 0.0099],
        [0.9955, 0.0045]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 215, Epoch 3/3, Batch 55/80
temp: 0.7897, beta: 0.1000, 
nri_train_loss: 1.1168, enc_train_loss: 3.2514, enc_train_entropy: 0.4222, dec_train_loss: 0.4539, enc_train_edge_accuracy: 0.5417

Edge pred tensor([[0.5428, 0.4572],
        [0.2907, 0.7093],
        [0.0461, 0.9539],
        [0.7930, 0.2070],
        [0.4975, 0.5025],
        [0.2375, 0.7625],
        [0.3987, 0.6013],
        [0.5892, 0.4108],
        [0.0942, 0.9058],
        [0.9786, 0.0214],
        [0.9819, 0.0181],
        [0.9253, 0.0747]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.3509,  0.1792],
        [ 0.0533,  0.9451],
        [-0.7629,  2.2676],
        [ 0.1226, -1.2203],
        [ 0.0555,  0.0655],
        [-0.4357,  0.7307],
        [-0.6852, -0.2743],
        [ 0.2551, -0.1057],
        [-0.8385,  1.4253],
        [ 1.7574, -2.0676],
        [ 2.6810, -1.3118],
        [ 2.1469, -0.3695]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.5178e-01, 2.4822e-01],
        [9.5846e-01, 4.1535e-02],
        [4.7992e-04, 9.9952e-01],
        [9.8261e-01, 1.7393e-02],
        [7.6801e-01, 2.3199e-01],
        [6.5126e-01, 3.4874e-01],
        [3.7787e-02, 9.6221e-01],
        [1.2097e-01, 8.7903e-01],
        [1.2355e-02, 9.8764e-01],
        [9.9927e-01, 7.2939e-04],
        [9.9915e-01, 8.4706e-04],
        [8.1196e-01, 1.8804e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.4924, 0.5076],
        [0.2868, 0.7132],
        [0.0016, 0.9984],
        [0.4041, 0.5959],
        [0.5238, 0.4762],
        [0.0012, 0.9988],
        [0.2502, 0.7498],
        [0.4794, 0.5206],
        [0.0012, 0.9988],
        [0.9757, 0.0243],
        [0.9782, 0.0218],
        [0.9801, 0.0199]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.8496,  0.8799],
        [-0.4828,  0.4281],
        [-2.3872,  4.0789],
        [ 0.1259,  0.5143],
        [ 0.7428,  0.6474],
        [-1.7049,  4.9805],
        [-1.7309, -0.6333],
        [ 0.1127,  0.1951],
        [-3.1111,  3.6127],
        [ 1.7244, -1.9687],
        [ 3.4310, -0.3728],
        [ 2.3625, -1.5331]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[4.4869e-01, 5.5131e-01],
        [3.7817e-01, 6.2183e-01],
        [1.8211e-04, 9.9982e-01],
        [4.2692e-01, 5.7308e-01],
        [7.6522e-02, 9.2348e-01],
        [7.7313e-05, 9.9992e-01],
        [9.6324e-02, 9.0368e-01],
        [1.3218e-02, 9.8678e-01],
        [1.2813e-06, 1.0000e+00],
        [9.9775e-01, 2.2531e-03],
        [9.9601e-01, 3.9933e-03],
        [9.9844e-01, 1.5601e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.2380, 0.7620],
        [0.5119, 0.4881],
        [0.7152, 0.2848],
        [0.4450, 0.5550],
        [0.6110, 0.3890],
        [0.6390, 0.3610],
        [0.5209, 0.4791],
        [0.1196, 0.8804],
        [0.4447, 0.5553],
        [0.9491, 0.0509],
        [0.7410, 0.2590],
        [0.9174, 0.0826]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.0708,  1.2343],
        [ 0.8716,  0.8239],
        [ 1.8483,  0.9272],
        [ 0.9540,  1.1749],
        [ 1.0573,  0.6057],
        [ 0.7070,  0.1359],
        [ 1.0776,  0.9940],
        [-0.8001,  1.1959],
        [ 0.3286,  0.5505],
        [ 2.3007, -0.6248],
        [ 0.1684, -0.8827],
        [ 1.4380, -0.9694]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.9308, 0.0692],
        [0.2844, 0.7156],
        [0.9545, 0.0455],
        [0.5204, 0.4796],
        [0.3357, 0.6643],
        [0.9298, 0.0702],
        [0.8890, 0.1110],
        [0.1905, 0.8095],
        [0.9849, 0.0151],
        [0.9785, 0.0215],
        [0.8117, 0.1883],
        [0.8408, 0.1592]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.6483, 0.3517],
        [0.3737, 0.6263],
        [0.6628, 0.3372],
        [0.5906, 0.4094],
        [0.5270, 0.4730],
        [0.7872, 0.2128],
        [0.3109, 0.6891],
        [0.5622, 0.4378],
        [0.6979, 0.3021],
        [0.9608, 0.0392],
        [0.9837, 0.0163],
        [0.9302, 0.0698]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-1.0674, -1.6788],
        [-0.3892,  0.1271],
        [-0.0087, -0.6844],
        [-0.3491, -0.7154],
        [ 0.1782,  0.0702],
        [ 0.8050, -0.5031],
        [-1.4053, -0.6092],
        [-0.6092, -0.8592],
        [ 0.3489, -0.4882],
        [ 1.0673, -2.1308],
        [ 1.3734, -2.7264],
        [ 1.8673, -0.7230]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.9030, 0.0970],
        [0.2130, 0.7870],
        [0.3459, 0.6541],
        [0.4581, 0.5419],
        [0.0194, 0.9806],
        [0.9916, 0.0084],
        [0.1533, 0.8467],
        [0.0971, 0.9029],
        [0.2391, 0.7609],
        [0.9799, 0.0201],
        [0.7115, 0.2885],
        [0.9871, 0.0129]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.3686, 0.6314],
        [0.4089, 0.5911],
        [0.4612, 0.5388],
        [0.4242, 0.5758],
        [0.4019, 0.5981],
        [0.5613, 0.4387],
        [0.4656, 0.5344],
        [0.3553, 0.6447],
        [0.6785, 0.3215],
        [0.9601, 0.0399],
        [0.9147, 0.0853],
        [0.9636, 0.0364]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.4277,  0.9660],
        [ 0.3228,  0.6914],
        [ 1.4287,  1.5841],
        [ 0.2511,  0.5565],
        [ 0.0405,  0.4382],
        [ 0.9875,  0.7409],
        [ 0.1979,  0.3358],
        [-0.1224,  0.4733],
        [ 1.1839,  0.4370],
        [ 1.6414, -1.5385],
        [ 1.2153, -1.1578],
        [ 1.9565, -1.3199]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.0410, 0.9590],
        [0.8054, 0.1946],
        [0.7788, 0.2212],
        [0.2026, 0.7974],
        [0.7423, 0.2577],
        [0.9830, 0.0170],
        [0.7545, 0.2455],
        [0.3656, 0.6344],
        [0.6671, 0.3329],
        [0.9947, 0.0053],
        [0.8797, 0.1203],
        [0.9121, 0.0879]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 220, Epoch 3/3, Batch 60/80
temp: 0.7857, beta: 0.1000, 
nri_train_loss: 1.0815, enc_train_loss: 2.9474, enc_train_entropy: 0.4475, dec_train_loss: 0.4287, enc_train_edge_accuracy: 0.5083

Edge pred tensor([[0.5670, 0.4330],
        [0.5095, 0.4905],
        [0.0185, 0.9815],
        [0.1225, 0.8775],
        [0.4539, 0.5461],
        [0.0045, 0.9955],
        [0.1991, 0.8009],
        [0.5957, 0.4043],
        [0.0068, 0.9932],
        [0.9464, 0.0536],
        [0.9809, 0.0191],
        [0.9781, 0.0219]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.4894,  0.2196],
        [ 0.3285,  0.2904],
        [-1.2006,  2.7716],
        [-1.5377,  0.4310],
        [-0.0718,  0.1132],
        [-3.1863,  2.2141],
        [-1.1108,  0.2813],
        [ 0.2289, -0.1585],
        [-2.0477,  2.9363],
        [ 2.4313, -0.4394],
        [ 3.1895, -0.7488],
        [ 3.5940, -0.2036]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.8277e-01, 7.1723e-01],
        [8.7695e-02, 9.1231e-01],
        [1.3225e-02, 9.8678e-01],
        [2.7211e-01, 7.2789e-01],
        [2.3656e-02, 9.7634e-01],
        [2.2813e-03, 9.9772e-01],
        [3.6659e-01, 6.3341e-01],
        [1.3276e-01, 8.6724e-01],
        [3.9742e-04, 9.9960e-01],
        [9.8415e-01, 1.5850e-02],
        [9.9103e-01, 8.9738e-03],
        [9.9809e-01, 1.9149e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.2853, 0.7147],
        [0.4080, 0.5920],
        [0.8044, 0.1956],
        [0.5307, 0.4693],
        [0.5894, 0.4106],
        [0.8538, 0.1462],
        [0.3614, 0.6386],
        [0.2835, 0.7165],
        [0.6652, 0.3348],
        [0.9768, 0.0232],
        [0.9750, 0.0250],
        [0.9822, 0.0178]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.6293,  1.5477],
        [ 0.6912,  1.0635],
        [ 0.6596, -0.7547],
        [ 1.0350,  0.9119],
        [ 0.4965,  0.1351],
        [ 0.5531, -1.2120],
        [ 1.3460,  1.9155],
        [ 0.8822,  1.8092],
        [ 0.5841, -0.1027],
        [ 2.6942, -1.0454],
        [ 2.4168, -1.2476],
        [ 2.4763, -1.5360]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[3.5196e-02, 9.6480e-01],
        [8.9619e-01, 1.0381e-01],
        [7.8204e-01, 2.1796e-01],
        [5.1413e-01, 4.8587e-01],
        [4.8484e-01, 5.1516e-01],
        [6.9833e-01, 3.0167e-01],
        [8.4065e-02, 9.1594e-01],
        [9.5293e-02, 9.0471e-01],
        [6.4126e-01, 3.5874e-01],
        [9.3187e-01, 6.8127e-02],
        [9.9950e-01, 4.9524e-04],
        [9.9927e-01, 7.2911e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.5310, 0.4690],
        [0.2575, 0.7425],
        [0.0026, 0.9974],
        [0.2598, 0.7402],
        [0.3798, 0.6202],
        [0.0027, 0.9973],
        [0.3982, 0.6018],
        [0.6880, 0.3120],
        [0.0013, 0.9987],
        [0.9195, 0.0805],
        [0.9401, 0.0599],
        [0.8509, 0.1491]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.1742,  0.0501],
        [-0.4258,  0.6334],
        [-2.6387,  3.3096],
        [-1.0255,  0.0218],
        [ 0.4353,  0.9257],
        [-2.1083,  3.7929],
        [-1.3170, -0.9042],
        [ 0.2270, -0.5637],
        [-3.2262,  3.4280],
        [ 0.8877, -1.5472],
        [ 2.0079, -0.7459],
        [ 1.3476, -0.3944]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.2253e-01, 4.7747e-01],
        [2.6699e-01, 7.3301e-01],
        [4.1215e-04, 9.9959e-01],
        [1.2876e-04, 9.9987e-01],
        [2.2731e-01, 7.7269e-01],
        [2.6656e-04, 9.9973e-01],
        [6.3918e-02, 9.3608e-01],
        [9.9444e-01, 5.5568e-03],
        [2.5128e-04, 9.9975e-01],
        [9.9965e-01, 3.5112e-04],
        [9.9307e-01, 6.9278e-03],
        [7.0008e-01, 2.9992e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.4841, 0.5159],
        [0.4126, 0.5874],
        [0.7501, 0.2499],
        [0.5636, 0.4364],
        [0.3389, 0.6611],
        [0.6444, 0.3556],
        [0.4094, 0.5906],
        [0.2233, 0.7767],
        [0.5415, 0.4585],
        [0.9344, 0.0656],
        [0.8935, 0.1065],
        [0.8997, 0.1003]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-5.4054e-01, -4.7695e-01],
        [ 2.1681e-01,  5.7006e-01],
        [ 6.4800e-02, -1.0345e+00],
        [-2.4789e-02, -2.8072e-01],
        [-6.6958e-01, -1.5801e-03],
        [-4.5827e-01, -1.0528e+00],
        [-2.8234e-02,  3.3828e-01],
        [-6.2537e-01,  6.2109e-01],
        [-3.8012e-01, -5.4666e-01],
        [ 1.4436e+00, -1.2132e+00],
        [ 3.7707e-01, -1.7503e+00],
        [ 1.3289e+00, -8.6505e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.5094, 0.4906],
        [0.0261, 0.9739],
        [0.8312, 0.1688],
        [0.0428, 0.9572],
        [0.9403, 0.0597],
        [0.9057, 0.0943],
        [0.9341, 0.0659],
        [0.0187, 0.9813],
        [0.5158, 0.4842],
        [0.9947, 0.0053],
        [0.7080, 0.2920],
        [0.8786, 0.1214]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.4837, 0.5163],
        [0.4486, 0.5514],
        [0.0092, 0.9908],
        [0.5087, 0.4913],
        [0.6901, 0.3099],
        [0.0050, 0.9950],
        [0.4837, 0.5163],
        [0.4980, 0.5020],
        [0.0046, 0.9954],
        [0.9819, 0.0181],
        [0.9661, 0.0339],
        [0.9675, 0.0325]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.4744,  0.5397],
        [-0.0782,  0.1283],
        [-1.8939,  2.7825],
        [ 0.5863,  0.5516],
        [ 1.3441,  0.5435],
        [-1.1130,  4.1808],
        [ 0.2422,  0.3073],
        [ 0.5370,  0.5449],
        [-1.6965,  3.6905],
        [ 2.3400, -1.6515],
        [ 1.9167, -1.4322],
        [ 1.9994, -1.3955]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[2.4294e-01, 7.5706e-01],
        [1.9266e-01, 8.0734e-01],
        [6.1462e-04, 9.9939e-01],
        [5.7434e-03, 9.9426e-01],
        [9.9542e-01, 4.5754e-03],
        [2.7852e-03, 9.9721e-01],
        [9.7376e-01, 2.6243e-02],
        [1.3582e-01, 8.6418e-01],
        [3.7541e-05, 9.9996e-01],
        [9.9714e-01, 2.8596e-03],
        [9.9684e-01, 3.1560e-03],
        [9.0590e-02, 9.0941e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 225, Epoch 3/3, Batch 65/80
temp: 0.7818, beta: 0.1000, 
nri_train_loss: 1.0185, enc_train_loss: 2.3203, enc_train_entropy: 0.4998, dec_train_loss: 0.3867, enc_train_edge_accuracy: 0.5500

Edge pred tensor([[0.3800, 0.6200],
        [0.4528, 0.5472],
        [0.1053, 0.8947],
        [0.4821, 0.5179],
        [0.6253, 0.3747],
        [0.0675, 0.9325],
        [0.5790, 0.4210],
        [0.6973, 0.3027],
        [0.1183, 0.8817],
        [0.9511, 0.0489],
        [0.9741, 0.0259],
        [0.9536, 0.0464]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.5846,  1.0741],
        [-0.0465,  0.1430],
        [-0.2101,  1.9293],
        [ 0.5372,  0.6086],
        [ 0.8222,  0.3099],
        [-0.6441,  1.9821],
        [ 0.2457, -0.0729],
        [ 1.0492,  0.2147],
        [-0.6011,  1.4073],
        [ 2.8847, -0.0836],
        [ 3.7862,  0.1600],
        [ 2.8933, -0.1293]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.8768, 0.1232],
        [0.3674, 0.6326],
        [0.0375, 0.9625],
        [0.3650, 0.6350],
        [0.8722, 0.1278],
        [0.0341, 0.9659],
        [0.4040, 0.5960],
        [0.5797, 0.4203],
        [0.0092, 0.9908],
        [0.1511, 0.8489],
        [0.9941, 0.0059],
        [0.9774, 0.0226]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.5526, 0.4474],
        [0.7735, 0.2265],
        [0.0376, 0.9624],
        [0.4744, 0.5256],
        [0.6868, 0.3132],
        [0.0206, 0.9794],
        [0.3445, 0.6555],
        [0.3912, 0.6088],
        [0.0029, 0.9971],
        [0.9607, 0.0393],
        [0.9682, 0.0318],
        [0.9487, 0.0513]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.6840,  0.4727],
        [ 1.8663,  0.6384],
        [-0.6684,  2.5747],
        [-0.3799, -0.2776],
        [ 0.7619, -0.0231],
        [-2.1079,  1.7556],
        [-0.9681, -0.3246],
        [-0.5667, -0.1242],
        [-2.9496,  2.8831],
        [ 0.9606, -2.2357],
        [ 1.5921, -1.8255],
        [ 1.8363, -1.0812]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[5.6251e-01, 4.3749e-01],
        [8.9798e-01, 1.0202e-01],
        [6.8109e-03, 9.9319e-01],
        [9.7487e-03, 9.9025e-01],
        [1.4175e-01, 8.5825e-01],
        [7.5074e-03, 9.9249e-01],
        [9.1877e-01, 8.1232e-02],
        [1.1976e-01, 8.8024e-01],
        [4.1233e-02, 9.5877e-01],
        [8.9783e-01, 1.0217e-01],
        [9.9940e-01, 6.0108e-04],
        [9.5428e-01, 4.5717e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.5960, 0.4040],
        [0.5639, 0.4361],
        [0.7061, 0.2939],
        [0.3628, 0.6372],
        [0.1833, 0.8167],
        [0.4978, 0.5022],
        [0.3586, 0.6414],
        [0.4464, 0.5536],
        [0.4311, 0.5689],
        [0.8811, 0.1189],
        [0.9387, 0.0613],
        [0.9585, 0.0415]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.7503,  1.3613],
        [ 0.9768,  0.7197],
        [ 0.6062, -0.2703],
        [ 0.4524,  1.0157],
        [-0.9690,  0.5253],
        [-0.2338, -0.2250],
        [ 0.2150,  0.7964],
        [ 0.2752,  0.4906],
        [-0.6030, -0.3258],
        [ 1.2855, -0.7178],
        [ 1.3174, -1.4115],
        [ 1.3172, -1.8223]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.4761, 0.5239],
        [0.7705, 0.2295],
        [0.9868, 0.0132],
        [0.5385, 0.4615],
        [0.0060, 0.9940],
        [0.1044, 0.8956],
        [0.2237, 0.7763],
        [0.9609, 0.0391],
        [0.8426, 0.1574],
        [0.9147, 0.0853],
        [0.9834, 0.0166],
        [0.9553, 0.0447]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.4638, 0.5362],
        [0.3904, 0.6096],
        [0.4143, 0.5857],
        [0.4771, 0.5229],
        [0.2146, 0.7854],
        [0.2229, 0.7771],
        [0.6256, 0.3744],
        [0.2889, 0.7111],
        [0.2816, 0.7184],
        [0.9797, 0.0203],
        [0.9306, 0.0694],
        [0.8732, 0.1268]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.6890,  0.8342],
        [ 0.0964,  0.5421],
        [ 0.1811,  0.5274],
        [ 1.0277,  1.1195],
        [ 0.2329,  1.5301],
        [ 0.0132,  1.2620],
        [ 1.2080,  0.6945],
        [ 0.3236,  1.2244],
        [-0.0362,  0.9006],
        [ 2.4600, -1.4148],
        [ 2.0816, -0.5150],
        [ 1.2124, -0.7174]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.0377, 0.9623],
        [0.5017, 0.4983],
        [0.0929, 0.9071],
        [0.8584, 0.1416],
        [0.2470, 0.7530],
        [0.5804, 0.4196],
        [0.9902, 0.0098],
        [0.1029, 0.8971],
        [0.4077, 0.5923],
        [0.9978, 0.0022],
        [0.2947, 0.7053],
        [0.9918, 0.0082]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.5124, 0.4876],
        [0.6828, 0.3172],
        [0.1801, 0.8199],
        [0.5684, 0.4316],
        [0.8345, 0.1655],
        [0.3555, 0.6445],
        [0.2785, 0.7215],
        [0.3815, 0.6185],
        [0.1321, 0.8679],
        [0.9705, 0.0295],
        [0.9564, 0.0436],
        [0.9838, 0.0162]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.2163,  0.1667],
        [ 1.5377,  0.7710],
        [ 0.6226,  2.1380],
        [ 1.2019,  0.9266],
        [ 1.9248,  0.3070],
        [ 1.5684,  2.1633],
        [ 0.3120,  1.2638],
        [ 0.5173,  1.0006],
        [ 0.8891,  2.7720],
        [ 2.4666, -1.0271],
        [ 1.2234, -1.8641],
        [ 2.9425, -1.1633]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[9.8879e-01, 1.1210e-02],
        [9.9932e-01, 6.8317e-04],
        [3.8499e-03, 9.9615e-01],
        [9.0073e-01, 9.9274e-02],
        [9.9490e-01, 5.1046e-03],
        [1.5659e-01, 8.4341e-01],
        [5.0234e-01, 4.9766e-01],
        [3.1731e-02, 9.6827e-01],
        [3.9333e-02, 9.6067e-01],
        [8.0428e-01, 1.9572e-01],
        [9.2558e-01, 7.4419e-02],
        [9.9758e-01, 2.4213e-03]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 230, Epoch 3/3, Batch 70/80
temp: 0.7779, beta: 0.1000, 
nri_train_loss: 0.9847, enc_train_loss: 1.8355, enc_train_entropy: 0.5402, dec_train_loss: 0.3690, enc_train_edge_accuracy: 0.5383

Edge pred tensor([[0.4181, 0.5819],
        [0.4732, 0.5268],
        [0.8914, 0.1086],
        [0.4519, 0.5481],
        [0.3188, 0.6812],
        [0.8052, 0.1948],
        [0.4684, 0.5316],
        [0.4165, 0.5835],
        [0.7009, 0.2991],
        [0.8203, 0.1797],
        [0.7532, 0.2468],
        [0.5995, 0.4005]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.7604, -0.4299],
        [ 0.1285,  0.2357],
        [ 1.1650, -0.9403],
        [-0.3781, -0.1850],
        [ 0.2658,  1.0253],
        [ 1.1380, -0.2814],
        [ 0.2441,  0.3708],
        [ 0.2869,  0.6239],
        [ 1.3977,  0.5460],
        [ 0.4433, -1.0749],
        [ 0.4926, -0.6230],
        [ 0.8057,  0.4024]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[8.7773e-01, 1.2227e-01],
        [1.2658e-01, 8.7342e-01],
        [8.3480e-01, 1.6520e-01],
        [8.3296e-02, 9.1670e-01],
        [1.9871e-02, 9.8013e-01],
        [9.9994e-01, 6.4022e-05],
        [8.6112e-01, 1.3888e-01],
        [6.6263e-01, 3.3737e-01],
        [9.9254e-01, 7.4566e-03],
        [8.2438e-01, 1.7562e-01],
        [8.3541e-01, 1.6459e-01],
        [8.7656e-01, 1.2344e-01]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.5475, 0.4525],
        [0.6678, 0.3322],
        [0.7002, 0.2998],
        [0.3868, 0.6132],
        [0.4502, 0.5498],
        [0.3744, 0.6256],
        [0.5042, 0.4958],
        [0.6245, 0.3755],
        [0.5330, 0.4670],
        [0.9325, 0.0675],
        [0.9485, 0.0515],
        [0.9694, 0.0306]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.3936,  1.2029],
        [ 1.1106,  0.4122],
        [ 1.6275,  0.7792],
        [-0.3798,  0.0812],
        [ 0.0370,  0.2368],
        [-0.2073,  0.3060],
        [-0.2281, -0.2448],
        [ 0.2631, -0.2454],
        [ 0.5390,  0.4066],
        [ 2.1140, -0.5119],
        [ 2.3966, -0.5170],
        [ 3.0199, -0.4345]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.5380, 0.4620],
        [0.9881, 0.0119],
        [0.6116, 0.3884],
        [0.0333, 0.9667],
        [0.8886, 0.1114],
        [0.6883, 0.3117],
        [0.9930, 0.0070],
        [0.9260, 0.0740],
        [0.9543, 0.0457],
        [0.7547, 0.2453],
        [0.9263, 0.0737],
        [0.9686, 0.0314]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.5884, 0.4116],
        [0.5234, 0.4766],
        [0.1565, 0.8435],
        [0.2784, 0.7216],
        [0.4838, 0.5162],
        [0.0385, 0.9615],
        [0.5068, 0.4932],
        [0.6522, 0.3478],
        [0.0872, 0.9128],
        [0.1643, 0.8357],
        [0.4268, 0.5732],
        [0.5724, 0.4276]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.9586,  0.6014],
        [-0.2502, -0.3437],
        [-0.4545,  1.2299],
        [-0.2952,  0.6572],
        [-0.3717, -0.3068],
        [-1.3706,  1.8470],
        [-0.3939, -0.4212],
        [ 0.3446, -0.2841],
        [-1.3434,  1.0050],
        [ 0.2346,  1.8612],
        [ 1.2170,  1.5119],
        [ 0.7030,  0.4115]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[7.7733e-01, 2.2267e-01],
        [7.9369e-01, 2.0631e-01],
        [6.2831e-04, 9.9937e-01],
        [8.2898e-01, 1.7102e-01],
        [4.3048e-01, 5.6953e-01],
        [1.5727e-02, 9.8427e-01],
        [5.3640e-01, 4.6360e-01],
        [3.8850e-01, 6.1150e-01],
        [2.0707e-02, 9.7929e-01],
        [5.4696e-03, 9.9453e-01],
        [1.9467e-01, 8.0533e-01],
        [9.1794e-01, 8.2058e-02]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.6589, 0.3411],
        [0.4833, 0.5167],
        [0.7991, 0.2009],
        [0.4338, 0.5662],
        [0.4004, 0.5996],
        [0.4698, 0.5302],
        [0.4586, 0.5414],
        [0.5640, 0.4360],
        [0.4274, 0.5726],
        [0.9251, 0.0749],
        [0.9233, 0.0767],
        [0.9403, 0.0597]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 1.5024,  0.8438],
        [ 1.2213,  1.2880],
        [ 1.9543,  0.5735],
        [ 0.1190,  0.3853],
        [ 0.6854,  1.0890],
        [ 0.6107,  0.7315],
        [-0.2349, -0.0688],
        [ 0.1404, -0.1171],
        [ 0.1468,  0.4393],
        [ 1.4506, -1.0625],
        [ 1.6282, -0.8594],
        [ 2.2443, -0.5120]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.9705, 0.0295],
        [0.4279, 0.5721],
        [0.7367, 0.2633],
        [0.9684, 0.0316],
        [0.9851, 0.0149],
        [0.9633, 0.0367],
        [0.5693, 0.4307],
        [0.9148, 0.0852],
        [0.3086, 0.6914],
        [0.9901, 0.0099],
        [0.9959, 0.0041],
        [0.9987, 0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.3277, 0.6723],
        [0.2803, 0.7197],
        [0.6617, 0.3383],
        [0.4074, 0.5926],
        [0.3921, 0.6079],
        [0.6372, 0.3628],
        [0.3790, 0.6210],
        [0.5507, 0.4493],
        [0.6598, 0.3402],
        [0.7377, 0.2623],
        [0.7637, 0.2363],
        [0.6591, 0.3409]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.4904,  1.2090],
        [-0.0893,  0.8538],
        [ 1.2314,  0.5606],
        [ 0.8855,  1.2602],
        [ 0.4528,  0.8915],
        [ 1.0198,  0.4568],
        [ 0.4323,  0.9260],
        [ 0.5461,  0.3428],
        [ 0.8197,  0.1572],
        [ 1.1563,  0.1223],
        [ 1.1217, -0.0516],
        [ 0.6611,  0.0018]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.1324, 0.8676],
        [0.1214, 0.8786],
        [0.9592, 0.0408],
        [0.8931, 0.1069],
        [0.0400, 0.9600],
        [0.7591, 0.2409],
        [0.0416, 0.9584],
        [0.6547, 0.3453],
        [0.2053, 0.7947],
        [0.9916, 0.0084],
        [0.3586, 0.6414],
        [0.9962, 0.0038]], device='cuda:0', grad_fn=<SliceBackward0>)
Step 235, Epoch 3/3, Batch 75/80
temp: 0.7740, beta: 0.1000, 
nri_train_loss: 0.9452, enc_train_loss: 1.3013, enc_train_entropy: 0.5847, dec_train_loss: 0.3473, enc_train_edge_accuracy: 0.5400

Edge pred tensor([[0.3774, 0.6226],
        [0.3638, 0.6362],
        [0.7580, 0.2420],
        [0.5048, 0.4952],
        [0.3331, 0.6669],
        [0.8190, 0.1810],
        [0.7188, 0.2812],
        [0.7027, 0.2973],
        [0.8283, 0.1717],
        [0.8082, 0.1918],
        [0.8163, 0.1837],
        [0.5092, 0.4908]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.0758,  0.5766],
        [-0.0666,  0.4923],
        [ 0.8994, -0.2423],
        [ 1.9707,  1.9515],
        [ 0.8341,  1.5285],
        [ 1.7687,  0.2593],
        [ 2.4239,  1.4856],
        [ 2.1051,  1.2448],
        [ 2.1983,  0.6248],
        [ 2.5527,  1.1140],
        [ 2.2148,  0.7235],
        [ 1.0079,  0.9712]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.9669, 0.0331],
        [0.1924, 0.8076],
        [0.9422, 0.0578],
        [0.3149, 0.6851],
        [0.3289, 0.6711],
        [0.9532, 0.0468],
        [0.9347, 0.0653],
        [0.9936, 0.0064],
        [0.9902, 0.0098],
        [0.9937, 0.0063],
        [0.8870, 0.1130],
        [0.8727, 0.1273]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.4283, 0.5717],
        [0.1947, 0.8053],
        [0.5696, 0.4304],
        [0.5317, 0.4683],
        [0.3223, 0.6777],
        [0.3971, 0.6029],
        [0.6093, 0.3907],
        [0.6248, 0.3752],
        [0.4517, 0.5483],
        [0.9280, 0.0720],
        [0.8934, 0.1066],
        [0.8358, 0.1642]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[ 0.4105,  0.6991],
        [ 0.0336,  1.4533],
        [ 1.7113,  1.4312],
        [ 0.1448,  0.0180],
        [ 0.3007,  1.0438],
        [ 0.6694,  1.0869],
        [-0.4906, -0.9350],
        [-0.2851, -0.7950],
        [-0.0945,  0.0991],
        [ 1.1241, -1.4330],
        [ 1.1583, -0.9678],
        [ 1.3939, -0.2332]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.1952, 0.8048],
        [0.4096, 0.5904],
        [0.4103, 0.5897],
        [0.2580, 0.7420],
        [0.0961, 0.9039],
        [0.7909, 0.2091],
        [0.9882, 0.0118],
        [0.5583, 0.4417],
        [0.0340, 0.9660],
        [0.9890, 0.0110],
        [0.8225, 0.1775],
        [0.9512, 0.0488]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.5968, 0.4032],
        [0.7632, 0.2368],
        [0.6366, 0.3634],
        [0.7273, 0.2727],
        [0.6577, 0.3423],
        [0.5429, 0.4571],
        [0.5650, 0.4350],
        [0.6144, 0.3856],
        [0.4332, 0.5668],
        [0.5511, 0.4489],
        [0.5131, 0.4869],
        [0.5928, 0.4072]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.5378, -0.9298],
        [ 0.2420, -0.9282],
        [ 0.2380, -0.3229],
        [ 0.6778, -0.3032],
        [ 0.1891, -0.4640],
        [ 0.1742,  0.0020],
        [ 0.1431, -0.1186],
        [-0.5679, -1.0339],
        [-0.4856, -0.2167],
        [ 0.6706,  0.4655],
        [-0.4809, -0.5334],
        [ 0.2081, -0.1673]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.8493, 0.1507],
        [0.6597, 0.3403],
        [0.5080, 0.4920],
        [0.9919, 0.0081],
        [0.4597, 0.5403],
        [0.5383, 0.4617],
        [0.1338, 0.8662],
        [0.0629, 0.9371],
        [0.9196, 0.0804],
        [0.1476, 0.8524],
        [0.9951, 0.0049],
        [0.6396, 0.3604]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.1763, 0.8237],
        [0.1724, 0.8276],
        [0.5787, 0.4213],
        [0.4360, 0.5640],
        [0.2130, 0.7870],
        [0.6513, 0.3487],
        [0.3733, 0.6267],
        [0.3548, 0.6452],
        [0.3704, 0.6296],
        [0.4757, 0.5243],
        [0.3811, 0.6189],
        [0.3704, 0.6296]], device='cuda:0', grad_fn=<SliceBackward0>)
logits tensor([[-0.0578,  1.4841],
        [-0.6542,  0.9147],
        [ 0.3252,  0.0078],
        [-0.4551, -0.1977],
        [-0.8642,  0.4427],
        [-0.2439, -0.8686],
        [-1.0781, -0.5602],
        [-0.3432,  0.2548],
        [-0.8864, -0.3557],
        [-0.2642, -0.1668],
        [ 0.2694,  0.7542],
        [-0.2728,  0.2579]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge matrix from gumble tensor([[0.3397, 0.6603],
        [0.2115, 0.7885],
        [0.7286, 0.2714],
        [0.1948, 0.8052],
        [0.1778, 0.8222],
        [0.7440, 0.2560],
        [0.9130, 0.0870],
        [0.2631, 0.7369],
        [0.8517, 0.1483],
        [0.9741, 0.0259],
        [0.6113, 0.3887],
        [0.0224, 0.9776]], device='cuda:0', grad_fn=<SliceBackward0>)
Edge pred tensor([[0.4296, 0.5704],
        [0.4773, 0.5227],
        [0.1792, 0.8208],
        [0.6015, 0.3985],
        [0.6138, 0.3862],
        [0.4428, 0.5572],
        [0.6007, 0.3993],
        [0.6014, 0.3986],
        [0.3655, 0.6345],
        [0.5156, 0.4844],
        [0.2499, 0.7501],
        [0.2487, 0.7513]], device='cuda:0')
logits tensor([[-0.1324,  0.1511],
        [-0.1533, -0.0622],
        [-0.7641,  0.7577],
        [ 0.8237,  0.4118],
        [ 0.2238, -0.2397],
        [ 0.6140,  0.8439],
        [ 0.7991,  0.3908],
        [ 0.7831,  0.3717],
        [ 0.6802,  1.2317],
        [ 1.7807,  1.7184],
        [ 1.2061,  2.3051],
        [ 0.4242,  1.5298]], device='cuda:0')
Edge matrix from gumble tensor([[0.9155, 0.0845],
        [0.0416, 0.9584],
        [0.0107, 0.9893],
        [0.1996, 0.8004],
        [0.2980, 0.7020],
        [0.7835, 0.2165],
        [0.3889, 0.6111],
        [0.7687, 0.2313],
        [0.0039, 0.9961],
        [0.1788, 0.8212],
        [0.0716, 0.9284],
        [0.9064, 0.0936]], device='cuda:0')
Edge pred tensor([[0.3686, 0.6314],
        [0.3327, 0.6673],
        [0.6680, 0.3320],
        [0.6744, 0.3256],
        [0.6726, 0.3274],
        [0.7153, 0.2847],
        [0.6066, 0.3934],
        [0.5738, 0.4262],
        [0.6087, 0.3913],
        [0.7107, 0.2893],
        [0.6585, 0.3415],
        [0.6982, 0.3018]], device='cuda:0')
logits tensor([[ 1.5072,  2.0454],
        [ 1.0928,  1.7888],
        [ 1.0190,  0.3199],
        [ 1.4773,  0.7493],
        [ 1.0594,  0.3396],
        [ 0.5453, -0.3761],
        [ 1.1511,  0.7181],
        [ 0.7338,  0.4364],
        [ 0.2759, -0.1661],
        [ 1.1555,  0.2569],
        [ 1.1111,  0.4546],
        [ 0.9019,  0.0633]], device='cuda:0')
Edge matrix from gumble tensor([[0.2600, 0.7400],
        [0.1408, 0.8592],
        [0.7758, 0.2242],
        [0.9874, 0.0126],
        [0.8685, 0.1315],
        [0.3194, 0.6806],
        [0.6344, 0.3656],
        [0.8440, 0.1560],
        [0.0108, 0.9892],
        [0.6379, 0.3621],
        [0.5878, 0.4122],
        [0.6503, 0.3497]], device='cuda:0')
Edge pred tensor([[0.4855, 0.5145],
        [0.3818, 0.6182],
        [0.3046, 0.6954],
        [0.6216, 0.3784],
        [0.4687, 0.5313],
        [0.5879, 0.4121],
        [0.5158, 0.4842],
        [0.4996, 0.5004],
        [0.4038, 0.5962],
        [0.1755, 0.8245],
        [0.1547, 0.8453],
        [0.1144, 0.8856]], device='cuda:0')
logits tensor([[-0.8302, -0.7720],
        [-1.2458, -0.7638],
        [-0.9942, -0.1686],
        [ 0.3628, -0.1335],
        [-0.4696, -0.3444],
        [-0.0534, -0.4087],
        [ 0.4146,  0.3516],
        [-0.3194, -0.3178],
        [ 0.0321,  0.4217],
        [ 1.0294,  2.5765],
        [-0.0322,  1.6659],
        [-0.0058,  2.0404]], device='cuda:0')
Edge matrix from gumble tensor([[7.7921e-01, 2.2079e-01],
        [5.9898e-04, 9.9940e-01],
        [1.9529e-01, 8.0471e-01],
        [6.0644e-01, 3.9356e-01],
        [3.4663e-03, 9.9653e-01],
        [3.7723e-01, 6.2277e-01],
        [9.8325e-02, 9.0167e-01],
        [7.0185e-02, 9.2981e-01],
        [4.9505e-02, 9.5050e-01],
        [1.8614e-01, 8.1386e-01],
        [6.1924e-02, 9.3808e-01],
        [4.6689e-01, 5.3311e-01]], device='cuda:0')
Edge pred tensor([[0.6927, 0.3073],
        [0.4775, 0.5225],
        [0.8701, 0.1299],
        [0.3639, 0.6361],
        [0.2099, 0.7901],
        [0.8389, 0.1611],
        [0.6864, 0.3136],
        [0.5974, 0.4026],
        [0.8312, 0.1688],
        [0.7180, 0.2820],
        [0.6220, 0.3780],
        [0.4962, 0.5038]], device='cuda:0')
logits tensor([[ 1.3028,  0.4898],
        [ 0.6014,  0.6916],
        [ 1.2770, -0.6247],
        [ 0.0962,  0.6547],
        [ 0.0296,  1.3553],
        [ 1.3489, -0.3014],
        [ 1.2189,  0.4356],
        [ 1.5618,  1.1670],
        [ 1.9563,  0.3622],
        [ 0.9840,  0.0493],
        [ 1.5776,  1.0796],
        [ 1.1857,  1.2010]], device='cuda:0')
Edge matrix from gumble tensor([[0.8847, 0.1153],
        [0.2474, 0.7526],
        [0.4593, 0.5407],
        [0.0050, 0.9950],
        [0.0275, 0.9725],
        [0.9487, 0.0513],
        [0.4899, 0.5101],
        [0.4658, 0.5342],
        [0.9347, 0.0653],
        [0.9878, 0.0122],
        [0.9799, 0.0201],
        [0.4105, 0.5895]], device='cuda:0')
Edge pred tensor([[0.3082, 0.6918],
        [0.3897, 0.6103],
        [0.3270, 0.6730],
        [0.4693, 0.5307],
        [0.4554, 0.5446],
        [0.6469, 0.3531],
        [0.6583, 0.3417],
        [0.5147, 0.4853],
        [0.4408, 0.5592],
        [0.8650, 0.1350],
        [0.6526, 0.3474],
        [0.5730, 0.4270]], device='cuda:0')
logits tensor([[-0.3750,  0.4333],
        [ 0.2090,  0.6577],
        [-0.2494,  0.4725],
        [ 0.2714,  0.3942],
        [ 0.7520,  0.9308],
        [ 1.1753,  0.5700],
        [ 0.8428,  0.1871],
        [ 1.1326,  1.0737],
        [ 1.0658,  1.3038],
        [ 0.5587, -1.2990],
        [ 0.2497, -0.3808],
        [ 0.2113, -0.0827]], device='cuda:0')
Edge matrix from gumble tensor([[0.1622, 0.8378],
        [0.4590, 0.5410],
        [0.0766, 0.9234],
        [0.5920, 0.4080],
        [0.0311, 0.9689],
        [0.4471, 0.5529],
        [0.8717, 0.1283],
        [0.0627, 0.9373],
        [0.1574, 0.8426],
        [0.9951, 0.0049],
        [0.2676, 0.7324],
        [0.1172, 0.8828]], device='cuda:0')
Edge pred tensor([[0.3376, 0.6624],
        [0.6134, 0.3866],
        [0.3028, 0.6972],
        [0.6260, 0.3740],
        [0.4235, 0.5765],
        [0.1180, 0.8820],
        [0.6504, 0.3496],
        [0.5920, 0.4080],
        [0.1947, 0.8053],
        [0.5487, 0.4513],
        [0.2887, 0.7113],
        [0.4466, 0.5534]], device='cuda:0')
logits tensor([[ 0.4675,  1.1413],
        [ 0.9539,  0.4921],
        [ 0.1738,  1.0079],
        [-0.0639, -0.5790],
        [-0.1552,  0.1532],
        [-1.3118,  0.7000],
        [-0.6396, -1.2605],
        [ 0.2968, -0.0753],
        [-1.2145,  0.2050],
        [ 0.3968,  0.2013],
        [ 0.2920,  1.1936],
        [ 0.7439,  0.9584]], device='cuda:0')
Edge matrix from gumble tensor([[0.8391, 0.1609],
        [0.7017, 0.2983],
        [0.3952, 0.6048],
        [0.7737, 0.2263],
        [0.0771, 0.9229],
        [0.0850, 0.9150],
        [0.9149, 0.0851],
        [0.5392, 0.4608],
        [0.1086, 0.8914],
        [0.0079, 0.9921],
        [0.7785, 0.2215],
        [0.4507, 0.5493]], device='cuda:0')
Edge pred tensor([[0.5357, 0.4643],
        [0.3891, 0.6109],
        [0.3500, 0.6500],
        [0.4611, 0.5389],
        [0.5103, 0.4897],
        [0.2372, 0.7628],
        [0.4266, 0.5734],
        [0.7772, 0.2228],
        [0.3581, 0.6419],
        [0.0984, 0.9016],
        [0.3097, 0.6903],
        [0.1848, 0.8152]], device='cuda:0')
logits tensor([[ 0.4265,  0.2836],
        [-1.0069, -0.5557],
        [-0.8244, -0.2052],
        [-0.5800, -0.4239],
        [-0.6106, -0.6519],
        [-1.1292,  0.0389],
        [-0.7213, -0.4255],
        [ 1.4195,  0.1698],
        [-0.6215, -0.0379],
        [ 0.0930,  2.3076],
        [ 2.0699,  2.8712],
        [ 0.2298,  1.7136]], device='cuda:0')
Edge matrix from gumble tensor([[0.5564, 0.4436],
        [0.4262, 0.5738],
        [0.0797, 0.9203],
        [0.8419, 0.1581],
        [0.9823, 0.0177],
        [0.0298, 0.9702],
        [0.1357, 0.8643],
        [0.9685, 0.0315],
        [0.5622, 0.4378],
        [0.0020, 0.9980],
        [0.4771, 0.5229],
        [0.1557, 0.8443]], device='cuda:0')
Edge pred tensor([[0.5548, 0.4452],
        [0.4531, 0.5469],
        [0.3352, 0.6648],
        [0.7295, 0.2705],
        [0.4616, 0.5384],
        [0.3782, 0.6218],
        [0.7885, 0.2115],
        [0.6800, 0.3200],
        [0.4148, 0.5852],
        [0.4496, 0.5504],
        [0.2507, 0.7493],
        [0.1643, 0.8357]], device='cuda:0')
logits tensor([[ 0.1314, -0.0887],
        [-1.1231, -0.9350],
        [-0.5835,  0.1014],
        [ 1.2212,  0.2290],
        [-0.4742, -0.3201],
        [ 0.0167,  0.5138],
        [ 2.0101,  0.6940],
        [ 1.4794,  0.7255],
        [ 0.9902,  1.3344],
        [ 2.1831,  2.3854],
        [ 1.5454,  2.6401],
        [ 0.5064,  2.1332]], device='cuda:0')
Edge matrix from gumble tensor([[6.4794e-02, 9.3521e-01],
        [3.2736e-01, 6.7264e-01],
        [4.8257e-02, 9.5174e-01],
        [9.9902e-01, 9.7646e-04],
        [3.3279e-01, 6.6721e-01],
        [1.6976e-01, 8.3024e-01],
        [9.8683e-01, 1.3172e-02],
        [9.7600e-01, 2.4003e-02],
        [3.2818e-01, 6.7182e-01],
        [7.2168e-01, 2.7832e-01],
        [6.2620e-01, 3.7380e-01],
        [2.0393e-02, 9.7961e-01]], device='cuda:0')
Edge pred tensor([[0.6804, 0.3196],
        [0.4916, 0.5084],
        [0.3540, 0.6460],
        [0.4979, 0.5021],
        [0.6640, 0.3360],
        [0.5809, 0.4191],
        [0.5423, 0.4577],
        [0.7423, 0.2577],
        [0.5298, 0.4702],
        [0.2490, 0.7510],
        [0.4285, 0.5715],
        [0.3595, 0.6405]], device='cuda:0')
logits tensor([[ 0.7714,  0.0158],
        [-0.6310, -0.5973],
        [ 0.3395,  0.9410],
        [ 0.7357,  0.7442],
        [ 0.4335, -0.2478],
        [ 1.5563,  1.2300],
        [ 0.2930,  0.1233],
        [ 0.9524, -0.1057],
        [ 0.9275,  0.8080],
        [ 0.3916,  1.4957],
        [ 0.5371,  0.8252],
        [-0.0984,  0.4793]], device='cuda:0')
Edge matrix from gumble tensor([[0.6551, 0.3449],
        [0.5808, 0.4192],
        [0.5497, 0.4503],
        [0.0518, 0.9482],
        [0.3183, 0.6817],
        [0.7152, 0.2848],
        [0.2541, 0.7459],
        [0.9284, 0.0716],
        [0.8858, 0.1142],
        [0.7385, 0.2615],
        [0.7539, 0.2461],
        [0.8794, 0.1206]], device='cuda:0')
Edge pred tensor([[0.6772, 0.3228],
        [0.4377, 0.5623],
        [0.7779, 0.2221],
        [0.6984, 0.3016],
        [0.4054, 0.5946],
        [0.7681, 0.2319],
        [0.6376, 0.3624],
        [0.5652, 0.4348],
        [0.7404, 0.2596],
        [0.6696, 0.3304],
        [0.4527, 0.5473],
        [0.1423, 0.8577]], device='cuda:0')
logits tensor([[-0.3552, -1.0961],
        [-0.8203, -0.5699],
        [ 0.5880, -0.6653],
        [ 0.4013, -0.4384],
        [ 0.2531,  0.6360],
        [ 1.4366,  0.2390],
        [-0.9781, -1.5431],
        [-0.9764, -1.2387],
        [ 0.6019, -0.4464],
        [ 0.2707, -0.4356],
        [-0.5773, -0.3874],
        [-0.9228,  0.8731]], device='cuda:0')
Edge matrix from gumble tensor([[0.8280, 0.1720],
        [0.9593, 0.0407],
        [0.8609, 0.1391],
        [0.6206, 0.3794],
        [0.1858, 0.8142],
        [0.9338, 0.0662],
        [0.9162, 0.0838],
        [0.1942, 0.8058],
        [0.8225, 0.1775],
        [0.9956, 0.0044],
        [0.9678, 0.0322],
        [0.0264, 0.9736]], device='cuda:0')

Epoch 3/3 completed, Global Step: 240
nri_train_loss: 0.9452, enc_train_loss: 1.3013, enc_train_entropy: 0.5847, dec_train_loss: 0.3473, enc_train_edge_accuracy: 0.5400
nri_val_loss: 0.9379, enc_val_loss: 0.9344, enc_val_entropy: 0.6153, dec_val_loss: 0.3522, enc_val_edge_accuracy: 0.5308

---------------------------------------------------------------------------


Training completed in 87.81 seconds or 1.46 minutes or 0.024391648703151282 hours.
Total training steps: 240

Training completed for model '[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3'. Trained model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3\checkpoints

---------------------------------------------------------------------------

<<<<<<<<<<<< TRAINING LOSS PLOT (TRAIN + VAL) >>>>>>>>>>>>

Creating training loss plot for [m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3...

Training loss (train + val) plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3


<<<<<<<<<<<< DECODER OUTPUT PLOT (TRAIN) >>>>>>>>>>>>

Creating decoder output plot for rep '1,001.282' for [m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3...

Decoder output plot for rep '1001.2823' logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3


<<<<<<<<<<<< DECODER OUTPUT PLOT (VAL) >>>>>>>>>>>>

Creating decoder output plot for rep '1,001.148' for [m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3...

Decoder output plot for rep '1001.148' logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3


---------------------------------------------------------------------------

TESTING TRAINED NRI MODEL...

.ckpt_files available in C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3\checkpoints:

['best-model-epoch=02-val_loss=0.0000.ckpt']

Trained NRI Model Loaded for testing.

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3\test
C:\Anaconda3\envs\afd_env\Lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py:425: The 'test_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=19` in the `DataLoader` to improve performance.
Testing: |                                                                                         | 0/? [00:00<?, ?it/s]
Initializing input processors for encoder model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No time feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Initializing input processors for decoder model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No time feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------
Testing:   0%|                                                                                    | 0/10 [00:00<?, ?it/s]Testing DataLoader 0:   0%|                                                                       | 0/10 [00:00<?, ?it/s]Edge pred tensor([[0.6037, 0.3963],
        [0.2156, 0.7844],
        [0.6096, 0.3904],
        [0.4315, 0.5685],
        [0.2976, 0.7024],
        [0.4318, 0.5682],
        [0.5306, 0.4694],
        [0.4788, 0.5212],
        [0.3534, 0.6466],
        [0.7400, 0.2600],
        [0.6594, 0.3406],
        [0.3991, 0.6009]], device='cuda:0')
logits tensor([[ 0.8079,  0.3868],
        [ 0.2160,  1.5075],
        [ 1.2056,  0.7599],
        [-0.0710,  0.2047],
        [ 0.4151,  1.2739],
        [ 1.0650,  1.3397],
        [-0.1608, -0.2831],
        [ 0.2774,  0.3622],
        [ 0.1978,  0.8021],
        [ 0.4456, -0.6002],
        [ 0.9997,  0.3390],
        [ 0.5017,  0.9111]], device='cuda:0')
Edge matrix from gumble tensor([[0.4814, 0.5186],
        [0.6460, 0.3540],
        [0.4300, 0.5700],
        [0.5716, 0.4284],
        [0.0457, 0.9543],
        [0.5373, 0.4627],
        [0.9923, 0.0077],
        [0.7466, 0.2534],
        [0.9958, 0.0042],
        [0.9158, 0.0842],
        [0.8533, 0.1467],
        [0.3927, 0.6073]], device='cuda:0')
Testing DataLoader 0:  10%|######3                                                        | 1/10 [00:00<00:02,  3.39it/s]Edge pred tensor([[0.2234, 0.7766],
        [0.1849, 0.8151],
        [0.3636, 0.6364],
        [0.4094, 0.5906],
        [0.2712, 0.7288],
        [0.6292, 0.3708],
        [0.4760, 0.5240],
        [0.3455, 0.6545],
        [0.5183, 0.4817],
        [0.6142, 0.3858],
        [0.3882, 0.6118],
        [0.4253, 0.5747]], device='cuda:0')
logits tensor([[ 0.4567,  1.7025],
        [ 0.0699,  1.5535],
        [ 0.6557,  1.2153],
        [ 0.2646,  0.6310],
        [-0.2279,  0.7605],
        [ 0.3121, -0.2167],
        [ 0.5066,  0.6027],
        [ 0.3141,  0.9531],
        [ 0.0776,  0.0042],
        [ 1.1350,  0.6702],
        [ 0.6902,  1.1451],
        [ 0.7377,  1.0390]], device='cuda:0')
Edge matrix from gumble tensor([[0.5467, 0.4533],
        [0.2417, 0.7583],
        [0.8820, 0.1180],
        [0.6463, 0.3537],
        [0.2345, 0.7655],
        [0.3884, 0.6116],
        [0.7010, 0.2990],
        [0.9851, 0.0149],
        [0.7464, 0.2536],
        [0.8053, 0.1947],
        [0.2372, 0.7628],
        [0.3620, 0.6380]], device='cuda:0')
Testing DataLoader 0:  20%|############6                                                  | 2/10 [00:00<00:01,  4.49it/s]Edge pred tensor([[0.6668, 0.3332],
        [0.5119, 0.4881],
        [0.1979, 0.8021],
        [0.4548, 0.5452],
        [0.4969, 0.5031],
        [0.1242, 0.8758],
        [0.4311, 0.5689],
        [0.7165, 0.2835],
        [0.0450, 0.9550],
        [0.3649, 0.6351],
        [0.3417, 0.6583],
        [0.2783, 0.7217]], device='cuda:0')
logits tensor([[ 0.2613, -0.4326],
        [-0.1766, -0.2243],
        [-0.5306,  0.8686],
        [ 0.8212,  1.0027],
        [ 0.9824,  0.9947],
        [ 0.4261,  2.3795],
        [-0.1650,  0.1123],
        [ 0.1612, -0.7658],
        [-1.2955,  1.7590],
        [ 0.6192,  1.1735],
        [ 0.3375,  0.9933],
        [ 0.1018,  1.0545]], device='cuda:0')
Edge matrix from gumble tensor([[0.5042, 0.4958],
        [0.4340, 0.5660],
        [0.0907, 0.9093],
        [0.1657, 0.8343],
        [0.5767, 0.4233],
        [0.1666, 0.8334],
        [0.5197, 0.4803],
        [0.9101, 0.0899],
        [0.1067, 0.8933],
        [0.1052, 0.8948],
        [0.3856, 0.6144],
        [0.1440, 0.8560]], device='cuda:0')
Testing DataLoader 0:  30%|##################9                                            | 3/10 [00:00<00:01,  5.31it/s]Edge pred tensor([[0.5530, 0.4470],
        [0.4671, 0.5329],
        [0.3305, 0.6695],
        [0.6469, 0.3531],
        [0.4206, 0.5794],
        [0.3447, 0.6553],
        [0.5187, 0.4813],
        [0.5093, 0.4907],
        [0.3451, 0.6549],
        [0.2952, 0.7048],
        [0.1481, 0.8519],
        [0.1302, 0.8698]], device='cuda:0')
logits tensor([[-0.3592, -0.5722],
        [-1.5070, -1.3751],
        [-0.7882, -0.0824],
        [ 0.6507,  0.0454],
        [-1.0852, -0.7649],
        [-0.2024,  0.4400],
        [ 0.8996,  0.8247],
        [ 0.5956,  0.5585],
        [ 0.6118,  1.2525],
        [ 1.5193,  2.3895],
        [ 0.7017,  2.4513],
        [-0.2613,  1.6376]], device='cuda:0')
Edge matrix from gumble tensor([[0.5888, 0.4112],
        [0.1307, 0.8693],
        [0.1485, 0.8515],
        [0.1777, 0.8223],
        [0.4504, 0.5496],
        [0.0607, 0.9393],
        [0.9643, 0.0357],
        [0.6012, 0.3988],
        [0.9131, 0.0869],
        [0.0937, 0.9063],
        [0.0273, 0.9727],
        [0.6582, 0.3418]], device='cuda:0')
Testing DataLoader 0:  40%|#########################2                                     | 4/10 [00:00<00:01,  5.70it/s]Edge pred tensor([[0.7722, 0.2278],
        [0.3114, 0.6886],
        [0.2770, 0.7230],
        [0.6062, 0.3938],
        [0.3043, 0.6957],
        [0.1531, 0.8469],
        [0.4996, 0.5004],
        [0.7156, 0.2844],
        [0.0971, 0.9029],
        [0.5183, 0.4817],
        [0.3550, 0.6450],
        [0.2868, 0.7132]], device='cuda:0')
logits tensor([[ 0.2579, -0.9631],
        [-1.7027, -0.9089],
        [-0.8044,  0.1547],
        [ 0.8255,  0.3942],
        [-0.4818,  0.3451],
        [-0.0822,  1.6280],
        [ 0.6841,  0.6858],
        [ 1.0224,  0.0997],
        [-0.5572,  1.6731],
        [ 1.0981,  1.0251],
        [ 1.1307,  1.7279],
        [ 0.0378,  0.9489]], device='cuda:0')
Edge matrix from gumble tensor([[0.5236, 0.4764],
        [0.2344, 0.7656],
        [0.9487, 0.0513],
        [0.6822, 0.3178],
        [0.7636, 0.2364],
        [0.0527, 0.9473],
        [0.8492, 0.1508],
        [0.5395, 0.4605],
        [0.0049, 0.9951],
        [0.3864, 0.6136],
        [0.8155, 0.1845],
        [0.1262, 0.8738]], device='cuda:0')
Testing DataLoader 0:  50%|###############################5                               | 5/10 [00:00<00:00,  6.08it/s]Edge pred tensor([[0.6469, 0.3531],
        [0.6137, 0.3863],
        [0.1958, 0.8042],
        [0.3832, 0.6168],
        [0.4590, 0.5410],
        [0.0623, 0.9377],
        [0.4658, 0.5342],
        [0.6868, 0.3132],
        [0.1762, 0.8238],
        [0.6695, 0.3305],
        [0.6117, 0.3883],
        [0.4686, 0.5314]], device='cuda:0')
logits tensor([[ 1.0755,  0.4700],
        [ 0.1476, -0.3153],
        [ 0.1956,  1.6082],
        [ 0.1411,  0.6173],
        [ 0.1707,  0.3350],
        [ 0.1378,  2.8487],
        [-0.4414, -0.3044],
        [ 1.1172,  0.3320],
        [ 0.0650,  1.6072],
        [ 0.9106,  0.2046],
        [ 1.5310,  1.0765],
        [ 0.8844,  1.0103]], device='cuda:0')
Edge matrix from gumble tensor([[0.0663, 0.9337],
        [0.8690, 0.1310],
        [0.0142, 0.9858],
        [0.0054, 0.9946],
        [0.6324, 0.3676],
        [0.0268, 0.9732],
        [0.1196, 0.8804],
        [0.7721, 0.2279],
        [0.9578, 0.0422],
        [0.4225, 0.5775],
        [0.6986, 0.3014],
        [0.7246, 0.2754]], device='cuda:0')
Testing DataLoader 0:  60%|#####################################8                         | 6/10 [00:00<00:00,  6.42it/s]Edge pred tensor([[0.3002, 0.6998],
        [0.3293, 0.6707],
        [0.6433, 0.3567],
        [0.6015, 0.3985],
        [0.4039, 0.5961],
        [0.7782, 0.2218],
        [0.6174, 0.3826],
        [0.3231, 0.6769],
        [0.7519, 0.2481],
        [0.8275, 0.1725],
        [0.4655, 0.5345],
        [0.4962, 0.5038]], device='cuda:0')
logits tensor([[ 0.1225,  0.9687],
        [ 0.1802,  0.8918],
        [ 1.0204,  0.4308],
        [ 1.4494,  1.0377],
        [ 0.3407,  0.7299],
        [ 1.0022, -0.2532],
        [ 1.6148,  1.1363],
        [ 0.2708,  1.0103],
        [ 1.0296, -0.0793],
        [ 2.1037,  0.5353],
        [ 0.8080,  0.9463],
        [ 0.9424,  0.9576]], device='cuda:0')
Edge matrix from gumble tensor([[0.6878, 0.3122],
        [0.2908, 0.7092],
        [0.4726, 0.5274],
        [0.0693, 0.9307],
        [0.1066, 0.8934],
        [0.9054, 0.0946],
        [0.6091, 0.3909],
        [0.5952, 0.4048],
        [0.3270, 0.6730],
        [0.8792, 0.1208],
        [0.3754, 0.6246],
        [0.0410, 0.9590]], device='cuda:0')
Testing DataLoader 0:  70%|############################################                   | 7/10 [00:01<00:00,  6.71it/s]Edge pred tensor([[0.8468, 0.1532],
        [0.7502, 0.2498],
        [0.7440, 0.2560],
        [0.6802, 0.3198],
        [0.4420, 0.5580],
        [0.6551, 0.3449],
        [0.7328, 0.2672],
        [0.7520, 0.2480],
        [0.6497, 0.3503],
        [0.1306, 0.8694],
        [0.2530, 0.7470],
        [0.2488, 0.7512]], device='cuda:0')
logits tensor([[ 0.9613, -0.7487],
        [ 0.4227, -0.6770],
        [ 1.3400,  0.2734],
        [ 1.1781,  0.4235],
        [-0.2422, -0.0094],
        [ 0.6386, -0.0029],
        [ 0.7630, -0.2457],
        [ 0.0167, -1.0928],
        [ 0.2562, -0.3617],
        [ 0.3529,  2.2482],
        [-0.0613,  1.0216],
        [-0.2212,  0.8837]], device='cuda:0')
Edge matrix from gumble tensor([[0.9258, 0.0742],
        [0.4691, 0.5309],
        [0.4653, 0.5347],
        [0.7364, 0.2636],
        [0.3260, 0.6740],
        [0.0321, 0.9679],
        [0.8808, 0.1192],
        [0.4189, 0.5811],
        [0.3163, 0.6837],
        [0.2394, 0.7606],
        [0.0902, 0.9098],
        [0.1272, 0.8728]], device='cuda:0')
Testing DataLoader 0:  80%|##################################################4            | 8/10 [00:01<00:00,  6.95it/s]Edge pred tensor([[0.5058, 0.4942],
        [0.4864, 0.5136],
        [0.5591, 0.4409],
        [0.8057, 0.1943],
        [0.5324, 0.4676],
        [0.5433, 0.4567],
        [0.6250, 0.3750],
        [0.3408, 0.6592],
        [0.3600, 0.6400],
        [0.7767, 0.2233],
        [0.4619, 0.5381],
        [0.4078, 0.5922]], device='cuda:0')
logits tensor([[-9.1310e-02, -1.1444e-01],
        [-3.3003e-01, -2.7567e-01],
        [-4.2534e-02, -2.8012e-01],
        [ 1.5384e+00,  1.1635e-01],
        [ 3.9568e-01,  2.6579e-01],
        [ 1.7467e-01,  1.0791e-03],
        [ 1.7289e+00,  1.2179e+00],
        [ 4.3283e-01,  1.0924e+00],
        [ 9.5538e-01,  1.5309e+00],
        [ 2.5014e+00,  1.2551e+00],
        [ 1.1800e+00,  1.3328e+00],
        [ 1.4263e+00,  1.7994e+00]], device='cuda:0')
Edge matrix from gumble tensor([[0.9327, 0.0673],
        [0.6374, 0.3626],
        [0.6396, 0.3604],
        [0.8972, 0.1028],
        [0.0532, 0.9468],
        [0.6761, 0.3239],
        [0.6506, 0.3494],
        [0.4697, 0.5303],
        [0.3185, 0.6815],
        [0.8847, 0.1153],
        [0.1131, 0.8869],
        [0.2843, 0.7157]], device='cuda:0')
Testing DataLoader 0:  90%|########################################################7      | 9/10 [00:01<00:00,  7.01it/s]Edge pred tensor([[0.4245, 0.5755],
        [0.3885, 0.6115],
        [0.5297, 0.4703],
        [0.3807, 0.6193],
        [0.4356, 0.5644],
        [0.7597, 0.2403],
        [0.4130, 0.5870],
        [0.4067, 0.5933],
        [0.6769, 0.3231],
        [0.3920, 0.6080],
        [0.3893, 0.6107],
        [0.3917, 0.6083]], device='cuda:0')
logits tensor([[-0.3850, -0.0806],
        [-0.5378, -0.0844],
        [ 0.3935,  0.2744],
        [ 0.3583,  0.8448],
        [-0.2335,  0.0254],
        [ 0.9248, -0.2263],
        [ 0.5474,  0.8992],
        [-0.0418,  0.3357],
        [ 1.0970,  0.3573],
        [ 0.7683,  1.2072],
        [ 0.1356,  0.5859],
        [ 0.3265,  0.7665]], device='cuda:0')
Edge matrix from gumble tensor([[0.9160, 0.0840],
        [0.2006, 0.7994],
        [0.7100, 0.2900],
        [0.2823, 0.7177],
        [0.3737, 0.6263],
        [0.6488, 0.3512],
        [0.7594, 0.2406],
        [0.0503, 0.9497],
        [0.6963, 0.3037],
        [0.0982, 0.9018],
        [0.8453, 0.1547],
        [0.2631, 0.7369]], device='cuda:0')
Testing DataLoader 0: 100%|##############################################################| 10/10 [00:01<00:00,  7.12it/s]
Testing completed in 1.41 seconds or 0.02 minutes or 0.0003905784421496921 hours.

nri_test_loss: 1.7785, enc_test_loss: 0.9318, dec_test_loss: 0.3542, enc_test_edge_accuracy: 0.5217

Edge predictions are as follows (showing probabilities for each edge type):

Rep 1,001.221:
[[0.42447692 0.5755231 ]
 [0.38854402 0.6114559 ]
 [0.52973276 0.47026724]
 [0.38070142 0.61929864]
 [0.43563366 0.56436634]
 [0.7597154  0.2402846 ]
 [0.41295567 0.5870443 ]
 [0.4067343  0.59326565]
 [0.67693555 0.32306445]
 [0.39200962 0.60799044]
 [0.38928005 0.6107199 ]
 [0.3917448  0.6082552 ]]

Rep 1,001.316:
[[0.48745045 0.5125496 ]
 [0.3377008  0.6622992 ]
 [0.32984254 0.6701575 ]
 [0.5349386  0.46506143]
 [0.67407507 0.325925  ]
 [0.47339576 0.52660424]
 [0.2876551  0.71234494]
 [0.6165096  0.38349035]
 [0.34607095 0.653929  ]
 [0.09489478 0.9051052 ]
 [0.22704355 0.77295643]
 [0.21370848 0.78629154]]

Rep 1,001.417:
[[0.8003804  0.19961952]
 [0.5687384  0.43126157]
 [0.13062443 0.8693755 ]
 [0.46137223 0.5386278 ]
 [0.3580707  0.64192927]
 [0.06739916 0.9326008 ]
 [0.46612403 0.53387594]
 [0.8305546  0.16944537]
 [0.16182475 0.83817524]
 [0.5213096  0.47869042]
 [0.6715827  0.32841727]
 [0.31677756 0.6832225 ]]

Rep 1,001.362:
[[0.6902289  0.30977112]
 [0.7623244  0.23767556]
 [0.69110864 0.3088914 ]
 [0.42312407 0.5768759 ]
 [0.48875502 0.511245  ]
 [0.41165432 0.5883457 ]
 [0.6086974  0.3913026 ]
 [0.5721638  0.42783618]
 [0.4842202  0.5157798 ]
 [0.03694047 0.96305954]
 [0.24493854 0.75506145]
 [0.31747696 0.682523  ]]

Rep 1,001.497:
[[0.49644306 0.50355697]
 [0.3170742  0.68292576]
 [0.1250902  0.8749098 ]
 [0.6699191  0.33008093]
 [0.5121123  0.48788765]
 [0.16046233 0.8395376 ]
 [0.65926737 0.34073266]
 [0.72123694 0.27876306]
 [0.29424983 0.70575017]
 [0.86685866 0.13314131]
 [0.81081176 0.18918824]
 [0.63081217 0.36918783]]

Rep 1,001.383:
[[0.30690876 0.6930912 ]
 [0.334081   0.665919  ]
 [0.7931807  0.20681925]
 [0.6666354  0.33336455]
 [0.4010099  0.5989901 ]
 [0.8726876  0.12731244]
 [0.6140348  0.38596526]
 [0.39526746 0.6047326 ]
 [0.7427381  0.2572618 ]
 [0.82885885 0.17114112]
 [0.5815501  0.4184499 ]
 [0.626674   0.37332597]]

Rep 1,001.215:
[[0.4680934  0.5319066 ]
 [0.23971315 0.7602868 ]
 [0.39600238 0.60399765]
 [0.28185597 0.718144  ]
 [0.4453682  0.5546318 ]
 [0.34023312 0.65976685]
 [0.55742323 0.44257677]
 [0.7577154  0.24228461]
 [0.5321887  0.4678113 ]
 [0.2699145  0.7300855 ]
 [0.634954   0.36504608]
 [0.3454727  0.6545273 ]]

Rep 1,001.371:
[[0.33806327 0.66193676]
 [0.33426318 0.66573685]
 [0.32737952 0.6726205 ]
 [0.5597608  0.4402392 ]
 [0.3535008  0.64649916]
 [0.4149726  0.5850274 ]
 [0.83620876 0.16379125]
 [0.78592175 0.2140783 ]
 [0.5843896  0.41561034]
 [0.6560572  0.34394288]
 [0.5568857  0.44311428]
 [0.30783525 0.6921648 ]]

Rep 1,001.203:
[[0.40095833 0.59904164]
 [0.2703542  0.7296458 ]
 [0.54993004 0.45006996]
 [0.669853   0.33014706]
 [0.1879144  0.8120856 ]
 [0.51351565 0.48648438]
 [0.5309952  0.46900478]
 [0.34094366 0.6590563 ]
 [0.5456255  0.45437446]
 [0.78347963 0.21652037]
 [0.5722808  0.42771915]
 [0.41051376 0.58948624]]

Rep 1,001.331:
[[0.46429783 0.53570217]
 [0.33166727 0.66833276]
 [0.36699167 0.6330083 ]
 [0.63768333 0.36231664]
 [0.44303253 0.5569675 ]
 [0.5963273  0.40367267]
 [0.64831334 0.35168666]
 [0.46156332 0.5384367 ]
 [0.4124873  0.58751273]
 [0.6595357  0.34046432]
 [0.34108573 0.65891427]
 [0.37526867 0.6247313 ]]

Rep 1,001.188:
[[0.32456836 0.6754316 ]
 [0.5835844  0.41641563]
 [0.78042966 0.21957034]
 [0.7156566  0.2843434 ]
 [0.625603   0.374397  ]
 [0.5802319  0.4197681 ]
 [0.53800243 0.46199754]
 [0.30966306 0.69033694]
 [0.3462443  0.6537557 ]
 [0.37879905 0.6212009 ]
 [0.21248174 0.78751826]
 [0.3057775  0.6942225 ]]

Rep 1,001.317:
[[0.7117799  0.28822008]
 [0.5876795  0.41232046]
 [0.7575008  0.24249919]
 [0.5670622  0.43293783]
 [0.60654026 0.3934598 ]
 [0.7093424  0.29065764]
 [0.58094686 0.41905308]
 [0.6551742  0.3448258 ]
 [0.77045685 0.22954318]
 [0.7715746  0.22842537]
 [0.50522286 0.4947771 ]
 [0.32606307 0.67393696]]

Rep 1,001.388:
[[0.31196517 0.68803483]
 [0.36218262 0.6378173 ]
 [0.566506   0.43349394]
 [0.5930338  0.40696624]
 [0.30364466 0.6963553 ]
 [0.66975725 0.33024275]
 [0.6139289  0.3860711 ]
 [0.48059767 0.5194023 ]
 [0.7931202  0.20687976]
 [0.7987078  0.20129222]
 [0.7626671  0.2373328 ]
 [0.5776631  0.42233682]]

Rep 1,001.298:
[[0.52555865 0.47444135]
 [0.32247463 0.67752534]
 [0.15899606 0.84100395]
 [0.45993373 0.5400663 ]
 [0.5412934  0.45870662]
 [0.12991136 0.87008864]
 [0.34677905 0.6532209 ]
 [0.6273744  0.37262556]
 [0.22452892 0.7754711 ]
 [0.57165605 0.42834398]
 [0.7239215  0.27607852]
 [0.42240718 0.5775928 ]]

Rep 1,001.468:
[[0.6109497  0.38905028]
 [0.46807116 0.53192884]
 [0.3929083  0.60709167]
 [0.49884024 0.5011598 ]
 [0.5643622  0.43563777]
 [0.2808521  0.7191479 ]
 [0.415745   0.584255  ]
 [0.6921794  0.30782056]
 [0.26456574 0.7354343 ]
 [0.0991272  0.9008728 ]
 [0.20687962 0.79312044]
 [0.16738097 0.832619  ]]

Rep 1,001.334:
[[0.46657518 0.53342485]
 [0.15621296 0.843787  ]
 [0.5997431  0.40025684]
 [0.3788438  0.62115616]
 [0.28343692 0.7165631 ]
 [0.6563183  0.34368163]
 [0.45075315 0.5492468 ]
 [0.581721   0.41827893]
 [0.7659205  0.23407954]
 [0.7364523  0.2635477 ]
 [0.6482401  0.3517599 ]
 [0.6158358  0.38416424]]

Rep 1,001.212:
[[0.42235103 0.577649  ]
 [0.2781583  0.72184175]
 [0.63689935 0.36310068]
 [0.34255883 0.6574412 ]
 [0.55449104 0.4455089 ]
 [0.66906285 0.3309372 ]
 [0.35767633 0.6423236 ]
 [0.22894733 0.77105266]
 [0.6372336  0.36276644]
 [0.31434143 0.6856586 ]
 [0.3847094  0.61529064]
 [0.21242233 0.7875777 ]]

Rep 1,001.164:
[[0.67053336 0.3294667 ]
 [0.65686846 0.34313157]
 [0.48325476 0.5167452 ]
 [0.6367242  0.3632758 ]
 [0.69222987 0.30777016]
 [0.81664664 0.1833534 ]
 [0.43064132 0.5693587 ]
 [0.6821058  0.31789416]
 [0.69185215 0.30814782]
 [0.5237516  0.4762484 ]
 [0.68946916 0.3105308 ]
 [0.44452327 0.5554768 ]]

Rep 1,001.247:
[[0.25005984 0.7499401 ]
 [0.26591876 0.73408127]
 [0.7057519  0.29424804]
 [0.56975603 0.43024397]
 [0.24439101 0.75560904]
 [0.6083948  0.39160526]
 [0.3940667  0.60593337]
 [0.32327455 0.67672545]
 [0.4317899  0.56821007]
 [0.36368072 0.6363192 ]
 [0.2815427  0.71845734]
 [0.17655064 0.8234494 ]]

Rep 1,001.161:
[[0.58911395 0.41088605]
 [0.31699407 0.6830059 ]
 [0.4109088  0.5890912 ]
 [0.6807451  0.31925488]
 [0.34258953 0.6574105 ]
 [0.7322298  0.2677701 ]
 [0.6965329  0.3034671 ]
 [0.7033762  0.29662383]
 [0.44771215 0.5522879 ]
 [0.5450942  0.45490578]
 [0.7367362  0.26326385]
 [0.27780446 0.7221955 ]]

Rep 1,001.163:
[[0.2997212  0.70027876]
 [0.4053552  0.5946448 ]
 [0.76173776 0.2382623 ]
 [0.19229597 0.80770403]
 [0.23892553 0.7610745 ]
 [0.38571954 0.61428046]
 [0.4016901  0.59830993]
 [0.34982398 0.65017605]
 [0.5546113  0.4453887 ]
 [0.5702836  0.42971638]
 [0.5079677  0.49203232]
 [0.49302676 0.5069732 ]]

Rep 1,001.177:
[[0.36693606 0.633064  ]
 [0.3105852  0.68941486]
 [0.67835754 0.3216425 ]
 [0.37717775 0.6228223 ]
 [0.30092183 0.69907814]
 [0.5829861  0.41701385]
 [0.5506635  0.44933653]
 [0.688626   0.31137398]
 [0.76559114 0.23440883]
 [0.70565176 0.29434824]
 [0.46866405 0.5313359 ]
 [0.44720757 0.5527925 ]]

Rep 1,001.358:
[[0.7467175  0.25328255]
 [0.41327864 0.58672136]
 [0.09474292 0.90525705]
 [0.47941238 0.5205876 ]
 [0.4565695  0.5434305 ]
 [0.092906   0.90709406]
 [0.33236077 0.66763926]
 [0.7530204  0.24697956]
 [0.10235052 0.89764947]
 [0.57108533 0.42891467]
 [0.66541153 0.3345884 ]
 [0.28678894 0.7132111 ]]

Rep 1,001.363:
[[0.5428623  0.4571377 ]
 [0.3529862  0.64701384]
 [0.81758684 0.18241315]
 [0.47379717 0.5262028 ]
 [0.38485715 0.6151428 ]
 [0.8517652  0.14823481]
 [0.67050254 0.32949746]
 [0.4974989  0.50250113]
 [0.8376466  0.1623534 ]
 [0.546687   0.453313  ]
 [0.59168863 0.40831134]
 [0.5130375  0.4869625 ]]

Rep 1,001.396:
[[0.3024509  0.6975491 ]
 [0.38570544 0.6142946 ]
 [0.4813529  0.5186471 ]
 [0.51071084 0.4892892 ]
 [0.5374731  0.4625269 ]
 [0.307814   0.692186  ]
 [0.5098301  0.49016985]
 [0.3466942  0.6533058 ]
 [0.15017347 0.8498265 ]
 [0.8226166  0.17738338]
 [0.6062325  0.39376745]
 [0.56246644 0.43753353]]

Rep 1,001.114:
[[0.6738911  0.32610887]
 [0.5022121  0.49778786]
 [0.83289635 0.16710363]
 [0.47902653 0.52097344]
 [0.31127688 0.68872315]
 [0.47467926 0.5253207 ]
 [0.38655248 0.61344755]
 [0.37263048 0.6273695 ]
 [0.43072158 0.5692784 ]
 [0.7619504  0.23804966]
 [0.7951759  0.20482409]
 [0.661406   0.33859402]]

Rep 1,001.262:
[[0.38758248 0.61241746]
 [0.5041402  0.49585974]
 [0.72919416 0.27080584]
 [0.35129726 0.64870274]
 [0.52605015 0.47394982]
 [0.58795625 0.4120438 ]
 [0.26349935 0.7365006 ]
 [0.4346188  0.56538117]
 [0.47676042 0.52323955]
 [0.3487588  0.6512412 ]
 [0.41711628 0.5828837 ]
 [0.41623977 0.58376026]]

Rep 1,001.469:
[[0.47768274 0.5223173 ]
 [0.63543355 0.36456645]
 [0.6722538  0.32774618]
 [0.49997687 0.5000231 ]
 [0.6136423  0.3863577 ]
 [0.8509463  0.14905368]
 [0.3768621  0.6231379 ]
 [0.41415873 0.5858413 ]
 [0.6181376  0.3818624 ]
 [0.38161227 0.61838776]
 [0.3556257  0.6443743 ]
 [0.40354937 0.5964506 ]]

Rep 1,001.186:
[[0.76315105 0.236849  ]
 [0.58929163 0.41070837]
 [0.6783042  0.32169583]
 [0.70206314 0.29793683]
 [0.5973371  0.40266293]
 [0.7528285  0.24717149]
 [0.44446522 0.5555347 ]
 [0.56936044 0.43063954]
 [0.62477404 0.37522596]
 [0.26357213 0.7364279 ]
 [0.1250477  0.8749523 ]
 [0.07881733 0.92118263]]

Rep 1,001.285:
[[0.520571   0.47942898]
 [0.5191492  0.4808508 ]
 [0.3015359  0.6984641 ]
 [0.6022939  0.3977061 ]
 [0.56205004 0.43794996]
 [0.44955236 0.5504476 ]
 [0.44481212 0.5551879 ]
 [0.48049796 0.51950204]
 [0.27161998 0.72838   ]
 [0.7914334  0.20856668]
 [0.72720885 0.27279115]
 [0.70292413 0.29707584]]

Rep 1,001.311:
[[0.53732216 0.4626778 ]
 [0.46653986 0.5334602 ]
 [0.6995819  0.30041805]
 [0.28394    0.71606004]
 [0.47020978 0.5297902 ]
 [0.7707636  0.22923638]
 [0.35962468 0.6403753 ]
 [0.5501527  0.44984728]
 [0.6708443  0.32915568]
 [0.32171074 0.67828923]
 [0.47736564 0.5226343 ]
 [0.41718826 0.5828117 ]]

Rep 1,001.286:
[[0.50182784 0.4981722 ]
 [0.64572704 0.35427293]
 [0.83792645 0.16207355]
 [0.54474676 0.45525318]
 [0.48574325 0.5142568 ]
 [0.65930367 0.34069633]
 [0.60747033 0.39252967]
 [0.49544767 0.5045523 ]
 [0.6881127  0.31188738]
 [0.7865404  0.21345966]
 [0.7484378  0.25156218]
 [0.77481276 0.22518729]]

Rep 1,001.325:
[[0.72155267 0.27844733]
 [0.42256272 0.5774373 ]
 [0.2180444  0.7819556 ]
 [0.6488209  0.3511791 ]
 [0.5531106  0.4468894 ]
 [0.21913266 0.78086734]
 [0.6959841  0.30401587]
 [0.858958   0.14104202]
 [0.48803332 0.5119667 ]
 [0.7048137  0.29518628]
 [0.73405945 0.26594058]
 [0.50738966 0.49261037]]

Rep 1,001.107:
[[0.36229986 0.6377001 ]
 [0.42319757 0.5768025 ]
 [0.40982547 0.59017456]
 [0.715872   0.28412798]
 [0.56698483 0.43301517]
 [0.6753922  0.32460776]
 [0.5507089  0.4492911 ]
 [0.3462148  0.65378517]
 [0.32050708 0.67949295]
 [0.9009309  0.09906909]
 [0.65816313 0.34183684]
 [0.62157136 0.3784286 ]]

Rep 1,001.494:
[[0.5018751  0.4981249 ]
 [0.40683267 0.5931673 ]
 [0.7073083  0.2926917 ]
 [0.6807419  0.31925815]
 [0.39010495 0.60989505]
 [0.73204464 0.26795536]
 [0.48180252 0.5181975 ]
 [0.35799742 0.6420026 ]
 [0.7411078  0.25889215]
 [0.94231373 0.05768625]
 [0.9086386  0.0913614 ]
 [0.81666285 0.18333712]]

Rep 1,001.237:
[[0.7149607  0.2850393 ]
 [0.5180465  0.48195353]
 [0.6302759  0.36972407]
 [0.38527688 0.61472315]
 [0.37444678 0.62555325]
 [0.4452857  0.55471426]
 [0.5988853  0.40111467]
 [0.8701554  0.12984458]
 [0.5992289  0.4007711 ]
 [0.45265642 0.5473436 ]
 [0.41869226 0.58130777]
 [0.24342875 0.7565713 ]]

Rep 1,001.115:
[[0.431871   0.568129  ]
 [0.28527516 0.71472484]
 [0.80320024 0.19679978]
 [0.58806634 0.41193366]
 [0.28987288 0.7101271 ]
 [0.61505395 0.38494605]
 [0.51428545 0.48571452]
 [0.26446334 0.7355367 ]
 [0.6209617  0.37903827]
 [0.4581219  0.5418781 ]
 [0.28273383 0.7172662 ]
 [0.1591346  0.84086543]]

Rep 1,001.491:
[[0.6482482  0.35175174]
 [0.6132361  0.38676387]
 [0.87157726 0.1284227 ]
 [0.47875175 0.5212482 ]
 [0.5688478  0.4311522 ]
 [0.74419683 0.25580323]
 [0.5399141  0.46008593]
 [0.5064573  0.4935426 ]
 [0.62032485 0.37967512]
 [0.77868813 0.22131188]
 [0.45307836 0.5469217 ]
 [0.41129968 0.5887003 ]]

Rep 1,001.409:
[[0.7931634  0.20683657]
 [0.5752936  0.4247064 ]
 [0.5556109  0.44438913]
 [0.48725152 0.5127485 ]
 [0.6134659  0.38653412]
 [0.4097971  0.59020287]
 [0.7565711  0.24342892]
 [0.9012576  0.09874242]
 [0.6181765  0.38182348]
 [0.60763574 0.39236423]
 [0.48186755 0.51813245]
 [0.33641472 0.66358525]]

Rep 1,001.223:
[[0.2734748  0.7265252 ]
 [0.32622918 0.6737708 ]
 [0.44918275 0.5508173 ]
 [0.5964404  0.40355965]
 [0.3965192  0.60348076]
 [0.6152857  0.38471428]
 [0.6227314  0.37726858]
 [0.3130688  0.68693113]
 [0.6207228  0.37927726]
 [0.7255996  0.27440044]
 [0.34892282 0.6510772 ]
 [0.5068289  0.4931711 ]]

Rep 1,001.497:
[[0.6799599  0.3200401 ]
 [0.6145693  0.3854307 ]
 [0.4904734  0.50952655]
 [0.73570114 0.26429886]
 [0.51128495 0.48871508]
 [0.23983824 0.7601617 ]
 [0.5260686  0.47393143]
 [0.5769794  0.4230206 ]
 [0.12333856 0.87666136]
 [0.3168762  0.6831238 ]
 [0.19235714 0.8076429 ]
 [0.17044722 0.8295528 ]]

Rep 1,001.227:
[[0.53665984 0.4633402 ]
 [0.32641345 0.6735865 ]
 [0.2369613  0.7630387 ]
 [0.24130172 0.7586983 ]
 [0.25103354 0.7489664 ]
 [0.14162946 0.85837054]
 [0.4033199  0.5966801 ]
 [0.68274325 0.31725678]
 [0.38862205 0.61137795]
 [0.6100095  0.38999054]
 [0.8129812  0.18701887]
 [0.70381016 0.2961898 ]]

Rep 1,001.281:
[[0.6466731  0.35332695]
 [0.66705084 0.33294916]
 [0.6703993  0.32960072]
 [0.65221715 0.34778282]
 [0.501435   0.49856502]
 [0.37972283 0.6202772 ]
 [0.7533897  0.24661025]
 [0.7865993  0.21340072]
 [0.6014438  0.3985562 ]
 [0.5145077  0.48549226]
 [0.25222152 0.7477785 ]
 [0.15058638 0.8494136 ]]

Rep 1,001.404:
[[0.48525497 0.514745  ]
 [0.39183542 0.60816455]
 [0.59110266 0.40889734]
 [0.41791847 0.58208156]
 [0.23648567 0.7635143 ]
 [0.5870871  0.41291288]
 [0.3654347  0.6345653 ]
 [0.4317188  0.56828123]
 [0.69403577 0.30596417]
 [0.6713453  0.3286547 ]
 [0.550062   0.449938  ]
 [0.48275486 0.5172451 ]]

Rep 1,001.636:
[[0.6590693  0.34093064]
 [0.45192793 0.54807204]
 [0.14507341 0.8549266 ]
 [0.6493723  0.3506277 ]
 [0.6859465  0.31405348]
 [0.25744537 0.7425546 ]
 [0.49304417 0.50695586]
 [0.5643296  0.43567038]
 [0.2753679  0.7246321 ]
 [0.60648096 0.393519  ]
 [0.56726146 0.4327385 ]
 [0.4546366  0.5453634 ]]

Rep 1,001.686:
[[0.59165895 0.40834108]
 [0.36492735 0.63507265]
 [0.44695413 0.5530458 ]
 [0.67878187 0.32121816]
 [0.49131247 0.50868756]
 [0.26495817 0.7350418 ]
 [0.5365054  0.4634946 ]
 [0.7592027  0.24079725]
 [0.3882135  0.6117865 ]
 [0.12063862 0.8793614 ]
 [0.38748652 0.6125134 ]
 [0.3764075  0.6235925 ]]

Rep 1,001.132:
[[0.78227234 0.21772774]
 [0.45686704 0.54313296]
 [0.13310836 0.8668917 ]
 [0.3368417  0.66315836]
 [0.32520998 0.67479   ]
 [0.05832486 0.9416751 ]
 [0.47055483 0.5294452 ]
 [0.82220757 0.17779244]
 [0.0895699  0.9104301 ]
 [0.47693002 0.52307   ]
 [0.41805756 0.58194244]
 [0.2595968  0.74040323]]

Rep 1,001.416:
[[0.5040461  0.4959539 ]
 [0.31530675 0.6846932 ]
 [0.6621898  0.33781025]
 [0.62698096 0.37301898]
 [0.2377573  0.7622427 ]
 [0.74020386 0.25979617]
 [0.5827101  0.41728988]
 [0.5226951  0.47730482]
 [0.6450906  0.35490948]
 [0.91151124 0.08848878]
 [0.7790601  0.22093983]
 [0.44105625 0.55894375]]

Rep 1,001.490:
[[0.7521476  0.24785241]
 [0.53163606 0.46836397]
 [0.18491621 0.81508374]
 [0.6567179  0.3432821 ]
 [0.6113413  0.38865864]
 [0.3178034  0.6821966 ]
 [0.7834858  0.2165142 ]
 [0.7735698  0.2264302 ]
 [0.47355118 0.5264488 ]
 [0.6771576  0.3228424 ]
 [0.5407927  0.45920727]
 [0.2729981  0.72700197]]

Rep 1,001.348:
[[0.32814318 0.6718568 ]
 [0.44980147 0.55019855]
 [0.5466772  0.45332283]
 [0.7293327  0.27066737]
 [0.32099357 0.6790064 ]
 [0.5366162  0.46338382]
 [0.63400114 0.36599886]
 [0.5041265  0.49587354]
 [0.6234589  0.37654108]
 [0.95827764 0.04172233]
 [0.85493153 0.14506842]
 [0.72385085 0.27614918]]

Adjacency matrix from edge pred is as follows:

Rep 1,001.221:
[[[0.         0.        ]
  [0.42447692 0.5755231 ]
  [0.38854402 0.6114559 ]
  [0.52973276 0.47026724]]

 [[0.38070142 0.61929864]
  [0.         0.        ]
  [0.43563366 0.56436634]
  [0.7597154  0.2402846 ]]

 [[0.41295567 0.5870443 ]
  [0.4067343  0.59326565]
  [0.         0.        ]
  [0.67693555 0.32306445]]

 [[0.39200962 0.60799044]
  [0.38928005 0.6107199 ]
  [0.3917448  0.6082552 ]
  [0.         0.        ]]]

Rep 1,001.316:
[[[0.         0.        ]
  [0.48745045 0.5125496 ]
  [0.3377008  0.6622992 ]
  [0.32984254 0.6701575 ]]

 [[0.5349386  0.46506143]
  [0.         0.        ]
  [0.67407507 0.325925  ]
  [0.47339576 0.52660424]]

 [[0.2876551  0.71234494]
  [0.6165096  0.38349035]
  [0.         0.        ]
  [0.34607095 0.653929  ]]

 [[0.09489478 0.9051052 ]
  [0.22704355 0.77295643]
  [0.21370848 0.78629154]
  [0.         0.        ]]]

Rep 1,001.417:
[[[0.         0.        ]
  [0.8003804  0.19961952]
  [0.5687384  0.43126157]
  [0.13062443 0.8693755 ]]

 [[0.46137223 0.5386278 ]
  [0.         0.        ]
  [0.3580707  0.64192927]
  [0.06739916 0.9326008 ]]

 [[0.46612403 0.53387594]
  [0.8305546  0.16944537]
  [0.         0.        ]
  [0.16182475 0.83817524]]

 [[0.5213096  0.47869042]
  [0.6715827  0.32841727]
  [0.31677756 0.6832225 ]
  [0.         0.        ]]]

Rep 1,001.362:
[[[0.         0.        ]
  [0.6902289  0.30977112]
  [0.7623244  0.23767556]
  [0.69110864 0.3088914 ]]

 [[0.42312407 0.5768759 ]
  [0.         0.        ]
  [0.48875502 0.511245  ]
  [0.41165432 0.5883457 ]]

 [[0.6086974  0.3913026 ]
  [0.5721638  0.42783618]
  [0.         0.        ]
  [0.4842202  0.5157798 ]]

 [[0.03694047 0.96305954]
  [0.24493854 0.75506145]
  [0.31747696 0.682523  ]
  [0.         0.        ]]]

Rep 1,001.497:
[[[0.         0.        ]
  [0.49644306 0.50355697]
  [0.3170742  0.68292576]
  [0.1250902  0.8749098 ]]

 [[0.6699191  0.33008093]
  [0.         0.        ]
  [0.5121123  0.48788765]
  [0.16046233 0.8395376 ]]

 [[0.65926737 0.34073266]
  [0.72123694 0.27876306]
  [0.         0.        ]
  [0.29424983 0.70575017]]

 [[0.86685866 0.13314131]
  [0.81081176 0.18918824]
  [0.63081217 0.36918783]
  [0.         0.        ]]]

Rep 1,001.383:
[[[0.         0.        ]
  [0.30690876 0.6930912 ]
  [0.334081   0.665919  ]
  [0.7931807  0.20681925]]

 [[0.6666354  0.33336455]
  [0.         0.        ]
  [0.4010099  0.5989901 ]
  [0.8726876  0.12731244]]

 [[0.6140348  0.38596526]
  [0.39526746 0.6047326 ]
  [0.         0.        ]
  [0.7427381  0.2572618 ]]

 [[0.82885885 0.17114112]
  [0.5815501  0.4184499 ]
  [0.626674   0.37332597]
  [0.         0.        ]]]

Rep 1,001.215:
[[[0.         0.        ]
  [0.4680934  0.5319066 ]
  [0.23971315 0.7602868 ]
  [0.39600238 0.60399765]]

 [[0.28185597 0.718144  ]
  [0.         0.        ]
  [0.4453682  0.5546318 ]
  [0.34023312 0.65976685]]

 [[0.55742323 0.44257677]
  [0.7577154  0.24228461]
  [0.         0.        ]
  [0.5321887  0.4678113 ]]

 [[0.2699145  0.7300855 ]
  [0.634954   0.36504608]
  [0.3454727  0.6545273 ]
  [0.         0.        ]]]

Rep 1,001.371:
[[[0.         0.        ]
  [0.33806327 0.66193676]
  [0.33426318 0.66573685]
  [0.32737952 0.6726205 ]]

 [[0.5597608  0.4402392 ]
  [0.         0.        ]
  [0.3535008  0.64649916]
  [0.4149726  0.5850274 ]]

 [[0.83620876 0.16379125]
  [0.78592175 0.2140783 ]
  [0.         0.        ]
  [0.5843896  0.41561034]]

 [[0.6560572  0.34394288]
  [0.5568857  0.44311428]
  [0.30783525 0.6921648 ]
  [0.         0.        ]]]

Rep 1,001.203:
[[[0.         0.        ]
  [0.40095833 0.59904164]
  [0.2703542  0.7296458 ]
  [0.54993004 0.45006996]]

 [[0.669853   0.33014706]
  [0.         0.        ]
  [0.1879144  0.8120856 ]
  [0.51351565 0.48648438]]

 [[0.5309952  0.46900478]
  [0.34094366 0.6590563 ]
  [0.         0.        ]
  [0.5456255  0.45437446]]

 [[0.78347963 0.21652037]
  [0.5722808  0.42771915]
  [0.41051376 0.58948624]
  [0.         0.        ]]]

Rep 1,001.331:
[[[0.         0.        ]
  [0.46429783 0.53570217]
  [0.33166727 0.66833276]
  [0.36699167 0.6330083 ]]

 [[0.63768333 0.36231664]
  [0.         0.        ]
  [0.44303253 0.5569675 ]
  [0.5963273  0.40367267]]

 [[0.64831334 0.35168666]
  [0.46156332 0.5384367 ]
  [0.         0.        ]
  [0.4124873  0.58751273]]

 [[0.6595357  0.34046432]
  [0.34108573 0.65891427]
  [0.37526867 0.6247313 ]
  [0.         0.        ]]]

Rep 1,001.188:
[[[0.         0.        ]
  [0.32456836 0.6754316 ]
  [0.5835844  0.41641563]
  [0.78042966 0.21957034]]

 [[0.7156566  0.2843434 ]
  [0.         0.        ]
  [0.625603   0.374397  ]
  [0.5802319  0.4197681 ]]

 [[0.53800243 0.46199754]
  [0.30966306 0.69033694]
  [0.         0.        ]
  [0.3462443  0.6537557 ]]

 [[0.37879905 0.6212009 ]
  [0.21248174 0.78751826]
  [0.3057775  0.6942225 ]
  [0.         0.        ]]]

Rep 1,001.317:
[[[0.         0.        ]
  [0.7117799  0.28822008]
  [0.5876795  0.41232046]
  [0.7575008  0.24249919]]

 [[0.5670622  0.43293783]
  [0.         0.        ]
  [0.60654026 0.3934598 ]
  [0.7093424  0.29065764]]

 [[0.58094686 0.41905308]
  [0.6551742  0.3448258 ]
  [0.         0.        ]
  [0.77045685 0.22954318]]

 [[0.7715746  0.22842537]
  [0.50522286 0.4947771 ]
  [0.32606307 0.67393696]
  [0.         0.        ]]]

Rep 1,001.388:
[[[0.         0.        ]
  [0.31196517 0.68803483]
  [0.36218262 0.6378173 ]
  [0.566506   0.43349394]]

 [[0.5930338  0.40696624]
  [0.         0.        ]
  [0.30364466 0.6963553 ]
  [0.66975725 0.33024275]]

 [[0.6139289  0.3860711 ]
  [0.48059767 0.5194023 ]
  [0.         0.        ]
  [0.7931202  0.20687976]]

 [[0.7987078  0.20129222]
  [0.7626671  0.2373328 ]
  [0.5776631  0.42233682]
  [0.         0.        ]]]

Rep 1,001.298:
[[[0.         0.        ]
  [0.52555865 0.47444135]
  [0.32247463 0.67752534]
  [0.15899606 0.84100395]]

 [[0.45993373 0.5400663 ]
  [0.         0.        ]
  [0.5412934  0.45870662]
  [0.12991136 0.87008864]]

 [[0.34677905 0.6532209 ]
  [0.6273744  0.37262556]
  [0.         0.        ]
  [0.22452892 0.7754711 ]]

 [[0.57165605 0.42834398]
  [0.7239215  0.27607852]
  [0.42240718 0.5775928 ]
  [0.         0.        ]]]

Rep 1,001.468:
[[[0.         0.        ]
  [0.6109497  0.38905028]
  [0.46807116 0.53192884]
  [0.3929083  0.60709167]]

 [[0.49884024 0.5011598 ]
  [0.         0.        ]
  [0.5643622  0.43563777]
  [0.2808521  0.7191479 ]]

 [[0.415745   0.584255  ]
  [0.6921794  0.30782056]
  [0.         0.        ]
  [0.26456574 0.7354343 ]]

 [[0.0991272  0.9008728 ]
  [0.20687962 0.79312044]
  [0.16738097 0.832619  ]
  [0.         0.        ]]]

Rep 1,001.334:
[[[0.         0.        ]
  [0.46657518 0.53342485]
  [0.15621296 0.843787  ]
  [0.5997431  0.40025684]]

 [[0.3788438  0.62115616]
  [0.         0.        ]
  [0.28343692 0.7165631 ]
  [0.6563183  0.34368163]]

 [[0.45075315 0.5492468 ]
  [0.581721   0.41827893]
  [0.         0.        ]
  [0.7659205  0.23407954]]

 [[0.7364523  0.2635477 ]
  [0.6482401  0.3517599 ]
  [0.6158358  0.38416424]
  [0.         0.        ]]]

Rep 1,001.212:
[[[0.         0.        ]
  [0.42235103 0.577649  ]
  [0.2781583  0.72184175]
  [0.63689935 0.36310068]]

 [[0.34255883 0.6574412 ]
  [0.         0.        ]
  [0.55449104 0.4455089 ]
  [0.66906285 0.3309372 ]]

 [[0.35767633 0.6423236 ]
  [0.22894733 0.77105266]
  [0.         0.        ]
  [0.6372336  0.36276644]]

 [[0.31434143 0.6856586 ]
  [0.3847094  0.61529064]
  [0.21242233 0.7875777 ]
  [0.         0.        ]]]

Rep 1,001.164:
[[[0.         0.        ]
  [0.67053336 0.3294667 ]
  [0.65686846 0.34313157]
  [0.48325476 0.5167452 ]]

 [[0.6367242  0.3632758 ]
  [0.         0.        ]
  [0.69222987 0.30777016]
  [0.81664664 0.1833534 ]]

 [[0.43064132 0.5693587 ]
  [0.6821058  0.31789416]
  [0.         0.        ]
  [0.69185215 0.30814782]]

 [[0.5237516  0.4762484 ]
  [0.68946916 0.3105308 ]
  [0.44452327 0.5554768 ]
  [0.         0.        ]]]

Rep 1,001.247:
[[[0.         0.        ]
  [0.25005984 0.7499401 ]
  [0.26591876 0.73408127]
  [0.7057519  0.29424804]]

 [[0.56975603 0.43024397]
  [0.         0.        ]
  [0.24439101 0.75560904]
  [0.6083948  0.39160526]]

 [[0.3940667  0.60593337]
  [0.32327455 0.67672545]
  [0.         0.        ]
  [0.4317899  0.56821007]]

 [[0.36368072 0.6363192 ]
  [0.2815427  0.71845734]
  [0.17655064 0.8234494 ]
  [0.         0.        ]]]

Rep 1,001.161:
[[[0.         0.        ]
  [0.58911395 0.41088605]
  [0.31699407 0.6830059 ]
  [0.4109088  0.5890912 ]]

 [[0.6807451  0.31925488]
  [0.         0.        ]
  [0.34258953 0.6574105 ]
  [0.7322298  0.2677701 ]]

 [[0.6965329  0.3034671 ]
  [0.7033762  0.29662383]
  [0.         0.        ]
  [0.44771215 0.5522879 ]]

 [[0.5450942  0.45490578]
  [0.7367362  0.26326385]
  [0.27780446 0.7221955 ]
  [0.         0.        ]]]

Rep 1,001.163:
[[[0.         0.        ]
  [0.2997212  0.70027876]
  [0.4053552  0.5946448 ]
  [0.76173776 0.2382623 ]]

 [[0.19229597 0.80770403]
  [0.         0.        ]
  [0.23892553 0.7610745 ]
  [0.38571954 0.61428046]]

 [[0.4016901  0.59830993]
  [0.34982398 0.65017605]
  [0.         0.        ]
  [0.5546113  0.4453887 ]]

 [[0.5702836  0.42971638]
  [0.5079677  0.49203232]
  [0.49302676 0.5069732 ]
  [0.         0.        ]]]

Rep 1,001.177:
[[[0.         0.        ]
  [0.36693606 0.633064  ]
  [0.3105852  0.68941486]
  [0.67835754 0.3216425 ]]

 [[0.37717775 0.6228223 ]
  [0.         0.        ]
  [0.30092183 0.69907814]
  [0.5829861  0.41701385]]

 [[0.5506635  0.44933653]
  [0.688626   0.31137398]
  [0.         0.        ]
  [0.76559114 0.23440883]]

 [[0.70565176 0.29434824]
  [0.46866405 0.5313359 ]
  [0.44720757 0.5527925 ]
  [0.         0.        ]]]

Rep 1,001.358:
[[[0.         0.        ]
  [0.7467175  0.25328255]
  [0.41327864 0.58672136]
  [0.09474292 0.90525705]]

 [[0.47941238 0.5205876 ]
  [0.         0.        ]
  [0.4565695  0.5434305 ]
  [0.092906   0.90709406]]

 [[0.33236077 0.66763926]
  [0.7530204  0.24697956]
  [0.         0.        ]
  [0.10235052 0.89764947]]

 [[0.57108533 0.42891467]
  [0.66541153 0.3345884 ]
  [0.28678894 0.7132111 ]
  [0.         0.        ]]]

Rep 1,001.363:
[[[0.         0.        ]
  [0.5428623  0.4571377 ]
  [0.3529862  0.64701384]
  [0.81758684 0.18241315]]

 [[0.47379717 0.5262028 ]
  [0.         0.        ]
  [0.38485715 0.6151428 ]
  [0.8517652  0.14823481]]

 [[0.67050254 0.32949746]
  [0.4974989  0.50250113]
  [0.         0.        ]
  [0.8376466  0.1623534 ]]

 [[0.546687   0.453313  ]
  [0.59168863 0.40831134]
  [0.5130375  0.4869625 ]
  [0.         0.        ]]]

Rep 1,001.396:
[[[0.         0.        ]
  [0.3024509  0.6975491 ]
  [0.38570544 0.6142946 ]
  [0.4813529  0.5186471 ]]

 [[0.51071084 0.4892892 ]
  [0.         0.        ]
  [0.5374731  0.4625269 ]
  [0.307814   0.692186  ]]

 [[0.5098301  0.49016985]
  [0.3466942  0.6533058 ]
  [0.         0.        ]
  [0.15017347 0.8498265 ]]

 [[0.8226166  0.17738338]
  [0.6062325  0.39376745]
  [0.56246644 0.43753353]
  [0.         0.        ]]]

Rep 1,001.114:
[[[0.         0.        ]
  [0.6738911  0.32610887]
  [0.5022121  0.49778786]
  [0.83289635 0.16710363]]

 [[0.47902653 0.52097344]
  [0.         0.        ]
  [0.31127688 0.68872315]
  [0.47467926 0.5253207 ]]

 [[0.38655248 0.61344755]
  [0.37263048 0.6273695 ]
  [0.         0.        ]
  [0.43072158 0.5692784 ]]

 [[0.7619504  0.23804966]
  [0.7951759  0.20482409]
  [0.661406   0.33859402]
  [0.         0.        ]]]

Rep 1,001.262:
[[[0.         0.        ]
  [0.38758248 0.61241746]
  [0.5041402  0.49585974]
  [0.72919416 0.27080584]]

 [[0.35129726 0.64870274]
  [0.         0.        ]
  [0.52605015 0.47394982]
  [0.58795625 0.4120438 ]]

 [[0.26349935 0.7365006 ]
  [0.4346188  0.56538117]
  [0.         0.        ]
  [0.47676042 0.52323955]]

 [[0.3487588  0.6512412 ]
  [0.41711628 0.5828837 ]
  [0.41623977 0.58376026]
  [0.         0.        ]]]

Rep 1,001.469:
[[[0.         0.        ]
  [0.47768274 0.5223173 ]
  [0.63543355 0.36456645]
  [0.6722538  0.32774618]]

 [[0.49997687 0.5000231 ]
  [0.         0.        ]
  [0.6136423  0.3863577 ]
  [0.8509463  0.14905368]]

 [[0.3768621  0.6231379 ]
  [0.41415873 0.5858413 ]
  [0.         0.        ]
  [0.6181376  0.3818624 ]]

 [[0.38161227 0.61838776]
  [0.3556257  0.6443743 ]
  [0.40354937 0.5964506 ]
  [0.         0.        ]]]

Rep 1,001.186:
[[[0.         0.        ]
  [0.76315105 0.236849  ]
  [0.58929163 0.41070837]
  [0.6783042  0.32169583]]

 [[0.70206314 0.29793683]
  [0.         0.        ]
  [0.5973371  0.40266293]
  [0.7528285  0.24717149]]

 [[0.44446522 0.5555347 ]
  [0.56936044 0.43063954]
  [0.         0.        ]
  [0.62477404 0.37522596]]

 [[0.26357213 0.7364279 ]
  [0.1250477  0.8749523 ]
  [0.07881733 0.92118263]
  [0.         0.        ]]]

Rep 1,001.285:
[[[0.         0.        ]
  [0.520571   0.47942898]
  [0.5191492  0.4808508 ]
  [0.3015359  0.6984641 ]]

 [[0.6022939  0.3977061 ]
  [0.         0.        ]
  [0.56205004 0.43794996]
  [0.44955236 0.5504476 ]]

 [[0.44481212 0.5551879 ]
  [0.48049796 0.51950204]
  [0.         0.        ]
  [0.27161998 0.72838   ]]

 [[0.7914334  0.20856668]
  [0.72720885 0.27279115]
  [0.70292413 0.29707584]
  [0.         0.        ]]]

Rep 1,001.311:
[[[0.         0.        ]
  [0.53732216 0.4626778 ]
  [0.46653986 0.5334602 ]
  [0.6995819  0.30041805]]

 [[0.28394    0.71606004]
  [0.         0.        ]
  [0.47020978 0.5297902 ]
  [0.7707636  0.22923638]]

 [[0.35962468 0.6403753 ]
  [0.5501527  0.44984728]
  [0.         0.        ]
  [0.6708443  0.32915568]]

 [[0.32171074 0.67828923]
  [0.47736564 0.5226343 ]
  [0.41718826 0.5828117 ]
  [0.         0.        ]]]

Rep 1,001.286:
[[[0.         0.        ]
  [0.50182784 0.4981722 ]
  [0.64572704 0.35427293]
  [0.83792645 0.16207355]]

 [[0.54474676 0.45525318]
  [0.         0.        ]
  [0.48574325 0.5142568 ]
  [0.65930367 0.34069633]]

 [[0.60747033 0.39252967]
  [0.49544767 0.5045523 ]
  [0.         0.        ]
  [0.6881127  0.31188738]]

 [[0.7865404  0.21345966]
  [0.7484378  0.25156218]
  [0.77481276 0.22518729]
  [0.         0.        ]]]

Rep 1,001.325:
[[[0.         0.        ]
  [0.72155267 0.27844733]
  [0.42256272 0.5774373 ]
  [0.2180444  0.7819556 ]]

 [[0.6488209  0.3511791 ]
  [0.         0.        ]
  [0.5531106  0.4468894 ]
  [0.21913266 0.78086734]]

 [[0.6959841  0.30401587]
  [0.858958   0.14104202]
  [0.         0.        ]
  [0.48803332 0.5119667 ]]

 [[0.7048137  0.29518628]
  [0.73405945 0.26594058]
  [0.50738966 0.49261037]
  [0.         0.        ]]]

Rep 1,001.107:
[[[0.         0.        ]
  [0.36229986 0.6377001 ]
  [0.42319757 0.5768025 ]
  [0.40982547 0.59017456]]

 [[0.715872   0.28412798]
  [0.         0.        ]
  [0.56698483 0.43301517]
  [0.6753922  0.32460776]]

 [[0.5507089  0.4492911 ]
  [0.3462148  0.65378517]
  [0.         0.        ]
  [0.32050708 0.67949295]]

 [[0.9009309  0.09906909]
  [0.65816313 0.34183684]
  [0.62157136 0.3784286 ]
  [0.         0.        ]]]

Rep 1,001.494:
[[[0.         0.        ]
  [0.5018751  0.4981249 ]
  [0.40683267 0.5931673 ]
  [0.7073083  0.2926917 ]]

 [[0.6807419  0.31925815]
  [0.         0.        ]
  [0.39010495 0.60989505]
  [0.73204464 0.26795536]]

 [[0.48180252 0.5181975 ]
  [0.35799742 0.6420026 ]
  [0.         0.        ]
  [0.7411078  0.25889215]]

 [[0.94231373 0.05768625]
  [0.9086386  0.0913614 ]
  [0.81666285 0.18333712]
  [0.         0.        ]]]

Rep 1,001.237:
[[[0.         0.        ]
  [0.7149607  0.2850393 ]
  [0.5180465  0.48195353]
  [0.6302759  0.36972407]]

 [[0.38527688 0.61472315]
  [0.         0.        ]
  [0.37444678 0.62555325]
  [0.4452857  0.55471426]]

 [[0.5988853  0.40111467]
  [0.8701554  0.12984458]
  [0.         0.        ]
  [0.5992289  0.4007711 ]]

 [[0.45265642 0.5473436 ]
  [0.41869226 0.58130777]
  [0.24342875 0.7565713 ]
  [0.         0.        ]]]

Rep 1,001.115:
[[[0.         0.        ]
  [0.431871   0.568129  ]
  [0.28527516 0.71472484]
  [0.80320024 0.19679978]]

 [[0.58806634 0.41193366]
  [0.         0.        ]
  [0.28987288 0.7101271 ]
  [0.61505395 0.38494605]]

 [[0.51428545 0.48571452]
  [0.26446334 0.7355367 ]
  [0.         0.        ]
  [0.6209617  0.37903827]]

 [[0.4581219  0.5418781 ]
  [0.28273383 0.7172662 ]
  [0.1591346  0.84086543]
  [0.         0.        ]]]

Rep 1,001.491:
[[[0.         0.        ]
  [0.6482482  0.35175174]
  [0.6132361  0.38676387]
  [0.87157726 0.1284227 ]]

 [[0.47875175 0.5212482 ]
  [0.         0.        ]
  [0.5688478  0.4311522 ]
  [0.74419683 0.25580323]]

 [[0.5399141  0.46008593]
  [0.5064573  0.4935426 ]
  [0.         0.        ]
  [0.62032485 0.37967512]]

 [[0.77868813 0.22131188]
  [0.45307836 0.5469217 ]
  [0.41129968 0.5887003 ]
  [0.         0.        ]]]

Rep 1,001.409:
[[[0.         0.        ]
  [0.7931634  0.20683657]
  [0.5752936  0.4247064 ]
  [0.5556109  0.44438913]]

 [[0.48725152 0.5127485 ]
  [0.         0.        ]
  [0.6134659  0.38653412]
  [0.4097971  0.59020287]]

 [[0.7565711  0.24342892]
  [0.9012576  0.09874242]
  [0.         0.        ]
  [0.6181765  0.38182348]]

 [[0.60763574 0.39236423]
  [0.48186755 0.51813245]
  [0.33641472 0.66358525]
  [0.         0.        ]]]

Rep 1,001.223:
[[[0.         0.        ]
  [0.2734748  0.7265252 ]
  [0.32622918 0.6737708 ]
  [0.44918275 0.5508173 ]]

 [[0.5964404  0.40355965]
  [0.         0.        ]
  [0.3965192  0.60348076]
  [0.6152857  0.38471428]]

 [[0.6227314  0.37726858]
  [0.3130688  0.68693113]
  [0.         0.        ]
  [0.6207228  0.37927726]]

 [[0.7255996  0.27440044]
  [0.34892282 0.6510772 ]
  [0.5068289  0.4931711 ]
  [0.         0.        ]]]

Rep 1,001.497:
[[[0.         0.        ]
  [0.6799599  0.3200401 ]
  [0.6145693  0.3854307 ]
  [0.4904734  0.50952655]]

 [[0.73570114 0.26429886]
  [0.         0.        ]
  [0.51128495 0.48871508]
  [0.23983824 0.7601617 ]]

 [[0.5260686  0.47393143]
  [0.5769794  0.4230206 ]
  [0.         0.        ]
  [0.12333856 0.87666136]]

 [[0.3168762  0.6831238 ]
  [0.19235714 0.8076429 ]
  [0.17044722 0.8295528 ]
  [0.         0.        ]]]

Rep 1,001.227:
[[[0.         0.        ]
  [0.53665984 0.4633402 ]
  [0.32641345 0.6735865 ]
  [0.2369613  0.7630387 ]]

 [[0.24130172 0.7586983 ]
  [0.         0.        ]
  [0.25103354 0.7489664 ]
  [0.14162946 0.85837054]]

 [[0.4033199  0.5966801 ]
  [0.68274325 0.31725678]
  [0.         0.        ]
  [0.38862205 0.61137795]]

 [[0.6100095  0.38999054]
  [0.8129812  0.18701887]
  [0.70381016 0.2961898 ]
  [0.         0.        ]]]

Rep 1,001.281:
[[[0.         0.        ]
  [0.6466731  0.35332695]
  [0.66705084 0.33294916]
  [0.6703993  0.32960072]]

 [[0.65221715 0.34778282]
  [0.         0.        ]
  [0.501435   0.49856502]
  [0.37972283 0.6202772 ]]

 [[0.7533897  0.24661025]
  [0.7865993  0.21340072]
  [0.         0.        ]
  [0.6014438  0.3985562 ]]

 [[0.5145077  0.48549226]
  [0.25222152 0.7477785 ]
  [0.15058638 0.8494136 ]
  [0.         0.        ]]]

Rep 1,001.404:
[[[0.         0.        ]
  [0.48525497 0.514745  ]
  [0.39183542 0.60816455]
  [0.59110266 0.40889734]]

 [[0.41791847 0.58208156]
  [0.         0.        ]
  [0.23648567 0.7635143 ]
  [0.5870871  0.41291288]]

 [[0.3654347  0.6345653 ]
  [0.4317188  0.56828123]
  [0.         0.        ]
  [0.69403577 0.30596417]]

 [[0.6713453  0.3286547 ]
  [0.550062   0.449938  ]
  [0.48275486 0.5172451 ]
  [0.         0.        ]]]

Rep 1,001.636:
[[[0.         0.        ]
  [0.6590693  0.34093064]
  [0.45192793 0.54807204]
  [0.14507341 0.8549266 ]]

 [[0.6493723  0.3506277 ]
  [0.         0.        ]
  [0.6859465  0.31405348]
  [0.25744537 0.7425546 ]]

 [[0.49304417 0.50695586]
  [0.5643296  0.43567038]
  [0.         0.        ]
  [0.2753679  0.7246321 ]]

 [[0.60648096 0.393519  ]
  [0.56726146 0.4327385 ]
  [0.4546366  0.5453634 ]
  [0.         0.        ]]]

Rep 1,001.686:
[[[0.         0.        ]
  [0.59165895 0.40834108]
  [0.36492735 0.63507265]
  [0.44695413 0.5530458 ]]

 [[0.67878187 0.32121816]
  [0.         0.        ]
  [0.49131247 0.50868756]
  [0.26495817 0.7350418 ]]

 [[0.5365054  0.4634946 ]
  [0.7592027  0.24079725]
  [0.         0.        ]
  [0.3882135  0.6117865 ]]

 [[0.12063862 0.8793614 ]
  [0.38748652 0.6125134 ]
  [0.3764075  0.6235925 ]
  [0.         0.        ]]]

Rep 1,001.132:
[[[0.         0.        ]
  [0.78227234 0.21772774]
  [0.45686704 0.54313296]
  [0.13310836 0.8668917 ]]

 [[0.3368417  0.66315836]
  [0.         0.        ]
  [0.32520998 0.67479   ]
  [0.05832486 0.9416751 ]]

 [[0.47055483 0.5294452 ]
  [0.82220757 0.17779244]
  [0.         0.        ]
  [0.0895699  0.9104301 ]]

 [[0.47693002 0.52307   ]
  [0.41805756 0.58194244]
  [0.2595968  0.74040323]
  [0.         0.        ]]]

Rep 1,001.416:
[[[0.         0.        ]
  [0.5040461  0.4959539 ]
  [0.31530675 0.6846932 ]
  [0.6621898  0.33781025]]

 [[0.62698096 0.37301898]
  [0.         0.        ]
  [0.2377573  0.7622427 ]
  [0.74020386 0.25979617]]

 [[0.5827101  0.41728988]
  [0.5226951  0.47730482]
  [0.         0.        ]
  [0.6450906  0.35490948]]

 [[0.91151124 0.08848878]
  [0.7790601  0.22093983]
  [0.44105625 0.55894375]
  [0.         0.        ]]]

Rep 1,001.490:
[[[0.         0.        ]
  [0.7521476  0.24785241]
  [0.53163606 0.46836397]
  [0.18491621 0.81508374]]

 [[0.6567179  0.3432821 ]
  [0.         0.        ]
  [0.6113413  0.38865864]
  [0.3178034  0.6821966 ]]

 [[0.7834858  0.2165142 ]
  [0.7735698  0.2264302 ]
  [0.         0.        ]
  [0.47355118 0.5264488 ]]

 [[0.6771576  0.3228424 ]
  [0.5407927  0.45920727]
  [0.2729981  0.72700197]
  [0.         0.        ]]]

Rep 1,001.348:
[[[0.         0.        ]
  [0.32814318 0.6718568 ]
  [0.44980147 0.55019855]
  [0.5466772  0.45332283]]

 [[0.7293327  0.27066737]
  [0.         0.        ]
  [0.32099357 0.6790064 ]
  [0.5366162  0.46338382]]

 [[0.63400114 0.36599886]
  [0.5041265  0.49587354]
  [0.         0.        ]
  [0.6234589  0.37654108]]

 [[0.95827764 0.04172233]
  [0.85493153 0.14506842]
  [0.72385085 0.27614918]
  [0.         0.        ]]]

Test metrics and hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3\test

---------------------------------------------------------------------------

<<<<<<<<<<<< DECODER OUTPUT PLOT (TEST) >>>>>>>>>>>>

Creating decoder output plot for rep '1,001.221' for [m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3...

Decoder output plot for rep '1001.2211' logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\topology_estimation\logs\mass_sp_dm\M004\scene_1\nri\train\etypes=2\m004\apv\set_G\E=f_mlp1_og_D=gru\tswp_0\[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3\test

Testing DataLoader 0: 100%|##############################################################| 10/10 [00:03<00:00,  2.97it/s]

        Test metric               DataLoader 0        

       dec/test_loss           0.35422977805137634    
  enc/test_edge_accuracy       0.5216666460037231     
     enc/test_entropy          0.6154941916465759     
       enc/test_loss           0.9318355917930603     
       nri/test_loss           1.7784607410430908     


===========================================================================

Nri model '[m004_(apv+G)]-(E=f_mlp1_og_D=gru)_edge_est_2.3' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-09-15 10:58:41
