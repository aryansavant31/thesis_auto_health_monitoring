=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: [gearbox_1_(acc+G)]-IF_fdet_9
Start Time: 2025-09-22 18:47:16
End Time: 2025-09-22 18:47:59

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


Dataset selections:
---------------------------------------------
*_(<ds_subtype_num>) <ds_subtype> : [<augments>]_*

- **Healthy configs**
  (1) 0_N    : [OG]

- **Unhealthy configs**
  (1) 0_B-007    : [OG]

- **Unknown configs**


Node and signal types:
---------------------------------------------
*_(<node_num>) <node_type> : [<signal_types>]_*

  (1) gearbox   : [acc]

Node group name: gearbox_1
Signal group name: acc


For ds_type 'OK' and others....
---------------------------------------------
Maximum timesteps across all node types: 243,938

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

For ds_type 'NOK' and others....
---------------------------------------------
Maximum timesteps across all node types: 244,739

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

Target rep_num 1001.0001 found at index 0. This sample will be included in the test set.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
------------------------------------------------------------
Total samples: 487 
Train: 389/389 [OK=194, NOK=195, UK=0], Test: 97/97 [OK=49, NOK=48, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 389
torch.Size([1, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 97
torch.Size([1, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: 0.48

---------------------------------------------------------------------------

Initializing feature selector for anomaly detection model...

>> Feature selector initialized with LDA

Starting feature selection...
feat_Data_np shape: (389, 37)

Top 10 features selected: ['mean_abs', 'hist_upper_bound', 'variance', 'hist_lower_bound', 'max', 'normalized_std', 'rms', 'peak_value', 'sixth_moment', 'peak_to_peak']
Feature selection completed. Updating the anomaly detector model to use selected features

---------------------------------------------------------------------------
'Version 1' already exists in the log path 'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Next model number folder will be: [gearbox_1_(acc+G)]-IF_fdet_9
Model parameters saved to C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_9.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_9

---------------------------------------------------------------------------

<<<<<<<<<<<< FEATURE RANKING PLOT>>>>>>>>>>>>

> Creating feature ranking for [gearbox_1_(acc+G)]-IF_fdet_9 / train...
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\feature_extraction\selector.py:181: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

  feat_rank_plot = sns.barplot(x=self.feat_ranking.values, y=self.feat_ranking.index, palette="viridis")

Feature ranking plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_9


Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> Feature normalizer initialized with 'std' normalization

>> Time feature extractor initialized with features: from_ranks(feat_list=['mean_abs', 'hist_upper_bound', 'variance', 'hist_lower_bound', 'max', 'normalized_std', 'rms', 'peak_value', 'sixth_moment', 'peak_to_peak'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['mean_abs_0', 'hist_upper_bound_0', 'variance_0', 'hist_lower_bound_0', 'max_0', 'normalized_std_0', 'rms_0', 'peak_value_0', 'sixth_moment_0', 'peak_to_peak_0']

Fitting anomaly detection model...

Model fitted successfully in 1.39 seconds

Training inference completed in 0.12 seconds

Training accuracy: 0.73

OK lower bound (at 100.0 percentile): 0.0000

NOK upper bound (at 100.0 percentile): -0.0000

Dataframe is as follows:
     mean_abs_0  hist_upper_bound_0  variance_0  hist_lower_bound_0  ...    rep_num    scores  pred_label  final_pred_label
0     -0.468383            0.156748   -0.639604           -1.327764  ...  1001.0058 -0.059015          -1                -1
1     -0.302700            0.890612   -0.599462           -1.550822  ...  1001.0005 -0.039499          -1                -1
2     -0.302613            0.784412   -0.594023           -1.833510  ...  1001.0084  0.018198           1                 1
3     -0.478482           -0.079781   -0.641885           -1.174390  ...  1001.0078  0.004631           1                 1
4     -0.475761           -0.055352   -0.641278           -1.240708  ...  1001.0082  0.047971           1                 1
..          ...                 ...         ...                 ...  ...        ...       ...         ...               ...
384   -0.476953           -0.027818   -0.641139           -1.263242  ...  1001.0172  0.052935           1                 1
385   -0.490574           -0.054734   -0.643354           -1.225696  ...  1001.0221  0.028799           1                 1
386   -0.464528            0.111067   -0.639287           -1.294588  ...  1001.0202 -0.031056          -1                -1
387   -0.356544            0.390762   -0.615432           -1.455490  ...  1001.0025 -0.116191          -1                -1
388   -0.466911            0.088520   -0.639980           -1.238904  ...  1001.0212 -0.004132          -1                -1

[389 rows x 15 columns]

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_9

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_9\anomaly_detector.pkl

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_9 / train...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_9


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for [gearbox_1_(acc+G)]-IF_fdet_9 / train...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_9


Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_9\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> Feature normalizer initialized with 'std' normalization

>> Time feature extractor initialized with features: from_ranks(feat_list=['mean_abs', 'hist_upper_bound', 'variance', 'hist_lower_bound', 'max', 'normalized_std', 'rms', 'peak_value', 'sixth_moment', 'peak_to_peak'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['mean_abs_0', 'hist_upper_bound_0', 'variance_0', 'hist_lower_bound_0', 'max_0', 'normalized_std_0', 'rms_0', 'peak_value_0', 'sixth_moment_0', 'peak_to_peak_0']

Test inference completed in 0.13 seconds

NOK upper bound (at 100.0 percentile): -0.1383

OK lower bound (from training): 0.0000

NOK upper bound (from testing): -0.1383

Dataframe is as follows:
    mean_abs_0  hist_upper_bound_0  variance_0  hist_lower_bound_0  ...    rep_num    scores  pred_label  final_pred_label
0    -0.425798            0.058308   -0.599576           -1.232953  ...  1001.0001 -0.181073          -1                -1
1    -0.278609            0.818450   -0.557729           -2.005374  ...  1001.0240 -0.150806          -1                -1
2    -0.266896            0.522127   -0.561795           -1.646363  ...  1001.0134 -0.179315          -1                -1
3    -0.195589            0.776360   -0.532507           -1.884439  ...  1001.0132 -0.223297          -1                -1
4    -0.252245            1.040267   -0.547196           -2.070792  ...  1001.0209 -0.198874          -1                -1
..         ...                 ...         ...                 ...  ...        ...       ...         ...               ...
92   -0.307411            0.746449   -0.572876           -1.548192  ...  1001.0140 -0.152709          -1                -1
93   -0.423937           -0.059360   -0.599321           -1.259405  ...  1001.0149 -0.177647          -1                -1
94   -0.427816            0.040862   -0.600164           -1.256868  ...  1001.0234 -0.178867          -1                -1
95   -0.187977            0.940061   -0.527117           -2.106305  ...  1001.0074 -0.239093          -1                -1
96   -0.240405            0.624982   -0.552324           -1.736292  ...  1001.0159 -0.193567          -1                -1

[97 rows x 15 columns]

Test accuracy: 0.49
Precision: 0.49, Recall: 1.00, F1-score: 0.66

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_9\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_9 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_9\test


===========================================================================

Fault detection model '[gearbox_1_(acc+G)]-IF_fdet_9' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-09-22 18:47:59
