=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: [gearbox_1_(acc+G)]-IF_fdet_12
Start Time: 2025-09-22 18:53:48
End Time: 2025-09-22 18:54:09

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


Dataset selections:
---------------------------------------------
*_(<ds_subtype_num>) <ds_subtype> : [<augments>]_*

- **Healthy configs**
  (1) 0_N    : [OG]
  (2) 1_N    : [OG]

- **Unhealthy configs**
  (1) 0_B-007    : [OG]

- **Unknown configs**


Node and signal types:
---------------------------------------------
*_(<node_num>) <node_type> : [<signal_types>]_*

  (1) gearbox   : [acc]

Node group name: gearbox_1
Signal group name: acc


For ds_type 'OK' and others....
---------------------------------------------
Maximum timesteps across all node types: 483,903

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

For ds_type 'NOK' and others....
---------------------------------------------
Maximum timesteps across all node types: 244,739

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

Target rep_num 1001.0001 found at index 0. This sample will be included in the test set.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
------------------------------------------------------------
Total samples: 970 
Train: 776/776 [OK=579, NOK=197, UK=0], Test: 194/194 [OK=147, NOK=47, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 0 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 776
torch.Size([1, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 194
torch.Size([1, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: 0.2

---------------------------------------------------------------------------

Initializing feature selector for anomaly detection model...

>> Feature selector initialized with LDA

Starting feature selection...
feat_Data_np shape: (776, 37)

Top 10 features selected: ['rms', 'mean_abs', 'variance', 'std', 'peak_to_peak', 'min', 'max', 'peak_value', 'skewness', 'hist_upper_bound']
Feature selection completed. Updating the anomaly detector model to use selected features

---------------------------------------------------------------------------
'Version 1' already exists in the log path 'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Next model number folder will be: [gearbox_1_(acc+G)]-IF_fdet_12
Model parameters saved to C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_12.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_12

---------------------------------------------------------------------------

<<<<<<<<<<<< FEATURE RANKING PLOT>>>>>>>>>>>>

> Creating feature ranking for [gearbox_1_(acc+G)]-IF_fdet_12 / train...
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\feature_extraction\selector.py:181: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

  feat_rank_plot = sns.barplot(x=self.feat_ranking.values, y=self.feat_ranking.index, palette="viridis")

Feature ranking plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_12


Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> Time feature extractor initialized with features: from_ranks(feat_list=['rms', 'mean_abs', 'variance', 'std', 'peak_to_peak', 'min', 'max', 'peak_value', 'skewness', 'hist_upper_bound'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['rms_0', 'mean_abs_0', 'variance_0', 'std_0', 'peak_to_peak_0', 'min_0', 'max_0', 'peak_value_0', 'skewness_0', 'hist_upper_bound_0']

Fitting anomaly detection model...

Model fitted successfully in 1.62 seconds

Training inference completed in 0.15 seconds

Training accuracy: 0.90

OK lower bound (at 100.0 percentile): 0.0000

NOK upper bound (at 100.0 percentile): -0.0001

Dataframe is as follows:
        rms_0  mean_abs_0  variance_0     std_0  ...    rep_num    scores  pred_label  final_pred_label
0    0.150606    0.117291    0.021488  0.146586  ...  1001.0211  0.003257           1                 1
1    0.070686    0.057047    0.004827  0.069474  ...  1001.0014  0.084996           1                 1
2    0.069457    0.055572    0.004628  0.068033  ...  1002.0363  0.129191           1                 1
3    0.073561    0.059026    0.005204  0.072137  ...  1001.0156  0.109537           1                 1
4    0.073226    0.058997    0.005183  0.071995  ...  1002.0366  0.113327           1                 1
..        ...         ...         ...       ...  ...        ...       ...         ...               ...
771  0.075717    0.061212    0.005524  0.074324  ...  1001.0046  0.074391           1                 1
772  0.064732    0.052665    0.004117  0.064164  ...  1002.0263  0.076427           1                 1
773  0.065237    0.052371    0.004138  0.064329  ...  1002.0140  0.091162           1                 1
774  0.065763    0.053892    0.004038  0.063543  ...  1002.0333  0.069274           1                 1
775  0.128052    0.102270    0.015623  0.124990  ...  1001.0177 -0.024258          -1                -1

[776 rows x 15 columns]

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_12

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_12\anomaly_detector.pkl

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_12 / train...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_12


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for [gearbox_1_(acc+G)]-IF_fdet_12 / train...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_12


Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_12\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> Time feature extractor initialized with features: from_ranks(feat_list=['rms', 'mean_abs', 'variance', 'std', 'peak_to_peak', 'min', 'max', 'peak_value', 'skewness', 'hist_upper_bound'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['rms_0', 'mean_abs_0', 'variance_0', 'std_0', 'peak_to_peak_0', 'min_0', 'max_0', 'peak_value_0', 'skewness_0', 'hist_upper_bound_0']

Test inference completed in 0.21 seconds

NOK upper bound (at 100.0 percentile): -0.0003

OK lower bound (from training): 0.0000

NOK upper bound (from testing): -0.0003

Dataframe is as follows:
        rms_0  mean_abs_0  variance_0     std_0  ...    rep_num    scores  pred_label  final_pred_label
0    0.076116    0.061736    0.005641  0.075106  ...  1001.0001  0.088182           1                 1
1    0.067831    0.055887    0.004384  0.066213  ...  1002.0394  0.120854           1                 1
2    0.150064    0.122180    0.021655  0.147157  ...  1001.0100  0.014659           1                 1
3    0.059040    0.047063    0.003355  0.057921  ...  1002.0055  0.030730           1                 1
4    0.067211    0.054308    0.004419  0.066477  ...  1002.0287  0.132734           1                 1
..        ...         ...         ...       ...  ...        ...       ...         ...               ...
189  0.144980    0.115398    0.019667  0.140240  ...  1001.0018  0.023711           1                 1
190  0.136079    0.108804    0.017357  0.131747  ...  1001.0072  0.016099           1                 1
191  0.060979    0.048770    0.003628  0.060234  ...  1002.0057  0.070193           1                 1
192  0.073480    0.058138    0.005197  0.072088  ...  1001.0074  0.088357           1                 1
193  0.153838    0.121098    0.022629  0.150430  ...  1001.0003 -0.039772          -1                -1

[194 rows x 15 columns]

Test accuracy: 0.92
Precision: 0.92, Recall: 0.72, F1-score: 0.81

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_12\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_12 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_12\test


===========================================================================

Fault detection model '[gearbox_1_(acc+G)]-IF_fdet_12' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-09-22 18:54:09
