=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: [gearbox_1_(acc+G)]-SVC_fdet_1
Start Time: 2025-09-22 19:18:20
End Time: 2025-09-22 19:18:38

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


Dataset selections:
---------------------------------------------
*_(<ds_subtype_num>) <ds_subtype> : [<augments>]_*

- **Healthy configs**
  (1) 0_N    : [OG]
  (2) 1_N    : [OG]

- **Unhealthy configs**
  (1) 0_B-007    : [OG]

- **Unknown configs**


Node and signal types:
---------------------------------------------
*_(<node_num>) <node_type> : [<signal_types>]_*

  (1) gearbox   : [acc]

Node group name: gearbox_1
Signal group name: acc


For ds_type 'OK' and others....
---------------------------------------------
Maximum timesteps across all node types: 483,903

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

For ds_type 'NOK' and others....
---------------------------------------------
Maximum timesteps across all node types: 244,739

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

Target rep_num 1001.0001 found at index 0. This sample will be included in the test set.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
------------------------------------------------------------
Total samples: 970 
Train: 776/776 [OK=577, NOK=199, UK=0], Test: 194/194 [OK=149, NOK=45, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 0 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 776
torch.Size([1, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 194
torch.Size([1, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: SVC

---------------------------------------------------------------------------

Initializing feature selector for anomaly detection model...

>> Feature selector initialized with LDA

Starting feature selection...
feat_Data_np shape: (776, 37)

Top 10 features selected: ['mean_abs', 'rms', 'min', 'hist_upper_bound', 'std', 'peak_value', 'hist_lower_bound', 'max', 'variance', 'difference_variance']
Feature selection completed. Updating the anomaly detector model to use selected features

---------------------------------------------------------------------------
Model parameters saved to C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\SVC\tswp_0\[gearbox_1_(acc+G)]-SVC_fdet_1.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\SVC\tswp_0\[gearbox_1_(acc+G)]-SVC_fdet_1

---------------------------------------------------------------------------

<<<<<<<<<<<< FEATURE RANKING PLOT>>>>>>>>>>>>

> Creating feature ranking for [gearbox_1_(acc+G)]-SVC_fdet_1 / train...
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\feature_extraction\selector.py:181: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

  feat_rank_plot = sns.barplot(x=self.feat_ranking.values, y=self.feat_ranking.index, palette="viridis")

Feature ranking plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\SVC\tswp_0\[gearbox_1_(acc+G)]-SVC_fdet_1


Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> Time feature extractor initialized with features: from_ranks(feat_list=['mean_abs', 'rms', 'min', 'hist_upper_bound', 'std', 'peak_value', 'hist_lower_bound', 'max', 'variance', 'difference_variance'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['mean_abs_0', 'rms_0', 'min_0', 'hist_upper_bound_0', 'std_0', 'peak_value_0', 'hist_lower_bound_0', 'max_0', 'variance_0', 'difference_variance_0']

Fitting anomaly detection model...

Model fitted successfully in 0.40 seconds

Training inference completed in 0.01 seconds

Training accuracy: 1.00

OK lower bound (at 100.0 percentile): 0.4566

NOK upper bound (at 100.0 percentile): -0.2738

Dataframe is as follows:
     mean_abs_0     rms_0     min_0  hist_upper_bound_0  ...    rep_num    scores  pred_label  final_pred_label
0      0.054169  0.065783 -0.170856            0.163513  ...  1002.0217  1.892606         1.0                 1
1      0.060164  0.074249 -0.208615            0.188578  ...  1001.0034  1.571649         1.0                 1
2      0.123961  0.151447 -0.348596            0.451427  ...  1001.0131 -1.776491        -1.0                -1
3      0.059038  0.072199 -0.178783            0.193990  ...  1001.0084  1.668209         1.0                 1
4      0.052531  0.064636 -0.182330            0.179382  ...  1002.0004  1.777944         1.0                 1
..          ...       ...       ...                 ...  ...        ...       ...         ...               ...
771    0.056970  0.070887 -0.197142            0.209027  ...  1001.0012  1.500447         1.0                 1
772    0.127831  0.166465 -0.498591            0.494498  ...  1001.0011 -1.972707        -1.0                -1
773    0.053921  0.066723 -0.165432            0.207342  ...  1002.0124  1.656703         1.0                 1
774    0.053729  0.065936 -0.169396            0.215275  ...  1002.0401  1.593870         1.0                 1
775    0.064265  0.078208 -0.201105            0.229275  ...  1001.0232  1.290187         1.0                 1

[776 rows x 15 columns]

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\SVC\tswp_0\[gearbox_1_(acc+G)]-SVC_fdet_1

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\SVC\tswp_0\[gearbox_1_(acc+G)]-SVC_fdet_1\anomaly_detector.pkl

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-SVC_fdet_1 / train...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\SVC\tswp_0\[gearbox_1_(acc+G)]-SVC_fdet_1


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for [gearbox_1_(acc+G)]-SVC_fdet_1 / train...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\SVC\tswp_0\[gearbox_1_(acc+G)]-SVC_fdet_1


Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\SVC\tswp_0\[gearbox_1_(acc+G)]-SVC_fdet_1\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> Time feature extractor initialized with features: from_ranks(feat_list=['mean_abs', 'rms', 'min', 'hist_upper_bound', 'std', 'peak_value', 'hist_lower_bound', 'max', 'variance', 'difference_variance'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['mean_abs_0', 'rms_0', 'min_0', 'hist_upper_bound_0', 'std_0', 'peak_value_0', 'hist_lower_bound_0', 'max_0', 'variance_0', 'difference_variance_0']

Test inference completed in 0.10 seconds

NOK upper bound (at 100.0 percentile): -0.2727

OK lower bound (from training): 0.4566

NOK upper bound (from testing): -0.2727

Dataframe is as follows:
     mean_abs_0     rms_0     min_0  hist_upper_bound_0  ...    rep_num    scores  pred_label  final_pred_label
0      0.061736  0.076116 -0.198602            0.218003  ...  1001.0001  1.400167         1.0                 1
1      0.062718  0.077539 -0.194012            0.215079  ...  1001.0141  1.435231         1.0                 1
2      0.056047  0.069435 -0.181495            0.240327  ...  1001.0219  1.340308         1.0                 1
3      0.054855  0.067963 -0.232398            0.180659  ...  1002.0149  1.545194         1.0                 1
4      0.061701  0.076845 -0.193804            0.255153  ...  1001.0092  1.121702         1.0                 1
..          ...       ...       ...                 ...  ...        ...       ...         ...               ...
189    0.065223  0.080516 -0.208198            0.245350  ...  1001.0206  1.111627         1.0                 1
190    0.052447  0.065442 -0.157922            0.185422  ...  1002.0120  1.819326         1.0                 1
191    0.126991  0.157472 -0.462918            0.458372  ...  1001.0064 -1.948739        -1.0                -1
192    0.124020  0.160546 -0.461666            0.589656  ...  1001.0158 -1.989745        -1.0                -1
193    0.051862  0.064749 -0.174402            0.199206  ...  1002.0395  1.688994         1.0                 1

[194 rows x 15 columns]

Test accuracy: 1.00
Precision: 1.00, Recall: 1.00, F1-score: 1.00

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\SVC\tswp_0\[gearbox_1_(acc+G)]-SVC_fdet_1\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-SVC_fdet_1 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\SVC\tswp_0\[gearbox_1_(acc+G)]-SVC_fdet_1\test


===========================================================================

Fault detection model '[gearbox_1_(acc+G)]-SVC_fdet_1' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-09-22 19:18:38
