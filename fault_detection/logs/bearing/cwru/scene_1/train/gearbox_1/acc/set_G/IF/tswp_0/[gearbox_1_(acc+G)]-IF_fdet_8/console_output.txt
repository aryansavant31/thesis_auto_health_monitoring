=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: [gearbox_1_(acc+G)]-IF_fdet_8
Start Time: 2025-09-22 18:43:56
End Time: 2025-09-22 18:44:29

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


Dataset selections:
---------------------------------------------
*_(<ds_subtype_num>) <ds_subtype> : [<augments>]_*

- **Healthy configs**
  (1) 0_N    : [OG]

- **Unhealthy configs**
  (1) 0_B-007    : [OG]

- **Unknown configs**


Node and signal types:
---------------------------------------------
*_(<node_num>) <node_type> : [<signal_types>]_*

  (1) gearbox   : [acc]

Node group name: gearbox_1
Signal group name: acc


For ds_type 'OK' and others....
---------------------------------------------
Maximum timesteps across all node types: 243,938

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

For ds_type 'NOK' and others....
---------------------------------------------
Maximum timesteps across all node types: 244,739

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

Target rep_num 1001.0001 found at index 0. This sample will be included in the test set.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
------------------------------------------------------------
Total samples: 487 
Train: 389/389 [OK=193, NOK=196, UK=0], Test: 97/97 [OK=50, NOK=47, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 389
torch.Size([1, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 97
torch.Size([1, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: 0.48

---------------------------------------------------------------------------

Initializing feature selector for anomaly detection model...

>> Feature selector initialized with LDA

Starting feature selection...
feat_Data_np shape: (389, 37)

Top 10 features selected: ['peak_value', 'variance', 'mean_abs', 'max', 'min', 'difference_variance', 'rms', 'skewness', 'normalized_std', 'peak_to_peak']
Feature selection completed. Updating the anomaly detector model to use selected features

---------------------------------------------------------------------------
'Version 1' already exists in the log path 'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Next model number folder will be: [gearbox_1_(acc+G)]-IF_fdet_8
Model parameters saved to C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_8.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_8

---------------------------------------------------------------------------

<<<<<<<<<<<< FEATURE RANKING PLOT>>>>>>>>>>>>

> Creating feature ranking for [gearbox_1_(acc+G)]-IF_fdet_8 / train...
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\feature_extraction\selector.py:181: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

  feat_rank_plot = sns.barplot(x=self.feat_ranking.values, y=self.feat_ranking.index, palette="viridis")

Feature ranking plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_8


Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> Time feature extractor initialized with features: from_ranks(feat_list=['peak_value', 'variance', 'mean_abs', 'max', 'min', 'difference_variance', 'rms', 'skewness', 'normalized_std', 'peak_to_peak'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['peak_value_0', 'variance_0', 'mean_abs_0', 'max_0', 'min_0', 'difference_variance_0', 'rms_0', 'skewness_0', 'normalized_std_0', 'peak_to_peak_0']

Fitting anomaly detection model...

Model fitted successfully in 1.41 seconds

Training inference completed in 0.13 seconds

Training accuracy: 0.70

OK lower bound (at 100.0 percentile): 0.0002

NOK upper bound (at 100.0 percentile): -0.0001

Dataframe is as follows:
     peak_value_0  variance_0  mean_abs_0     max_0  ...    rep_num    scores  pred_label  final_pred_label
0        0.230520    0.005158    0.058084  0.262855  ...  1001.0094  0.009279           1                 1
1        0.194117    0.005314    0.060658  0.205278  ...  1001.0032  0.027434           1                 1
2        0.209346    0.005984    0.063831  0.194221  ...  1001.0196 -0.015747          -1                -1
3        0.298529    0.012282    0.093133  0.340252  ...  1001.0156 -0.157218          -1                -1
4        0.193908    0.005205    0.059335  0.200271  ...  1001.0169  0.047600           1                 1
..            ...         ...         ...       ...  ...        ...       ...         ...               ...
384      0.474496    0.016280    0.100446  0.517366  ...  1001.0171 -0.080685          -1                -1
385      0.369979    0.014259    0.099950  0.439761  ...  1001.0140 -0.080417          -1                -1
386      0.389381    0.013935    0.096262  0.419317  ...  1001.0187 -0.069469          -1                -1
387      0.423385    0.017448    0.107433  0.474183  ...  1001.0199  0.006267           1                 1
388      0.205069    0.005632    0.062223  0.211119  ...  1001.0218  0.019958           1                 1

[389 rows x 15 columns]

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_8

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_8\anomaly_detector.pkl

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_8 / train...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_8


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for [gearbox_1_(acc+G)]-IF_fdet_8 / train...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_8


Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_8\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> Time feature extractor initialized with features: from_ranks(feat_list=['peak_value', 'variance', 'mean_abs', 'max', 'min', 'difference_variance', 'rms', 'skewness', 'normalized_std', 'peak_to_peak'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['peak_value_0', 'variance_0', 'mean_abs_0', 'max_0', 'min_0', 'difference_variance_0', 'rms_0', 'skewness_0', 'normalized_std_0', 'peak_to_peak_0']

Test inference completed in 0.16 seconds

NOK upper bound (at 100.0 percentile): -0.0011

OK lower bound (from training): 0.0002

NOK upper bound (from testing): -0.0011

Dataframe is as follows:
    peak_value_0  variance_0  mean_abs_0     max_0  ...    rep_num    scores  pred_label  final_pred_label
0       0.208198    0.005641    0.061736  0.217794  ...  1001.0001  0.032717           1                 1
1       0.201731    0.005367    0.060330  0.194012  ...  1001.0188  0.005429           1                 1
2       0.530613    0.024915    0.126339  0.537393  ...  1001.0055 -0.040268          -1                -1
3       0.186294    0.005010    0.059038  0.193804  ...  1001.0084  0.012546           1                 1
4       0.224679    0.004926    0.056634  0.218420  ...  1001.0038  0.025846           1                 1
..           ...         ...         ...       ...  ...        ...       ...         ...               ...
92      0.212475    0.005650    0.062710  0.220506  ...  1001.0133  0.035997           1                 1
93      0.518201    0.028392    0.137087  0.597057  ...  1001.0154 -0.094560          -1                -1
94      0.191926    0.005313    0.058871  0.195890  ...  1001.0011  0.016916           1                 1
95      0.419838    0.024219    0.129668  0.406174  ...  1001.0148 -0.013510          -1                -1
96      0.324606    0.015877    0.107440  0.332742  ...  1001.0110 -0.051647          -1                -1

[97 rows x 15 columns]

Test accuracy: 0.68
Precision: 0.67, Recall: 0.68, F1-score: 0.67

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_8\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_8 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_8\test


===========================================================================

Fault detection model '[gearbox_1_(acc+G)]-IF_fdet_8' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-09-22 18:44:29
