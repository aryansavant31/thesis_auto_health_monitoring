=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: [gearbox_1_(acc+G)]-IF_fdet_2
Start Time: 2025-09-22 17:02:28
End Time: 2025-09-22 17:02:47

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


Dataset selections:
---------------------------------------------
*_(<ds_subtype_num>) <ds_subtype> : [<augments>]_*

- **Healthy configs**
  (1) 0_N    : [OG]

- **Unhealthy configs**
  (1) 0_B-007    : [OG]

- **Unknown configs**


Node and signal types:
---------------------------------------------
*_(<node_num>) <node_type> : [<signal_types>]_*

  (1) gearbox   : [acc]

Node group name: gearbox_1
Signal group name: acc


For ds_type 'OK' and others....
---------------------------------------------
Maximum timesteps across all node types: 243,938

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

For ds_type 'NOK' and others....
---------------------------------------------
Maximum timesteps across all node types: 244,739

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

Target rep_num 1001.0001 found at index 0. This sample will be included in the test set.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
------------------------------------------------------------
Total samples: 487 
Train: 389/389 [OK=187, NOK=202, UK=0], Test: 97/97 [OK=55, NOK=42, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 389
torch.Size([1, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 97
torch.Size([1, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: 0.03

---------------------------------------------------------------------------

Initializing feature selector for anomaly detection model...

>> Feature selector initialized with PCA

Starting feature selection...
feat_Data_np shape: (389, 37)

PCA loadings are as follows:
                                     PC1           PC2       PC3
clearance_factor_0         2.039668e-04  6.241875e-04  0.000367
crest_factor_0             1.146770e-04  1.194380e-04  0.000237
difference_variance_0      8.438308e-07  3.670099e-05  0.000105
energy_0                   1.461299e-03  1.332003e-03  0.137158
eo_0                       9.914495e-01  1.298723e-01  0.012643
fifth_moment_0             4.610434e-07  3.013963e-05  0.000059
fifth_moment_normalized_0  8.744684e-05  1.222297e-03  0.000015
hist_lower_bound_0         2.736894e-05  6.528689e-05  0.001452
hist_upper_bound_0         3.476047e-05  2.165185e-05  0.001736
impulse_factor_0           1.639090e-04  3.816682e-04  0.000297
kurtosis_0                 1.303490e-01  9.899783e-01  0.051085
latitude_factor_0          2.039668e-04  6.241875e-04  0.000367
log_log_ratio_0            2.817988e-03  1.130043e-03  0.284034
margin_index_0             2.039668e-04  6.241875e-04  0.000367
max_0                      3.474254e-05  2.639425e-05  0.001741
mean_0                     1.751586e-06  9.912680e-06  0.000159
mean_abs_0                 4.799386e-06  7.595372e-06  0.000491
mean_abs_modif1_0          3.449831e-06  1.767566e-06  0.000355
mean_abs_modif2_0          2.659141e-06  1.494174e-05  0.000265
mean_deviation_ratio_0     4.476875e-06  3.384741e-05  0.000258
min_0                      2.741164e-05  6.622569e-05  0.001461
normalized_std_0           9.584597e-07  1.310368e-05  0.000040
peak_to_peak_0             6.232758e-05  1.007176e-04  0.003216
peak_value_0               3.113770e-05  4.247631e-05  0.001605
pulse_index_0              2.055832e-04  3.233130e-03  0.022279
rms_0                      6.442102e-06  1.219477e-05  0.000597
shape_factor_0             6.126881e-06  8.437369e-05  0.000017
sixth_moment_0             5.257556e-07  3.261555e-05  0.000070
skewness_0                 4.376662e-07  2.648544e-05  0.000056
sq_root_abs_0              3.722611e-06  5.152431e-07  0.000412
std_0                      6.124079e-06  7.968468e-06  0.000581
std_deviation_index_0      4.909664e-06  8.732308e-05  0.000035
variance_0                 1.048071e-06  5.126160e-06  0.000099
waveform_indicator_0       1.142104e-04  8.272823e-04  0.007411
waveform_length_0          1.028130e-03  7.547459e-04  0.128319
wilson_amplitude_0         5.058304e-03  5.530487e-02  0.938456
zero_crossing_rate_0       7.978769e-06  1.605450e-05  0.000582

Top 10 features selected: ['kurtosis', 'eo', 'wilson_amplitude', 'log_log_ratio', 'energy', 'waveform_length', 'pulse_index', 'waveform_indicator', 'peak_to_peak', 'max']
Feature selection completed. Updating the anomaly detector model to use selected features

---------------------------------------------------------------------------
'Version 2' already exists in the log path 'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Are you sure you want to remove the model number 2 from the log path C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2? (y/n): Overwrote exsiting model number '2' from the log path C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2.
Model parameters saved to C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2

---------------------------------------------------------------------------

<<<<<<<<<<<< FEATURE RANKING PLOT>>>>>>>>>>>>

> Creating feature ranking for [gearbox_1_(acc+G)]-IF_fdet_2 / train...
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\feature_extraction\selector.py:137: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

  feat_rank_plot = sns.barplot(x=self.feat_ranking.values, y=self.feat_ranking.index, palette="viridis")

Feature ranking plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2


Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> Time feature extractor initialized with features: from_ranks(feat_list=['kurtosis', 'eo', 'wilson_amplitude', 'log_log_ratio', 'energy', 'waveform_length', 'pulse_index', 'waveform_indicator', 'peak_to_peak', 'max'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['kurtosis_0', 'eo_0', 'wilson_amplitude_0', 'log_log_ratio_0', 'energy_0', 'waveform_length_0', 'pulse_index_0', 'waveform_indicator_0', 'peak_to_peak_0', 'max_0']

Fitting anomaly detection model...

Model fitted successfully in 1.34 seconds

Training inference completed in 0.11 seconds

Training accuracy: 0.50

OK lower bound (at 100.0 percentile): 0.0024

NOK upper bound (at 100.0 percentile): -0.0043

Dataframe is as follows:
      kurtosis_0          eo_0  ...  pred_label  final_pred_label
0    2614.948486   5397.309082  ...           1                 1
1    2862.690918   6362.418945  ...           1                 1
2    2907.468018   6380.514648  ...           1                 1
3    2751.968750   5606.509766  ...           1                 1
4    2658.155762   5698.813477  ...           1                 1
..           ...           ...  ...         ...               ...
384  2769.899902   5988.247070  ...           1                 1
385  2510.777832   4431.769043  ...           1                 1
386  2850.099609   6117.259766  ...           1                 1
387  3330.748291  12125.583008  ...           1                 1
388  3895.397949  10250.989258  ...           1                 1

[389 rows x 15 columns]

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2\anomaly_detector.pkl

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_2 / train...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2


Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> Time feature extractor initialized with features: from_ranks(feat_list=['kurtosis', 'eo', 'wilson_amplitude', 'log_log_ratio', 'energy', 'waveform_length', 'pulse_index', 'waveform_indicator', 'peak_to_peak', 'max'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['kurtosis_0', 'eo_0', 'wilson_amplitude_0', 'log_log_ratio_0', 'energy_0', 'waveform_length_0', 'pulse_index_0', 'waveform_indicator_0', 'peak_to_peak_0', 'max_0']

Test inference completed in 0.14 seconds

NOK upper bound (at 100.0 percentile): -0.0046

OK lower bound (from training): 0.0024

NOK upper bound (from testing): -0.0046

Dataframe is as follows:
     kurtosis_0         eo_0  ...  pred_label  final_pred_label
0   2758.797607  5102.407227  ...           1                 1
1   2672.010986  5304.174805  ...           1                 1
2   2945.652344  7216.238770  ...           1                 1
3   3248.230713  9811.773438  ...           1                 1
4   2767.094482  6383.711426  ...           1                 1
..          ...          ...  ...         ...               ...
92  2926.213623  6871.488770  ...           1                 1
93  2732.006592  5012.900391  ...           1                 1
94  2769.418213  5925.415039  ...           1                 1
95  2861.270020  6249.581543  ...           1                 1
96  2828.243408  5940.599121  ...           1                 1

[97 rows x 15 columns]

Test accuracy: 0.59
Precision: 0.75, Recall: 0.07, F1-score: 0.13

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_2 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_2\test


===========================================================================

Fault detection model '[gearbox_1_(acc+G)]-IF_fdet_2' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-09-22 17:02:47
