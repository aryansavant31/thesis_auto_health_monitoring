=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: [gearbox_1_(acc+G)]-IF_fdet_1
Start Time: 2025-09-22 17:04:34
End Time: 2025-09-22 17:05:23

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


Dataset selections:
---------------------------------------------
*_(<ds_subtype_num>) <ds_subtype> : [<augments>]_*

- **Healthy configs**
  (1) 0_N    : [OG]

- **Unhealthy configs**
  (1) 0_B-007    : [OG]

- **Unknown configs**


Node and signal types:
---------------------------------------------
*_(<node_num>) <node_type> : [<signal_types>]_*

  (1) gearbox   : [acc]

Node group name: gearbox_1
Signal group name: acc


For ds_type 'OK' and others....
---------------------------------------------
Maximum timesteps across all node types: 243,938

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

For ds_type 'NOK' and others....
---------------------------------------------
Maximum timesteps across all node types: 244,739

No data interpolation applied.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

Target rep_num 1001.0001 found at index 0. This sample will be included in the test set.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
------------------------------------------------------------
Total samples: 487 
Train: 389/389 [OK=188, NOK=201, UK=0], Test: 97/97 [OK=55, NOK=42, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 389
torch.Size([1, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 97
torch.Size([1, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: 0.03

---------------------------------------------------------------------------

Initializing feature selector for anomaly detection model...

>> Feature selector initialized with PCA

Starting feature selection...
feat_Data_np shape: (389, 37)

PCA loadings are as follows:
                                     PC1       PC2  ...       PC9      PC10
clearance_factor_0         2.013512e-04  0.000602  ...  0.361134  0.083222
crest_factor_0             1.130412e-04  0.000104  ...  0.210629  0.282671
difference_variance_0      8.048702e-07  0.000034  ...  0.089866  0.070706
energy_0                   1.500318e-03  0.001937  ...  0.126931  0.436205
eo_0                       9.915428e-01  0.129151  ...  0.000112  0.000014
fifth_moment_0             4.058331e-07  0.000022  ...  0.081633  0.191940
fifth_moment_normalized_0  1.105781e-04  0.001186  ...  0.462730  0.070549
hist_lower_bound_0         2.762146e-05  0.000080  ...  0.006251  0.083403
hist_upper_bound_0         3.509202e-05  0.000012  ...  0.012373  0.157996
impulse_factor_0           1.619055e-04  0.000363  ...  0.212493  0.102770
kurtosis_0                 1.296182e-01  0.990183  ...  0.001225  0.000579
latitude_factor_0          2.013512e-04  0.000602  ...  0.361017  0.108349
log_log_ratio_0            2.897455e-03  0.000297  ...  0.039452  0.169657
margin_index_0             2.013512e-04  0.000602  ...  0.362191  0.120633
max_0                      3.507177e-05  0.000013  ...  0.051237  0.081590
mean_0                     1.183372e-06  0.000017  ...  0.129409  0.094426
mean_abs_0                 4.655773e-06  0.000001  ...  0.065139  0.167674
mean_abs_modif1_0          3.540112e-06  0.000004  ...  0.016666  0.100709
mean_abs_modif2_0          2.610536e-06  0.000008  ...  0.034706  0.154503
mean_deviation_ratio_0     3.747918e-06  0.000032  ...  0.071143  0.267670
min_0                      2.760654e-05  0.000088  ...  0.031324  0.097463
normalized_std_0           9.051554e-07  0.000001  ...  0.063417  0.057610
peak_to_peak_0             6.280910e-05  0.000112  ...  0.048030  0.078394
peak_value_0               3.128793e-05  0.000051  ...  0.052708  0.075694
pulse_index_0              2.395187e-04  0.003225  ...  0.080691  0.061867
rms_0                      6.533411e-06  0.000007  ...  0.054803  0.247183
shape_factor_0             5.849503e-06  0.000070  ...  0.020843  0.113101
sixth_moment_0             3.653470e-07  0.000023  ...  0.113394  0.166496
skewness_0                 4.920863e-07  0.000028  ...  0.083520  0.194001
sq_root_abs_0              3.659027e-06  0.000011  ...  0.048417  0.050176
std_0                      6.279939e-06  0.000003  ...  0.041065  0.265874
std_deviation_index_0      4.767482e-06  0.000084  ...  0.089563  0.306780
variance_0                 1.233162e-06  0.000004  ...  0.102171  0.157633
waveform_indicator_0       1.019569e-04  0.000828  ...  0.412288  0.189443
waveform_length_0          1.076779e-03  0.000309  ...  0.075654  0.123048
wilson_amplitude_0         5.472883e-03  0.053286  ...  0.004563  0.004912
zero_crossing_rate_0       8.069705e-06  0.000004  ...  0.059858  0.134840

[37 rows x 10 columns]

Top 10 features selected: ['waveform_length', 'fifth_moment_normalized', 'log_log_ratio', 'pulse_index', 'wilson_amplitude', 'energy', 'waveform_indicator', 'kurtosis', 'eo', 'difference_variance']
Feature selection completed. Updating the anomaly detector model to use selected features

---------------------------------------------------------------------------
'Version 1' already exists in the log path 'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Are you sure you want to remove the model number 1 from the log path C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1? (y/n): Overwrote exsiting model number '1' from the log path C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1.
Model parameters saved to C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1

---------------------------------------------------------------------------

<<<<<<<<<<<< FEATURE RANKING PLOT>>>>>>>>>>>>

> Creating feature ranking for [gearbox_1_(acc+G)]-IF_fdet_1 / train...
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\feature_extraction\selector.py:137: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `y` variable to `hue` and set `legend=False` for the same effect.

  feat_rank_plot = sns.barplot(x=self.feat_ranking.values, y=self.feat_ranking.index, palette="viridis")

Feature ranking plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1


Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> Time feature extractor initialized with features: from_ranks(feat_list=['waveform_length', 'fifth_moment_normalized', 'log_log_ratio', 'pulse_index', 'wilson_amplitude', 'energy', 'waveform_indicator', 'kurtosis', 'eo', 'difference_variance'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['waveform_length_0', 'fifth_moment_normalized_0', 'log_log_ratio_0', 'pulse_index_0', 'wilson_amplitude_0', 'energy_0', 'waveform_indicator_0', 'kurtosis_0', 'eo_0', 'difference_variance_0']

Fitting anomaly detection model...

Model fitted successfully in 1.55 seconds

Training inference completed in 0.12 seconds

Training accuracy: 0.50

OK lower bound (at 100.0 percentile): 0.0007

NOK upper bound (at 100.0 percentile): -0.0012

Dataframe is as follows:
     waveform_length_0  fifth_moment_normalized_0  ...  pred_label  final_pred_label
0            30.050213                   0.228977  ...           1                 1
1            30.054176                  -0.532825  ...           1                 1
2            32.038109                  -0.356579  ...           1                 1
3            52.511623                   0.872690  ...           1                 1
4            29.176321                   0.380411  ...           1                 1
..                 ...                        ...  ...         ...               ...
384          44.032242                   0.360986  ...           1                 1
385          32.159103                  -0.094031  ...           1                 1
386          32.198116                  -0.980309  ...           1                 1
387          30.007236                  -2.060017  ...           1                 1
388          30.497900                   0.037782  ...           1                 1

[389 rows x 15 columns]

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\anomaly_detector.pkl

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_1 / train...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1


Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> Time feature extractor initialized with features: from_ranks(feat_list=['waveform_length', 'fifth_moment_normalized', 'log_log_ratio', 'pulse_index', 'wilson_amplitude', 'energy', 'waveform_indicator', 'kurtosis', 'eo', 'difference_variance'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['waveform_length_0', 'fifth_moment_normalized_0', 'log_log_ratio_0', 'pulse_index_0', 'wilson_amplitude_0', 'energy_0', 'waveform_indicator_0', 'kurtosis_0', 'eo_0', 'difference_variance_0']

Test inference completed in 0.18 seconds

NOK upper bound could not be determined as there are no samples predicted as NOK.

OK lower bound (from training): 0.0007

NOK upper bound could not be determined as there are no samples predicted as NOK during testing.

Dataframe is as follows:
    waveform_length_0  fifth_moment_normalized_0  ...  pred_label  final_pred_label
0           30.899067                  -1.228538  ...           1                 1
1           29.447939                  -1.484542  ...           1                 1
2           32.176838                  -0.069535  ...           1                 1
3           36.167442                   0.389042  ...           1                 1
4           45.738922                  -0.605599  ...           1                 1
..                ...                        ...  ...         ...               ...
92          48.367062                  -0.154483  ...           1                 1
93          33.444801                  -0.613591  ...           1                 1
94          49.572441                   0.246699  ...           1                 1
95          31.433748                  -0.864853  ...           1                 1
96          27.807596                  -0.679421  ...           1                 1

[97 rows x 15 columns]

Test accuracy: 0.57
Precision: 0.00, Recall: 0.00, F1-score: 0.00

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_1 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\test


===========================================================================

Fault detection model '[gearbox_1_(acc+G)]-IF_fdet_1' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-09-22 17:05:23
