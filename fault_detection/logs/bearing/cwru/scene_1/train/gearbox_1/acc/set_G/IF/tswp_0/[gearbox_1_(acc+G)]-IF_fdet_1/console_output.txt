=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: [gearbox_1_(acc+G)]-IF_fdet_1
Start Time: 2025-10-08 23:46:24
End Time: 2025-10-08 23:47:08

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


Dataset selections:
---------------------------------------------
*_(<ds_subtype_num>) <ds_subtype> : [<augments>]_*

- **Healthy configs**
  (1) 0_N    : [OG]
  (2) 1_N    : [OG]

- **Unhealthy configs**
  (3) 0_B-007    : [OG]

- **Unknown configs**


Node and signal types:
---------------------------------------------
*_(<node_num>) <node_type> : [<signal_types>]_*

  (1) gearbox   : [acc]

Node group name: gearbox_1
Signal group name: acc


For ds_type 'OK' and others....
---------------------------------------------
Maximum timesteps across all node types: 483,903

No data interpolation applied.

First 1000 timesteps chopped off from the data.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

For ds_type 'NOK' and others....
---------------------------------------------
Maximum timesteps across all node types: 244,739

No data interpolation applied.

First 1000 timesteps chopped off from the data.

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.

Target rep_num 1001.0001 found at index 0. This sample will be included in the test set.


Total units: 3

[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
------------------------------------------------------------
Total samples: 2423 
Train: 1696/1696 [OK=1253, NOK=443, UK=0], Test: 242/242 [OK=191, NOK=51, UK=0], Val: 484/484 [OK=369, NOK=115, UK=0],
Remainder: 1 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 1696
torch.Size([1, 1, 500, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 242
torch.Size([1, 1, 500, 1]) 

val_data_loader statistics:
Number of batches: 484
torch.Size([1, 1, 500, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 2000
Contamination: 1e-15

---------------------------------------------------------------------------

Initializing feature selector for anomaly detection model...

>> Feature selector initialized with LDA

Starting feature selection...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> Feature normalizer initialized with 'std' normalization

>> No time feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Top 6 consensus features selected: ['std', 'rms', 'variance', 'energy', 'mean_deviation_ratio', 'mean']
Feature selection completed. Updated the fault detector model to use selected features

---------------------------------------------------------------------------
'Version 1' already exists in the log path 'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Are you sure you want to remove the model number 1 from the log path C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1? (y/n): Overwrote exsiting model number '1' from the log path C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1.
Model parameters saved to C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1

---------------------------------------------------------------------------

Feature ranking plot with variance logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1


Feature ranking plot with mean score logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1


Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> Feature normalizer loaded with 'std' normalization

>> Time feature extractor initialized with features: from_ranks(feat_list=['std', 'rms', 'variance', 'energy', 'mean_deviation_ratio', 'mean'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['std_0', 'rms_0', 'variance_0', 'energy_0', 'mean_deviation_ratio_0', 'mean_0']

Fitting anomaly detection model...

Model fitted successfully in 3.32 seconds

Tuning contamination parameter using validation data...

Feature names: ['std_0', 'rms_0', 'variance_0', 'energy_0', 'mean_deviation_ratio_0', 'mean_0']

Best threshold: 0.6079 with db_ok: 0.1399
Validation Precision: 1.0000, Recall: 1.0000, F1-Score: 1.0000

Training inference completed in 0.18 seconds

Training accuracy (for hard predictions): 0.00

OK upper bound could not be determined as there are no samples predicted as OK.

Dataframe is as follows:
  machine_num  ... n_samples
0         002  ...       829
1         001  ...       424

[2 rows x 8 columns]

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\fault_detector.pkl

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_1 / train...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1


<<<<<<<<<<<< CONFUSION MATRIX ADVANCE >>>>>>>>>>>>

> Creating confusion matrix (hard/soft) for [gearbox_1_(acc+G)]-IF_fdet_1 / train...

Confusion matrix (hard/soft) logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION ADVANCE 1 (GIVEN vs PRED) >>>>>>>>>>>>

(Using '100%' OK of train

Creating anomaly score distribution plot for [gearbox_1_(acc+G)]-IF_fdet_1 / train...
## Bin details for Anomaly Score Distribution Advance 1 (100% OK of train) 
-------------------------
### Total True Negative Hard (OK, correct) samples: 0
---------- Samples in True Negative Hard (OK, correct) bins ----------

### Total True Positive Hard (NOK, correct) samples: 0
---------- Samples in True Positive Hard (NOK, correct) bins ----------

### Total False Positive Hard (OK, misclassified) samples: 0
---------- Samples in False Positive Hard (OK, misclassified) bins ----------

### Total False Negative Hard (NOK, misclassified) samples: 0
---------- Samples in False Negative Hard (NOK, misclassified) bins ----------

### Total True Negative Soft (OK, correct) samples: 0
---------- Samples in True Negative Soft (OK, correct) bins ----------

### Total True Positive Soft (NOK, correct) samples: 0
---------- Samples in True Positive Soft (NOK, correct) bins ----------

### Total False Positive Soft (OK, misclassified) samples: 39
---------- Samples in False Positive Soft (OK, misclassified) bins ----------
- **Bin 30 (0.60000, 0.62000) [light red]**: 1 (1,002.0682), 2 (1,002.1057), 9 (1,002.0285), 18 (1,002.0675), 19 (1,002.0215), 22 (1,001.0533), 35 (1,001.0500), 38 (1,001.0218)
- **Bin 31 (0.62000, 0.64000) [light red]**: 4 (1,002.1154), 5 (1,002.1118), 6 (1,002.0840), 10 (1,002.1040), 13 (1,002.1105), 14 (1,002.0305), 17 (1,002.0670), 24 (1,001.0375), 33 (1,001.0341), 34 (1,001.0464)
- **Bin 32 (0.64000, 0.66000) [light red]**: 3 (1,002.0652), 8 (1,002.0983), 12 (1,002.0880), 20 (1,002.0134), 21 (1,001.0006), 28 (1,001.0105)
- **Bin 33 (0.66000, 0.68000) [light red]**: 15 (1,002.0780), 16 (1,002.0435), 23 (1,001.0141), 26 (1,001.0511), 27 (1,001.0115), 30 (1,001.0502), 31 (1,001.0360), 32 (1,001.0514)
- **Bin 34 (0.68000, 0.70000) [light red]**: 11 (1,002.1045), 29 (1,001.0522)
- **Bin 35 (0.70000, 0.72000) [light red]**: 0 (1,002.1199), 7 (1,002.0728), 25 (1,001.0463), 36 (1,001.0494)
- **Bin 36 (0.72000, 0.74000) [light red]**: 37 (1,001.0551)

### Total False Negative Soft (NOK, misclassified) samples: 0
---------- Samples in False Negative Soft (NOK, misclassified) bins ----------
No DB delta OK

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for [gearbox_1_(acc+G)]-IF_fdet_1 / train...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1


Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> Feature normalizer loaded with 'std' normalization

>> Time feature extractor initialized with features: from_ranks(feat_list=['std', 'rms', 'variance', 'energy', 'mean_deviation_ratio', 'mean'])

>> No feature reduction is applied

---------------------------------------------------------------------------

Feature names: ['std_0', 'rms_0', 'variance_0', 'energy_0', 'mean_deviation_ratio_0', 'mean_0']

Test inference completed in 0.21 seconds

OK upper bound could not be determined as there are no samples predicted as OK during training.

Dataframe is as follows:
  machine_num                                            rep_num  pred_label  final_pred_label    scores  given_label   nok_pct  n_samples
0         001  [1001.0001, 1001.026, 1001.049, 1001.0043, 100...          -1              -0.5  0.474016          1.0  0.016949         59
1         003  [1003.0353, 1003.0116, 1003.002, 1003.0366, 10...          -1              -1.0  0.745626         -1.0  1.000000         51
2         002  [1002.0766, 1002.1201, 1002.0667, 1002.0939, 1...          -1              -0.5  0.460053          1.0  0.022727        132

Test accuracy (for hard prediction): 0.33
Precision (hard): 1.00, Recall (hard): 1.00, F1-score (hard): 1.00
Precision (soft): 0.00, Recall (soft): 0.00, F1-score (soft): 0.00

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [gearbox_1_(acc+G)]-IF_fdet_1 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\test


<<<<<<<<<<<< CONFUSION MATRIX ADVANCE >>>>>>>>>>>>

> Creating confusion matrix (hard/soft) for [gearbox_1_(acc+G)]-IF_fdet_1 / test...

Confusion matrix (hard/soft) logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION ADVANCE 1 (GIVEN vs PRED) >>>>>>>>>>>>

(Using '100%' OK of train

Creating anomaly score distribution plot for [gearbox_1_(acc+G)]-IF_fdet_1 / test...
## Bin details for Anomaly Score Distribution Advance 1 (100% OK of train) 
-------------------------
### Total True Negative Hard (OK, correct) samples: 0
---------- Samples in True Negative Hard (OK, correct) bins ----------

### Total True Positive Hard (NOK, correct) samples: 51
---------- Samples in True Positive Hard (NOK, correct) bins ----------
- **Bin 36 (0.72000, 0.74000) [dark orange]**: 1 (1,003.0353), 2 (1,003.0116), 21 (1,003.0497), 25 (1,003.0393), 28 (1,003.0518), 33 (1,003.0318), 43 (1,003.0016), 46 (1,003.0002)
- **Bin 37 (0.74000, 0.76000) [dark orange]**: 3 (1,003.0020), 4 (1,003.0366), 5 (1,003.0277), 6 (1,003.0342), 7 (1,003.0287), 8 (1,003.0539), 9 (1,003.0143), 10 (1,003.0054), 12 (1,003.0415), 13 (1,003.0347), 14 (1,003.0544), 15 (1,003.0440), 16 (1,003.0502), 17 (1,003.0180), 18 (1,003.0545), 19 (1,003.0392), 20 (1,003.0524), 22 (1,003.0263), 23 (1,003.0530), 24 (1,003.0300), 26 (1,003.0506), 27 (1,003.0492), 29 (1,003.0244), 30 (1,003.0390), 31 (1,003.0236), 32 (1,003.0450), 34 (1,003.0014), 35 (1,003.0455), 36 (1,003.0013), 37 (1,003.0335), 38 (1,003.0055), 39 (1,003.0398), 40 (1,003.0608), 41 (1,003.0522), 42 (1,003.0001), 44 (1,003.0572), 45 (1,003.0221), 47 (1,003.0237), 48 (1,003.0361), 49 (1,003.0033), 50 (1,003.0594), 51 (1,003.0595)
- **Bin 38 (0.76000, 0.78000) [dark orange]**: 11 (1,003.0504)

### Total False Positive Hard (OK, misclassified) samples: 0
---------- Samples in False Positive Hard (OK, misclassified) bins ----------

### Total False Negative Hard (NOK, misclassified) samples: 0
---------- Samples in False Negative Hard (NOK, misclassified) bins ----------

### Total True Negative Soft (OK, correct) samples: 0
---------- Samples in True Negative Soft (OK, correct) bins ----------

### Total True Positive Soft (NOK, correct) samples: 0
---------- Samples in True Positive Soft (NOK, correct) bins ----------

### Total False Positive Soft (OK, misclassified) samples: 4
---------- Samples in False Positive Soft (OK, misclassified) bins ----------
- **Bin 31 (0.62000, 0.64000) [light red]**: 54 (1,002.0821)
- **Bin 32 (0.64000, 0.66000) [light red]**: 0 (1,001.0512), 53 (1,002.0630)
- **Bin 34 (0.68000, 0.70000) [light red]**: 52 (1,002.0785)

### Total False Negative Soft (NOK, misclassified) samples: 0
---------- Samples in False Negative Soft (NOK, misclassified) bins ----------
No DB delta OK

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for [gearbox_1_(acc+G)]-IF_fdet_1 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\gearbox_1\acc\set_G\IF\tswp_0\[gearbox_1_(acc+G)]-IF_fdet_1\test


===========================================================================

Fault detection model '[gearbox_1_(acc+G)]-IF_fdet_1' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-10-08 23:47:08
