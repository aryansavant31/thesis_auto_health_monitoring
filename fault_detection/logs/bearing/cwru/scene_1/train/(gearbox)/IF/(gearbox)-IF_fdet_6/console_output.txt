=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (gearbox)-IF_fdet_6
Start Time: 2025-08-18 10:29:18
End Time: 2025-08-18 10:30:34
==================================================


Starting fault detection model training...

'Train' type dataset selected:
No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]


Total samples: 240, 
Train: 190/192 [OK=143, NOK=47, UK=0], Test: 40/48 [OK=31, NOK=9, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 0 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 19
torch.Size([10, 1, 4000, 1])

test_data_loader statistics:
Number of batches: 4
torch.Size([10, 1, 4000, 1])

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 100
Contamination: auto

---------------------------------------------------------------------------

Frequency data cannot be normalzied before feature extraction.
'Version 1' already exists in the log path 
'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\
(gearbox)\IF\(gearbox)-IF_fdet_1'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Next model number folder will be: (gearbox)-IF_fdet_6
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(
gearbox)\IF\(gearbox)-IF_fdet_6.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_6

---------------------------------------------------------------------------

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp1996_dim0, comp1997_dim0, comp1998_dim0, comp1999_dim0]

Fitting anomaly detection model...

Model fitted successfully in 4.01 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  ...  given_label    scores  pred_label
0      0.001216    0.001223    0.001247  ...          0.0  0.103892           0
1      0.000848    0.000854    0.000885  ...          0.0  0.101082           0
2      0.001557    0.001568    0.001604  ...          0.0  0.100607           0
3      0.000022    0.000024    0.000045  ...          0.0  0.087430           0
4      0.001061    0.001071    0.001088  ...          1.0 -0.000165           1
..          ...         ...         ...  ...          ...       ...         ...
185    0.001030    0.001036    0.001052  ...          0.0  0.109934           0
186    0.008103    0.008143    0.008266  ...          1.0 -0.027573           1
187    0.001288    0.001296    0.001338  ...          0.0  0.095793           0
188    0.001095    0.001101    0.001124  ...          0.0  0.090406           0
189    0.000803    0.000808    0.000831  ...          0.0  0.093688           0

[190 rows x 2003 columns]

Training accuracy: 0.88

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_6

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_6\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_6\test

Testing anomaly detection model...

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

Frequency data cannot be normalzied before feature extraction.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp1996_dim0, comp1997_dim0, comp1998_dim0, comp1999_dim0]

Dataframe is as follows:
    comp0_dim0  comp1_dim0  comp2_dim0  ...  given_label    scores  pred_label
0     0.000110    0.000113    0.000125  ...          0.0  0.097437           0
1     0.000185    0.000186    0.000182  ...          0.0  0.087272           0
2     0.001434    0.001445    0.001501  ...          0.0  0.092557           0
3     0.001072    0.001074    0.001086  ...          1.0  0.042254           0
4     0.000482    0.000483    0.000484  ...          0.0  0.104633           0
5     0.001357    0.001367    0.001420  ...          0.0  0.085490           0
6     0.000907    0.000914    0.000937  ...          0.0  0.093024           0
7     0.000920    0.000924    0.000930  ...          0.0  0.101091           0
8     0.001017    0.001026    0.001071  ...          0.0  0.084361           0
9     0.000554    0.000556    0.000565  ...          0.0  0.080914           0
10    0.000304    0.000307    0.000337  ...          0.0  0.100526           0
11    0.007530    0.007556    0.007602  ...          1.0  0.017579           0
12    0.001301    0.001311    0.001363  ...          0.0  0.095273           0
13    0.002462    0.002476    0.002517  ...          1.0  0.022527           0
14    0.000029    0.000032    0.000060  ...          0.0  0.100350           0
15    0.000442    0.000446    0.000464  ...          0.0  0.084017           0
16    0.001400    0.001411    0.001466  ...          0.0  0.072975           0
17    0.006788    0.006820    0.006935  ...          1.0  0.040220           0
18    0.001078    0.001083    0.001087  ...          0.0  0.085215           0
19    0.000482    0.000485    0.000482  ...          0.0  0.082626           0
20    0.000003    0.000015    0.000051  ...          0.0  0.099429           0
21    0.006917    0.006953    0.007056  ...          1.0  0.021905           0
22    0.000934    0.000941    0.000960  ...          0.0  0.103998           0
23    0.000588    0.000591    0.000612  ...          0.0  0.092647           0
24    0.000248    0.000246    0.000315  ...          1.0 -0.020673           1
25    0.001191    0.001198    0.001217  ...          0.0  0.100549           0
26    0.002516    0.002540    0.002639  ...          1.0  0.025833           0
27    0.000769    0.000774    0.000799  ...          0.0  0.091408           0
28    0.000527    0.000530    0.000562  ...          0.0  0.092040           0
29    0.000514    0.000516    0.000506  ...          0.0  0.075658           0
30    0.001171    0.001179    0.001219  ...          0.0  0.100060           0
31    0.000107    0.000111    0.000121  ...          0.0  0.096234           0
32    0.000356    0.000358    0.000368  ...          0.0  0.101232           0
33    0.000578    0.000590    0.000703  ...          1.0  0.007831           0
34    0.001233    0.001241    0.001282  ...          0.0  0.106248           0
35    0.000633    0.000641    0.000650  ...          1.0 -0.009783           1
36    0.000749    0.000755    0.000784  ...          0.0  0.090717           0
37    0.000853    0.000860    0.000879  ...          0.0  0.100115           0
38    0.001358    0.001365    0.001382  ...          0.0  0.092464           0
39    0.003025    0.003064    0.003188  ...          1.0  0.025213           0

[40 rows x 2003 columns]

Test accuracy: 0.80
Precision: 1.00, Recall: 0.20, F1-score: 0.33

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_6\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (gearbox)-IF_fdet_6 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_6\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (gearbox)-IF_fdet_6 / test...

Total OK samples (from pred_label) : 38
---------- Samples in OK bins ----------
Bin 11 (0.00725, 0.00979): [33]
Bin 15 (0.01740, 0.01994): [11]
Bin 16 (0.01994, 0.02248): [21]
Bin 17 (0.02248, 0.02502): [13]
Bin 18 (0.02502, 0.02756): [26, 39]
Bin 23 (0.03771, 0.04025): [17]
Bin 24 (0.04025, 0.04279): [3]
Bin 36 (0.07071, 0.07325): [16]
Bin 37 (0.07325, 0.07579): [29]
Bin 40 (0.08086, 0.08340): [9, 19]
Bin 41 (0.08340, 0.08594): [5, 8, 15, 18]
Bin 42 (0.08594, 0.08848): [1]
Bin 43 (0.08848, 0.09102): [36]
Bin 44 (0.09102, 0.09356): [2, 6, 23, 27, 28, 38]
Bin 45 (0.09356, 0.09609): [12]
Bin 46 (0.09609, 0.09863): [0, 31]
Bin 47 (0.09863, 0.10117): [7, 10, 14, 20, 25, 30, 37]
Bin 48 (0.10117, 0.10371): [32]
Bin 49 (0.10371, 0.10625): [4, 22]

Total NOK samples (from pred_label) : 2
---------- Samples in NOK bins ----------
Bin 0 (-0.02067, -0.01813): [24]
Bin 4 (-0.01052, -0.00798): [35]

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_6\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (gearbox)-IF_fdet_6 / test...

Total OK samples (from given_label) : 30
---------- Samples in OK bins ----------
Bin 36 (0.07071, 0.07325): [16]
Bin 37 (0.07325, 0.07579): [29]
Bin 40 (0.08086, 0.08340): [9, 19]
Bin 41 (0.08340, 0.08594): [5, 8, 15, 18]
Bin 42 (0.08594, 0.08848): [1]
Bin 43 (0.08848, 0.09102): [36]
Bin 44 (0.09102, 0.09356): [2, 6, 23, 27, 28, 38]
Bin 45 (0.09356, 0.09609): [12]
Bin 46 (0.09609, 0.09863): [0, 31]
Bin 47 (0.09863, 0.10117): [7, 10, 14, 20, 25, 30, 37]
Bin 48 (0.10117, 0.10371): [32]
Bin 49 (0.10371, 0.10625): [4, 22]

Total NOK samples (from given_label) : 10
---------- Samples in NOK bins ----------
Bin 0 (-0.02067, -0.01813): [24]
Bin 4 (-0.01052, -0.00798): [35]
Bin 11 (0.00725, 0.00979): [33]
Bin 15 (0.01740, 0.01994): [11]
Bin 16 (0.01994, 0.02248): [21]
Bin 17 (0.02248, 0.02502): [13]
Bin 18 (0.02502, 0.02756): [26, 39]
Bin 23 (0.03771, 0.04025): [17]
Bin 24 (0.04025, 0.04279): [3]

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_6\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (gearbox)-IF_fdet_6 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_6\test


===========================================================================

Fault detection model '(gearbox)-IF_fdet_6' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-18 10:30:34
