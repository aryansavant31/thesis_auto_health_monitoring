=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (gearbox)-IF_fdet_7
Start Time: 2025-08-18 13:31:20
End Time: 2025-08-18 13:31:55

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:
No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]


Total samples: 240, 
Train: 190/192 [OK=146, NOK=44, UK=0], Test: 40/48 [OK=27, NOK=13, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 0 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 19
torch.Size([10, 1, 4000, 1])

test_data_loader statistics:
Number of batches: 4
torch.Size([10, 1, 4000, 1])

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 100
Contamination: auto

---------------------------------------------------------------------------
'Version 7' already exists in the log path 
'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\
(gearbox)\IF\(gearbox)-IF_fdet_7'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Are you sure you want to remove the model number 7 from the log path C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_7? (y/n): Overwrote exsiting model number '7' from the log path 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(
gearbox)\IF\(gearbox)-IF_fdet_7.
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(
gearbox)\IF\(gearbox)-IF_fdet_7.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_7

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized for 'frequency' domain

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Frequency data cannot be normalized before feature extraction, hence skipping raw data normalization.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp1996_dim0, comp1997_dim0, comp1998_dim0, comp1999_dim0]

Fitting anomaly detection model...

Model fitted successfully in 4.32 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  ...  given_label    scores  pred_label
0      0.001779    0.001791    0.001823  ...          1.0  0.027728           0
1      0.000356    0.000358    0.000368  ...          0.0  0.101420           0
2      0.000613    0.000616    0.000616  ...          0.0  0.099245           0
3      0.003598    0.003619    0.003686  ...          1.0 -0.052971           1
4      0.000022    0.000022    0.000019  ...          0.0  0.103748           0
..          ...         ...         ...  ...          ...       ...         ...
185    0.000524    0.000526    0.000529  ...          0.0  0.088969           0
186    0.000404    0.000407    0.000405  ...          0.0  0.097971           0
187    0.002079    0.002102    0.002168  ...          1.0  0.023089           0
188    0.003809    0.003818    0.003888  ...          1.0  0.025169           0
189    0.000514    0.000516    0.000506  ...          0.0  0.083087           0

[190 rows x 2003 columns]

Training accuracy: 0.85

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_7

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_7\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_7\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized for 'frequency' domain

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Frequency data cannot be normalized before feature extraction, hence skipping raw data normalization.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp1996_dim0, comp1997_dim0, comp1998_dim0, comp1999_dim0]

Dataframe is as follows:
    comp0_dim0  comp1_dim0  comp2_dim0  ...  given_label    scores  pred_label
0     0.003260    0.003282    0.003337  ...          1.0  0.026095           0
1     0.007530    0.007556    0.007602  ...          1.0  0.033674           0
2     0.000209    0.000210    0.000208  ...          0.0  0.086475           0
3     0.001216    0.001223    0.001247  ...          0.0  0.098488           0
4     0.001046    0.001052    0.001084  ...          0.0  0.096445           0
5     0.000368    0.000373    0.000416  ...          0.0  0.080100           0
6     0.000987    0.000993    0.000997  ...          0.0  0.108757           0
7     0.005037    0.005050    0.005039  ...          1.0 -0.127745           1
8     0.002684    0.002675    0.002563  ...          1.0 -0.034253           1
9     0.003025    0.003064    0.003188  ...          1.0  0.028997           0
10    0.000054    0.000057    0.000086  ...          0.0  0.086723           0
11    0.009224    0.009255    0.009332  ...          1.0 -0.013187           1
12    0.000557    0.000561    0.000569  ...          0.0  0.103445           0
13    0.001965    0.001961    0.001898  ...          1.0  0.014070           0
14    0.000585    0.000590    0.000624  ...          0.0  0.093990           0
15    0.006032    0.006076    0.006221  ...          1.0 -0.021452           1
16    0.001755    0.001778    0.001915  ...          1.0  0.024046           0
17    0.000244    0.000248    0.000268  ...          0.0  0.081960           0
18    0.003229    0.003241    0.003264  ...          1.0  0.037954           0
19    0.000731    0.000737    0.000756  ...          0.0  0.088314           0
20    0.000022    0.000024    0.000045  ...          0.0  0.080693           0
21    0.001301    0.001311    0.001363  ...          0.0  0.086736           0
22    0.002462    0.002476    0.002517  ...          1.0  0.030587           0
23    0.002516    0.002540    0.002639  ...          1.0  0.027599           0
24    0.000999    0.001004    0.001031  ...          0.0  0.083850           0
25    0.000003    0.000015    0.000051  ...          0.0  0.105790           0
26    0.000983    0.000989    0.001015  ...          0.0  0.089612           0
27    0.000504    0.000509    0.000547  ...          0.0  0.103715           0
28    0.000129    0.000129    0.000146  ...          0.0  0.078227           0
29    0.001017    0.001026    0.001071  ...          0.0  0.085789           0
30    0.001461    0.001473    0.001530  ...          0.0  0.091484           0
31    0.001103    0.001110    0.001143  ...          0.0  0.095310           0
32    0.001078    0.001083    0.001087  ...          0.0  0.071273           0
33    0.000471    0.000473    0.000481  ...          0.0  0.090044           0
34    0.001040    0.001046    0.001086  ...          0.0  0.078408           0
35    0.004325    0.004348    0.004405  ...          1.0 -0.027839           1
36    0.002104    0.002115    0.002147  ...          0.0  0.092224           0
37    0.000480    0.000481    0.000479  ...          0.0  0.090798           0
38    0.000565    0.000569    0.000587  ...          0.0  0.095064           0
39    0.001072    0.001080    0.001114  ...          0.0  0.100284           0

[40 rows x 2003 columns]

Test accuracy: 0.80
Precision: 1.00, Recall: 0.38, F1-score: 0.56

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_7\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (gearbox)-IF_fdet_7 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_7\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (gearbox)-IF_fdet_7 / test...

Total OK samples (from pred_label) : 35
---------- Samples in OK bins ----------
Bin 29 (0.00943, 0.01416): [13]
Bin 32 (0.02362, 0.02835): [0, 16, 23]
Bin 33 (0.02835, 0.03308): [9, 22]
Bin 34 (0.03308, 0.03781): [1]
Bin 35 (0.03781, 0.04254): [18]
Bin 42 (0.07092, 0.07565): [32]
Bin 43 (0.07565, 0.08038): [5, 28, 34]
Bin 44 (0.08038, 0.08511): [17, 20, 24]
Bin 45 (0.08511, 0.08984): [2, 10, 19, 21, 26, 29]
Bin 46 (0.08984, 0.09457): [14, 30, 33, 36, 37]
Bin 47 (0.09457, 0.09930): [3, 4, 31, 38]
Bin 48 (0.09930, 0.10403): [12, 27, 39]
Bin 49 (0.10403, 0.10876): [25]

Total NOK samples (from pred_label) : 5
---------- Samples in NOK bins ----------
Bin 0 (-0.12774, -0.12301): [7]
Bin 19 (-0.03787, -0.03314): [8]
Bin 21 (-0.02841, -0.02368): [35]
Bin 22 (-0.02368, -0.01895): [15]
Bin 24 (-0.01422, -0.00949): [11]

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_7\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (gearbox)-IF_fdet_7 / test...

Total OK samples (from given_label) : 27
---------- Samples in OK bins ----------
Bin 42 (0.07092, 0.07565): [32]
Bin 43 (0.07565, 0.08038): [5, 28, 34]
Bin 44 (0.08038, 0.08511): [17, 20, 24]
Bin 45 (0.08511, 0.08984): [2, 10, 19, 21, 26, 29]
Bin 46 (0.08984, 0.09457): [14, 30, 33, 36, 37]
Bin 47 (0.09457, 0.09930): [3, 4, 31, 38]
Bin 48 (0.09930, 0.10403): [12, 27, 39]
Bin 49 (0.10403, 0.10876): [25]

Total NOK samples (from given_label) : 13
---------- Samples in NOK bins ----------
Bin 0 (-0.12774, -0.12301): [7]
Bin 19 (-0.03787, -0.03314): [8]
Bin 21 (-0.02841, -0.02368): [35]
Bin 22 (-0.02368, -0.01895): [15]
Bin 24 (-0.01422, -0.00949): [11]
Bin 29 (0.00943, 0.01416): [13]
Bin 32 (0.02362, 0.02835): [0, 16, 23]
Bin 33 (0.02835, 0.03308): [9, 22]
Bin 34 (0.03308, 0.03781): [1]
Bin 35 (0.03781, 0.04254): [18]

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_7\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (gearbox)-IF_fdet_7 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_7\test


===========================================================================

Fault detection model '(gearbox)-IF_fdet_7' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-18 13:31:55
