=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (gearbox)-IF_fdet_1
Start Time: 2025-08-19 23:34:23
End Time: 2025-08-19 23:35:01

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


ds_subtype selections:

(<ds_subtype_num>) <ds_subtype> : [<augments>]
---------------------------------------------
>> Healthy configs
(1) 0_N    : [OG]
(2) 1_N    : [OG]

>> Unhealthy configs
(1) 0_B-021    : [OG]

>> Unknown configs


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]


For ds_type 'OK' and others....

Maximum timesteps across all node types: 483903

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.


Total samples: 192, 
Train: 153/153 [OK=114, NOK=39, UK=0], Test: 38/38 [OK=29, NOK=9, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK={0: 1, 1: 0, -1: 0}, NOK=1, UK=1]

train_data_loader statistics:
Number of batches: 153
torch.Size([1, 1, 5000, 1])

test_data_loader statistics:
Number of batches: 38
torch.Size([1, 1, 5000, 1])

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: auto

---------------------------------------------------------------------------
'Version 1' already exists in the log path 
'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox
)\IF\(gearbox)-IF_fdet_1'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Are you sure you want to remove the model number 1 from the log path C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_1? (y/n): Overwrote exsiting model number '1' from the log path 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)
\IF\(gearbox)-IF_fdet_1.
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)
\IF\(gearbox)-IF_fdet_1.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_1

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized for 'time' domain

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No time feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp4996_dim0, comp4997_dim0, comp4998_dim0, comp4999_dim0]

Fitting anomaly detection model...

Model fitted successfully in 4.60 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  comp3_dim0  ...  given_label   rep_num    scores  pred_label
0      0.453576    0.443164    0.424645    0.400744  ...          0.0  1001.038  0.156150           0
1      0.404798    0.401443    0.394944    0.400605  ...          0.0  1001.016  0.157085           0
2      0.425623    0.420591    0.414022    0.413882  ...          0.0  1002.010  0.163986           0
3      0.676499    0.672026    0.644764    0.612330  ...          1.0  1001.017 -0.053972           1
4      0.272054    0.295401    0.335524    0.408360  ...          1.0  1001.038 -0.047998           1
..          ...         ...         ...         ...  ...          ...       ...       ...         ...
148    0.420941    0.424575    0.427370    0.427160  ...          0.0  1002.070  0.163583           0
149    0.407104    0.419613    0.421709    0.411227  ...          0.0  1001.009  0.159877           0
150    0.395573    0.380967    0.378801    0.386348  ...          0.0  1002.058  0.158810           0
151    0.438138    0.508039    0.564239    0.624493  ...          1.0  1001.022 -0.041844           1
152    0.390891    0.386139    0.393756    0.410808  ...          0.0  1002.016  0.163118           0

[153 rows x 5004 columns]

Training accuracy: 1.00

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_1

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_1\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_1\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized for 'time' domain

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No time feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp4996_dim0, comp4997_dim0, comp4998_dim0, comp4999_dim0]

Dataframe is as follows:
    comp0_dim0  comp1_dim0  comp2_dim0  comp3_dim0  ...  given_label   rep_num    scores  pred_label
0     0.436324    0.429010    0.418619    0.409388  ...          0.0  1002.068  0.173939           0
1     0.438695    0.443991    0.447724    0.441116  ...          0.0  1001.021  0.174278           0
2     0.407270    0.398997    0.398442    0.411910  ...          0.0  1002.026  0.174303           0
3     0.418014    0.422856    0.429111    0.438846  ...          0.0  1001.043  0.168724           0
4     0.451305    0.463008    0.466186    0.459527  ...          0.0  1001.011  0.174028           0
5     0.442881    0.439905    0.445252    0.453777  ...          0.0  1002.025  0.174887           0
6     0.527245    0.530272    0.528254    0.524117  ...          1.0  1001.034  0.019153           0
7     0.461242    0.443134    0.418014    0.400359  ...          0.0  1001.044  0.170974           0
8     0.504743    0.508073    0.506660    0.508577  ...          1.0  1001.028  0.016373           0
9     0.470333    0.443794    0.426942    0.415641  ...          1.0  1001.035  0.011991           0
10    0.533804    0.538547    0.529768    0.514531  ...          1.0  1001.018  0.002244           0
11    0.405454    0.416601    0.431936    0.443235  ...          0.0  1002.071  0.177319           0
12    0.422301    0.424218    0.424117    0.424773  ...          0.0  1002.048  0.172687           0
13    0.408480    0.408278    0.418468    0.429010  ...          0.0  1001.002  0.171285           0
14    0.446614    0.442175    0.432087    0.421091  ...          0.0  1001.018  0.172964           0
15    0.441419    0.437232    0.434407    0.435416  ...          0.0  1002.051  0.173627           0
16    0.431885    0.444496    0.449792    0.441873  ...          0.0  1002.022  0.175726           0
17    0.420838    0.421242    0.413121    0.410195  ...          0.0  1002.083  0.174994           0
18    0.415139    0.419477    0.429716    0.438947  ...          0.0  1002.007  0.175324           0
19    0.437636    0.446312    0.451204    0.448733  ...          0.0  1002.039  0.176453           0
20    0.498890    0.565288    0.623007    0.676589  ...          1.0  1001.024 -0.068737           1
21    0.513320    0.535621    0.549445    0.550151  ...          1.0  1001.009  0.006379           0
22    0.441368    0.446463    0.451204    0.455038  ...          0.0  1002.088  0.172742           0
23    0.418417    0.412213    0.415391    0.422049  ...          0.0  1001.012  0.173690           0
24    0.422251    0.426488    0.427345    0.423461  ...          0.0  1001.020  0.171440           0
25    0.428102    0.429363    0.422251    0.413424  ...          0.0  1001.037  0.171438           0
26    0.414735    0.431330    0.442428    0.445908  ...          0.0  1002.031  0.174762           0
27    0.420838    0.413323    0.415794    0.428304  ...          0.0  1002.057  0.174069           0
28    0.545409    0.563976    0.568315    0.571443  ...          1.0  1001.037  0.020006           0
29    0.552069    0.518163    0.479516    0.441776  ...          1.0  1001.026  0.020943           0
30    0.417711    0.421141    0.431129    0.438947  ...          0.0  1002.072  0.172852           0
31    0.427749    0.433348    0.433802    0.427043  ...          0.0  1002.014  0.175772           0
32    0.402725    0.416852    0.437134    0.457719  ...          1.0  1001.029  0.025259           0
33    0.441066    0.428909    0.414584    0.409035  ...          0.0  1001.007  0.176358           0
34    0.383209    0.395517    0.405403    0.413121  ...          0.0  1001.029  0.169000           0
35    0.396324    0.397635    0.407471    0.414886  ...          0.0  1002.024  0.173354           0
36    0.422553    0.412314    0.403033    0.402024  ...          0.0  1002.027  0.174015           0
37    0.437484    0.446059    0.448733    0.438796  ...          0.0  1001.001  0.169719           0

[38 rows x 5004 columns]

Test accuracy: 0.79
Precision: 1.00, Recall: 0.11, F1-score: 0.20

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_1\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (gearbox)-IF_fdet_1 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_1\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (gearbox)-IF_fdet_1 / test...

Total OK samples (from pred_label) : 37
---------- Samples in OK bins ----------
Bin 14 (0.00016, 0.00508): 10 (1,001.018)
Bin 15 (0.00508, 0.01000): 21 (1,001.009)
Bin 16 (0.01000, 0.01492): 9 (1,001.035)
Bin 17 (0.01492, 0.01984): 6 (1,001.034), 8 (1,001.028)
Bin 18 (0.01984, 0.02476): 28 (1,001.037), 29 (1,001.026)
Bin 19 (0.02476, 0.02969): 32 (1,001.029)
Bin 48 (0.16748, 0.17240): 3 (1,001.043), 7 (1,001.044), 13 (1,001.002), 24 (1,001.020), 25 (1,001.037), 34 (1,001.029), 37 (1,001.001)
Bin 49 (0.17240, 0.17732): 0 (1,002.068), 1 (1,001.021), 2 (1,002.026), 4 (1,001.011), 5 (1,002.025), 12 (1,002.048), 14 (1,001.018), 15 (1,002.051), 16 (1,002.022), 17 (1,002.083), 18 (1,002.007), 19 (1,002.039), 22 (1,002.088), 23 (1,001.012), 26 (1,002.031), 27 (1,002.057), 30 (1,002.072), 31 (1,002.014), 33 (1,001.007), 35 (1,002.024), 36 (1,002.027)

Total NOK samples (from pred_label) : 1
---------- Samples in NOK bins ----------
Bin 0 (-0.06874, -0.06382): 20 (1,001.024)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_1\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (gearbox)-IF_fdet_1 / test...

Total OK samples (from given_label) : 29
---------- Samples in OK bins ----------
Bin 48 (0.16748, 0.17240): 3 (1,001.043), 7 (1,001.044), 13 (1,001.002), 24 (1,001.020), 25 (1,001.037), 34 (1,001.029), 37 (1,001.001)
Bin 49 (0.17240, 0.17732): 0 (1,002.068), 1 (1,001.021), 2 (1,002.026), 4 (1,001.011), 5 (1,002.025), 12 (1,002.048), 14 (1,001.018), 15 (1,002.051), 16 (1,002.022), 17 (1,002.083), 18 (1,002.007), 19 (1,002.039), 22 (1,002.088), 23 (1,001.012), 26 (1,002.031), 27 (1,002.057), 30 (1,002.072), 31 (1,002.014), 33 (1,001.007), 35 (1,002.024), 36 (1,002.027)

Total NOK samples (from given_label) : 9
---------- Samples in NOK bins ----------
Bin 0 (-0.06874, -0.06382): 20 (1,001.024)
Bin 14 (0.00016, 0.00508): 10 (1,001.018)
Bin 15 (0.00508, 0.01000): 21 (1,001.009)
Bin 16 (0.01000, 0.01492): 9 (1,001.035)
Bin 17 (0.01492, 0.01984): 6 (1,001.034), 8 (1,001.028)
Bin 18 (0.01984, 0.02476): 28 (1,001.037), 29 (1,001.026)
Bin 19 (0.02476, 0.02969): 32 (1,001.029)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_1\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (gearbox)-IF_fdet_1 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_1\test


===========================================================================

Fault detection model '(gearbox)-IF_fdet_1' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-19 23:35:01
