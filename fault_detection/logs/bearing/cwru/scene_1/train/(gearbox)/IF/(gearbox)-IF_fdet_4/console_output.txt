=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (gearbox)-IF_fdet_4
Start Time: 2025-08-17 22:08:44
End Time: 2025-08-17 22:09:23
==================================================


Starting fault detection model training...

'Train' type dataset selected:
No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]


Total samples: 240, 
Train: 190/192 [OK=139, NOK=51, UK=0], Test: 40/48 [OK=33, NOK=7, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 0 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 19
torch.Size([10, 1, 4000, 1])

test_data_loader statistics:
Number of batches: 4
torch.Size([10, 1, 4000, 1])

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 100
Contamination: auto

---------------------------------------------------------------------------
'Version 1' already exists in the log path 
'C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gear
box)\IF\(gearbox)-IF_fdet_1'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Next model number folder will be: (gearbox)-IF_fdet_4
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearb
ox)\IF\(gearbox)-IF_fdet_4.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_4

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp3996_dim0, comp3997_dim0, comp3998_dim0, comp3999_dim0]

Fitting anomaly detection model...

Model fitted successfully in 3.73 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  comp3_dim0  ...  comp3999_dim0  given_label    scores  pred_label
0      0.411962    0.423340    0.428423    0.432003  ...       0.433043          0.0  0.158974           0
1      0.430098    0.426748    0.425131    0.426459  ...       0.464462          0.0  0.152252           0
2      0.456376    0.452853    0.455048    0.461690  ...       0.431368          0.0  0.162144           0
3      0.429693    0.449446    0.461459    0.459264  ...       0.445576          0.0  0.165041           0
4      0.438530    0.441706    0.438183    0.427903  ...       0.422994          0.0  0.163595           0
..          ...         ...         ...         ...  ...            ...          ...       ...         ...
185    0.408381    0.416005    0.422763    0.429347  ...       0.418604          0.0  0.161344           0
186    0.409305    0.399198    0.406880    0.426112  ...       0.428711          0.0  0.158084           0
187    0.394924    0.399314    0.412251    0.427036  ...       0.431830          0.0  0.162824           0
188    0.427441    0.425535    0.420395    0.420510  ...       0.446962          0.0  0.166729           0
189    0.437606    0.439916    0.432350    0.420683  ...       0.437837          0.0  0.164604           0

[190 rows x 4003 columns]

Training accuracy: 1.00

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_4

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_4\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_4\test

Testing anomaly detection model...

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp3996_dim0, comp3997_dim0, comp3998_dim0, comp3999_dim0]

Dataframe is as follows:
    comp0_dim0  comp1_dim0  comp2_dim0  comp3_dim0  ...  comp3999_dim0  given_label    scores  pred_label
0     0.419123    0.403285    0.396072    0.397383  ...       0.419577          0.0  0.164592           0
1     0.613724    0.610494    0.590817    0.567407  ...       0.550353          1.0  0.002542           0
2     0.451003    0.435467    0.428354    0.427345  ...       0.434861          0.0  0.162875           0
3     0.425580    0.435567    0.443588    0.447825  ...       0.440914          0.0  0.163151           0
4     0.419830    0.422554    0.425176    0.427850  ...       0.407724          0.0  0.161329           0
5     0.419275    0.428304    0.429817    0.422251  ...       0.429161          0.0  0.157222           0
6     0.446362    0.447270    0.449893    0.441116  ...       0.432491          0.0  0.167037           0
7     0.435164    0.436122    0.431028    0.425025  ...       0.434559          0.0  0.158637           0
8     0.425580    0.428859    0.424571    0.422705  ...       0.459880          0.0  0.163579           0
9     0.446766    0.446917    0.438897    0.431280  ...       0.429666          0.0  0.161510           0
10    0.432743    0.432087    0.435769    0.440107  ...       0.436122          0.0  0.167426           0
11    0.428253    0.423764    0.417207    0.413827  ...       0.409691          0.0  0.164080           0
12    0.425378    0.430422    0.426438    0.418014  ...       0.422301          0.0  0.158378           0
13    0.411658    0.418518    0.425984    0.429615  ...       0.423411          0.0  0.152532           0
14    0.423562    0.406614    0.396828    0.396980  ...       0.443436          0.0  0.155266           0
15    0.420839    0.413323    0.415794    0.428304  ...       0.410599          0.0  0.157102           0
16    0.447774    0.450296    0.442982    0.423159  ...       0.404848          0.0  0.150647           0
17    0.440309    0.436021    0.434357    0.435315  ...       0.439502          0.0  0.161044           0
18    0.428102    0.429363    0.422251    0.413424  ...       0.412919          0.0  0.155937           0
19    0.459981    0.458317    0.453928    0.448178  ...       0.444143          0.0  0.161608           0
20    0.425328    0.437888    0.447875    0.452667  ...       0.437837          0.0  0.158636           0
21    0.417610    0.427345    0.434458    0.433499  ...       0.431129          0.0  0.162404           0
22    0.461251    0.414934    0.385368    0.373562  ...       0.525933          1.0 -0.003599           1
23    0.440359    0.430019    0.419981    0.413777  ...       0.424470          0.0  0.159081           0
24    0.432238    0.428304    0.421646    0.416904  ...       0.432440          0.0  0.166195           0
25    0.411608    0.425025    0.435013    0.438544  ...       0.438039          0.0  0.163800           0
26    0.400057    0.408077    0.415996    0.427749  ...       0.418316          0.0  0.158772           0
27    0.433398    0.434458    0.425025    0.411305  ...       0.416147          0.0  0.156539           0
28    0.619677    0.588799    0.545409    0.491423  ...       0.520686          1.0 -0.020300           1
29    0.410296    0.417812    0.426084    0.432642  ...       0.434306          0.0  0.157497           0
30    0.402629    0.399401    0.402478    0.407673  ...       0.425681          0.0  0.152499           0
31    0.464077    0.493845    0.523814    0.545005  ...       0.431685          1.0 -0.017644           1
32    0.399905    0.404798    0.410246    0.413222  ...       0.419729          0.0  0.153980           0
33    0.430876    0.421292    0.413827    0.410750  ...       0.430775          0.0  0.165095           0
34    0.423209    0.407219    0.402074    0.408379  ...       0.415088          0.0  0.153606           0
35    0.383209    0.395517    0.405403    0.413121  ...       0.407320          0.0  0.162199           0
36    0.567205    0.599697    0.613421    0.609485  ...       0.578305          1.0  0.017500           0
37    0.447225    0.451060    0.457114    0.467104  ...       0.512815          1.0 -0.020403           1
38    0.428455    0.441166    0.454786    0.455895  ...       0.423209          0.0  0.163556           0
39    0.432137    0.431179    0.424571    0.418165  ...       0.399804          0.0  0.169454           0

[40 rows x 4003 columns]

Test accuracy: 0.95
Precision: 1.00, Recall: 0.67, F1-score: 0.80

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_4\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (gearbox)-IF_fdet_4 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_4\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (gearbox)-IF_fdet_4 / test...

Total OK samples (from pred_label) : 36
---------- Samples in OK bins ----------
Bin 6 (0.00238, 0.00618): [1]
Bin 9 (0.01377, 0.01757): [36]
Bin 45 (0.15047, 0.15427): [13, 16, 30, 32, 34]
Bin 46 (0.15427, 0.15806): [5, 14, 15, 18, 27, 29]
Bin 47 (0.15806, 0.16186): [4, 7, 9, 12, 17, 19, 20, 23, 26]
Bin 48 (0.16186, 0.16566): [0, 2, 3, 8, 11, 21, 25, 33, 35, 38]
Bin 49 (0.16566, 0.16945): [6, 10, 24]

Total NOK samples (from pred_label) : 4
---------- Samples in NOK bins ----------
Bin 0 (-0.02040, -0.01661): [28, 31, 37]
Bin 4 (-0.00521, -0.00142): [22]

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_4\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (gearbox)-IF_fdet_4 / test...

Total OK samples (from given_label) : 34
---------- Samples in OK bins ----------
Bin 45 (0.15047, 0.15427): [13, 16, 30, 32, 34]
Bin 46 (0.15427, 0.15806): [5, 14, 15, 18, 27, 29]
Bin 47 (0.15806, 0.16186): [4, 7, 9, 12, 17, 19, 20, 23, 26]
Bin 48 (0.16186, 0.16566): [0, 2, 3, 8, 11, 21, 25, 33, 35, 38]
Bin 49 (0.16566, 0.16945): [6, 10, 24]

Total NOK samples (from given_label) : 6
---------- Samples in NOK bins ----------
Bin 0 (-0.02040, -0.01661): [28, 31, 37]
Bin 4 (-0.00521, -0.00142): [22]
Bin 6 (0.00238, 0.00618): [1]
Bin 9 (0.01377, 0.01757): [36]

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_4\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (gearbox)-IF_fdet_4 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\IF\(gearbox)-IF_fdet_4\test


===========================================================================

Fault detection model '(gearbox)-IF_fdet_4' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-17 22:09:23
