=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (GN-gearbox-acc)-IF_fdet_10
Start Time: 2025-08-28 23:39:02
End Time: 2025-08-28 23:39:36

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


ds_subtype selections:

(<ds_subtype_num>) <ds_subtype> : [<augments>]
---------------------------------------------
>> Healthy configs
(1) 0_N    : [OG]

>> Unhealthy configs
(1) 0_B-021    : [OG]

>> Unknown configs


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]

Node group name: gearbox
Signal group name: acc


For ds_type 'OK' and others....

Maximum timesteps across all node types: 243,938

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
---------------------------------------------
Total samples: 972 
Train: 720/777 [OK=372, NOK=348, UK=0], Test: 160/194 [OK=74, NOK=86, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=0, NOK=1, UK=0]

train_data_loader statistics:
Number of batches: 9
torch.Size([80, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 2
torch.Size([80, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: auto

---------------------------------------------------------------------------
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\beari
ng\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_
10.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_10

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> Raw data normalizer initialized with 'std' normalization

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Frequency data cannot be normalized before feature extraction, hence skipping raw data normalization.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Fitting anomaly detection model...

Model fitted successfully in 2.42 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0      0.011677    0.016990    0.022810  ...  1001.272  0.054719           0
1      0.009106    0.001991    0.049864  ...  1001.047 -0.048881           1
2      0.004668    0.006018    0.007578  ...  1001.390  0.095772           0
3      0.023250    0.028156    0.037614  ...  1001.116  0.018342           0
4      0.000357    0.001732    0.006994  ...  1001.369  0.096906           0
..          ...         ...         ...  ...       ...       ...         ...
715    0.006557    0.008269    0.014836  ...  1001.208  0.024088           0
716    0.014774    0.016130    0.021205  ...  1001.345  0.045152           0
717    0.014265    0.016892    0.022303  ...  1001.462  0.067854           0
718    0.001936    0.001994    0.003721  ...  1001.002  0.096016           0
719    0.007056    0.008371    0.011911  ...  1001.368  0.099278           0

[720 rows x 504 columns]

Training accuracy: 0.62

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_10

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_10\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_10\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> Raw data normalizer initialized with 'std' normalization

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Frequency data cannot be normalized before feature extraction, hence skipping raw data normalization.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0      0.004347    0.004698    0.007645  ...  1001.098  0.091226           0
1      0.040326    0.041367    0.065913  ...  1001.130  0.047228           0
2      0.001471    0.003214    0.016280  ...  1001.422 -0.075033           1
3      0.008922    0.011622    0.022874  ...  1001.438 -0.016564           1
4      0.000044    0.001765    0.004236  ...  1001.005  0.059524           0
..          ...         ...         ...  ...       ...       ...         ...
155    0.034296    0.039092    0.052903  ...  1001.481  0.058353           0
156    0.010361    0.010460    0.017987  ...  1001.146  0.051421           0
157    0.007022    0.008132    0.011725  ...  1001.412  0.096027           0
158    0.014382    0.016973    0.017339  ...  1001.173  0.046618           0
159    0.006328    0.009590    0.035801  ...  1001.008 -0.040392           1

[160 rows x 504 columns]

Test accuracy: 0.62
Precision: 1.00, Recall: 0.30, F1-score: 0.46

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_10\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (GN-gearbox-acc)-IF_fdet_10 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_10\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_10 / test...

Total OK samples (from pred_label) : 134
---------- Samples in OK bins ----------
Bin 30 (0.00332, 0.00827): 98 (1,001.084)
Bin 31 (0.00827, 0.01322): 81 (1,001.347)
Bin 32 (0.01322, 0.01817): 47 (1,001.222)
Bin 33 (0.01817, 0.02312): 94 (1,001.342), 116 (1,001.226), 132 (1,001.262)
Bin 34 (0.02312, 0.02806): 43 (1,001.192), 55 (1,001.274)
Bin 35 (0.02806, 0.03301): 16 (1,001.441), 34 (1,001.338), 73 (1,001.228), 118 (1,001.430)
Bin 36 (0.03301, 0.03796): 7 (1,001.078)
Bin 37 (0.03796, 0.04291): 18 (1,001.066), 99 (1,001.069), 123 (1,001.476), 134 (1,001.098), 146 (1,001.076)
Bin 38 (0.04291, 0.04785): 1 (1,001.130), 23 (1,001.195), 52 (1,001.190), 56 (1,001.266), 71 (1,001.214), 77 (1,001.362), 104 (1,001.053), 125 (1,001.302), 138 (1,001.479), 145 (1,001.378), 158 (1,001.173)
Bin 39 (0.04785, 0.05280): 9 (1,001.060), 51 (1,001.468), 54 (1,001.336), 83 (1,001.220), 95 (1,001.334), 117 (1,001.181), 142 (1,001.393), 148 (1,001.364), 156 (1,001.146)
Bin 40 (0.05280, 0.05775): 22 (1,001.152), 36 (1,001.306), 45 (1,001.333), 57 (1,001.131), 62 (1,001.064), 68 (1,001.473), 70 (1,001.263), 89 (1,001.328), 102 (1,001.062), 103 (1,001.129), 121 (1,001.021), 137 (1,001.134)
Bin 41 (0.05775, 0.06270): 4 (1,001.005), 6 (1,001.153), 29 (1,001.246), 32 (1,001.004), 46 (1,001.022), 63 (1,001.341), 72 (1,001.099), 84 (1,001.460), 155 (1,001.481)
Bin 42 (0.06270, 0.06765): 91 (1,001.013)
Bin 46 (0.08249, 0.08744): 8 (1,001.210), 38 (1,001.136), 48 (1,001.286), 60 (1,001.187), 87 (1,001.112), 119 (1,001.024), 127 (1,001.085)
Bin 47 (0.08744, 0.09238): 0 (1,001.098), 15 (1,001.147), 17 (1,001.067), 21 (1,001.339), 30 (1,001.464), 53 (1,001.430), 65 (1,001.241), 78 (1,001.403), 79 (1,001.127), 85 (1,001.344), 86 (1,001.331), 105 (1,001.041), 109 (1,001.189), 110 (1,001.005), 114 (1,001.171), 126 (1,001.440), 128 (1,001.310), 139 (1,001.230), 140 (1,001.128), 143 (1,001.476), 151 (1,001.118), 152 (1,001.335), 153 (1,001.282)
Bin 48 (0.09238, 0.09733): 5 (1,001.242), 12 (1,001.451), 19 (1,001.044), 25 (1,001.190), 33 (1,001.020), 39 (1,001.350), 40 (1,001.314), 42 (1,001.336), 44 (1,001.055), 50 (1,001.071), 58 (1,001.469), 59 (1,001.133), 69 (1,001.367), 74 (1,001.447), 76 (1,001.439), 80 (1,001.300), 82 (1,001.372), 93 (1,001.255), 96 (1,001.073), 97 (1,001.109), 101 (1,001.446), 107 (1,001.092), 108 (1,001.280), 111 (1,001.051), 115 (1,001.140), 120 (1,001.250), 129 (1,001.180), 130 (1,001.247), 131 (1,001.248), 135 (1,001.173), 147 (1,001.062), 149 (1,001.269), 157 (1,001.412)
Bin 49 (0.09733, 0.10228): 10 (1,001.307), 14 (1,001.260), 20 (1,001.379), 26 (1,001.388), 35 (1,001.151), 41 (1,001.113), 61 (1,001.135), 90 (1,001.058), 100 (1,001.356), 112 (1,001.186)

Total NOK samples (from pred_label) : 26
---------- Samples in NOK bins ----------
Bin 0 (-0.14511, -0.14016): 49 (1,001.311)
Bin 2 (-0.13521, -0.13026): 122 (1,001.291)
Bin 4 (-0.12532, -0.12037): 136 (1,001.437)
Bin 9 (-0.10058, -0.09563): 24 (1,001.299)
Bin 10 (-0.09563, -0.09068): 27 (1,001.194), 37 (1,001.059), 75 (1,001.440)
Bin 13 (-0.08079, -0.07584): 64 (1,001.416), 144 (1,001.355)
Bin 14 (-0.07584, -0.07089): 2 (1,001.422)
Bin 15 (-0.07089, -0.06594): 150 (1,001.139)
Bin 16 (-0.06594, -0.06100): 66 (1,001.273)
Bin 19 (-0.05110, -0.04615): 88 (1,001.323)
Bin 20 (-0.04615, -0.04120): 31 (1,001.186)
Bin 21 (-0.04120, -0.03626): 28 (1,001.182), 159 (1,001.008)
Bin 22 (-0.03626, -0.03131): 106 (1,001.015)
Bin 23 (-0.03131, -0.02636): 11 (1,001.260)
Bin 25 (-0.02141, -0.01647): 3 (1,001.438), 154 (1,001.335)
Bin 26 (-0.01647, -0.01152): 113 (1,001.386)
Bin 27 (-0.01152, -0.00657): 124 (1,001.233), 133 (1,001.294), 141 (1,001.296)
Bin 28 (-0.00657, -0.00162): 13 (1,001.482)
Bin 29 (-0.00162, 0.00332): 67 (1,001.065)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_10\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_10 / test...

Total OK samples (from given_label) : 74
---------- Samples in OK bins ----------
Bin 46 (0.08249, 0.08744): 8 (1,001.210), 38 (1,001.136), 48 (1,001.286), 60 (1,001.187), 87 (1,001.112), 119 (1,001.024), 127 (1,001.085)
Bin 47 (0.08744, 0.09238): 0 (1,001.098), 15 (1,001.147), 17 (1,001.067), 21 (1,001.339), 30 (1,001.464), 53 (1,001.430), 65 (1,001.241), 78 (1,001.403), 79 (1,001.127), 85 (1,001.344), 86 (1,001.331), 105 (1,001.041), 109 (1,001.189), 110 (1,001.005), 114 (1,001.171), 126 (1,001.440), 128 (1,001.310), 139 (1,001.230), 140 (1,001.128), 143 (1,001.476), 151 (1,001.118), 152 (1,001.335), 153 (1,001.282)
Bin 48 (0.09238, 0.09733): 5 (1,001.242), 12 (1,001.451), 19 (1,001.044), 25 (1,001.190), 33 (1,001.020), 39 (1,001.350), 40 (1,001.314), 42 (1,001.336), 44 (1,001.055), 50 (1,001.071), 58 (1,001.469), 59 (1,001.133), 69 (1,001.367), 74 (1,001.447), 76 (1,001.439), 80 (1,001.300), 82 (1,001.372), 93 (1,001.255), 96 (1,001.073), 97 (1,001.109), 101 (1,001.446), 107 (1,001.092), 108 (1,001.280), 111 (1,001.051), 115 (1,001.140), 120 (1,001.250), 129 (1,001.180), 130 (1,001.247), 131 (1,001.248), 135 (1,001.173), 147 (1,001.062), 149 (1,001.269), 157 (1,001.412)
Bin 49 (0.09733, 0.10228): 10 (1,001.307), 14 (1,001.260), 20 (1,001.379), 26 (1,001.388), 35 (1,001.151), 41 (1,001.113), 61 (1,001.135), 90 (1,001.058), 100 (1,001.356), 112 (1,001.186)

Total NOK samples (from given_label) : 86
---------- Samples in NOK bins ----------
Bin 0 (-0.14511, -0.14016): 49 (1,001.311)
Bin 2 (-0.13521, -0.13026): 122 (1,001.291)
Bin 4 (-0.12532, -0.12037): 136 (1,001.437)
Bin 9 (-0.10058, -0.09563): 24 (1,001.299)
Bin 10 (-0.09563, -0.09068): 27 (1,001.194), 37 (1,001.059), 75 (1,001.440)
Bin 13 (-0.08079, -0.07584): 64 (1,001.416), 144 (1,001.355)
Bin 14 (-0.07584, -0.07089): 2 (1,001.422)
Bin 15 (-0.07089, -0.06594): 150 (1,001.139)
Bin 16 (-0.06594, -0.06100): 66 (1,001.273)
Bin 19 (-0.05110, -0.04615): 88 (1,001.323)
Bin 20 (-0.04615, -0.04120): 31 (1,001.186)
Bin 21 (-0.04120, -0.03626): 28 (1,001.182), 159 (1,001.008)
Bin 22 (-0.03626, -0.03131): 106 (1,001.015)
Bin 23 (-0.03131, -0.02636): 11 (1,001.260)
Bin 25 (-0.02141, -0.01647): 3 (1,001.438), 154 (1,001.335)
Bin 26 (-0.01647, -0.01152): 113 (1,001.386)
Bin 27 (-0.01152, -0.00657): 124 (1,001.233), 133 (1,001.294), 141 (1,001.296)
Bin 28 (-0.00657, -0.00162): 13 (1,001.482)
Bin 29 (-0.00162, 0.00332): 67 (1,001.065)
Bin 30 (0.00332, 0.00827): 98 (1,001.084)
Bin 31 (0.00827, 0.01322): 81 (1,001.347)
Bin 32 (0.01322, 0.01817): 47 (1,001.222)
Bin 33 (0.01817, 0.02312): 94 (1,001.342), 116 (1,001.226), 132 (1,001.262)
Bin 34 (0.02312, 0.02806): 43 (1,001.192), 55 (1,001.274)
Bin 35 (0.02806, 0.03301): 16 (1,001.441), 34 (1,001.338), 73 (1,001.228), 118 (1,001.430)
Bin 36 (0.03301, 0.03796): 7 (1,001.078)
Bin 37 (0.03796, 0.04291): 18 (1,001.066), 99 (1,001.069), 123 (1,001.476), 134 (1,001.098), 146 (1,001.076)
Bin 38 (0.04291, 0.04785): 1 (1,001.130), 23 (1,001.195), 52 (1,001.190), 56 (1,001.266), 71 (1,001.214), 77 (1,001.362), 104 (1,001.053), 125 (1,001.302), 138 (1,001.479), 145 (1,001.378), 158 (1,001.173)
Bin 39 (0.04785, 0.05280): 9 (1,001.060), 51 (1,001.468), 54 (1,001.336), 83 (1,001.220), 95 (1,001.334), 117 (1,001.181), 142 (1,001.393), 148 (1,001.364), 156 (1,001.146)
Bin 40 (0.05280, 0.05775): 22 (1,001.152), 36 (1,001.306), 45 (1,001.333), 57 (1,001.131), 62 (1,001.064), 68 (1,001.473), 70 (1,001.263), 89 (1,001.328), 102 (1,001.062), 103 (1,001.129), 121 (1,001.021), 137 (1,001.134)
Bin 41 (0.05775, 0.06270): 4 (1,001.005), 6 (1,001.153), 29 (1,001.246), 32 (1,001.004), 46 (1,001.022), 63 (1,001.341), 72 (1,001.099), 84 (1,001.460), 155 (1,001.481)
Bin 42 (0.06270, 0.06765): 91 (1,001.013)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_10\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (GN-gearbox-acc)-IF_fdet_10 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_10\test


===========================================================================

Fault detection model '(GN-gearbox-acc)-IF_fdet_10' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-28 23:39:36
