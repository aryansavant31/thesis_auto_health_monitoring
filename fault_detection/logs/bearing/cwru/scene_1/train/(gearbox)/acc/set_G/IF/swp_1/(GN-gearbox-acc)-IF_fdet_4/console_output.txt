=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (GN-gearbox-acc)-IF_fdet_4
Start Time: 2025-08-28 23:30:57
End Time: 2025-08-28 23:31:15

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


ds_subtype selections:

(<ds_subtype_num>) <ds_subtype> : [<augments>]
---------------------------------------------
>> Healthy configs
(1) 0_N    : [OG]

>> Unhealthy configs
(1) 0_B-021    : [OG]

>> Unknown configs


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]

Node group name: gearbox
Signal group name: acc


For ds_type 'OK' and others....

Maximum timesteps across all node types: 243,938

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
---------------------------------------------
Total samples: 972 
Train: 720/777 [OK=370, NOK=350, UK=0], Test: 160/194 [OK=71, NOK=89, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=1, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 9
torch.Size([80, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 2
torch.Size([80, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 200
Contamination: auto

---------------------------------------------------------------------------
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs
\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc
)-IF_fdet_4.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_4

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> No raw data normalization is applied

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Fitting anomaly detection model...

Model fitted successfully in 0.40 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  ...    scores  pred_label
0      0.002749    0.001086  ...  0.098422           0
1      0.004745    0.000599  ...  0.033885           0
2      0.014003    0.018165  ...  0.057223           0
3      0.013198    0.018287  ...  0.039553           0
4      0.000430    0.000914  ...  0.081123           0
..          ...         ...  ...       ...         ...
715    0.002138    0.001935  ...  0.101148           0
716    0.000608    0.000664  ...  0.075450           0
717    0.004554    0.004435  ...  0.104995           0
718    0.003885    0.005110  ...  0.094122           0
719    0.000443    0.001422  ...  0.051552           0

[720 rows x 504 columns]

Training accuracy: 0.63

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_4

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_4\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_4\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> No raw data normalization is applied

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Dataframe is as follows:
     comp0_dim0  comp1_dim0  ...    scores  pred_label
0      0.026530    0.032433  ... -0.100241           1
1      0.018078    0.022403  ... -0.019174           1
2      0.028598    0.034027  ...  0.041933           0
3      0.007284    0.011583  ...  0.049366           0
4      0.009210    0.013851  ...  0.032679           0
..          ...         ...  ...       ...         ...
155    0.007528    0.009646  ...  0.104491           0
156    0.002310    0.004248  ...  0.097709           0
157    0.011571    0.017760  ... -0.050335           1
158    0.001152    0.003250  ...  0.105653           0
159    0.005869    0.009873  ... -0.078018           1

[160 rows x 504 columns]

Test accuracy: 0.57
Precision: 1.00, Recall: 0.22, F1-score: 0.37

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_4\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (GN-gearbox-acc)-IF_fdet_4 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_4\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_4 / test...

Total OK samples (from pred_label) : 140
---------- Samples in OK bins ----------
Bin 23 (-0.00283, 0.00141): 30 (1,001.482)
Bin 24 (0.00141, 0.00564): 42 (1,001.292), 105 (1,001.037)
Bin 25 (0.00564, 0.00988): 120 (1,001.161)
Bin 26 (0.00988, 0.01411): 153 (1,001.281)
Bin 27 (0.01411, 0.01835): 100 (1,001.222)
Bin 28 (0.01835, 0.02258): 6 (1,001.221), 18 (1,001.413), 24 (1,001.366), 46 (1,001.072)
Bin 29 (0.02258, 0.02682): 84 (1,001.486), 135 (1,001.003)
Bin 30 (0.02682, 0.03105): 36 (1,001.445), 48 (1,001.401), 72 (1,001.067)
Bin 31 (0.03105, 0.03529): 4 (1,001.197), 39 (1,001.400), 44 (1,001.442), 139 (1,001.256)
Bin 32 (0.03529, 0.03952): 27 (1,001.345), 35 (1,001.159)
Bin 33 (0.03952, 0.04376): 2 (1,001.378), 57 (1,001.266), 62 (1,001.320), 122 (1,001.066), 132 (1,001.456), 154 (1,001.014)
Bin 34 (0.04376, 0.04800): 61 (1,001.377), 64 (1,001.002), 141 (1,001.375)
Bin 35 (0.04800, 0.05223): 3 (1,001.328), 32 (1,001.277), 85 (1,001.317), 101 (1,001.199), 115 (1,001.115), 131 (1,001.369), 140 (1,001.173)
Bin 36 (0.05223, 0.05647): 12 (1,001.129), 14 (1,001.108), 23 (1,001.062), 69 (1,001.288), 86 (1,001.170), 97 (1,001.283), 104 (1,001.151), 129 (1,001.114), 148 (1,001.421)
Bin 37 (0.05647, 0.06070): 10 (1,001.162), 13 (1,001.188), 19 (1,001.263), 41 (1,001.125), 49 (1,001.165), 89 (1,001.372), 95 (1,001.064), 121 (1,001.217), 126 (1,001.334), 145 (1,001.055)
Bin 38 (0.06070, 0.06494): 11 (1,001.359), 37 (1,001.357), 47 (1,001.431), 60 (1,001.045), 73 (1,001.471), 147 (1,001.278)
Bin 39 (0.06494, 0.06917): 53 (1,001.052), 111 (1,001.212), 116 (1,001.167), 128 (1,001.250)
Bin 40 (0.06917, 0.07341): 50 (1,001.383), 138 (1,001.465)
Bin 42 (0.07764, 0.08188): 31 (1,001.028), 59 (1,001.230), 96 (1,001.354), 136 (1,001.026)
Bin 43 (0.08188, 0.08611): 9 (1,001.203), 63 (1,001.254), 107 (1,001.436), 114 (1,001.158)
Bin 44 (0.08611, 0.09035): 40 (1,001.326), 55 (1,001.223), 58 (1,001.043), 65 (1,001.065), 74 (1,001.270), 80 (1,001.300), 81 (1,001.332), 93 (1,001.146), 102 (1,001.148), 103 (1,001.461), 110 (1,001.204)
Bin 45 (0.09035, 0.09458): 7 (1,001.023), 26 (1,001.208), 66 (1,001.353), 68 (1,001.142), 76 (1,001.176), 79 (1,001.180), 87 (1,001.403), 88 (1,001.091), 99 (1,001.339), 113 (1,001.112), 133 (1,001.127), 134 (1,001.366), 149 (1,001.341), 150 (1,001.373), 151 (1,001.342)
Bin 46 (0.09458, 0.09882): 5 (1,001.248), 16 (1,001.385), 25 (1,001.313), 34 (1,001.016), 43 (1,001.365), 67 (1,001.115), 70 (1,001.446), 77 (1,001.215), 83 (1,001.415), 94 (1,001.417), 125 (1,001.145), 143 (1,001.068), 156 (1,001.418)
Bin 47 (0.09882, 0.10305): 8 (1,001.099), 38 (1,001.422), 45 (1,001.048), 52 (1,001.378), 71 (1,001.351), 82 (1,001.262), 108 (1,001.292), 117 (1,001.329), 119 (1,001.014), 123 (1,001.392), 124 (1,001.066), 130 (1,001.328), 137 (1,001.133), 142 (1,001.242), 146 (1,001.391), 152 (1,001.314)
Bin 48 (0.10305, 0.10729): 15 (1,001.198), 33 (1,001.013), 78 (1,001.236), 118 (1,001.188), 144 (1,001.207), 155 (1,001.456), 158 (1,001.235)
Bin 49 (0.10729, 0.11152): 90 (1,001.267)

Total NOK samples (from pred_label) : 20
---------- Samples in NOK bins ----------
Bin 0 (-0.10024, -0.09601): 0 (1,001.235)
Bin 2 (-0.09177, -0.08754): 29 (1,001.090), 112 (1,001.102)
Bin 4 (-0.08330, -0.07906): 92 (1,001.140)
Bin 5 (-0.07906, -0.07483): 159 (1,001.091)
Bin 9 (-0.06212, -0.05789): 22 (1,001.417), 28 (1,001.238)
Bin 11 (-0.05365, -0.04942): 157 (1,001.023)
Bin 12 (-0.04942, -0.04518): 98 (1,001.230)
Bin 13 (-0.04518, -0.04095): 75 (1,001.186)
Bin 14 (-0.04095, -0.03671): 17 (1,001.289)
Bin 15 (-0.03671, -0.03248): 106 (1,001.352)
Bin 16 (-0.03248, -0.02824): 91 (1,001.454)
Bin 19 (-0.01977, -0.01553): 1 (1,001.371), 127 (1,001.143)
Bin 20 (-0.01553, -0.01130): 21 (1,001.388), 109 (1,001.384)
Bin 21 (-0.01130, -0.00706): 20 (1,001.395), 51 (1,001.042)
Bin 22 (-0.00706, -0.00283): 54 (1,001.298)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_4\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_4 / test...

Total OK samples (from given_label) : 71
---------- Samples in OK bins ----------
Bin 42 (0.07764, 0.08188): 31 (1,001.028), 59 (1,001.230), 96 (1,001.354)
Bin 43 (0.08188, 0.08611): 9 (1,001.203), 63 (1,001.254), 107 (1,001.436), 114 (1,001.158)
Bin 44 (0.08611, 0.09035): 40 (1,001.326), 55 (1,001.223), 58 (1,001.043), 65 (1,001.065), 74 (1,001.270), 80 (1,001.300), 81 (1,001.332), 93 (1,001.146), 102 (1,001.148), 103 (1,001.461), 110 (1,001.204)
Bin 45 (0.09035, 0.09458): 7 (1,001.023), 26 (1,001.208), 66 (1,001.353), 68 (1,001.142), 76 (1,001.176), 79 (1,001.180), 87 (1,001.403), 88 (1,001.091), 99 (1,001.339), 113 (1,001.112), 133 (1,001.127), 134 (1,001.366), 149 (1,001.341), 150 (1,001.373), 151 (1,001.342)
Bin 46 (0.09458, 0.09882): 5 (1,001.248), 16 (1,001.385), 25 (1,001.313), 34 (1,001.016), 43 (1,001.365), 67 (1,001.115), 70 (1,001.446), 77 (1,001.215), 83 (1,001.415), 94 (1,001.417), 125 (1,001.145), 143 (1,001.068), 156 (1,001.418)
Bin 47 (0.09882, 0.10305): 8 (1,001.099), 38 (1,001.422), 45 (1,001.048), 52 (1,001.378), 71 (1,001.351), 82 (1,001.262), 108 (1,001.292), 117 (1,001.329), 119 (1,001.014), 123 (1,001.392), 124 (1,001.066), 130 (1,001.328), 137 (1,001.133), 142 (1,001.242), 146 (1,001.391), 152 (1,001.314)
Bin 48 (0.10305, 0.10729): 15 (1,001.198), 33 (1,001.013), 78 (1,001.236), 118 (1,001.188), 144 (1,001.207), 155 (1,001.456), 158 (1,001.235)
Bin 49 (0.10729, 0.11152): 90 (1,001.267)

Total NOK samples (from given_label) : 89
---------- Samples in NOK bins ----------
Bin 0 (-0.10024, -0.09601): 0 (1,001.235)
Bin 2 (-0.09177, -0.08754): 29 (1,001.090), 112 (1,001.102)
Bin 4 (-0.08330, -0.07906): 92 (1,001.140)
Bin 5 (-0.07906, -0.07483): 159 (1,001.091)
Bin 9 (-0.06212, -0.05789): 22 (1,001.417), 28 (1,001.238)
Bin 11 (-0.05365, -0.04942): 157 (1,001.023)
Bin 12 (-0.04942, -0.04518): 98 (1,001.230)
Bin 13 (-0.04518, -0.04095): 75 (1,001.186)
Bin 14 (-0.04095, -0.03671): 17 (1,001.289)
Bin 15 (-0.03671, -0.03248): 106 (1,001.352)
Bin 16 (-0.03248, -0.02824): 91 (1,001.454)
Bin 19 (-0.01977, -0.01553): 1 (1,001.371), 127 (1,001.143)
Bin 20 (-0.01553, -0.01130): 21 (1,001.388), 109 (1,001.384)
Bin 21 (-0.01130, -0.00706): 20 (1,001.395), 51 (1,001.042)
Bin 22 (-0.00706, -0.00283): 54 (1,001.298)
Bin 23 (-0.00283, 0.00141): 30 (1,001.482)
Bin 24 (0.00141, 0.00564): 42 (1,001.292), 105 (1,001.037)
Bin 25 (0.00564, 0.00988): 120 (1,001.161)
Bin 26 (0.00988, 0.01411): 153 (1,001.281)
Bin 27 (0.01411, 0.01835): 100 (1,001.222)
Bin 28 (0.01835, 0.02258): 6 (1,001.221), 18 (1,001.413), 24 (1,001.366), 46 (1,001.072)
Bin 29 (0.02258, 0.02682): 84 (1,001.486), 135 (1,001.003)
Bin 30 (0.02682, 0.03105): 36 (1,001.445), 48 (1,001.401), 72 (1,001.067)
Bin 31 (0.03105, 0.03529): 4 (1,001.197), 39 (1,001.400), 44 (1,001.442), 139 (1,001.256)
Bin 32 (0.03529, 0.03952): 27 (1,001.345), 35 (1,001.159)
Bin 33 (0.03952, 0.04376): 2 (1,001.378), 57 (1,001.266), 62 (1,001.320), 122 (1,001.066), 132 (1,001.456), 154 (1,001.014)
Bin 34 (0.04376, 0.04800): 61 (1,001.377), 64 (1,001.002), 141 (1,001.375)
Bin 35 (0.04800, 0.05223): 3 (1,001.328), 32 (1,001.277), 85 (1,001.317), 101 (1,001.199), 115 (1,001.115), 131 (1,001.369), 140 (1,001.173)
Bin 36 (0.05223, 0.05647): 12 (1,001.129), 14 (1,001.108), 23 (1,001.062), 69 (1,001.288), 86 (1,001.170), 97 (1,001.283), 104 (1,001.151), 129 (1,001.114), 148 (1,001.421)
Bin 37 (0.05647, 0.06070): 10 (1,001.162), 13 (1,001.188), 19 (1,001.263), 41 (1,001.125), 49 (1,001.165), 89 (1,001.372), 95 (1,001.064), 121 (1,001.217), 126 (1,001.334), 145 (1,001.055)
Bin 38 (0.06070, 0.06494): 11 (1,001.359), 37 (1,001.357), 47 (1,001.431), 60 (1,001.045), 73 (1,001.471), 147 (1,001.278)
Bin 39 (0.06494, 0.06917): 53 (1,001.052), 111 (1,001.212), 116 (1,001.167), 128 (1,001.250)
Bin 40 (0.06917, 0.07341): 50 (1,001.383), 138 (1,001.465)
Bin 42 (0.07764, 0.08188): 136 (1,001.026)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_4\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (GN-gearbox-acc)-IF_fdet_4 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_4\test


===========================================================================

Fault detection model '(GN-gearbox-acc)-IF_fdet_4' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-28 23:31:15
