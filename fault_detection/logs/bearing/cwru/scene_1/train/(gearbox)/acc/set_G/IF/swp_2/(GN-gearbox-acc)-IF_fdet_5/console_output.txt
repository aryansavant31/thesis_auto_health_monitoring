=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (GN-gearbox-acc)-IF_fdet_5
Start Time: 2025-08-28 23:39:02
End Time: 2025-08-28 23:39:35

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


ds_subtype selections:

(<ds_subtype_num>) <ds_subtype> : [<augments>]
---------------------------------------------
>> Healthy configs
(1) 0_N    : [OG]

>> Unhealthy configs
(1) 0_B-021    : [OG]

>> Unknown configs


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]

Node group name: gearbox
Signal group name: acc


For ds_type 'OK' and others....

Maximum timesteps across all node types: 243,938

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
---------------------------------------------
Total samples: 972 
Train: 700/777 [OK=339, NOK=361, UK=0], Test: 100/194 [OK=62, NOK=38, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=1, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 7
torch.Size([100, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 1
torch.Size([100, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: auto

---------------------------------------------------------------------------
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\beari
ng\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_
5.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_5

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> No raw data normalization is applied

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Fitting anomaly detection model...

Model fitted successfully in 2.39 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0      0.001091    0.001733    0.002243  ...  1001.085  0.084999           0
1      0.004036    0.003948    0.008275  ...  1001.214  0.101223           0
2      0.005348    0.006350    0.008818  ...  1001.339  0.091991           0
3      0.001049    0.000782    0.007092  ...  1001.014  0.092502           0
4      0.005953    0.006751    0.008470  ...  1001.011  0.089149           0
..          ...         ...         ...  ...       ...       ...         ...
695    0.002719    0.002789    0.006083  ...  1001.367  0.096847           0
696    0.008250    0.008149    0.027210  ...  1001.084  0.010402           0
697    0.005018    0.005583    0.009567  ...  1001.083  0.095495           0
698    0.002310    0.004248    0.012026  ...  1001.418  0.096128           0
699    0.002837    0.005378    0.017888  ...  1001.001  0.060649           0

[700 rows x 504 columns]

Training accuracy: 0.59

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_5

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_5\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_5\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> No raw data normalization is applied

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Dataframe is as follows:
    comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0     0.006607    0.006272    0.005986  ...  1001.317  0.046360           0
1     0.004418    0.008799    0.037689  ...  1001.102 -0.089936           1
2     0.010931    0.018105    0.032705  ...  1001.478  0.045900           0
3     0.007022    0.008132    0.011725  ...  1001.412  0.093063           0
4     0.001978    0.003626    0.009927  ...  1001.126  0.087846           0
..         ...         ...         ...  ...       ...       ...         ...
95    0.003270    0.003098    0.003028  ...  1001.182 -0.033801           1
96    0.008922    0.011622    0.022874  ...  1001.438 -0.016614           1
97    0.018042    0.023162    0.033297  ...  1001.031 -0.051408           1
98    0.006571    0.008256    0.010289  ...  1001.144  0.093187           0
99    0.008337    0.010113    0.014719  ...  1001.219  0.089598           0

[100 rows x 504 columns]

Test accuracy: 0.74
Precision: 1.00, Recall: 0.32, F1-score: 0.48

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_5\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (GN-gearbox-acc)-IF_fdet_5 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_5\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_5 / test...

Total OK samples (from pred_label) : 88
---------- Samples in OK bins ----------
Bin 26 (0.00270, 0.00675): 31 (1,001.126), 37 (1,001.100)
Bin 28 (0.01081, 0.01486): 80 (1,001.030)
Bin 29 (0.01486, 0.01892): 13 (1,001.243)
Bin 30 (0.01892, 0.02297): 69 (1,001.242)
Bin 31 (0.02297, 0.02703): 8 (1,001.116)
Bin 34 (0.03514, 0.03920): 45 (1,001.436)
Bin 35 (0.03920, 0.04325): 17 (1,001.350), 48 (1,001.456)
Bin 36 (0.04325, 0.04731): 0 (1,001.317), 2 (1,001.478), 25 (1,001.283), 42 (1,001.195)
Bin 37 (0.04731, 0.05136): 29 (1,001.362), 67 (1,001.423)
Bin 38 (0.05136, 0.05542): 11 (1,001.196), 53 (1,001.354)
Bin 39 (0.05542, 0.05947): 21 (1,001.134), 22 (1,001.121), 87 (1,001.109)
Bin 40 (0.05947, 0.06353): 6 (1,001.125), 24 (1,001.021), 52 (1,001.018), 88 (1,001.431)
Bin 41 (0.06353, 0.06759): 60 (1,001.020), 83 (1,001.272)
Bin 45 (0.07975, 0.08381): 10 (1,001.383), 72 (1,001.225)
Bin 46 (0.08381, 0.08786): 4 (1,001.126), 14 (1,001.290), 18 (1,001.209), 27 (1,001.093), 50 (1,001.396), 91 (1,001.331)
Bin 47 (0.08786, 0.09192): 19 (1,001.305), 23 (1,001.240), 33 (1,001.223), 39 (1,001.416), 40 (1,001.409), 55 (1,001.197), 57 (1,001.371), 59 (1,001.252), 64 (1,001.210), 71 (1,001.351), 75 (1,001.314), 79 (1,001.478), 82 (1,001.049), 94 (1,001.108), 99 (1,001.219)
Bin 48 (0.09192, 0.09598): 3 (1,001.412), 5 (1,001.301), 7 (1,001.333), 15 (1,001.297), 32 (1,001.264), 34 (1,001.382), 35 (1,001.472), 36 (1,001.426), 38 (1,001.442), 43 (1,001.090), 49 (1,001.465), 56 (1,001.398), 58 (1,001.236), 63 (1,001.480), 73 (1,001.106), 77 (1,001.334), 78 (1,001.263), 84 (1,001.035), 86 (1,001.174), 98 (1,001.144)
Bin 49 (0.09598, 0.10003): 9 (1,001.441), 12 (1,001.420), 16 (1,001.410), 20 (1,001.360), 26 (1,001.135), 30 (1,001.084), 41 (1,001.224), 46 (1,001.022), 51 (1,001.429), 61 (1,001.374), 62 (1,001.417), 65 (1,001.217), 66 (1,001.216), 70 (1,001.267), 74 (1,001.194), 76 (1,001.129), 85 (1,001.021), 93 (1,001.389)

Total NOK samples (from pred_label) : 12
---------- Samples in NOK bins ----------
Bin 0 (-0.10275, -0.09870): 92 (1,001.300)
Bin 3 (-0.09059, -0.08653): 1 (1,001.102)
Bin 12 (-0.05408, -0.05003): 97 (1,001.031)
Bin 13 (-0.05003, -0.04597): 90 (1,001.047)
Bin 15 (-0.04192, -0.03786): 68 (1,001.089), 81 (1,001.398)
Bin 17 (-0.03381, -0.02975): 95 (1,001.182)
Bin 19 (-0.02569, -0.02164): 89 (1,001.454)
Bin 20 (-0.02164, -0.01758): 28 (1,001.241)
Bin 21 (-0.01758, -0.01353): 47 (1,001.255), 96 (1,001.438)
Bin 22 (-0.01353, -0.00947): 54 (1,001.244)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_5\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_5 / test...

Total OK samples (from given_label) : 62
---------- Samples in OK bins ----------
Bin 45 (0.07975, 0.08381): 10 (1,001.383), 72 (1,001.225)
Bin 46 (0.08381, 0.08786): 4 (1,001.126), 14 (1,001.290), 18 (1,001.209), 27 (1,001.093), 50 (1,001.396), 91 (1,001.331)
Bin 47 (0.08786, 0.09192): 19 (1,001.305), 23 (1,001.240), 33 (1,001.223), 39 (1,001.416), 40 (1,001.409), 55 (1,001.197), 57 (1,001.371), 59 (1,001.252), 64 (1,001.210), 71 (1,001.351), 75 (1,001.314), 79 (1,001.478), 82 (1,001.049), 94 (1,001.108), 99 (1,001.219)
Bin 48 (0.09192, 0.09598): 3 (1,001.412), 5 (1,001.301), 7 (1,001.333), 15 (1,001.297), 32 (1,001.264), 34 (1,001.382), 35 (1,001.472), 36 (1,001.426), 38 (1,001.442), 43 (1,001.090), 49 (1,001.465), 56 (1,001.398), 58 (1,001.236), 63 (1,001.480), 73 (1,001.106), 77 (1,001.334), 78 (1,001.263), 84 (1,001.035), 86 (1,001.174), 98 (1,001.144)
Bin 49 (0.09598, 0.10003): 9 (1,001.441), 12 (1,001.420), 16 (1,001.410), 20 (1,001.360), 26 (1,001.135), 30 (1,001.084), 41 (1,001.224), 46 (1,001.022), 51 (1,001.429), 61 (1,001.374), 62 (1,001.417), 65 (1,001.217), 66 (1,001.216), 70 (1,001.267), 74 (1,001.194), 76 (1,001.129), 85 (1,001.021), 93 (1,001.389)

Total NOK samples (from given_label) : 38
---------- Samples in NOK bins ----------
Bin 0 (-0.10275, -0.09870): 92 (1,001.300)
Bin 3 (-0.09059, -0.08653): 1 (1,001.102)
Bin 12 (-0.05408, -0.05003): 97 (1,001.031)
Bin 13 (-0.05003, -0.04597): 90 (1,001.047)
Bin 15 (-0.04192, -0.03786): 68 (1,001.089), 81 (1,001.398)
Bin 17 (-0.03381, -0.02975): 95 (1,001.182)
Bin 19 (-0.02569, -0.02164): 89 (1,001.454)
Bin 20 (-0.02164, -0.01758): 28 (1,001.241)
Bin 21 (-0.01758, -0.01353): 47 (1,001.255), 96 (1,001.438)
Bin 22 (-0.01353, -0.00947): 54 (1,001.244)
Bin 26 (0.00270, 0.00675): 31 (1,001.126), 37 (1,001.100)
Bin 28 (0.01081, 0.01486): 80 (1,001.030)
Bin 29 (0.01486, 0.01892): 13 (1,001.243)
Bin 30 (0.01892, 0.02297): 69 (1,001.242)
Bin 31 (0.02297, 0.02703): 8 (1,001.116)
Bin 34 (0.03514, 0.03920): 45 (1,001.436)
Bin 35 (0.03920, 0.04325): 17 (1,001.350), 48 (1,001.456)
Bin 36 (0.04325, 0.04731): 0 (1,001.317), 2 (1,001.478), 25 (1,001.283), 42 (1,001.195)
Bin 37 (0.04731, 0.05136): 29 (1,001.362), 67 (1,001.423)
Bin 38 (0.05136, 0.05542): 11 (1,001.196), 53 (1,001.354)
Bin 39 (0.05542, 0.05947): 21 (1,001.134), 22 (1,001.121), 87 (1,001.109)
Bin 40 (0.05947, 0.06353): 6 (1,001.125), 24 (1,001.021), 52 (1,001.018), 88 (1,001.431)
Bin 41 (0.06353, 0.06759): 60 (1,001.020), 83 (1,001.272)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_5\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (GN-gearbox-acc)-IF_fdet_5 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_5\test


===========================================================================

Fault detection model '(GN-gearbox-acc)-IF_fdet_5' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-28 23:39:35
