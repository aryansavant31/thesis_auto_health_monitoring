=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (GN-gearbox-acc)-IF_fdet_6
Start Time: 2025-08-28 23:39:02
End Time: 2025-08-28 23:39:35

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


ds_subtype selections:

(<ds_subtype_num>) <ds_subtype> : [<augments>]
---------------------------------------------
>> Healthy configs
(1) 0_N    : [OG]

>> Unhealthy configs
(1) 0_B-021    : [OG]

>> Unknown configs


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]

Node group name: gearbox
Signal group name: acc


For ds_type 'OK' and others....

Maximum timesteps across all node types: 243,938

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
---------------------------------------------
Total samples: 972 
Train: 700/777 [OK=349, NOK=351, UK=0], Test: 100/194 [OK=59, NOK=41, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=0, NOK=1, UK=0]

train_data_loader statistics:
Number of batches: 7
torch.Size([100, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 1
torch.Size([100, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: auto

---------------------------------------------------------------------------
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\beari
ng\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_
6.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_6

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Frequency data cannot be normalized before feature extraction, hence skipping raw data normalization.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Fitting anomaly detection model...

Model fitted successfully in 2.41 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0      0.002592    0.003258    0.003953  ...  1001.473  0.091114           0
1      0.006939    0.008845    0.013073  ...  1001.263  0.092691           0
2      0.002653    0.003987    0.007245  ...  1001.012  0.092706           0
3      0.005320    0.006357    0.008314  ...  1001.326  0.090788           0
4      0.001724    0.001578    0.004338  ...  1001.182  0.098956           0
..          ...         ...         ...  ...       ...       ...         ...
695    0.001335    0.001449    0.002232  ...  1001.294  0.094124           0
696    0.023583    0.027198    0.038910  ...  1001.482 -0.000947           1
697    0.009669    0.014317    0.030015  ...  1001.183  0.036804           0
698    0.002310    0.004248    0.012026  ...  1001.418  0.097370           0
699    0.003252    0.002389    0.010966  ...  1001.279  0.099043           0

[700 rows x 504 columns]

Training accuracy: 0.61

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_6

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_6\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_6\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Frequency data cannot be normalized before feature extraction, hence skipping raw data normalization.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Dataframe is as follows:
    comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0     0.037475    0.039657    0.062026  ...  1001.377  0.043513           0
1     0.006607    0.006272    0.005986  ...  1001.317  0.043149           0
2     0.016839    0.017862    0.028632  ...  1001.071  0.068112           0
3     0.000017    0.001596    0.008888  ...  1001.410  0.097890           0
4     0.004148    0.002507    0.016580  ...  1001.284  0.096997           0
..         ...         ...         ...  ...       ...       ...         ...
95    0.003642    0.005051    0.007541  ...  1001.335  0.094770           0
96    0.002031    0.001060    0.008638  ...  1001.191  0.096116           0
97    0.002779    0.004976    0.013812  ...  1001.231  0.096928           0
98    0.007924    0.011269    0.020420  ...  1001.443  0.057210           0
99    0.002694    0.003009    0.003905  ...  1001.416  0.088831           0

[100 rows x 504 columns]

Test accuracy: 0.69
Precision: 1.00, Recall: 0.24, F1-score: 0.39

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_6\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (GN-gearbox-acc)-IF_fdet_6 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_6\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_6 / test...

Total OK samples (from pred_label) : 90
---------- Samples in OK bins ----------
Bin 28 (0.00193, 0.00659): 16 (1,001.038)
Bin 31 (0.01589, 0.02054): 37 (1,001.030)
Bin 32 (0.02054, 0.02519): 39 (1,001.201), 86 (1,001.221)
Bin 33 (0.02519, 0.02985): 11 (1,001.261)
Bin 34 (0.02985, 0.03450): 15 (1,001.413), 69 (1,001.223)
Bin 35 (0.03450, 0.03915): 13 (1,001.275)
Bin 36 (0.03915, 0.04380): 0 (1,001.377), 1 (1,001.317), 22 (1,001.464)
Bin 37 (0.04380, 0.04846): 48 (1,001.283)
Bin 38 (0.04846, 0.05311): 45 (1,001.446)
Bin 39 (0.05311, 0.05776): 12 (1,001.207), 18 (1,001.001), 53 (1,001.258), 67 (1,001.475), 87 (1,001.272), 98 (1,001.443)
Bin 40 (0.05776, 0.06241): 25 (1,001.303), 28 (1,001.471), 35 (1,001.259)
Bin 41 (0.06241, 0.06706): 6 (1,001.254), 8 (1,001.020), 40 (1,001.337), 76 (1,001.428), 78 (1,001.096), 79 (1,001.383)
Bin 42 (0.06706, 0.07172): 2 (1,001.071), 52 (1,001.462), 66 (1,001.179)
Bin 44 (0.07637, 0.08102): 60 (1,001.087)
Bin 45 (0.08102, 0.08567): 30 (1,001.450)
Bin 46 (0.08567, 0.09032): 9 (1,001.347), 23 (1,001.290), 29 (1,001.065), 36 (1,001.116), 42 (1,001.332), 56 (1,001.254), 59 (1,001.387), 81 (1,001.120), 83 (1,001.045), 84 (1,001.399), 99 (1,001.416)
Bin 47 (0.09032, 0.09498): 19 (1,001.471), 24 (1,001.261), 26 (1,001.180), 32 (1,001.149), 34 (1,001.155), 43 (1,001.460), 44 (1,001.424), 55 (1,001.098), 57 (1,001.165), 61 (1,001.452), 63 (1,001.437), 65 (1,001.092), 70 (1,001.316), 80 (1,001.188), 85 (1,001.248), 88 (1,001.245), 90 (1,001.308), 91 (1,001.118), 93 (1,001.073), 95 (1,001.335)
Bin 48 (0.09498, 0.09963): 3 (1,001.410), 4 (1,001.284), 17 (1,001.169), 21 (1,001.457), 38 (1,001.150), 41 (1,001.273), 54 (1,001.044), 64 (1,001.022), 68 (1,001.070), 73 (1,001.084), 74 (1,001.147), 75 (1,001.061), 77 (1,001.138), 82 (1,001.134), 89 (1,001.151), 96 (1,001.191), 97 (1,001.231)
Bin 49 (0.09963, 0.10428): 5 (1,001.434), 10 (1,001.319), 27 (1,001.114), 47 (1,001.293), 49 (1,001.015), 50 (1,001.186), 62 (1,001.465), 71 (1,001.313)

Total NOK samples (from pred_label) : 10
---------- Samples in NOK bins ----------
Bin 0 (-0.12832, -0.12367): 7 (1,001.041), 20 (1,001.291)
Bin 7 (-0.09576, -0.09111): 72 (1,001.216)
Bin 9 (-0.08646, -0.08180): 31 (1,001.091)
Bin 12 (-0.07250, -0.06785): 46 (1,001.355)
Bin 17 (-0.04924, -0.04459): 51 (1,001.449), 58 (1,001.031)
Bin 21 (-0.03063, -0.02598): 92 (1,001.182)
Bin 24 (-0.01667, -0.01202): 33 (1,001.388)
Bin 26 (-0.00737, -0.00272): 14 (1,001.143)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_6\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_6 / test...

Total OK samples (from given_label) : 59
---------- Samples in OK bins ----------
Bin 44 (0.07637, 0.08102): 60 (1,001.087)
Bin 45 (0.08102, 0.08567): 30 (1,001.450)
Bin 46 (0.08567, 0.09032): 9 (1,001.347), 23 (1,001.290), 29 (1,001.065), 36 (1,001.116), 42 (1,001.332), 56 (1,001.254), 59 (1,001.387), 81 (1,001.120), 83 (1,001.045), 84 (1,001.399), 99 (1,001.416)
Bin 47 (0.09032, 0.09498): 19 (1,001.471), 24 (1,001.261), 26 (1,001.180), 32 (1,001.149), 34 (1,001.155), 43 (1,001.460), 44 (1,001.424), 55 (1,001.098), 57 (1,001.165), 61 (1,001.452), 63 (1,001.437), 65 (1,001.092), 70 (1,001.316), 80 (1,001.188), 85 (1,001.248), 88 (1,001.245), 90 (1,001.308), 91 (1,001.118), 93 (1,001.073), 95 (1,001.335)
Bin 48 (0.09498, 0.09963): 3 (1,001.410), 4 (1,001.284), 17 (1,001.169), 21 (1,001.457), 38 (1,001.150), 41 (1,001.273), 54 (1,001.044), 64 (1,001.022), 68 (1,001.070), 73 (1,001.084), 74 (1,001.147), 75 (1,001.061), 77 (1,001.138), 82 (1,001.134), 89 (1,001.151), 96 (1,001.191), 97 (1,001.231)
Bin 49 (0.09963, 0.10428): 5 (1,001.434), 10 (1,001.319), 27 (1,001.114), 47 (1,001.293), 49 (1,001.015), 50 (1,001.186), 62 (1,001.465), 71 (1,001.313)

Total NOK samples (from given_label) : 41
---------- Samples in NOK bins ----------
Bin 0 (-0.12832, -0.12367): 7 (1,001.041), 20 (1,001.291)
Bin 7 (-0.09576, -0.09111): 72 (1,001.216)
Bin 9 (-0.08646, -0.08180): 31 (1,001.091)
Bin 12 (-0.07250, -0.06785): 46 (1,001.355)
Bin 17 (-0.04924, -0.04459): 51 (1,001.449), 58 (1,001.031)
Bin 21 (-0.03063, -0.02598): 92 (1,001.182)
Bin 24 (-0.01667, -0.01202): 33 (1,001.388)
Bin 26 (-0.00737, -0.00272): 14 (1,001.143)
Bin 28 (0.00193, 0.00659): 16 (1,001.038)
Bin 31 (0.01589, 0.02054): 37 (1,001.030)
Bin 32 (0.02054, 0.02519): 39 (1,001.201), 86 (1,001.221)
Bin 33 (0.02519, 0.02985): 11 (1,001.261)
Bin 34 (0.02985, 0.03450): 15 (1,001.413), 69 (1,001.223)
Bin 35 (0.03450, 0.03915): 13 (1,001.275)
Bin 36 (0.03915, 0.04380): 0 (1,001.377), 1 (1,001.317), 22 (1,001.464)
Bin 37 (0.04380, 0.04846): 48 (1,001.283)
Bin 38 (0.04846, 0.05311): 45 (1,001.446)
Bin 39 (0.05311, 0.05776): 12 (1,001.207), 18 (1,001.001), 53 (1,001.258), 67 (1,001.475), 87 (1,001.272), 98 (1,001.443)
Bin 40 (0.05776, 0.06241): 25 (1,001.303), 28 (1,001.471), 35 (1,001.259)
Bin 41 (0.06241, 0.06706): 6 (1,001.254), 8 (1,001.020), 40 (1,001.337), 76 (1,001.428), 78 (1,001.096), 79 (1,001.383)
Bin 42 (0.06706, 0.07172): 2 (1,001.071), 52 (1,001.462), 66 (1,001.179)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_6\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (GN-gearbox-acc)-IF_fdet_6 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_6\test


===========================================================================

Fault detection model '(GN-gearbox-acc)-IF_fdet_6' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-28 23:39:35
