=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (GN-gearbox-acc)-IF_fdet_7
Start Time: 2025-08-28 23:39:02
End Time: 2025-08-28 23:39:35

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


ds_subtype selections:

(<ds_subtype_num>) <ds_subtype> : [<augments>]
---------------------------------------------
>> Healthy configs
(1) 0_N    : [OG]

>> Unhealthy configs
(1) 0_B-021    : [OG]

>> Unknown configs


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]

Node group name: gearbox
Signal group name: acc


For ds_type 'OK' and others....

Maximum timesteps across all node types: 243,938

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
---------------------------------------------
Total samples: 972 
Train: 700/777 [OK=347, NOK=353, UK=0], Test: 100/194 [OK=47, NOK=53, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=0, NOK=1, UK=0]

train_data_loader statistics:
Number of batches: 7
torch.Size([100, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 1
torch.Size([100, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: auto

---------------------------------------------------------------------------
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\beari
ng\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_
7.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_7

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> Raw data normalizer initialized with 'std' normalization

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Frequency data cannot be normalized before feature extraction, hence skipping raw data normalization.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Fitting anomaly detection model...

Model fitted successfully in 2.40 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0      0.004614    0.004688    0.008418  ...  1001.130  0.086872           0
1      0.016990    0.015957    0.041888  ...  1001.392  0.026333           0
2      0.001702    0.002640    0.006570  ...  1001.070  0.100120           0
3      0.006592    0.008170    0.010924  ...  1001.233  0.096000           0
4      0.008610    0.008515    0.016592  ...  1001.096  0.065551           0
..          ...         ...         ...  ...       ...       ...         ...
695    0.031035    0.040730    0.049078  ...  1001.298  0.005491           0
696    0.002643    0.003485    0.005776  ...  1001.332  0.091392           0
697    0.003290    0.003622    0.004866  ...  1001.073  0.096487           0
698    0.003252    0.002389    0.010966  ...  1001.279  0.097886           0
699    0.003088    0.003137    0.007510  ...  1001.022  0.097752           0

[700 rows x 504 columns]

Training accuracy: 0.61

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_7

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_7\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_7\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> Raw data normalizer initialized with 'std' normalization

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Frequency data cannot be normalized before feature extraction, hence skipping raw data normalization.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Dataframe is as follows:
    comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0     0.034296    0.039092    0.052903  ...  1001.481  0.060578           0
1     0.009916    0.011841    0.016435  ...  1001.170  0.060308           0
2     0.008759    0.012301    0.015963  ...  1001.259  0.061638           0
3     0.021210    0.019938    0.034467  ...  1001.472  0.035611           0
4     0.002974    0.002832    0.008383  ...  1001.278  0.065267           0
..         ...         ...         ...  ...       ...       ...         ...
95    0.029704    0.033820    0.041990  ...  1001.294 -0.010896           1
96    0.003397    0.002330    0.012610  ...  1001.033  0.098561           0
97    0.013743    0.007598    0.048241  ...  1001.172  0.020786           0
98    0.001954    0.001964    0.003908  ...  1001.148  0.090672           0
99    0.015922    0.017978    0.026674  ...  1001.150  0.043394           0

[100 rows x 504 columns]

Test accuracy: 0.64
Precision: 1.00, Recall: 0.32, F1-score: 0.49

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_7\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (GN-gearbox-acc)-IF_fdet_7 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_7\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_7 / test...

Total OK samples (from pred_label) : 83
---------- Samples in OK bins ----------
Bin 27 (-0.00002, 0.00442): 8 (1,001.309), 36 (1,001.065)
Bin 29 (0.00886, 0.01330): 60 (1,001.292)
Bin 30 (0.01330, 0.01774): 22 (1,001.080), 69 (1,001.198)
Bin 31 (0.01774, 0.02218): 68 (1,001.116), 97 (1,001.172)
Bin 32 (0.02218, 0.02662): 47 (1,001.366)
Bin 33 (0.02662, 0.03106): 5 (1,001.224)
Bin 34 (0.03106, 0.03550): 6 (1,001.313), 32 (1,001.436), 46 (1,001.183)
Bin 35 (0.03550, 0.03994): 3 (1,001.472), 65 (1,001.011), 74 (1,001.456)
Bin 36 (0.03994, 0.04438): 99 (1,001.150)
Bin 37 (0.04438, 0.04882): 53 (1,001.350)
Bin 38 (0.04882, 0.05326): 37 (1,001.418), 52 (1,001.247)
Bin 39 (0.05326, 0.05770): 9 (1,001.364), 16 (1,001.217)
Bin 40 (0.05770, 0.06214): 0 (1,001.481), 1 (1,001.170), 2 (1,001.259), 15 (1,001.055), 18 (1,001.153), 42 (1,001.473), 51 (1,001.331), 91 (1,001.443)
Bin 41 (0.06214, 0.06658): 4 (1,001.278), 17 (1,001.471), 20 (1,001.460), 55 (1,001.085), 70 (1,001.250)
Bin 42 (0.06658, 0.07102): 7 (1,001.189)
Bin 43 (0.07102, 0.07546): 84 (1,001.424)
Bin 44 (0.07546, 0.07989): 31 (1,001.203), 90 (1,001.087)
Bin 45 (0.07989, 0.08433): 44 (1,001.306)
Bin 46 (0.08433, 0.08877): 57 (1,001.253)
Bin 47 (0.08877, 0.09321): 10 (1,001.479), 12 (1,001.061), 19 (1,001.030), 27 (1,001.424), 30 (1,001.339), 41 (1,001.024), 43 (1,001.373), 62 (1,001.025), 64 (1,001.308), 71 (1,001.142), 72 (1,001.181), 75 (1,001.480), 98 (1,001.148)
Bin 48 (0.09321, 0.09765): 11 (1,001.190), 29 (1,001.062), 33 (1,001.110), 34 (1,001.461), 38 (1,001.380), 39 (1,001.459), 40 (1,001.367), 48 (1,001.428), 50 (1,001.314), 54 (1,001.020), 67 (1,001.464), 76 (1,001.080), 79 (1,001.439), 83 (1,001.084), 85 (1,001.236), 88 (1,001.052), 89 (1,001.415), 92 (1,001.297), 93 (1,001.365)
Bin 49 (0.09765, 0.10209): 13 (1,001.429), 14 (1,001.107), 28 (1,001.451), 35 (1,001.408), 45 (1,001.111), 77 (1,001.222), 78 (1,001.324), 82 (1,001.441), 94 (1,001.329), 96 (1,001.033)

Total NOK samples (from pred_label) : 17
---------- Samples in NOK bins ----------
Bin 0 (-0.11989, -0.11545): 56 (1,001.353)
Bin 6 (-0.09325, -0.08881): 63 (1,001.059)
Bin 7 (-0.08881, -0.08437): 24 (1,001.102), 49 (1,001.299)
Bin 10 (-0.07549, -0.07105): 59 (1,001.448), 87 (1,001.124)
Bin 13 (-0.06217, -0.05773): 86 (1,001.406)
Bin 16 (-0.04885, -0.04441): 73 (1,001.449)
Bin 18 (-0.03997, -0.03553): 80 (1,001.229)
Bin 19 (-0.03553, -0.03110): 23 (1,001.015), 58 (1,001.301)
Bin 20 (-0.03110, -0.02666): 25 (1,001.232)
Bin 22 (-0.02222, -0.01778): 81 (1,001.241)
Bin 23 (-0.01778, -0.01334): 26 (1,001.040), 66 (1,001.233)
Bin 24 (-0.01334, -0.00890): 95 (1,001.294)
Bin 26 (-0.00446, -0.00002): 21 (1,001.025)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_7\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_7 / test...

Total OK samples (from given_label) : 47
---------- Samples in OK bins ----------
Bin 44 (0.07546, 0.07989): 31 (1,001.203), 90 (1,001.087)
Bin 45 (0.07989, 0.08433): 44 (1,001.306)
Bin 46 (0.08433, 0.08877): 57 (1,001.253)
Bin 47 (0.08877, 0.09321): 10 (1,001.479), 12 (1,001.061), 19 (1,001.030), 27 (1,001.424), 30 (1,001.339), 41 (1,001.024), 43 (1,001.373), 62 (1,001.025), 64 (1,001.308), 71 (1,001.142), 72 (1,001.181), 75 (1,001.480), 98 (1,001.148)
Bin 48 (0.09321, 0.09765): 11 (1,001.190), 29 (1,001.062), 33 (1,001.110), 34 (1,001.461), 38 (1,001.380), 39 (1,001.459), 40 (1,001.367), 48 (1,001.428), 50 (1,001.314), 54 (1,001.020), 67 (1,001.464), 76 (1,001.080), 79 (1,001.439), 83 (1,001.084), 85 (1,001.236), 88 (1,001.052), 89 (1,001.415), 92 (1,001.297), 93 (1,001.365)
Bin 49 (0.09765, 0.10209): 13 (1,001.429), 14 (1,001.107), 28 (1,001.451), 35 (1,001.408), 45 (1,001.111), 77 (1,001.222), 78 (1,001.324), 82 (1,001.441), 94 (1,001.329), 96 (1,001.033)

Total NOK samples (from given_label) : 53
---------- Samples in NOK bins ----------
Bin 0 (-0.11989, -0.11545): 56 (1,001.353)
Bin 6 (-0.09325, -0.08881): 63 (1,001.059)
Bin 7 (-0.08881, -0.08437): 24 (1,001.102), 49 (1,001.299)
Bin 10 (-0.07549, -0.07105): 59 (1,001.448), 87 (1,001.124)
Bin 13 (-0.06217, -0.05773): 86 (1,001.406)
Bin 16 (-0.04885, -0.04441): 73 (1,001.449)
Bin 18 (-0.03997, -0.03553): 80 (1,001.229)
Bin 19 (-0.03553, -0.03110): 23 (1,001.015), 58 (1,001.301)
Bin 20 (-0.03110, -0.02666): 25 (1,001.232)
Bin 22 (-0.02222, -0.01778): 81 (1,001.241)
Bin 23 (-0.01778, -0.01334): 26 (1,001.040), 66 (1,001.233)
Bin 24 (-0.01334, -0.00890): 95 (1,001.294)
Bin 26 (-0.00446, -0.00002): 21 (1,001.025)
Bin 27 (-0.00002, 0.00442): 8 (1,001.309), 36 (1,001.065)
Bin 29 (0.00886, 0.01330): 60 (1,001.292)
Bin 30 (0.01330, 0.01774): 22 (1,001.080), 69 (1,001.198)
Bin 31 (0.01774, 0.02218): 68 (1,001.116), 97 (1,001.172)
Bin 32 (0.02218, 0.02662): 47 (1,001.366)
Bin 33 (0.02662, 0.03106): 5 (1,001.224)
Bin 34 (0.03106, 0.03550): 6 (1,001.313), 32 (1,001.436), 46 (1,001.183)
Bin 35 (0.03550, 0.03994): 3 (1,001.472), 65 (1,001.011), 74 (1,001.456)
Bin 36 (0.03994, 0.04438): 99 (1,001.150)
Bin 37 (0.04438, 0.04882): 53 (1,001.350)
Bin 38 (0.04882, 0.05326): 37 (1,001.418), 52 (1,001.247)
Bin 39 (0.05326, 0.05770): 9 (1,001.364), 16 (1,001.217)
Bin 40 (0.05770, 0.06214): 0 (1,001.481), 1 (1,001.170), 2 (1,001.259), 15 (1,001.055), 18 (1,001.153), 42 (1,001.473), 51 (1,001.331), 91 (1,001.443)
Bin 41 (0.06214, 0.06658): 4 (1,001.278), 17 (1,001.471), 20 (1,001.460), 55 (1,001.085), 70 (1,001.250)
Bin 42 (0.06658, 0.07102): 7 (1,001.189)
Bin 43 (0.07102, 0.07546): 84 (1,001.424)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_7\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (GN-gearbox-acc)-IF_fdet_7 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_7\test


===========================================================================

Fault detection model '(GN-gearbox-acc)-IF_fdet_7' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-28 23:39:35
