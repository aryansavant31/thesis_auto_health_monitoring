=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (GN-gearbox-acc)-IF_fdet_16
Start Time: 2025-08-28 23:39:02
End Time: 2025-08-28 23:39:37

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


ds_subtype selections:

(<ds_subtype_num>) <ds_subtype> : [<augments>]
---------------------------------------------
>> Healthy configs
(1) 0_N    : [OG]

>> Unhealthy configs
(1) 0_B-021    : [OG]

>> Unknown configs


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]

Node group name: gearbox
Signal group name: acc


For ds_type 'OK' and others....

Maximum timesteps across all node types: 243,938

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
---------------------------------------------
Total samples: 972 
Train: 720/777 [OK=357, NOK=363, UK=0], Test: 160/194 [OK=83, NOK=77, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=1, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 9
torch.Size([80, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 2
torch.Size([80, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 2000
Contamination: auto

---------------------------------------------------------------------------
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\beari
ng\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_
16.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_16

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> Raw data normalizer initialized with 'std' normalization

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Frequency data cannot be normalized before feature extraction, hence skipping raw data normalization.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Fitting anomaly detection model...

Model fitted successfully in 4.39 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0      0.013242    0.014435    0.030461  ...  1001.361  0.051008           0
1      0.001593    0.003565    0.011166  ...  1001.334  0.095069           0
2      0.003963    0.004915    0.005101  ...  1001.252  0.061867           0
3      0.015824    0.016347    0.031251  ...  1001.045  0.063656           0
4      0.008610    0.008515    0.016592  ...  1001.096  0.066726           0
..          ...         ...         ...  ...       ...       ...         ...
715    0.018147    0.020422    0.030067  ...  1001.064  0.058911           0
716    0.002837    0.005378    0.017888  ...  1001.001  0.062386           0
717    0.002623    0.002806    0.004754  ...  1001.265  0.099806           0
718    0.001432    0.002119    0.003799  ...  1001.374  0.099024           0
719    0.000247    0.001139    0.007880  ...  1001.365  0.092036           0

[720 rows x 504 columns]

Training accuracy: 0.60

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_16

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_16\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_16\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> Raw data normalizer initialized with 'std' normalization

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Frequency data cannot be normalized before feature extraction, hence skipping raw data normalization.

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0      0.013173    0.019639    0.034143  ...  1001.019  0.004414           0
1      0.001978    0.003626    0.009927  ...  1001.126  0.092422           0
2      0.005714    0.007119    0.009467  ...  1001.059  0.099845           0
3      0.008054    0.005169    0.037118  ...  1001.273 -0.062921           1
4      0.002738    0.003134    0.004946  ...  1001.134  0.098221           0
..          ...         ...         ...  ...       ...       ...         ...
155    0.004682    0.006962    0.009995  ...  1001.055  0.096269           0
156    0.002689    0.004511    0.011121  ...  1001.304  0.098613           0
157    0.005348    0.006350    0.008818  ...  1001.339  0.093492           0
158    0.000992    0.002282    0.008999  ...  1001.293  0.100005           0
159    0.013555    0.014120    0.021364  ...  1001.026  0.073845           0

[160 rows x 504 columns]

Test accuracy: 0.66
Precision: 1.00, Recall: 0.30, F1-score: 0.46

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_16\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (GN-gearbox-acc)-IF_fdet_16 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_16\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_16 / test...

Total OK samples (from pred_label) : 137
---------- Samples in OK bins ----------
Bin 27 (-0.00124, 0.00349): 47 (1,001.025), 71 (1,001.145), 86 (1,001.100)
Bin 28 (0.00349, 0.00821): 0 (1,001.019)
Bin 29 (0.00821, 0.01294): 31 (1,001.414)
Bin 30 (0.01294, 0.01766): 23 (1,001.245), 40 (1,001.240), 122 (1,001.030)
Bin 31 (0.01766, 0.02238): 140 (1,001.360)
Bin 33 (0.02711, 0.03183): 116 (1,001.366)
Bin 34 (0.03183, 0.03656): 56 (1,001.441), 69 (1,001.223), 79 (1,001.419), 148 (1,001.436), 152 (1,001.293)
Bin 35 (0.03656, 0.04128): 28 (1,001.261), 36 (1,001.317), 76 (1,001.456), 130 (1,001.256)
Bin 36 (0.04128, 0.04600): 50 (1,001.480), 52 (1,001.411), 64 (1,001.285), 90 (1,001.472), 133 (1,001.409), 135 (1,001.204), 153 (1,001.330)
Bin 37 (0.04600, 0.05073): 11 (1,001.163), 25 (1,001.302), 42 (1,001.159), 87 (1,001.345), 94 (1,001.169), 95 (1,001.214), 115 (1,001.336), 123 (1,001.203)
Bin 38 (0.05073, 0.05545): 13 (1,001.196), 78 (1,001.333), 101 (1,001.375), 108 (1,001.439)
Bin 39 (0.05545, 0.06018): 7 (1,001.121), 34 (1,001.193), 53 (1,001.458), 63 (1,001.390), 97 (1,001.312), 121 (1,001.404)
Bin 40 (0.06018, 0.06490): 41 (1,001.460), 61 (1,001.110), 66 (1,001.288), 104 (1,001.085), 142 (1,001.389)
Bin 41 (0.06490, 0.06963): 113 (1,001.179), 125 (1,001.094)
Bin 42 (0.06963, 0.07435): 51 (1,001.087), 68 (1,001.254), 159 (1,001.026)
Bin 45 (0.08380, 0.08852): 14 (1,001.179), 17 (1,001.027), 45 (1,001.085), 73 (1,001.331), 128 (1,001.049), 143 (1,001.400), 144 (1,001.450)
Bin 46 (0.08852, 0.09325): 1 (1,001.126), 10 (1,001.122), 35 (1,001.380), 46 (1,001.211), 62 (1,001.466), 65 (1,001.316), 67 (1,001.197), 72 (1,001.409), 75 (1,001.437), 77 (1,001.011), 82 (1,001.072), 107 (1,001.063), 119 (1,001.051), 126 (1,001.149), 129 (1,001.471), 132 (1,001.069), 134 (1,001.469), 139 (1,001.200), 147 (1,001.006), 149 (1,001.193), 154 (1,001.167)
Bin 47 (0.09325, 0.09797): 5 (1,001.198), 8 (1,001.433), 9 (1,001.346), 12 (1,001.071), 15 (1,001.188), 16 (1,001.426), 18 (1,001.359), 20 (1,001.056), 21 (1,001.423), 24 (1,001.480), 27 (1,001.040), 30 (1,001.234), 32 (1,001.361), 39 (1,001.464), 43 (1,001.246), 55 (1,001.353), 58 (1,001.042), 70 (1,001.415), 74 (1,001.448), 80 (1,001.148), 81 (1,001.401), 88 (1,001.335), 89 (1,001.219), 92 (1,001.128), 98 (1,001.329), 99 (1,001.089), 102 (1,001.047), 105 (1,001.154), 106 (1,001.170), 109 (1,001.002), 111 (1,001.470), 114 (1,001.145), 118 (1,001.291), 120 (1,001.014), 138 (1,001.037), 145 (1,001.447), 146 (1,001.124), 150 (1,001.390), 155 (1,001.055), 157 (1,001.339)
Bin 48 (0.09797, 0.10270): 2 (1,001.059), 4 (1,001.134), 19 (1,001.106), 22 (1,001.319), 26 (1,001.324), 93 (1,001.352), 100 (1,001.337), 110 (1,001.457), 112 (1,001.395), 124 (1,001.100), 136 (1,001.299), 141 (1,001.194), 156 (1,001.304), 158 (1,001.293)

Total NOK samples (from pred_label) : 23
---------- Samples in NOK bins ----------
Bin 0 (-0.12879, -0.12407): 91 (1,001.291)
Bin 1 (-0.12407, -0.11934): 103 (1,001.353)
Bin 5 (-0.10517, -0.10045): 29 (1,001.092)
Bin 6 (-0.10045, -0.09572): 33 (1,001.102)
Bin 7 (-0.09572, -0.09100): 151 (1,001.299)
Bin 8 (-0.09100, -0.08627): 85 (1,001.477)
Bin 13 (-0.06738, -0.06265): 3 (1,001.273), 57 (1,001.340), 131 (1,001.265)
Bin 14 (-0.06265, -0.05793): 60 (1,001.154)
Bin 16 (-0.05320, -0.04848): 83 (1,001.141), 137 (1,001.238)
Bin 18 (-0.04376, -0.03903): 37 (1,001.323)
Bin 19 (-0.03903, -0.03431): 38 (1,001.182)
Bin 20 (-0.03431, -0.02958): 48 (1,001.033)
Bin 22 (-0.02486, -0.02013): 44 (1,001.083)
Bin 24 (-0.01541, -0.01069): 127 (1,001.294)
Bin 25 (-0.01069, -0.00596): 96 (1,001.335)
Bin 26 (-0.00596, -0.00124): 49 (1,001.123), 54 (1,001.296), 59 (1,001.038), 84 (1,001.482)
Bin 27 (-0.00124, 0.00349): 117 (1,001.037)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_16\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_16 / test...

Total OK samples (from given_label) : 83
---------- Samples in OK bins ----------
Bin 45 (0.08380, 0.08852): 14 (1,001.179), 17 (1,001.027), 45 (1,001.085), 73 (1,001.331), 128 (1,001.049), 143 (1,001.400), 144 (1,001.450)
Bin 46 (0.08852, 0.09325): 1 (1,001.126), 10 (1,001.122), 35 (1,001.380), 46 (1,001.211), 62 (1,001.466), 65 (1,001.316), 67 (1,001.197), 72 (1,001.409), 75 (1,001.437), 77 (1,001.011), 82 (1,001.072), 107 (1,001.063), 119 (1,001.051), 126 (1,001.149), 129 (1,001.471), 132 (1,001.069), 134 (1,001.469), 139 (1,001.200), 147 (1,001.006), 149 (1,001.193), 154 (1,001.167)
Bin 47 (0.09325, 0.09797): 5 (1,001.198), 8 (1,001.433), 9 (1,001.346), 12 (1,001.071), 15 (1,001.188), 16 (1,001.426), 18 (1,001.359), 20 (1,001.056), 21 (1,001.423), 24 (1,001.480), 27 (1,001.040), 30 (1,001.234), 32 (1,001.361), 39 (1,001.464), 43 (1,001.246), 55 (1,001.353), 58 (1,001.042), 70 (1,001.415), 74 (1,001.448), 80 (1,001.148), 81 (1,001.401), 88 (1,001.335), 89 (1,001.219), 92 (1,001.128), 98 (1,001.329), 99 (1,001.089), 102 (1,001.047), 105 (1,001.154), 106 (1,001.170), 109 (1,001.002), 111 (1,001.470), 114 (1,001.145), 118 (1,001.291), 120 (1,001.014), 138 (1,001.037), 145 (1,001.447), 146 (1,001.124), 150 (1,001.390), 155 (1,001.055), 157 (1,001.339)
Bin 48 (0.09797, 0.10270): 2 (1,001.059), 4 (1,001.134), 19 (1,001.106), 22 (1,001.319), 26 (1,001.324), 93 (1,001.352), 100 (1,001.337), 110 (1,001.457), 112 (1,001.395), 124 (1,001.100), 136 (1,001.299), 141 (1,001.194), 156 (1,001.304), 158 (1,001.293)

Total NOK samples (from given_label) : 77
---------- Samples in NOK bins ----------
Bin 0 (-0.12879, -0.12407): 91 (1,001.291)
Bin 1 (-0.12407, -0.11934): 103 (1,001.353)
Bin 5 (-0.10517, -0.10045): 29 (1,001.092)
Bin 6 (-0.10045, -0.09572): 33 (1,001.102)
Bin 7 (-0.09572, -0.09100): 151 (1,001.299)
Bin 8 (-0.09100, -0.08627): 85 (1,001.477)
Bin 13 (-0.06738, -0.06265): 3 (1,001.273), 57 (1,001.340), 131 (1,001.265)
Bin 14 (-0.06265, -0.05793): 60 (1,001.154)
Bin 16 (-0.05320, -0.04848): 83 (1,001.141), 137 (1,001.238)
Bin 18 (-0.04376, -0.03903): 37 (1,001.323)
Bin 19 (-0.03903, -0.03431): 38 (1,001.182)
Bin 20 (-0.03431, -0.02958): 48 (1,001.033)
Bin 22 (-0.02486, -0.02013): 44 (1,001.083)
Bin 24 (-0.01541, -0.01069): 127 (1,001.294)
Bin 25 (-0.01069, -0.00596): 96 (1,001.335)
Bin 26 (-0.00596, -0.00124): 49 (1,001.123), 54 (1,001.296), 59 (1,001.038), 84 (1,001.482)
Bin 27 (-0.00124, 0.00349): 47 (1,001.025), 71 (1,001.145), 86 (1,001.100), 117 (1,001.037)
Bin 28 (0.00349, 0.00821): 0 (1,001.019)
Bin 29 (0.00821, 0.01294): 31 (1,001.414)
Bin 30 (0.01294, 0.01766): 23 (1,001.245), 40 (1,001.240), 122 (1,001.030)
Bin 31 (0.01766, 0.02238): 140 (1,001.360)
Bin 33 (0.02711, 0.03183): 116 (1,001.366)
Bin 34 (0.03183, 0.03656): 56 (1,001.441), 69 (1,001.223), 79 (1,001.419), 148 (1,001.436), 152 (1,001.293)
Bin 35 (0.03656, 0.04128): 28 (1,001.261), 36 (1,001.317), 76 (1,001.456), 130 (1,001.256)
Bin 36 (0.04128, 0.04600): 50 (1,001.480), 52 (1,001.411), 64 (1,001.285), 90 (1,001.472), 133 (1,001.409), 135 (1,001.204), 153 (1,001.330)
Bin 37 (0.04600, 0.05073): 11 (1,001.163), 25 (1,001.302), 42 (1,001.159), 87 (1,001.345), 94 (1,001.169), 95 (1,001.214), 115 (1,001.336), 123 (1,001.203)
Bin 38 (0.05073, 0.05545): 13 (1,001.196), 78 (1,001.333), 101 (1,001.375), 108 (1,001.439)
Bin 39 (0.05545, 0.06018): 7 (1,001.121), 34 (1,001.193), 53 (1,001.458), 63 (1,001.390), 97 (1,001.312), 121 (1,001.404)
Bin 40 (0.06018, 0.06490): 41 (1,001.460), 61 (1,001.110), 66 (1,001.288), 104 (1,001.085), 142 (1,001.389)
Bin 41 (0.06490, 0.06963): 113 (1,001.179), 125 (1,001.094)
Bin 42 (0.06963, 0.07435): 51 (1,001.087), 68 (1,001.254), 159 (1,001.026)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_16\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (GN-gearbox-acc)-IF_fdet_16 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_16\test


===========================================================================

Fault detection model '(GN-gearbox-acc)-IF_fdet_16' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-28 23:39:37
