=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (GN-gearbox-acc)-IF_fdet_11
Start Time: 2025-08-28 23:39:02
End Time: 2025-08-28 23:39:36

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


ds_subtype selections:

(<ds_subtype_num>) <ds_subtype> : [<augments>]
---------------------------------------------
>> Healthy configs
(1) 0_N    : [OG]

>> Unhealthy configs
(1) 0_B-021    : [OG]

>> Unknown configs


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]

Node group name: gearbox
Signal group name: acc


For ds_type 'OK' and others....

Maximum timesteps across all node types: 243,938

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
---------------------------------------------
Total samples: 972 
Train: 700/777 [OK=348, NOK=352, UK=0], Test: 100/194 [OK=50, NOK=50, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=1, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 7
torch.Size([100, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 1
torch.Size([100, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 2000
Contamination: auto

---------------------------------------------------------------------------
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\beari
ng\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_
11.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_11

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> No raw data normalization is applied

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Fitting anomaly detection model...

Model fitted successfully in 4.42 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0      0.003123    0.013048    0.057581  ...  1001.427 -0.107391           1
1      0.006417    0.006499    0.013151  ...  1001.227  0.101227           0
2      0.009694    0.012625    0.018209  ...  1001.206  0.023523           0
3      0.001085    0.002486    0.007377  ...  1001.483  0.085892           0
4      0.006598    0.007212    0.010893  ...  1001.175  0.040341           0
..          ...         ...         ...  ...       ...       ...         ...
695    0.001458    0.002226    0.023017  ...  1001.416 -0.072891           1
696    0.006032    0.003454    0.025251  ...  1001.420  0.055380           0
697    0.004447    0.006116    0.021057  ...  1001.248  0.004092           0
698    0.003192    0.004607    0.007840  ...  1001.104  0.096672           0
699    0.000991    0.000874    0.004918  ...  1001.013  0.063693           0

[700 rows x 504 columns]

Training accuracy: 0.61

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_11

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_11\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_11\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> No raw data normalization is applied

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Dataframe is as follows:
    comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0     0.007632    0.009413    0.011881  ...  1001.269  0.093566           0
1     0.019643    0.019335    0.040598  ...  1001.250  0.067245           0
2     0.029282    0.034638    0.051185  ...  1001.033 -0.033252           1
3     0.001031    0.000621    0.005160  ...  1001.216  0.096965           0
4     0.003432    0.003029    0.008585  ...  1001.159  0.095822           0
..         ...         ...         ...  ...       ...       ...         ...
95    0.020520    0.019028    0.037306  ...  1001.453  0.039165           0
96    0.001745    0.001564    0.004653  ...  1001.197  0.088178           0
97    0.013160    0.013299    0.026418  ...  1001.119  0.069404           0
98    0.003118    0.003452    0.006006  ...  1001.072  0.088503           0
99    0.003964    0.006157    0.011651  ...  1001.347  0.089235           0

[100 rows x 504 columns]

Test accuracy: 0.65
Precision: 1.00, Recall: 0.30, F1-score: 0.46

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_11\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (GN-gearbox-acc)-IF_fdet_11 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_11\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_11 / test...

Total OK samples (from pred_label) : 85
---------- Samples in OK bins ----------
Bin 29 (-0.00134, 0.00356): 81 (1,001.019)
Bin 31 (0.00846, 0.01335): 19 (1,001.187), 88 (1,001.245), 94 (1,001.292)
Bin 32 (0.01335, 0.01825): 25 (1,001.097)
Bin 33 (0.01825, 0.02315): 23 (1,001.392)
Bin 34 (0.02315, 0.02805): 7 (1,001.155), 17 (1,001.180), 62 (1,001.192)
Bin 36 (0.03295, 0.03785): 15 (1,001.256)
Bin 37 (0.03785, 0.04275): 5 (1,001.378), 95 (1,001.453)
Bin 38 (0.04275, 0.04765): 41 (1,001.053), 42 (1,001.108), 45 (1,001.068), 49 (1,001.302)
Bin 39 (0.04765, 0.05255): 65 (1,001.055), 79 (1,001.468)
Bin 40 (0.05255, 0.05745): 13 (1,001.303), 72 (1,001.104), 78 (1,001.412), 92 (1,001.331)
Bin 41 (0.05745, 0.06235): 10 (1,001.359), 24 (1,001.387), 32 (1,001.259), 36 (1,001.288), 50 (1,001.272), 55 (1,001.188)
Bin 42 (0.06235, 0.06725): 1 (1,001.250), 26 (1,001.035)
Bin 43 (0.06725, 0.07215): 14 (1,001.308), 31 (1,001.305), 40 (1,001.202), 97 (1,001.119)
Bin 44 (0.07215, 0.07705): 68 (1,001.135)
Bin 45 (0.07705, 0.08195): 48 (1,001.220)
Bin 46 (0.08195, 0.08685): 18 (1,001.443), 21 (1,001.399), 29 (1,001.176), 54 (1,001.118), 63 (1,001.018)
Bin 47 (0.08685, 0.09175): 6 (1,001.241), 22 (1,001.396), 37 (1,001.481), 58 (1,001.414), 60 (1,001.387), 64 (1,001.440), 69 (1,001.191), 77 (1,001.190), 80 (1,001.348), 91 (1,001.471), 93 (1,001.171), 96 (1,001.197), 98 (1,001.072), 99 (1,001.347)
Bin 48 (0.09175, 0.09665): 0 (1,001.269), 4 (1,001.159), 8 (1,001.014), 9 (1,001.245), 11 (1,001.359), 16 (1,001.129), 27 (1,001.080), 28 (1,001.423), 39 (1,001.428), 47 (1,001.424), 53 (1,001.023), 57 (1,001.345), 59 (1,001.433), 61 (1,001.361), 66 (1,001.260), 71 (1,001.470), 73 (1,001.259), 74 (1,001.212), 85 (1,001.455), 90 (1,001.198)
Bin 49 (0.09665, 0.10155): 3 (1,001.216), 12 (1,001.032), 20 (1,001.441), 33 (1,001.456), 44 (1,001.267), 46 (1,001.114), 56 (1,001.052), 83 (1,001.186), 87 (1,001.327)

Total NOK samples (from pred_label) : 15
---------- Samples in NOK bins ----------
Bin 0 (-0.14344, -0.13854): 76 (1,001.311)
Bin 2 (-0.13364, -0.12874): 30 (1,001.437), 35 (1,001.041)
Bin 8 (-0.10424, -0.09934): 89 (1,001.059)
Bin 10 (-0.09444, -0.08954): 43 (1,001.194)
Bin 11 (-0.08954, -0.08464): 75 (1,001.140)
Bin 14 (-0.07484, -0.06994): 82 (1,001.340)
Bin 16 (-0.06504, -0.06014): 38 (1,001.406)
Bin 18 (-0.05524, -0.05034): 67 (1,001.230)
Bin 21 (-0.04054, -0.03564): 52 (1,001.182)
Bin 22 (-0.03564, -0.03074): 2 (1,001.033)
Bin 23 (-0.03074, -0.02584): 34 (1,001.318), 84 (1,001.237)
Bin 26 (-0.01604, -0.01114): 51 (1,001.210)
Bin 28 (-0.00624, -0.00134): 70 (1,001.038)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_11\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_11 / test...

Total OK samples (from given_label) : 50
---------- Samples in OK bins ----------
Bin 45 (0.07705, 0.08195): 48 (1,001.220)
Bin 46 (0.08195, 0.08685): 18 (1,001.443), 21 (1,001.399), 29 (1,001.176), 54 (1,001.118), 63 (1,001.018)
Bin 47 (0.08685, 0.09175): 6 (1,001.241), 22 (1,001.396), 37 (1,001.481), 58 (1,001.414), 60 (1,001.387), 64 (1,001.440), 69 (1,001.191), 77 (1,001.190), 80 (1,001.348), 91 (1,001.471), 93 (1,001.171), 96 (1,001.197), 98 (1,001.072), 99 (1,001.347)
Bin 48 (0.09175, 0.09665): 0 (1,001.269), 4 (1,001.159), 8 (1,001.014), 9 (1,001.245), 11 (1,001.359), 16 (1,001.129), 27 (1,001.080), 28 (1,001.423), 39 (1,001.428), 47 (1,001.424), 53 (1,001.023), 57 (1,001.345), 59 (1,001.433), 61 (1,001.361), 66 (1,001.260), 71 (1,001.470), 73 (1,001.259), 74 (1,001.212), 85 (1,001.455), 90 (1,001.198)
Bin 49 (0.09665, 0.10155): 3 (1,001.216), 12 (1,001.032), 20 (1,001.441), 33 (1,001.456), 44 (1,001.267), 46 (1,001.114), 56 (1,001.052), 83 (1,001.186), 87 (1,001.327)

Total NOK samples (from given_label) : 50
---------- Samples in NOK bins ----------
Bin 0 (-0.14344, -0.13854): 76 (1,001.311)
Bin 2 (-0.13364, -0.12874): 30 (1,001.437), 35 (1,001.041)
Bin 8 (-0.10424, -0.09934): 89 (1,001.059)
Bin 10 (-0.09444, -0.08954): 43 (1,001.194)
Bin 11 (-0.08954, -0.08464): 75 (1,001.140)
Bin 14 (-0.07484, -0.06994): 82 (1,001.340)
Bin 16 (-0.06504, -0.06014): 38 (1,001.406)
Bin 18 (-0.05524, -0.05034): 67 (1,001.230)
Bin 21 (-0.04054, -0.03564): 52 (1,001.182)
Bin 22 (-0.03564, -0.03074): 2 (1,001.033)
Bin 23 (-0.03074, -0.02584): 34 (1,001.318), 84 (1,001.237)
Bin 26 (-0.01604, -0.01114): 51 (1,001.210)
Bin 28 (-0.00624, -0.00134): 70 (1,001.038)
Bin 29 (-0.00134, 0.00356): 81 (1,001.019)
Bin 31 (0.00846, 0.01335): 19 (1,001.187), 88 (1,001.245), 94 (1,001.292)
Bin 32 (0.01335, 0.01825): 25 (1,001.097)
Bin 33 (0.01825, 0.02315): 23 (1,001.392)
Bin 34 (0.02315, 0.02805): 7 (1,001.155), 17 (1,001.180), 62 (1,001.192)
Bin 36 (0.03295, 0.03785): 15 (1,001.256)
Bin 37 (0.03785, 0.04275): 5 (1,001.378), 95 (1,001.453)
Bin 38 (0.04275, 0.04765): 41 (1,001.053), 42 (1,001.108), 45 (1,001.068), 49 (1,001.302)
Bin 39 (0.04765, 0.05255): 65 (1,001.055), 79 (1,001.468)
Bin 40 (0.05255, 0.05745): 13 (1,001.303), 72 (1,001.104), 78 (1,001.412), 92 (1,001.331)
Bin 41 (0.05745, 0.06235): 10 (1,001.359), 24 (1,001.387), 32 (1,001.259), 36 (1,001.288), 50 (1,001.272), 55 (1,001.188)
Bin 42 (0.06235, 0.06725): 1 (1,001.250), 26 (1,001.035)
Bin 43 (0.06725, 0.07215): 14 (1,001.308), 31 (1,001.305), 40 (1,001.202), 97 (1,001.119)
Bin 44 (0.07215, 0.07705): 68 (1,001.135)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_11\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (GN-gearbox-acc)-IF_fdet_11 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\set_GN\IF\swp_2\(GN-gearbox-acc)-IF_fdet_11\test


===========================================================================

Fault detection model '(GN-gearbox-acc)-IF_fdet_11' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-28 23:39:36
