=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (GN-gearbox-acc)-IF_fdet_3
Start Time: 2025-08-28 23:30:57
End Time: 2025-08-28 23:31:15

CPU: Intel64 Family 6 Model 154 Stepping 3, GenuineIntel (Cores: 20), Max Frequency: 2300.00 MHz
GPUs Detected: 1
GPU 0: NVIDIA GeForce RTX 3050 Ti Laptop GPU, Memory: 4.00 GB
OS: Windows 11 (10.0.26100)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


ds_subtype selections:

(<ds_subtype_num>) <ds_subtype> : [<augments>]
---------------------------------------------
>> Healthy configs
(1) 0_N    : [OG]

>> Unhealthy configs
(1) 0_B-021    : [OG]

>> Unknown configs


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) gearbox   : [acc]

Node group name: gearbox
Signal group name: acc


For ds_type 'OK' and others....

Maximum timesteps across all node types: 243,938

No 'fs_matrix' recieved from the data. Hence, using the currently set 'fs' in data_config. Current fs:
[[48000]]

No exclusive rep numbers found in keys of hfd5 file. Hence, using default rep numbers.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
---------------------------------------------
Total samples: 972 
Train: 700/777 [OK=362, NOK=338, UK=0], Test: 100/194 [OK=44, NOK=56, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK=0, NOK=1, UK=0]

train_data_loader statistics:
Number of batches: 7
torch.Size([100, 1, 1000, 1])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 1
torch.Size([100, 1, 1000, 1]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 200
Contamination: auto

---------------------------------------------------------------------------
Model parameters saved to 
C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs
\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc
)-IF_fdet_3.

Training environment set. Training will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_3

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> No raw data normalization is applied

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Fitting anomaly detection model...

Model fitted successfully in 0.40 seconds

Dataframe is as follows:
     comp0_dim0  comp1_dim0  ...    scores  pred_label
0      0.015016    0.018079  ... -0.147608           1
1      0.004447    0.006116  ...  0.009866           0
2      0.009669    0.014317  ...  0.047060           0
3      0.000476    0.000384  ...  0.089332           0
4      0.004554    0.004435  ...  0.101883           0
..          ...         ...  ...       ...         ...
695    0.009586    0.012979  ...  0.052599           0
696    0.001613    0.000775  ...  0.101051           0
697    0.014373    0.016149  ...  0.078915           0
698    0.001473    0.000982  ...  0.112298           0
699    0.000247    0.001139  ...  0.104635           0

[700 rows x 504 columns]

Training accuracy: 0.62

Training hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_3

Model saved at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_3\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_3\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: freq(cutoff_freq=100)

>> No raw data normalization is applied

>> No feature normalization is applied

>> No frequency feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp1_dim0, comp2_dim0, comp3_dim0...comp496_dim0, comp497_dim0, comp498_dim0, comp499_dim0]

Dataframe is as follows:
    comp0_dim0  comp1_dim0  comp2_dim0  ...   rep_num    scores  pred_label
0     0.009209    0.014870    0.037106  ...  1001.015 -0.031169           1
1     0.002836    0.003734    0.006119  ...  1001.192  0.097425           0
2     0.008073    0.009230    0.012132  ...  1001.021  0.064432           0
3     0.022259    0.023208    0.036422  ...  1001.101  0.061547           0
4     0.018601    0.022743    0.031669  ...  1001.380  0.040286           0
..         ...         ...         ...  ...       ...       ...         ...
95    0.007924    0.011269    0.020420  ...  1001.443  0.065541           0
96    0.004420    0.004101    0.009800  ...  1001.105  0.111377           0
97    0.004480    0.004708    0.007384  ...  1001.262  0.093175           0
98    0.010931    0.018105    0.032705  ...  1001.478  0.043867           0
99    0.004228    0.007167    0.005957  ...  1001.486  0.039633           0

[100 rows x 504 columns]

Test accuracy: 0.57
Precision: 1.00, Recall: 0.23, F1-score: 0.38

Testing hyperparameters logged for tensorboard at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_3\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (GN-gearbox-acc)-IF_fdet_3 / test...

Confusion matrix logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_3\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_3 / test...

Total OK samples (from pred_label) : 87
---------- Samples in OK bins ----------
Bin 22 (-0.00135, 0.00283): 27 (1,001.145)
Bin 26 (0.01536, 0.01954): 92 (1,001.342)
Bin 27 (0.01954, 0.02372): 6 (1,001.221), 38 (1,001.184), 45 (1,001.180), 46 (1,001.054)
Bin 28 (0.02372, 0.02790): 29 (1,001.192)
Bin 29 (0.02790, 0.03208): 40 (1,001.413)
Bin 30 (0.03208, 0.03625): 15 (1,001.067), 80 (1,001.411), 82 (1,001.200)
Bin 31 (0.03625, 0.04043): 4 (1,001.380), 34 (1,001.195), 49 (1,001.172), 99 (1,001.486)
Bin 32 (0.04043, 0.04461): 24 (1,001.314), 54 (1,001.120), 98 (1,001.478)
Bin 34 (0.04879, 0.05297): 11 (1,001.185), 59 (1,001.115), 60 (1,001.328), 62 (1,001.137), 78 (1,001.098), 85 (1,001.168)
Bin 35 (0.05297, 0.05715): 22 (1,001.162), 25 (1,001.285), 26 (1,001.271), 35 (1,001.130), 47 (1,001.173), 48 (1,001.473)
Bin 36 (0.05715, 0.06133): 7 (1,001.160), 36 (1,001.382), 69 (1,001.028), 70 (1,001.393)
Bin 37 (0.06133, 0.06550): 2 (1,001.021), 3 (1,001.101), 63 (1,001.377), 88 (1,001.303)
Bin 38 (0.06550, 0.06968): 30 (1,001.212), 77 (1,001.105), 95 (1,001.443)
Bin 40 (0.07386, 0.07804): 31 (1,001.325), 43 (1,001.471)
Bin 43 (0.08640, 0.09057): 8 (1,001.354)
Bin 44 (0.09057, 0.09475): 9 (1,001.290), 12 (1,001.422), 28 (1,001.421), 53 (1,001.162), 68 (1,001.055), 84 (1,001.355), 87 (1,001.079), 90 (1,001.344), 94 (1,001.096), 97 (1,001.262)
Bin 45 (0.09475, 0.09893): 1 (1,001.192), 10 (1,001.357), 13 (1,001.075), 17 (1,001.443), 21 (1,001.333), 51 (1,001.461), 73 (1,001.346), 76 (1,001.065), 79 (1,001.156), 91 (1,001.073), 93 (1,001.462)
Bin 46 (0.09893, 0.10311): 18 (1,001.294), 20 (1,001.336), 23 (1,001.214), 39 (1,001.287), 41 (1,001.128), 55 (1,001.374), 58 (1,001.078), 61 (1,001.385), 66 (1,001.094), 74 (1,001.149), 75 (1,001.153)
Bin 47 (0.10311, 0.10729): 32 (1,001.460), 37 (1,001.194), 42 (1,001.134), 44 (1,001.340), 56 (1,001.174), 71 (1,001.092), 72 (1,001.417), 89 (1,001.140)
Bin 48 (0.10729, 0.11147): 83 (1,001.410), 96 (1,001.105)

Total NOK samples (from pred_label) : 13
---------- Samples in NOK bins ----------
Bin 0 (-0.09328, -0.08910): 57 (1,001.140), 86 (1,001.235)
Bin 1 (-0.08910, -0.08492): 52 (1,001.440)
Bin 9 (-0.05567, -0.05149): 50 (1,001.394)
Bin 10 (-0.05149, -0.04731): 64 (1,001.340)
Bin 12 (-0.04314, -0.03896): 67 (1,001.229)
Bin 14 (-0.03478, -0.03060): 0 (1,001.015)
Bin 15 (-0.03060, -0.02642): 81 (1,001.236)
Bin 17 (-0.02224, -0.01806): 19 (1,001.408)
Bin 18 (-0.01806, -0.01389): 14 (1,001.438), 33 (1,001.233)
Bin 19 (-0.01389, -0.00971): 65 (1,001.395)
Bin 21 (-0.00553, -0.00135): 5 (1,001.037)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_3\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (GN-gearbox-acc)-IF_fdet_3 / test...

Total OK samples (from given_label) : 44
---------- Samples in OK bins ----------
Bin 43 (0.08640, 0.09057): 8 (1,001.354)
Bin 44 (0.09057, 0.09475): 9 (1,001.290), 12 (1,001.422), 28 (1,001.421), 53 (1,001.162), 68 (1,001.055), 84 (1,001.355), 87 (1,001.079), 90 (1,001.344), 94 (1,001.096), 97 (1,001.262)
Bin 45 (0.09475, 0.09893): 1 (1,001.192), 10 (1,001.357), 13 (1,001.075), 17 (1,001.443), 21 (1,001.333), 51 (1,001.461), 73 (1,001.346), 76 (1,001.065), 79 (1,001.156), 91 (1,001.073), 93 (1,001.462)
Bin 46 (0.09893, 0.10311): 18 (1,001.294), 20 (1,001.336), 23 (1,001.214), 39 (1,001.287), 41 (1,001.128), 55 (1,001.374), 58 (1,001.078), 61 (1,001.385), 66 (1,001.094), 74 (1,001.149), 75 (1,001.153)
Bin 47 (0.10311, 0.10729): 32 (1,001.460), 37 (1,001.194), 42 (1,001.134), 44 (1,001.340), 56 (1,001.174), 71 (1,001.092), 72 (1,001.417), 89 (1,001.140)
Bin 48 (0.10729, 0.11147): 83 (1,001.410), 96 (1,001.105)

Total NOK samples (from given_label) : 56
---------- Samples in NOK bins ----------
Bin 0 (-0.09328, -0.08910): 57 (1,001.140), 86 (1,001.235)
Bin 1 (-0.08910, -0.08492): 52 (1,001.440)
Bin 9 (-0.05567, -0.05149): 50 (1,001.394)
Bin 10 (-0.05149, -0.04731): 64 (1,001.340)
Bin 12 (-0.04314, -0.03896): 67 (1,001.229)
Bin 14 (-0.03478, -0.03060): 0 (1,001.015)
Bin 15 (-0.03060, -0.02642): 81 (1,001.236)
Bin 17 (-0.02224, -0.01806): 19 (1,001.408)
Bin 18 (-0.01806, -0.01389): 14 (1,001.438), 33 (1,001.233)
Bin 19 (-0.01389, -0.00971): 65 (1,001.395)
Bin 21 (-0.00553, -0.00135): 5 (1,001.037)
Bin 22 (-0.00135, 0.00283): 27 (1,001.145)
Bin 26 (0.01536, 0.01954): 92 (1,001.342)
Bin 27 (0.01954, 0.02372): 6 (1,001.221), 38 (1,001.184), 45 (1,001.180), 46 (1,001.054)
Bin 28 (0.02372, 0.02790): 29 (1,001.192)
Bin 29 (0.02790, 0.03208): 40 (1,001.413)
Bin 30 (0.03208, 0.03625): 15 (1,001.067), 80 (1,001.411), 82 (1,001.200)
Bin 31 (0.03625, 0.04043): 4 (1,001.380), 34 (1,001.195), 49 (1,001.172), 99 (1,001.486)
Bin 32 (0.04043, 0.04461): 24 (1,001.314), 54 (1,001.120), 98 (1,001.478)
Bin 34 (0.04879, 0.05297): 11 (1,001.185), 59 (1,001.115), 60 (1,001.328), 62 (1,001.137), 78 (1,001.098), 85 (1,001.168)
Bin 35 (0.05297, 0.05715): 22 (1,001.162), 25 (1,001.285), 26 (1,001.271), 35 (1,001.130), 47 (1,001.173), 48 (1,001.473)
Bin 36 (0.05715, 0.06133): 7 (1,001.160), 36 (1,001.382), 69 (1,001.028), 70 (1,001.393)
Bin 37 (0.06133, 0.06550): 2 (1,001.021), 3 (1,001.101), 63 (1,001.377), 88 (1,001.303)
Bin 38 (0.06550, 0.06968): 30 (1,001.212), 77 (1,001.105), 95 (1,001.443)
Bin 40 (0.07386, 0.07804): 31 (1,001.325), 43 (1,001.471)

Anomaly score distribution plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_3\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (GN-gearbox-acc)-IF_fdet_3 / test...

Pair plot logged at C:\Aryan_Savant\Thesis_Projects\my_work\AFD_thesis\fault_detection\logs\bearing\cwru\scene_1\train\(gearbox)\acc\s=GN\IF\swp_1\(GN-gearbox-acc)-IF_fdet_3\test


===========================================================================

Fault detection model '(GN-gearbox-acc)-IF_fdet_3' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-28 23:31:15
