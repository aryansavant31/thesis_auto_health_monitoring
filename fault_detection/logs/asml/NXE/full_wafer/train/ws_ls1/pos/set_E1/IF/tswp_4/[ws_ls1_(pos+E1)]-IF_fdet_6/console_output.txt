=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: [ws_ls1_(pos+E1)]-IF_fdet_6
Start Time: 2025-10-30 10:54:28
End Time: 2025-10-30 10:57:40

CPU: Intel64 Family 6 Model 79 Stepping 1, GenuineIntel (Cores: 12), Max Frequency: 2594.00 MHz
GPU: None detected
OS: Windows 10 (10.0.19045)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


Dataset selections:
---------------------------------------------
*_(<ds_subtype_num>) <ds_subtype> : [<augments>]_*

- **Healthy configs**
  (1) E1_set01_M=mAI26    : [OG]
  (2) E1_set01_M=mAQ10    : [OG]
  (3) E1_set01_M=mAQ87    : [OG]
  (4) E1_set01_M=mAS23    : [OG]
  (5) E1_set01_M=mAU64    : [OG]
  (6) E1_set01_M=mBF18    : [OG]
  (7) E1_set01_M=mBF38    : [OG]
  (8) E1_set01_M=mBF92    : [OG]
  (9) E1_set01_M=mBH22    : [OG]
  (10) E1_set01_M=mBI93    : [OG]
  (11) E1_set01_M=mBJ96    : [OG]
  (12) E1_set01_M=mBK70    : [OG]
  (13) E1_set01_M=mBN34    : [OG]
  (14) E1_set01_M=mBP09    : [OG]
  (15) E1_set01_M=mBP98    : [OG]
  (16) E1_set01_M=mBS36    : [OG]
  (17) E1_set01_M=mBS45    : [OG]
  (18) E1_set01_M=mBU17    : [OG]
  (19) E1_set01_M=mBW64    : [OG]
  (20) E1_set01_M=mBY13    : [OG]
  (21) E1_set01_M=mBY93    : [OG]
  (22) E1_set01_M=mCD86    : [OG]
  (23) E1_set01_M=mCF56    : [OG]
  (24) E1_set01_M=mCF78    : [OG]
  (25) E1_set01_M=mCF96    : [OG]

- **Unhealthy configs**
  (26) (sim)_E1_set01_M=mAI26    : [glitch(prob=0.07, std_fac=2, add_next=True), sine(freqs=[3, 2], std_facs=[1.8, 2], add_next=False)]
  (27) (sim)_E1_set01_M=mAQ10    : [glitch(prob=0.08, std_fac=1.8, add_next=True), sine(freqs=[2, 4], std_facs=[1.8, 1.5], add_next=False)]
  (28) (sim)_E1_set01_M=mAQ87    : [glitch(prob=0.09, std_fac=2.2, add_next=True), sine(freqs=[2, 4, 5], std_facs=[2, 1.8, 1.5], add_next=False)]
  (29) (sim)_E1_set01_M=mAS23    : [glitch(prob=0.03, std_fac=1.9, add_next=True), sine(freqs=[1, 2, 3], std_facs=[1.7, 1.9, 2], add_next=False)]
  (30) (sim)_E1_set01_M=mBF92    : [glitch(prob=0.02, std_fac=1.5, add_next=True), sine(freqs=[1, 2, 4], std_facs=[1.8, 2, 1.9], add_next=False)]
  (31) (sim)_E1_set01_M=mBH22    : [glitch(prob=0.05, std_fac=1.9, add_next=True), sine(freqs=[1, 3, 5, 7], std_facs=[1.6, 2.1, 1.8, 1.9], add_next=False)]
  (32) (sim)_E1_set01_M=mBI93    : [glitch(prob=0.07, std_fac=2, add_next=True), sine(freqs=[3, 2], std_facs=[1.8, 2], add_next=False)]
  (33) (sim)_E1_set01_M=mBJ96    : [glitch(prob=0.08, std_fac=1.8, add_next=True), sine(freqs=[2, 4], std_facs=[1.8, 1.5], add_next=False)]

- **Unknown configs**


Node and signal types:
---------------------------------------------
*_(<node_num>) <node_type> : [<signal_types>]_*

  (1) ws_ls1   : [pos_x, pos_y]

Node group name: ws_ls1
Signal group name: pos


For ds_type 'OK' and others....
---------------------------------------------
Maximum timesteps across all node types: 32,768

No data interpolation applied.

No timesteps chopped off from the data.

'fs' is updated in data_config as given in loaded healthy (or unknown) data.
New fs:
[[20000., 20000.]]

Exclusive rep numbers found in keys of hdf5 file. Hence, using them as rep numbers.

For ds_type 'NOK' and others....
---------------------------------------------
Maximum timesteps across all node types: 32,768

No data interpolation applied.

No timesteps chopped off from the data.

'fs' is updated in data_config as given in loaded healthy (or unknown) data.
New fs:
[[20000., 20000.]]

Exclusive rep numbers found in keys of hdf5 file. Hence, using them as rep numbers.

Target rep_num 1001.0001 found at index 0. This sample will be included in the test set.


Total units: 33

[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
------------------------------------------------------------
Total samples: 1580 
Train: 1106/1106 [OK=849, NOK=257, UK=0], Test: 158/158 [OK=118, NOK=40, UK=0], Val: 315/316 [OK=228, NOK=87, UK=0],
Remainder: 0 [OK=0, NOK=0, UK=0]

train_data_loader statistics:
Number of batches: 1106
torch.Size([1, 1, 8000, 2])  => (batch_size, n_nodes, n_timesteps, n_dims)

test_data_loader statistics:
Number of batches: 158
torch.Size([1, 1, 8000, 2]) 

val_data_loader statistics:
Number of batches: 315
torch.Size([1, 1, 8000, 2]) 

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 2000
Contamination: 1e-15

---------------------------------------------------------------------------

Initializing feature selector for anomaly detection model...

>> Feature selector initialized with LDA

Starting feature selection...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time+freq(cutoff_freq=0)

>> No raw data normalization is applied

>> Feature normalizer initialized with 'std' normalization

>> Time feature extractor initialized with features: first_n_modes(n_modes=3)

>> Frequency feature extractor initialized with features: first_n_modes(n_modes=3)

>> No feature reduction is applied

---------------------------------------------------------------------------

Top 6 consensus features selected: ['impulse_factor', 'mean_abs', 'sq_root_abs', 'std_deviation_index', 'normalized_std', 'crest_factor']
Feature selection completed. Updated the fault detector model to use selected features

---------------------------------------------------------------------------
Unknown time feature extraction type: first_n_modes. Skipping...
Unknown frequency feature name in ranks: impulse_factor. Skipping...
Unknown frequency feature name in ranks: mean_abs. Skipping...
Unknown frequency feature name in ranks: sq_root_abs. Skipping...
Unknown frequency feature name in ranks: std_deviation_index. Skipping...
Unknown frequency feature name in ranks: normalized_std. Skipping...
Unknown frequency feature name in ranks: crest_factor. Skipping...
'Version 1' already exists in the log path 'C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_1\[ws_ls1_(pos+E1)]-IF_fdet_1'.
(a) Overwrite exsiting version, (b) create new version, (c) stop training (Choose 'a', 'b' or 'c'):  Next model number folder will be: [ws_ls1_(pos+E1)]-IF_fdet_6
Model parameters saved to C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6.

Training environment set. Training will be logged at: C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6

---------------------------------------------------------------------------

Feature ranking plot with variance logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6


Feature ranking plot with mean score logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6


Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time+freq(cutoff_freq=0)

>> No raw data normalization is applied

>> Feature normalizer loaded with 'std' normalization

>> Time feature extractor initialized with features: first_n_modes(n_modes=3), from_ranks(feat_list=['impulse_factor', 'mean_abs', 'sq_root_abs', 'std_deviation_index', 'normalized_std', 'crest_factor'])

>> Frequency feature extractor initialized with features: first_n_modes(n_modes=3), from_ranks(feat_list=['impulse_factor', 'mean_abs', 'sq_root_abs', 'std_deviation_index', 'normalized_std', 'crest_factor'])

>> No feature reduction is applied

---------------------------------------------------------------------------
Unknown time feature extraction type: first_n_modes. Skipping...
Unknown frequency feature name in ranks: impulse_factor. Skipping...
Unknown frequency feature name in ranks: mean_abs. Skipping...
Unknown frequency feature name in ranks: sq_root_abs. Skipping...
Unknown frequency feature name in ranks: std_deviation_index. Skipping...
Unknown frequency feature name in ranks: normalized_std. Skipping...
Unknown frequency feature name in ranks: crest_factor. Skipping...

Feature names: ['freq1_0', 'freq1_1', 'freq2_0', 'freq2_1', 'freq3_0', 'freq3_1', 'mode1_0', 'mode1_1', 'mode2_0', 'mode2_1', 'mode3_0', 'mode3_1', 'impulse_factor_0', 'impulse_factor_1', 'mean_abs_0', 'mean_abs_1', 'sq_root_abs_0', 'sq_root_abs_1', 'std_deviation_index_0', 'std_deviation_index_1', 'normalized_std_0', 'normalized_std_1', 'crest_factor_0', 'crest_factor_1']

Fitting anomaly detection model...

Model fitted successfully in 6.71 seconds

Tuning contamination parameter using validation data...
Unknown time feature extraction type: first_n_modes. Skipping...
Unknown frequency feature name in ranks: impulse_factor. Skipping...
Unknown frequency feature name in ranks: mean_abs. Skipping...
Unknown frequency feature name in ranks: sq_root_abs. Skipping...
Unknown frequency feature name in ranks: std_deviation_index. Skipping...
Unknown frequency feature name in ranks: normalized_std. Skipping...
Unknown frequency feature name in ranks: crest_factor. Skipping...

Feature names: ['freq1_0', 'freq1_1', 'freq2_0', 'freq2_1', 'freq3_0', 'freq3_1', 'mode1_0', 'mode1_1', 'mode2_0', 'mode2_1', 'mode3_0', 'mode3_1', 'impulse_factor_0', 'impulse_factor_1', 'mean_abs_0', 'mean_abs_1', 'sq_root_abs_0', 'sq_root_abs_1', 'std_deviation_index_0', 'std_deviation_index_1', 'normalized_std_0', 'normalized_std_1', 'crest_factor_0', 'crest_factor_1']

Best threshold: 0.5991 with db_ok: 0.1025
Validation Precision: 1.0000, Recall: 1.0000, F1-Score: 1.0000

Training inference completed in 0.43 seconds

Training accuracy (for hard predictions): 0.40

OK upper bound (at 100.0 percentile): 0.5966

Dataframe is as follows:
   machine_num                                            rep_num  pred_label  final_pred_label    scores  given_label   nok_pct  n_samples
0          013  [1013.0001, 4013.0002, 11013.0004, 3013.0003, ...          -1              -0.5  0.491568          1.0  0.054054         37
1          012  [8012.0004, 6012.0001, 12012.0003, 9012.0004, ...           1               1.0  0.497096          1.0  0.000000         31
2          017  [9017.0003, 7017.0003, 8017.0002, 3017.0003, 1...          -1              -0.5  0.486938          1.0  0.027027         37
3          001  [7001.0002, 3001.0003, 10001.0002, 12001.0003,...           1               1.0  0.482618          1.0  0.000000         35
4          009  [5009.0004, 1009.0004, 3009.0001, 1009.0003, 1...          -1              -0.5  0.485812          1.0  0.027778         36
5          021  [12021.0003, 8021.0002, 5021.0001, 8021.0001, ...          -1              -0.5  0.497943          1.0  0.054054         37
6          019  [8019.0002, 3019.0002, 5019.0004, 10019.0004, ...           1               1.0  0.481866          1.0  0.000000         35
7          015  [8015.0003, 6015.0004, 4015.0004, 2015.0003, 1...          -1              -0.5  0.482051          1.0  0.057143         35
8          003  [2003.0002, 5003.0001, 8003.0004, 10003.0002, ...           1               1.0  0.483236          1.0  0.000000         28
9          010  [1010.0004, 11010.0004, 6010.0004, 4010.0002, ...           1               1.0  0.470366          1.0  0.000000         27
10         023  [11023.0001, 7023.0001, 11023.0004, 4023.0001,...           1               1.0  0.489846          1.0  0.000000         38
11         007  [1007.0002, 11007.0003, 10007.0003, 9007.0003,...           1               1.0  0.479788          1.0  0.000000         32
12         004  [8004.0002, 11004.0002, 5004.0001, 10004.0004,...           1               1.0  0.486104          1.0  0.000000         35
13         002  [10002.0004, 6002.0002, 6002.0003, 1002.0001, ...          -1              -0.5  0.483683          1.0  0.031250         32
14         014  [3014.0002, 8014.0001, 10014.0004, 5014.0001, ...          -1              -0.5  0.526049          1.0  0.090909         33
15         018  [1018.0002, 9018.0004, 7018.0001, 4018.0003, 1...          -1              -0.5  0.487027          1.0  0.027778         36
16         020  [11020.0002, 11020.0003, 4020.0002, 8020.0003,...          -1              -0.5  0.485874          1.0  0.029412         34
17         022  [1022.0004, 4022.0002, 4022.0004, 10022.0004, ...          -1              -0.5  0.490349          1.0  0.026316         38
18         025  [8025.0004, 3025.0004, 7025.0004, 11025.0001, ...          -1              -0.5  0.495808          1.0  0.054054         37
19         008  [9008.0002, 2008.0004, 11008.0004, 11008.0002,...          -1              -0.5  0.490083          1.0  0.025641         39
20         006  [7006.0001, 2006.0001, 4006.0002, 1006.0003, 8...          -1              -0.5  0.485592          1.0  0.028571         35
21         016  [12016.0004, 1016.0003, 5016.0001, 5016.0004, ...          -1              -0.5  0.485160          1.0  0.029412         34
22         005  [6005.0004, 7005.0001, 3005.0001, 5005.0001, 4...           1               1.0  0.496348          1.0  0.000000         28
23         011  [1011.0004, 2011.0003, 12011.0002, 10011.0001,...          -1              -0.5  0.481324          1.0  0.031250         32
24         024  [6024.0004, 5024.0001, 7024.0002, 8024.0002, 9...           1               1.0  0.488311          1.0  0.000000         28

Training hyperparameters logged for tensorboard at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6

Model saved at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6\fault_detector.pkl

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [ws_ls1_(pos+E1)]-IF_fdet_6 / train...

Confusion matrix logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6


<<<<<<<<<<<< CONFUSION MATRIX ADVANCE >>>>>>>>>>>>

> Creating confusion matrix (hard/soft) for [ws_ls1_(pos+E1)]-IF_fdet_6 / train...

Confusion matrix (hard/soft) logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION ADVANCE 1 (GIVEN vs PRED) >>>>>>>>>>>>

(Using '100%' OK of train

Creating anomaly score distribution plot for [ws_ls1_(pos+E1)]-IF_fdet_6 / train...
## Bin details for Anomaly Score Distribution Advance 1 (100% OK of train) 
-------------------------
### Total True Negative Hard (OK, correct) samples: 317
---------- Samples in True Negative Hard (OK, correct) bins ----------
- **Bin 20 (0.40000, 0.42000) [dark green]**: 82 (12,019.0001), 153 (12,010.0001), 197 (12,023.0001), 218 (12,007.0001), 288 (12,005.0001), 323 (12,024.0001)
- **Bin 21 (0.42000, 0.44000) [dark green]**: 3 (6,012.0001), 7 (9,012.0002), 24 (3,012.0003), 35 (3,001.0003), 43 (9,001.0002), 62 (11,001.0003), 65 (6,001.0002), 78 (9,019.0002), 83 (6,019.0001), 93 (4,019.0004), 95 (3,019.0003), 98 (11,019.0003), 118 (11,003.0003), 120 (6,003.0001), 123 (9,003.0002), 131 (3,003.0003), 141 (3,010.0003), 146 (11,010.0003), 147 (6,010.0002), 149 (3,010.0001), 151 (9,010.0002), 160 (4,010.0004), 179 (4,023.0004), 189 (3,023.0003), 193 (9,023.0002), 194 (6,023.0002), 198 (6,023.0001), 203 (11,007.0003), 209 (3,007.0003), 211 (6,007.0001), 214 (9,007.0002), 221 (3,007.0001), 230 (6,007.0002), 232 (4,007.0004), 241 (12,004.0001), 242 (4,004.0004), 243 (3,004.0001), 245 (3,004.0003), 249 (9,004.0002), 253 (11,004.0003), 283 (3,005.0001), 292 (11,005.0003), 307 (6,005.0001), 314 (9,024.0002), 316 (11,024.0003), 319 (3,024.0003), 325 (6,024.0001), 327 (6,024.0002), 337 (4,024.0004)
- **Bin 22 (0.44000, 0.46000) [dark green]**: 8 (10,012.0002), 9 (12,012.0002), 23 (3,012.0001), 30 (8,012.0001), 31 (7,012.0003), 38 (12,001.0002), 44 (7,001.0003), 46 (10,001.0004), 47 (5,001.0004), 54 (1,001.0004), 58 (4,001.0002), 63 (8,001.0001), 74 (5,019.0004), 75 (10,019.0004), 89 (4,019.0002), 91 (1,019.0004), 94 (7,019.0003), 97 (8,019.0001), 104 (1,019.0003), 111 (8,003.0004), 112 (10,003.0002), 113 (1,003.0004), 121 (1,003.0003), 126 (10,003.0004), 130 (7,003.0003), 134 (4,003.0002), 135 (8,003.0001), 137 (1,010.0004), 140 (4,010.0002), 142 (8,010.0004), 144 (8,010.0001), 155 (10,010.0004), 162 (5,010.0004), 169 (8,023.0004), 177 (8,023.0001), 182 (10,023.0002), 191 (7,023.0003), 195 (12,023.0002), 199 (1,023.0004), 201 (4,023.0002), 206 (8,007.0001), 208 (1,007.0004), 210 (5,007.0004), 213 (10,007.0002), 216 (4,007.0002), 237 (10,004.0004), 251 (8,004.0004), 259 (12,004.0002), 261 (10,004.0002), 262 (8,004.0001), 263 (7,004.0003), 264 (4,004.0002), 265 (5,004.0004), 291 (1,005.0004), 295 (10,005.0004), 320 (12,024.0002), 333 (5,024.0004)
- **Bin 23 (0.46000, 0.48000) [dark green]**: 2 (8,012.0004), 5 (9,012.0004), 12 (12,012.0004), 17 (9,012.0003), 20 (1,012.0004), 21 (2,012.0001), 22 (10,012.0003), 26 (1,012.0003), 28 (9,012.0001), 36 (10,001.0002), 37 (12,001.0003), 40 (5,001.0001), 42 (9,001.0004), 48 (6,001.0004), 49 (10,001.0001), 50 (10,001.0003), 53 (9,001.0003), 55 (12,001.0004), 57 (3,001.0004), 61 (9,001.0001), 64 (8,001.0003), 68 (2,001.0001), 85 (10,019.0001), 86 (9,019.0004), 87 (9,019.0001), 88 (10,019.0002), 92 (2,019.0001), 101 (12,019.0004), 102 (3,019.0004), 103 (12,019.0003), 106 (9,019.0003), 110 (5,003.0001), 115 (10,003.0003), 116 (3,003.0004), 117 (2,003.0001), 124 (8,003.0003), 128 (9,003.0001), 136 (9,003.0003), 139 (6,010.0004), 143 (9,010.0001), 145 (10,010.0001), 148 (3,010.0004), 154 (8,010.0003), 157 (9,010.0003), 159 (12,010.0004), 161 (12,010.0003), 168 (10,023.0003), 173 (12,023.0003), 174 (6,023.0004), 175 (8,023.0003), 176 (9,023.0003), 181 (3,023.0004), 184 (1,023.0003), 188 (5,023.0001), 200 (2,023.0001), 204 (10,007.0003), 205 (9,007.0003), 212 (6,007.0004), 222 (3,007.0004), 226 (2,007.0001), 229 (1,007.0003), 231 (9,007.0001), 236 (5,004.0001), 238 (10,004.0003), 244 (6,004.0004), 246 (2,004.0001), 254 (10,004.0001), 255 (9,004.0003), 267 (8,004.0003), 281 (6,005.0004), 284 (5,005.0001), 287 (12,005.0004), 290 (10,005.0001), 296 (3,005.0004), 297 (12,005.0003), 302 (9,005.0004), 303 (2,005.0001), 306 (9,005.0003), 310 (6,024.0004), 311 (5,024.0001), 330 (10,024.0003), 331 (1,024.0004), 332 (10,024.0002)
- **Bin 24 (0.48000, 0.50000) [dark green]**: 4 (12,012.0003), 6 (6,012.0004), 66 (4,001.0001), 90 (4,019.0001), 127 (4,003.0001), 156 (4,010.0001), 167 (4,023.0001), 227 (4,007.0001), 240 (12,004.0004), 258 (4,004.0001), 304 (4,005.0001), 328 (4,024.0001), 334 (12,024.0003)
- **Bin 25 (0.50000, 0.52000) [dark green]**: 19 (11,012.0001), 41 (3,001.0002), 60 (7,001.0004), 67 (1,001.0002), 73 (3,019.0002), 76 (11,019.0001), 99 (1,019.0002), 100 (4,019.0003), 114 (4,003.0003), 122 (5,003.0002), 164 (11,023.0001), 190 (4,023.0003), 192 (3,023.0002), 202 (1,007.0002), 215 (3,007.0002), 220 (7,007.0004), 250 (1,004.0002), 252 (4,004.0003), 257 (3,004.0002), 260 (11,004.0001), 285 (4,005.0003), 298 (11,005.0001), 308 (7,005.0004), 315 (3,024.0002), 318 (11,024.0001), 322 (1,024.0002), 329 (4,024.0003)
- **Bin 26 (0.52000, 0.54000) [dark green]**: 11 (5,012.0002), 13 (1,012.0002), 14 (7,012.0004), 32 (2,012.0003), 39 (2,001.0003), 59 (11,001.0004), 77 (7,019.0002), 79 (5,019.0002), 81 (7,019.0004), 84 (11,019.0004), 129 (2,003.0003), 132 (7,003.0004), 138 (11,010.0004), 152 (7,010.0004), 163 (5,010.0002), 166 (11,023.0004), 172 (2,023.0004), 178 (5,023.0002), 180 (7,023.0004), 183 (7,023.0002), 185 (2,023.0003), 207 (2,007.0003), 217 (2,007.0004), 224 (5,007.0002), 233 (4,007.0003), 248 (7,004.0004), 256 (5,004.0002), 293 (5,005.0002), 294 (1,005.0002), 321 (7,024.0004), 324 (11,024.0004), 335 (2,024.0004)
- **Bin 27 (0.54000, 0.56000) [dark green]**: 10 (8,012.0002), 25 (11,012.0002), 45 (8,001.0002), 52 (11,001.0002), 72 (8,019.0002), 96 (11,019.0002), 125 (11,003.0002), 158 (11,010.0002), 171 (11,023.0002), 219 (11,007.0002), 228 (6,007.0003), 234 (8,004.0002), 235 (11,004.0002), 239 (6,004.0003), 286 (6,005.0003), 289 (8,005.0002), 299 (11,005.0002), 313 (8,024.0002)
- **Bin 28 (0.56000, 0.58000) [dark green]**: 16 (6,012.0003), 51 (6,001.0003), 80 (6,019.0003), 105 (7,019.0001), 109 (2,003.0002), 150 (6,010.0003), 187 (6,023.0003), 196 (2,023.0002), 223 (7,007.0002), 266 (2,004.0003), 282 (7,005.0001), 300 (2,005.0002), 301 (2,005.0003), 317 (7,024.0001), 326 (6,024.0003), 336 (2,024.0003)
- **Bin 29 (0.58000, 0.60000) [dark green]**: 15 (2,012.0002), 18 (1,012.0001), 27 (5,012.0003), 29 (7,012.0001), 34 (7,001.0002), 56 (5,001.0003), 119 (5,003.0003), 133 (1,003.0001), 165 (7,023.0001), 170 (5,023.0003), 186 (1,023.0001), 225 (7,007.0001), 247 (7,004.0002), 268 (1,004.0001), 305 (7,005.0002), 312 (7,024.0002)

### Total True Positive Hard (NOK, correct) samples: 0
---------- Samples in True Positive Hard (NOK, correct) bins ----------

### Total False Positive Hard (OK, misclassified) samples: 0
---------- Samples in False Positive Hard (OK, misclassified) bins ----------

### Total False Negative Hard (NOK, misclassified) samples: 0
---------- Samples in False Negative Hard (NOK, misclassified) bins ----------

### Total True Negative Soft (OK, correct) samples: 0
---------- Samples in True Negative Soft (OK, correct) bins ----------

### Total True Positive Soft (NOK, correct) samples: 0
---------- Samples in True Positive Soft (NOK, correct) bins ----------

### Total False Positive Soft (OK, misclassified) samples: 21
---------- Samples in False Positive Soft (OK, misclassified) bins ----------
- **Bin 29 (0.58000, 0.60000) [light red]**: 1 (5,013.0003), 280 (1,016.0001)
- **Bin 30 (0.60000, 0.62000) [light red]**: 0 (1,013.0001), 33 (1,017.0001), 69 (5,009.0003), 70 (1,021.0001), 71 (2,021.0002), 107 (5,015.0003), 108 (1,015.0001), 269 (1,002.0001), 270 (5,014.0001), 271 (1,014.0001), 273 (1,018.0001), 274 (5,020.0003), 275 (1,022.0001), 276 (1,025.0001), 277 (7,025.0001), 278 (1,008.0001), 309 (1,011.0001)
- **Bin 31 (0.62000, 0.64000) [light red]**: 272 (6,014.0003), 279 (1,006.0001)

### Total False Negative Soft (NOK, misclassified) samples: 0
---------- Samples in False Negative Soft (NOK, misclassified) bins ----------

DB delta OK (100% OK of train): 0.0025 (DB = 0.5991)

Anomaly score distribution plot logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION ADVANCE 2 (GIVEN vs PRED) >>>>>>>>>>>>

(Using '100%' OK of train

Creating anomaly score distribution plot for [ws_ls1_(pos+E1)]-IF_fdet_6 / train...
## Bin details for Anomaly Score Distribution Advance 2 (100% OK of train) 
-------------------------
### Total True Negative Hard (OK, correct) samples: 317
---------- Samples in True Negative Hard (OK, correct) bins ----------
- **Bin 20 (0.40000, 0.42000) [dark green]**: 82 (12,019.0001), 153 (12,010.0001), 197 (12,023.0001), 218 (12,007.0001), 288 (12,005.0001), 323 (12,024.0001)
- **Bin 21 (0.42000, 0.44000) [dark green]**: 3 (6,012.0001), 7 (9,012.0002), 24 (3,012.0003), 35 (3,001.0003), 43 (9,001.0002), 62 (11,001.0003), 65 (6,001.0002), 78 (9,019.0002), 83 (6,019.0001), 93 (4,019.0004), 95 (3,019.0003), 98 (11,019.0003), 118 (11,003.0003), 120 (6,003.0001), 123 (9,003.0002), 131 (3,003.0003), 141 (3,010.0003), 146 (11,010.0003), 147 (6,010.0002), 149 (3,010.0001), 151 (9,010.0002), 160 (4,010.0004), 179 (4,023.0004), 189 (3,023.0003), 193 (9,023.0002), 194 (6,023.0002), 198 (6,023.0001), 203 (11,007.0003), 209 (3,007.0003), 211 (6,007.0001), 214 (9,007.0002), 221 (3,007.0001), 230 (6,007.0002), 232 (4,007.0004), 241 (12,004.0001), 242 (4,004.0004), 243 (3,004.0001), 245 (3,004.0003), 249 (9,004.0002), 253 (11,004.0003), 283 (3,005.0001), 292 (11,005.0003), 307 (6,005.0001), 314 (9,024.0002), 316 (11,024.0003), 319 (3,024.0003), 325 (6,024.0001), 327 (6,024.0002), 337 (4,024.0004)
- **Bin 22 (0.44000, 0.46000) [dark green]**: 8 (10,012.0002), 9 (12,012.0002), 23 (3,012.0001), 30 (8,012.0001), 31 (7,012.0003), 38 (12,001.0002), 44 (7,001.0003), 46 (10,001.0004), 47 (5,001.0004), 54 (1,001.0004), 58 (4,001.0002), 63 (8,001.0001), 74 (5,019.0004), 75 (10,019.0004), 89 (4,019.0002), 91 (1,019.0004), 94 (7,019.0003), 97 (8,019.0001), 104 (1,019.0003), 111 (8,003.0004), 112 (10,003.0002), 113 (1,003.0004), 121 (1,003.0003), 126 (10,003.0004), 130 (7,003.0003), 134 (4,003.0002), 135 (8,003.0001), 137 (1,010.0004), 140 (4,010.0002), 142 (8,010.0004), 144 (8,010.0001), 155 (10,010.0004), 162 (5,010.0004), 169 (8,023.0004), 177 (8,023.0001), 182 (10,023.0002), 191 (7,023.0003), 195 (12,023.0002), 199 (1,023.0004), 201 (4,023.0002), 206 (8,007.0001), 208 (1,007.0004), 210 (5,007.0004), 213 (10,007.0002), 216 (4,007.0002), 237 (10,004.0004), 251 (8,004.0004), 259 (12,004.0002), 261 (10,004.0002), 262 (8,004.0001), 263 (7,004.0003), 264 (4,004.0002), 265 (5,004.0004), 291 (1,005.0004), 295 (10,005.0004), 320 (12,024.0002), 333 (5,024.0004)
- **Bin 23 (0.46000, 0.48000) [dark green]**: 2 (8,012.0004), 5 (9,012.0004), 12 (12,012.0004), 17 (9,012.0003), 20 (1,012.0004), 21 (2,012.0001), 22 (10,012.0003), 26 (1,012.0003), 28 (9,012.0001), 36 (10,001.0002), 37 (12,001.0003), 40 (5,001.0001), 42 (9,001.0004), 48 (6,001.0004), 49 (10,001.0001), 50 (10,001.0003), 53 (9,001.0003), 55 (12,001.0004), 57 (3,001.0004), 61 (9,001.0001), 64 (8,001.0003), 68 (2,001.0001), 85 (10,019.0001), 86 (9,019.0004), 87 (9,019.0001), 88 (10,019.0002), 92 (2,019.0001), 101 (12,019.0004), 102 (3,019.0004), 103 (12,019.0003), 106 (9,019.0003), 110 (5,003.0001), 115 (10,003.0003), 116 (3,003.0004), 117 (2,003.0001), 124 (8,003.0003), 128 (9,003.0001), 136 (9,003.0003), 139 (6,010.0004), 143 (9,010.0001), 145 (10,010.0001), 148 (3,010.0004), 154 (8,010.0003), 157 (9,010.0003), 159 (12,010.0004), 161 (12,010.0003), 168 (10,023.0003), 173 (12,023.0003), 174 (6,023.0004), 175 (8,023.0003), 176 (9,023.0003), 181 (3,023.0004), 184 (1,023.0003), 188 (5,023.0001), 200 (2,023.0001), 204 (10,007.0003), 205 (9,007.0003), 212 (6,007.0004), 222 (3,007.0004), 226 (2,007.0001), 229 (1,007.0003), 231 (9,007.0001), 236 (5,004.0001), 238 (10,004.0003), 244 (6,004.0004), 246 (2,004.0001), 254 (10,004.0001), 255 (9,004.0003), 267 (8,004.0003), 281 (6,005.0004), 284 (5,005.0001), 287 (12,005.0004), 290 (10,005.0001), 296 (3,005.0004), 297 (12,005.0003), 302 (9,005.0004), 303 (2,005.0001), 306 (9,005.0003), 310 (6,024.0004), 311 (5,024.0001), 330 (10,024.0003), 331 (1,024.0004), 332 (10,024.0002)
- **Bin 24 (0.48000, 0.50000) [dark green]**: 4 (12,012.0003), 6 (6,012.0004), 66 (4,001.0001), 90 (4,019.0001), 127 (4,003.0001), 156 (4,010.0001), 167 (4,023.0001), 227 (4,007.0001), 240 (12,004.0004), 258 (4,004.0001), 304 (4,005.0001), 328 (4,024.0001), 334 (12,024.0003)
- **Bin 25 (0.50000, 0.52000) [dark green]**: 19 (11,012.0001), 41 (3,001.0002), 60 (7,001.0004), 67 (1,001.0002), 73 (3,019.0002), 76 (11,019.0001), 99 (1,019.0002), 100 (4,019.0003), 114 (4,003.0003), 122 (5,003.0002), 164 (11,023.0001), 190 (4,023.0003), 192 (3,023.0002), 202 (1,007.0002), 215 (3,007.0002), 220 (7,007.0004), 250 (1,004.0002), 252 (4,004.0003), 257 (3,004.0002), 260 (11,004.0001), 285 (4,005.0003), 298 (11,005.0001), 308 (7,005.0004), 315 (3,024.0002), 318 (11,024.0001), 322 (1,024.0002), 329 (4,024.0003)
- **Bin 26 (0.52000, 0.54000) [dark green]**: 11 (5,012.0002), 13 (1,012.0002), 14 (7,012.0004), 32 (2,012.0003), 39 (2,001.0003), 59 (11,001.0004), 77 (7,019.0002), 79 (5,019.0002), 81 (7,019.0004), 84 (11,019.0004), 129 (2,003.0003), 132 (7,003.0004), 138 (11,010.0004), 152 (7,010.0004), 163 (5,010.0002), 166 (11,023.0004), 172 (2,023.0004), 178 (5,023.0002), 180 (7,023.0004), 183 (7,023.0002), 185 (2,023.0003), 207 (2,007.0003), 217 (2,007.0004), 224 (5,007.0002), 233 (4,007.0003), 248 (7,004.0004), 256 (5,004.0002), 293 (5,005.0002), 294 (1,005.0002), 321 (7,024.0004), 324 (11,024.0004), 335 (2,024.0004)
- **Bin 27 (0.54000, 0.56000) [dark green]**: 10 (8,012.0002), 25 (11,012.0002), 45 (8,001.0002), 52 (11,001.0002), 72 (8,019.0002), 96 (11,019.0002), 125 (11,003.0002), 158 (11,010.0002), 171 (11,023.0002), 219 (11,007.0002), 228 (6,007.0003), 234 (8,004.0002), 235 (11,004.0002), 239 (6,004.0003), 286 (6,005.0003), 289 (8,005.0002), 299 (11,005.0002), 313 (8,024.0002)
- **Bin 28 (0.56000, 0.58000) [dark green]**: 16 (6,012.0003), 51 (6,001.0003), 80 (6,019.0003), 105 (7,019.0001), 109 (2,003.0002), 150 (6,010.0003), 187 (6,023.0003), 196 (2,023.0002), 223 (7,007.0002), 266 (2,004.0003), 282 (7,005.0001), 300 (2,005.0002), 301 (2,005.0003), 317 (7,024.0001), 326 (6,024.0003), 336 (2,024.0003)
- **Bin 29 (0.58000, 0.60000) [dark green]**: 15 (2,012.0002), 18 (1,012.0001), 27 (5,012.0003), 29 (7,012.0001), 34 (7,001.0002), 56 (5,001.0003), 119 (5,003.0003), 133 (1,003.0001), 165 (7,023.0001), 170 (5,023.0003), 186 (1,023.0001), 225 (7,007.0001), 247 (7,004.0002), 268 (1,004.0001), 305 (7,005.0002), 312 (7,024.0002)

### Total True Positive Hard (NOK, correct) samples: 0
---------- Samples in True Positive Hard (NOK, correct) bins ----------

### Total False Positive Hard (OK, misclassified) samples: 0
---------- Samples in False Positive Hard (OK, misclassified) bins ----------

### Total False Negative Hard (NOK, misclassified) samples: 0
---------- Samples in False Negative Hard (NOK, misclassified) bins ----------

### Total True Negative Soft (OK, correct) samples: 0
---------- Samples in True Negative Soft (OK, correct) bins ----------

### Total True Positive Soft (NOK, correct) samples: 0
---------- Samples in True Positive Soft (NOK, correct) bins ----------

### Total False Positive Soft (OK, misclassified) samples: 21
---------- Samples in False Positive Soft (OK, misclassified) bins ----------
- **Bin 29 (0.58000, 0.60000) [light red]**: 1 (5,013.0003), 280 (1,016.0001)
- **Bin 30 (0.60000, 0.62000) [light red]**: 0 (1,013.0001), 33 (1,017.0001), 69 (5,009.0003), 70 (1,021.0001), 71 (2,021.0002), 107 (5,015.0003), 108 (1,015.0001), 269 (1,002.0001), 270 (5,014.0001), 271 (1,014.0001), 273 (1,018.0001), 274 (5,020.0003), 275 (1,022.0001), 276 (1,025.0001), 277 (7,025.0001), 278 (1,008.0001), 309 (1,011.0001)
- **Bin 31 (0.62000, 0.64000) [light red]**: 272 (6,014.0003), 279 (1,006.0001)

### Total False Negative Soft (NOK, misclassified) samples: 0
---------- Samples in False Negative Soft (NOK, misclassified) bins ----------

DB delta OK (100% OK of train): 0.0025 (DB = 0.5991)

Anomaly score distribution plot logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for [ws_ls1_(pos+E1)]-IF_fdet_6 / train...

Pair plot logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6


Testing environment set. Testing will be logged at: C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time+freq(cutoff_freq=0)

>> No raw data normalization is applied

>> Feature normalizer loaded with 'std' normalization

>> Time feature extractor initialized with features: first_n_modes(n_modes=3), from_ranks(feat_list=['impulse_factor', 'mean_abs', 'sq_root_abs', 'std_deviation_index', 'normalized_std', 'crest_factor'])

>> Frequency feature extractor initialized with features: first_n_modes(n_modes=3), from_ranks(feat_list=['impulse_factor', 'mean_abs', 'sq_root_abs', 'std_deviation_index', 'normalized_std', 'crest_factor'])

>> No feature reduction is applied

---------------------------------------------------------------------------
Unknown time feature extraction type: first_n_modes. Skipping...
Unknown frequency feature name in ranks: impulse_factor. Skipping...
Unknown frequency feature name in ranks: mean_abs. Skipping...
Unknown frequency feature name in ranks: sq_root_abs. Skipping...
Unknown frequency feature name in ranks: std_deviation_index. Skipping...
Unknown frequency feature name in ranks: normalized_std. Skipping...
Unknown frequency feature name in ranks: crest_factor. Skipping...

Feature names: ['freq1_0', 'freq1_1', 'freq2_0', 'freq2_1', 'freq3_0', 'freq3_1', 'mode1_0', 'mode1_1', 'mode2_0', 'mode2_1', 'mode3_0', 'mode3_1', 'impulse_factor_0', 'impulse_factor_1', 'mean_abs_0', 'mean_abs_1', 'sq_root_abs_0', 'sq_root_abs_1', 'std_deviation_index_0', 'std_deviation_index_1', 'normalized_std_0', 'normalized_std_1', 'crest_factor_0', 'crest_factor_1']

Test inference completed in 0.77 seconds

OK upper bound (from training): 0.5966

Dataframe is as follows:
   machine_num                                            rep_num  pred_label  final_pred_label    scores  given_label   nok_pct  n_samples
0          001       [1001.0001, 3001.0001, 5001.0002, 6001.0001]          -1              -1.0  0.503205          1.0  0.250000          4
1          027  [6027.0003, 1027.0002, 12027.0003, 1027.0001, ...          -1              -1.0  0.691994         -1.0  1.000000          6
2          015  [11015.0001, 3015.0004, 2015.0002, 4015.0002, ...           1               1.0  0.489246          1.0  0.000000          7
3          019      [8019.0003, 6019.0002, 5019.0001, 12019.0002]           1               1.0  0.457353          1.0  0.000000          4
4          005  [8005.0004, 8005.0003, 5005.0004, 8005.0001, 1...           1               1.0  0.451952          1.0  0.000000          7
5          002  [8002.0004, 3002.0002, 1002.0002, 9002.0001, 1...           1               1.0  0.481570          1.0  0.000000          9
6          030  [6030.0002, 9030.0001, 1030.0003, 3030.0003, 1...          -1              -1.0  0.694478         -1.0  1.000000          9
7          032     [12032.0002, 8032.0001, 2032.0001, 12032.0001]          -1              -1.0  0.685160         -1.0  1.000000          4
8          026  [2026.0001, 5026.0002, 8026.0003, 11026.0003, ...          -1              -1.0  0.683142         -1.0  1.000000          7
9          028  [5028.0001, 3028.0004, 1028.0001, 3028.0001, 8...          -1              -1.0  0.705645         -1.0  1.000000          5
10         018  [2018.0004, 2018.0002, 9018.0001, 9018.0002, 1...           1               1.0  0.486899          1.0  0.000000          6
11         031                  [3031.0001, 7031.0002, 4031.0002]          -1              -1.0  0.707760         -1.0  1.000000          3
12         016  [2016.0001, 1016.0002, 3016.0002, 5016.0002, 8...           1               1.0  0.498927          1.0  0.000000          6
13         012  [12012.0001, 3012.0002, 10012.0004, 4012.0002,...           1               1.0  0.472951          1.0  0.000000          6
14         009  [4009.0001, 7009.0002, 12009.0004, 9009.0002, ...           1               1.0  0.497435          1.0  0.000000          5
15         010       [7010.0002, 7010.0001, 1010.0001, 2010.0002]           1               1.0  0.572465          1.0  0.000000          4
16         033  [10033.0004, 3033.0004, 1033.0003, 2033.0003, ...          -1              -1.0  0.697130         -1.0  1.000000          5
17         014       [1014.0003, 3014.0001, 6014.0001, 7014.0001]           1               1.0  0.557418          1.0  0.000000          4
18         020                  [9020.0004, 8020.0004, 8020.0002]           1               1.0  0.494519          1.0  0.000000          3
19         021                             [3021.0001, 6021.0002]           1               1.0  0.435831          1.0  0.000000          2
20         017                                        [6017.0001]           1               1.0  0.434313          1.0  0.000000          1
21         011  [8011.0002, 6011.0002, 3011.0002, 7011.0002, 1...           1               1.0  0.496252          1.0  0.000000          5
22         008                 [9008.0001, 7008.0004, 12008.0002]           1               1.0  0.478235          1.0  0.000000          3
23         007  [12007.0002, 8007.0002, 5007.0001, 5007.0003, ...           1               1.0  0.504256          1.0  0.000000          5
24         024  [12024.0004, 9024.0001, 5024.0003, 8024.0003, ...          -1              -0.5  0.485528          1.0  0.142857          7
25         006  [6006.0003, 8006.0001, 10006.0001, 9006.0001, ...           1               1.0  0.505102          1.0  0.000000          6
26         025  [1025.0002, 2025.0003, 3025.0003, 10025.0003, ...           1               1.0  0.483448          1.0  0.000000          5
27         003     [3003.0002, 12003.0001, 12003.0002, 6003.0002]           1               1.0  0.448664          1.0  0.000000          4
28         022      [9022.0001, 9022.0002, 10022.0002, 7022.0003]           1               1.0  0.451415          1.0  0.000000          4
29         013  [1013.0003, 10013.0003, 12013.0001, 3013.0001,...           1               1.0  0.445641          1.0  0.000000          5
30         029                                        [6029.0002]          -1              -1.0  0.640319         -1.0  1.000000          1
31         004       [2004.0004, 2004.0002, 7004.0001, 6004.0002]           1               1.0  0.530288          1.0  0.000000          4
32         023                            [5023.0004, 10023.0001]           1               1.0  0.462022          1.0  0.000000          2

Test accuracy (for hard prediction): 0.94
Precision (hard): 0.89, Recall (hard): 1.00, F1-score (hard): 0.94
Precision (soft): 0.00, Recall (soft): 0.00, F1-score (soft): 0.00

Testing hyperparameters logged for tensorboard at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [ws_ls1_(pos+E1)]-IF_fdet_6 / test...

Confusion matrix logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6\test


<<<<<<<<<<<< CONFUSION MATRIX ADVANCE >>>>>>>>>>>>

> Creating confusion matrix (hard/soft) for [ws_ls1_(pos+E1)]-IF_fdet_6 / test...

Confusion matrix (hard/soft) logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION ADVANCE 1 (GIVEN vs PRED) >>>>>>>>>>>>

(Using '100%' OK of train

Creating anomaly score distribution plot for [ws_ls1_(pos+E1)]-IF_fdet_6 / test...
## Bin details for Anomaly Score Distribution Advance 1 (100% OK of train) 
-------------------------
### Total True Negative Hard (OK, correct) samples: 107
---------- Samples in True Negative Hard (OK, correct) bins ----------
- **Bin 20 (0.40000, 0.42000) [dark green]**: 130 (12,003.0001), 139 (12,013.0001)
- **Bin 21 (0.42000, 0.44000) [dark green]**: 15 (6,019.0002), 23 (6,005.0002), 62 (9,018.0002), 64 (4,018.0004), 74 (12,012.0001), 83 (9,009.0002), 102 (6,021.0002), 103 (6,017.0001), 105 (6,011.0002), 126 (3,025.0003), 132 (6,003.0002), 134 (9,022.0002), 140 (3,013.0001), 146 (6,004.0002)
- **Bin 22 (0.44000, 0.46000) [dark green]**: 10 (4,015.0002), 17 (12,019.0002), 18 (8,005.0004), 20 (5,005.0004), 21 (8,005.0001), 22 (12,005.0002), 24 (4,005.0002), 31 (7,002.0003), 72 (8,016.0004), 76 (10,012.0004), 77 (4,012.0002), 99 (8,020.0004), 101 (3,021.0001), 108 (1,011.0003), 111 (12,008.0002), 112 (12,007.0002), 119 (8,006.0001), 128 (5,025.0004), 131 (12,003.0002), 135 (10,022.0002), 136 (7,022.0003), 137 (1,013.0003), 141 (10,013.0004), 147 (5,023.0004)
- **Bin 23 (0.46000, 0.48000) [dark green]**: 8 (3,015.0004), 11 (5,015.0001), 12 (9,015.0004), 13 (12,015.0004), 14 (8,019.0003), 16 (5,019.0001), 19 (8,005.0003), 25 (8,002.0004), 28 (9,002.0001), 29 (1,002.0004), 30 (10,002.0003), 33 (9,002.0003), 61 (9,018.0001), 63 (12,018.0004), 68 (2,016.0001), 84 (9,009.0004), 98 (9,020.0004), 109 (9,008.0001), 114 (5,007.0001), 116 (9,007.0004), 120 (10,006.0001), 121 (9,006.0001), 127 (10,025.0003), 133 (9,022.0001), 138 (10,013.0003), 148 (10,023.0001)
- **Bin 24 (0.48000, 0.50000) [dark green]**: 78 (8,012.0003), 80 (4,009.0001), 82 (12,009.0004)
- **Bin 25 (0.50000, 0.52000) [dark green]**: 7 (11,015.0001), 26 (3,002.0002), 27 (1,002.0002), 69 (1,016.0002), 70 (3,016.0002), 71 (5,016.0002), 75 (3,012.0002), 97 (7,014.0001), 106 (3,011.0002), 129 (3,003.0002)
- **Bin 26 (0.52000, 0.54000) [dark green]**: 32 (11,002.0004), 59 (2,018.0004), 79 (2,012.0004), 107 (7,011.0002), 110 (7,008.0004), 123 (2,006.0003), 124 (1,025.0002), 125 (2,025.0003), 143 (2,004.0004)
- **Bin 27 (0.54000, 0.56000) [dark green]**: 73 (11,016.0002), 85 (7,010.0002), 94 (1,014.0003), 100 (8,020.0002), 104 (8,011.0002), 113 (8,007.0002), 122 (8,006.0002)
- **Bin 28 (0.56000, 0.58000) [dark green]**: 60 (2,018.0002), 86 (7,010.0001), 88 (2,010.0002), 95 (3,014.0001), 118 (6,006.0003), 145 (7,004.0001)
- **Bin 29 (0.58000, 0.60000) [dark green]**: 9 (2,015.0002), 81 (7,009.0002), 87 (1,010.0001), 96 (6,014.0001), 115 (5,007.0003), 144 (2,004.0002)

### Total True Positive Hard (NOK, correct) samples: 40
---------- Samples in True Positive Hard (NOK, correct) bins ----------
- **Bin 32 (0.64000, 0.66000) [dark orange]**: 43 (12,032.0002), 52 (6,026.0004), 142 (6,029.0002)
- **Bin 33 (0.66000, 0.68000) [dark orange]**: 39 (2,030.0001), 48 (5,026.0002), 51 (6,026.0003), 90 (3,033.0004)
- **Bin 34 (0.68000, 0.70000) [dark orange]**: 1 (6,027.0003), 2 (1,027.0002), 5 (3,027.0003), 6 (10,027.0001), 36 (1,030.0003), 37 (3,030.0003), 38 (10,030.0004), 42 (7,030.0003), 44 (8,032.0001), 46 (12,032.0001), 49 (8,026.0003), 50 (11,026.0003), 92 (2,033.0003)
- **Bin 35 (0.70000, 0.72000) [dark orange]**: 3 (12,027.0003), 4 (1,027.0001), 34 (6,030.0002), 35 (9,030.0001), 40 (10,030.0003), 41 (11,030.0001), 45 (2,032.0001), 47 (2,026.0001), 53 (1,026.0002), 54 (5,028.0001), 55 (3,028.0004), 56 (1,028.0001), 57 (3,028.0001), 58 (8,028.0001), 65 (3,031.0001), 66 (7,031.0002), 67 (4,031.0002), 89 (10,033.0004), 91 (1,033.0003), 93 (7,033.0002)

### Total False Positive Hard (OK, misclassified) samples: 1
---------- Samples in False Positive Hard (OK, misclassified) bins ----------
- **Bin 31 (0.62000, 0.64000) [dark red]**: 0 (1,001.0001)

### Total False Negative Hard (NOK, misclassified) samples: 0
---------- Samples in False Negative Hard (NOK, misclassified) bins ----------

### Total True Negative Soft (OK, correct) samples: 0
---------- Samples in True Negative Soft (OK, correct) bins ----------

### Total True Positive Soft (NOK, correct) samples: 0
---------- Samples in True Positive Soft (NOK, correct) bins ----------

### Total False Positive Soft (OK, misclassified) samples: 1
---------- Samples in False Positive Soft (OK, misclassified) bins ----------
- **Bin 30 (0.60000, 0.62000) [light red]**: 117 (5,024.0003)

### Total False Negative Soft (NOK, misclassified) samples: 0
---------- Samples in False Negative Soft (NOK, misclassified) bins ----------

DB delta OK (100% OK of train): 0.0025 (DB = 0.5991)

Anomaly score distribution plot logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION ADVANCE 2 (GIVEN vs PRED) >>>>>>>>>>>>

(Using '100%' OK of train

Creating anomaly score distribution plot for [ws_ls1_(pos+E1)]-IF_fdet_6 / test...
## Bin details for Anomaly Score Distribution Advance 2 (100% OK of train) 
-------------------------
### Total True Negative Hard (OK, correct) samples: 107
---------- Samples in True Negative Hard (OK, correct) bins ----------
- **Bin 20 (0.40000, 0.42000) [dark green]**: 130 (12,003.0001), 139 (12,013.0001)
- **Bin 21 (0.42000, 0.44000) [dark green]**: 15 (6,019.0002), 23 (6,005.0002), 62 (9,018.0002), 64 (4,018.0004), 74 (12,012.0001), 83 (9,009.0002), 102 (6,021.0002), 103 (6,017.0001), 105 (6,011.0002), 126 (3,025.0003), 132 (6,003.0002), 134 (9,022.0002), 140 (3,013.0001), 146 (6,004.0002)
- **Bin 22 (0.44000, 0.46000) [dark green]**: 10 (4,015.0002), 17 (12,019.0002), 18 (8,005.0004), 20 (5,005.0004), 21 (8,005.0001), 22 (12,005.0002), 24 (4,005.0002), 31 (7,002.0003), 72 (8,016.0004), 76 (10,012.0004), 77 (4,012.0002), 99 (8,020.0004), 101 (3,021.0001), 108 (1,011.0003), 111 (12,008.0002), 112 (12,007.0002), 119 (8,006.0001), 128 (5,025.0004), 131 (12,003.0002), 135 (10,022.0002), 136 (7,022.0003), 137 (1,013.0003), 141 (10,013.0004), 147 (5,023.0004)
- **Bin 23 (0.46000, 0.48000) [dark green]**: 8 (3,015.0004), 11 (5,015.0001), 12 (9,015.0004), 13 (12,015.0004), 14 (8,019.0003), 16 (5,019.0001), 19 (8,005.0003), 25 (8,002.0004), 28 (9,002.0001), 29 (1,002.0004), 30 (10,002.0003), 33 (9,002.0003), 61 (9,018.0001), 63 (12,018.0004), 68 (2,016.0001), 84 (9,009.0004), 98 (9,020.0004), 109 (9,008.0001), 114 (5,007.0001), 116 (9,007.0004), 120 (10,006.0001), 121 (9,006.0001), 127 (10,025.0003), 133 (9,022.0001), 138 (10,013.0003), 148 (10,023.0001)
- **Bin 24 (0.48000, 0.50000) [dark green]**: 78 (8,012.0003), 80 (4,009.0001), 82 (12,009.0004)
- **Bin 25 (0.50000, 0.52000) [dark green]**: 7 (11,015.0001), 26 (3,002.0002), 27 (1,002.0002), 69 (1,016.0002), 70 (3,016.0002), 71 (5,016.0002), 75 (3,012.0002), 97 (7,014.0001), 106 (3,011.0002), 129 (3,003.0002)
- **Bin 26 (0.52000, 0.54000) [dark green]**: 32 (11,002.0004), 59 (2,018.0004), 79 (2,012.0004), 107 (7,011.0002), 110 (7,008.0004), 123 (2,006.0003), 124 (1,025.0002), 125 (2,025.0003), 143 (2,004.0004)
- **Bin 27 (0.54000, 0.56000) [dark green]**: 73 (11,016.0002), 85 (7,010.0002), 94 (1,014.0003), 100 (8,020.0002), 104 (8,011.0002), 113 (8,007.0002), 122 (8,006.0002)
- **Bin 28 (0.56000, 0.58000) [dark green]**: 60 (2,018.0002), 86 (7,010.0001), 88 (2,010.0002), 95 (3,014.0001), 118 (6,006.0003), 145 (7,004.0001)
- **Bin 29 (0.58000, 0.60000) [dark green]**: 9 (2,015.0002), 81 (7,009.0002), 87 (1,010.0001), 96 (6,014.0001), 115 (5,007.0003), 144 (2,004.0002)

### Total True Positive Hard (NOK, correct) samples: 40
---------- Samples in True Positive Hard (NOK, correct) bins ----------
- **Bin 32 (0.64000, 0.66000) [dark orange]**: 43 (12,032.0002), 52 (6,026.0004), 142 (6,029.0002)
- **Bin 33 (0.66000, 0.68000) [dark orange]**: 39 (2,030.0001), 48 (5,026.0002), 51 (6,026.0003), 90 (3,033.0004)
- **Bin 34 (0.68000, 0.70000) [dark orange]**: 1 (6,027.0003), 2 (1,027.0002), 5 (3,027.0003), 6 (10,027.0001), 36 (1,030.0003), 37 (3,030.0003), 38 (10,030.0004), 42 (7,030.0003), 44 (8,032.0001), 46 (12,032.0001), 49 (8,026.0003), 50 (11,026.0003), 92 (2,033.0003)
- **Bin 35 (0.70000, 0.72000) [dark orange]**: 3 (12,027.0003), 4 (1,027.0001), 34 (6,030.0002), 35 (9,030.0001), 40 (10,030.0003), 41 (11,030.0001), 45 (2,032.0001), 47 (2,026.0001), 53 (1,026.0002), 54 (5,028.0001), 55 (3,028.0004), 56 (1,028.0001), 57 (3,028.0001), 58 (8,028.0001), 65 (3,031.0001), 66 (7,031.0002), 67 (4,031.0002), 89 (10,033.0004), 91 (1,033.0003), 93 (7,033.0002)

### Total False Positive Hard (OK, misclassified) samples: 1
---------- Samples in False Positive Hard (OK, misclassified) bins ----------
- **Bin 31 (0.62000, 0.64000) [dark red]**: 0 (1,001.0001)

### Total False Negative Hard (NOK, misclassified) samples: 0
---------- Samples in False Negative Hard (NOK, misclassified) bins ----------

### Total True Negative Soft (OK, correct) samples: 0
---------- Samples in True Negative Soft (OK, correct) bins ----------

### Total True Positive Soft (NOK, correct) samples: 0
---------- Samples in True Positive Soft (NOK, correct) bins ----------

### Total False Positive Soft (OK, misclassified) samples: 1
---------- Samples in False Positive Soft (OK, misclassified) bins ----------
- **Bin 30 (0.60000, 0.62000) [light red]**: 117 (5,024.0003)

### Total False Negative Soft (NOK, misclassified) samples: 0
---------- Samples in False Negative Soft (NOK, misclassified) bins ----------

DB delta OK (100% OK of train): 0.0025 (DB = 0.5991)

Anomaly score distribution plot logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for [ws_ls1_(pos+E1)]-IF_fdet_6 / test...

Pair plot logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ws_ls1\pos\set_E1\IF\tswp_4\[ws_ls1_(pos+E1)]-IF_fdet_6\test


===========================================================================

Fault detection model '[ws_ls1_(pos+E1)]-IF_fdet_6' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-10-30 10:57:40
