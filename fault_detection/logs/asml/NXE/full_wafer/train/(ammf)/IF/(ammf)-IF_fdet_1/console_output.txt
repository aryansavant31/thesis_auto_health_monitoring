=== SCRIPT EXECUTION LOG ===
Script: fault_detection.train.py
Base Name: (ammf)-IF_fdet_1
Start Time: 2025-08-21 14:34:02
End Time: 2025-08-21 14:35:35

CPU: Intel64 Family 6 Model 79 Stepping 1, GenuineIntel (Cores: 12), Max Frequency: 2594.00 MHz
GPU: None detected
OS: Windows 10 (10.0.19045)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting fault detection model training...

'Train' type dataset selected:


ds_subtype selections:

(<ds_subtype_num>) <ds_subtype> : [<augments>]
---------------------------------------------
>> Healthy configs
(1) E1_set01_M=mKW33    : [OG]

>> Unhealthy configs

>> Unknown configs


Node and signal types are set as follows:

(<node_num>) <node_type> : [<signal_types>]
---------------------------------------------
(1) ammf   : [acc_rx, acc_ry, acc_rz, acc_x, acc_y, acc_z]


For ds_type 'OK' and others....

Maximum timesteps across all node types: 4098

'fs' is updated in data_config as given in loaded healthy (or unknown) data.
New fs:
[[2499.9998, 2499.9998, 2499.9998, 2499.9998, 2499.9998, 2499.9998]]

Exclusive rep numbers found in keys of hdf5 file. Hence, using them as rep numbers.


Total samples: 12, 
Train: 9/9 [OK=9, NOK=0, UK=0], Test: 2/2 [OK=2, NOK=0, UK=0], Val: 0/0 [OK=0, NOK=0, UK=0],
Remainder: 1 [OK={0: 1, 1: 0, -1: 0}, NOK=1, UK=1]

train_data_loader statistics:
Number of batches: 9
torch.Size([1, 1, 4000, 6])

test_data_loader statistics:
Number of batches: 2
torch.Size([1, 1, 4000, 6])

---------------------------------------------------------------------------

Anomaly Detector Model Initialized with the following configurations:
Model type: IsolationForest
Number of trees in the forest: 1000
Contamination: auto

---------------------------------------------------------------------------
Model parameters saved to 
C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\(ammf)\IF\(ammf)-IF_fdet_1.

Training environment set. Training will be logged at: C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\(ammf)\IF\(ammf)-IF_fdet_1

---------------------------------------------------------------------------

Initializing input processors for anomaly detection model...

>> Domain transformer initialized for 'time' domain

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No time feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp0_dim1, comp0_dim2, comp0_dim3...comp3999_dim2, comp3999_dim3, comp3999_dim4, comp3999_dim5]

Fitting anomaly detection model...

Model fitted successfully in 10.65 seconds

Dataframe is as follows:
   comp0_dim0  comp0_dim1  comp0_dim2  comp0_dim3  ...  given_label    rep_num    scores  pred_label
0    0.460892    0.556121    0.280897    0.679493  ...          0.0   2001.001  0.023046           0
1    0.346445    0.893757    0.100432    0.885361  ...          0.0   8001.001  0.010953           0
2    0.482248    0.614357    0.251390    0.709117  ...          0.0  12001.001  0.024861           0
3    0.454750    0.690861    0.300639    0.670080  ...          0.0   5001.001  0.035107           0
4    0.572296    0.503521    0.523088    0.511774  ...          0.0  10001.001  0.007985           0
5    0.338353    0.534677    0.319224    0.602405  ...          0.0  11001.001 -0.009156           1
6    0.421199    0.534915    0.429124    0.546771  ...          0.0   3001.001  0.006894           0
7    0.395037    0.425199    0.560050    0.431881  ...          0.0   7001.001  0.010335           0
8    0.454547    0.612062    0.308899    0.653558  ...          0.0   9001.001  0.029490           0

[9 rows x 24004 columns]

Training accuracy: 0.89

Training hyperparameters logged for tensorboard at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\(ammf)\IF\(ammf)-IF_fdet_1

Model saved at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\(ammf)\IF\(ammf)-IF_fdet_1\anomaly_detector.pkl

---------------------------------------------------------------------------

Testing environment set. Testing will be logged at: C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\(ammf)\IF\(ammf)-IF_fdet_1\test

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized for 'time' domain

>> Raw data normalizer initialized with 'min_max' normalization

>> No feature normalization is applied

>> No time feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

No seperate features extracted, so using components as features: [comp0_dim0, comp0_dim1, comp0_dim2, comp0_dim3...comp3999_dim2, comp3999_dim3, comp3999_dim4, comp3999_dim5]

Dataframe is as follows:
   comp0_dim0  comp0_dim1  comp0_dim2  comp0_dim3  ...  given_label   rep_num    scores  pred_label
0    0.642357    0.180752    0.803715    0.131451  ...          0.0  1001.001 -0.009609           1
1    0.259207    0.546420    0.463901    0.594743  ...          0.0  4001.001 -0.022018           1

[2 rows x 24004 columns]

Test accuracy: 0.00
Precision: 0.00, Recall: 0.00, F1-score: 0.00

Testing hyperparameters logged for tensorboard at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\(ammf)\IF\(ammf)-IF_fdet_1\test

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX >>>>>>>>>>>>

> Creating confusion matrix for (ammf)-IF_fdet_1 / test...

Confusion matrix logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\(ammf)\IF\(ammf)-IF_fdet_1\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (PRED_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (ammf)-IF_fdet_1 / test...

Total OK samples (from pred_label) : 0
---------- Samples in OK bins ----------

Total NOK samples (from pred_label) : 2
---------- Samples in NOK bins ----------
Bin 0 (-0.02202, -0.02177): 1 (4,001.001)

Anomaly score distribution plot logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\(ammf)\IF\(ammf)-IF_fdet_1\test


<<<<<<<<<<<< ANOMALY SCORE DISTRIBUTION (GIVEN_LABEL) >>>>>>>>>>>>

Creating anomaly score distribution plot for (ammf)-IF_fdet_1 / test...

Total OK samples (from given_label) : 2
---------- Samples in OK bins ----------
Bin 0 (-0.02202, -0.02177): 1 (4,001.001)

Total NOK samples (from given_label) : 0
---------- Samples in NOK bins ----------

Anomaly score distribution plot logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\(ammf)\IF\(ammf)-IF_fdet_1\test


<<<<<<<<<<<< PAIR PLOT >>>>>>>>>>>>

> Creating pair plot for (ammf)-IF_fdet_1 / test...

Pair plot logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\(ammf)\IF\(ammf)-IF_fdet_1\test


===========================================================================

Fault detection model '(ammf)-IF_fdet_1' training completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-08-21 14:35:35
