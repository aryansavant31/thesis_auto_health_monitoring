=== SCRIPT EXECUTION LOG ===
Script: fault_detection.infer.py
Base Name: [ammf_(acc+E1)]-IF_fdet_48/custom_test_2
Start Time: 2025-09-21 23:32:53
End Time: 2025-09-21 23:34:38

CPU: Intel64 Family 6 Model 79 Stepping 1, GenuineIntel (Cores: 12), Max Frequency: 2594.00 MHz
GPU: None detected
OS: Windows 10 (10.0.19045)

Python Version: 3.12.11 | packaged by Anaconda, Inc. | (main, Jun  5 2025, 12:58:53) [MSC v.1929 64 bit (AMD64)]
========================================================================================================================


Starting anomaly detector to custom_test...

'Custom_test' type dataset selected:


Dataset selections:
---------------------------------------------
*_(<ds_subtype_num>) <ds_subtype> : [<augments>]_*

- **Healthy configs**
  (1) E1_set01_M=mEK83    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (2) E1_set01_M=mEO26    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (3) E1_set01_M=mEP39    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (4) E1_set01_M=mEP73    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (5) E1_set01_M=mEV46    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (6) E1_set01_M=mEZ94    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (7) E1_set01_M=mFA30    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (8) E1_set01_M=mFC17    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (9) E1_set01_M=mFF18    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (10) E1_set01_M=mFJ72    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (11) E1_set01_M=mFL29    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (12) E1_set01_M=mFM76    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (13) E1_set01_M=mFQ18    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (14) E1_set01_M=mFX20    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (15) E1_set01_M=mFX70    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (16) E1_set01_M=mFY86    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (17) E1_set01_M=mGB62    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (18) E1_set01_M=mGD45    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (19) E1_set01_M=mGD96    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (20) E1_set01_M=mGF06    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (21) E1_set01_M=mGF37    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (22) E1_set01_M=mGF62    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (23) E1_set01_M=mGG38    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (24) E1_set01_M=mGH51    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (25) E1_set01_M=mGI48    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (26) E1_set01_M=mGM63    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (27) E1_set01_M=mGR15    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (28) E1_set01_M=mGS15    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (29) E1_set01_M=mGT99    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (30) E1_set01_M=mGX70    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (31) E1_set01_M=mHA09    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (32) E1_set01_M=mHB89    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (33) E1_set01_M=mHC14    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (34) E1_set01_M=mHC51    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (35) E1_set01_M=mHD92    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (36) E1_set01_M=mHF87    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (37) E1_set01_M=mHF95    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (38) E1_set01_M=mHG72    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (39) E1_set01_M=mHG90    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (40) E1_set01_M=mHL47    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (41) E1_set01_M=mHM40    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (42) E1_set01_M=mHS02    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (43) E1_set01_M=mHT43    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (44) E1_set01_M=mHU18    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (45) E1_set01_M=mHV81    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (46) E1_set01_M=mHW09    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (47) E1_set01_M=mHW86    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (48) E1_set01_M=mHZ50    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (49) E1_set01_M=mIB13    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (50) E1_set01_M=mIC11    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (51) E1_set01_M=mIC20    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (52) E1_set01_M=mID45    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (53) E1_set01_M=mIF20    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (54) E1_set01_M=mIH25    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (55) E1_set01_M=mIK48    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (56) E1_set01_M=mIK66    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (57) E1_set01_M=mIN28    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (58) E1_set01_M=mIN36    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (59) E1_set01_M=mIP47    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (60) E1_set01_M=mIQ75    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (61) E1_set01_M=mIR17    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (62) E1_set01_M=mIR27    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (63) E1_set01_M=mIU28    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (64) E1_set01_M=mIU34    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (65) E1_set01_M=mIU81    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (66) E1_set01_M=mIU96    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (67) E1_set01_M=mIV66    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (68) E1_set01_M=mIW33    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (69) E1_set01_M=mIX10    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (70) E1_set01_M=mIX97    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (71) E1_set01_M=mIY01    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (72) E1_set01_M=mIZ81    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (73) E1_set01_M=mJA07    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (74) E1_set01_M=mJA16    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (75) E1_set01_M=mJD47    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (76) E1_set01_M=mJD49    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (77) E1_set01_M=mJK48    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (78) E1_set01_M=mJL74    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (79) E1_set01_M=mJR91    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (80) E1_set01_M=mJZ76    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (81) E1_set01_M=mKA74    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (82) E1_set01_M=mKG27    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (83) E1_set01_M=mKH54    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (84) E1_set01_M=mKH90    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (85) E1_set01_M=mKI28    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (86) E1_set01_M=mKJ81    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (87) E1_set01_M=mKL05    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (88) E1_set01_M=mKM26    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (89) E1_set01_M=mKM58    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (90) E1_set01_M=mKN34    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (91) E1_set01_M=mKS53    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (92) E1_set01_M=mKT03    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (93) E1_set01_M=mKW33    : [gau(mean=0.0, snr_db=35, add_next=False)]
  (94) E1_set01_M=mat    : [gau(mean=0.0, snr_db=35, add_next=False)]

- **Unhealthy configs**
  (1) (sim)_E1_set01_M=mAI26    : [gau(mean=0, snr_db=35, add_next=True), glitch(prob=0.07, std_fac=1.5, add_next=True), sine(freqs=[2, 4], std_facs=[1.3, 1.5], add_next=False)]
  (2) (sim)_E1_set01_M=mAQ10    : [gau(mean=0, snr_db=35, add_next=True), glitch(prob=0.02, std_fac=1.3, add_next=True), sine(freqs=[1, 2, 5], std_facs=[1.3, 1, 1.5], add_next=False)]

- **Unknown configs**


Node and signal types:
---------------------------------------------
*_(<node_num>) <node_type> : [<signal_types>]_*

  (1) ammf   : [acc_rx, acc_ry, acc_rz, acc_x, acc_y, acc_z]

Node group name: ammf
Signal group name: acc


For ds_type 'OK' and others....
---------------------------------------------
Maximum timesteps across all node types: 4,098

No data interpolation applied.

'fs' is updated in data_config as given in loaded healthy (or unknown) data.
New fs:
[[2500.0002, 2500.0002, 2500.0002, 2500.0002, 2500.0002, 2500.0002]]

Exclusive rep numbers found in keys of hdf5 file. Hence, using them as rep numbers.

For ds_type 'NOK' and others....
---------------------------------------------
Maximum timesteps across all node types: 4,098

No data interpolation applied.

'fs' is updated in data_config as given in loaded healthy (or unknown) data.
New fs:
[[2499.9998, 2499.9998, 2499.9998, 2499.9998, 2499.9998, 2499.9998]]

Exclusive rep numbers found in keys of hdf5 file. Hence, using them as rep numbers.


[1 sample = (n_nodes, n_timesteps (window_length), n_dims)]
---------------------------------------------
Total samples: 4604 
Desired samples: 4604/4604 [OK=4508, NOK=96, UK=0],
Remainder samples: 0 [OK=0, NOK=0, UK=0]

custom_data_loader statistics:
Number of batches: 4604
torch.Size([1, 1, 1000, 6])  => (batch_size, n_nodes, n_timesteps, n_dims)

---------------------------------------------------------------------------

Anomaly detector model loaded for 'custom_test' from C:\AFD\fault_detection\logs\asml\NXE\full_wafer\train\ammf\acc\set_E1\IF\tswp_1\[ammf_(acc+E1)]-IF_fdet_48\anomaly_detector.pkl

Model type: IsolationForest, Model ID: [ammf_(acc+E1)]-IF_fdet_48, No. of input features req.: 6000

---------------------------------------------------------------------------
Custom_test parameters saved to C:\AFD\fault_detection\logs\asml\NXE\full_wafer\custom_test\ammf\acc\set_E1\iswp_1.3\IF\[ammf_(acc+E1)]-IF_fdet_48\custom_test_2.

Custom_test environment set. Custom_test will be logged at: C:\AFD\fault_detection\logs\asml\NXE\full_wafer\custom_test\ammf\acc\set_E1\iswp_1.3\IF\[ammf_(acc+E1)]-IF_fdet_48\custom_test_2

---------------------------------------------------------------------------

Testing anomaly detection model...

Initializing input processors for anomaly detection model...

>> Domain transformer initialized: time(cutoff_freq=0)

>> No raw data normalization is applied

>> No feature normalization is applied

>> No time feature extraction is applied

>> No feature reduction is applied

---------------------------------------------------------------------------

Using components as features: [comp0_dim0, comp0_dim1, comp0_dim2, comp0_dim3...comp999_dim2, comp999_dim3, comp999_dim4, comp999_dim5]

Test inference completed in 42.81 seconds

NOK upper bound (at 100.0 percentile): -0.0003

OK lower bound (from training): 0.0084

NOK upper bound (from testing): -0.0003

Dataframe is as follows:
      comp0_dim0  comp0_dim1  comp0_dim2  ...    scores  pred_label  final_pred_label
0       0.000011    0.000202   -0.000150  ...  0.168500           1               1.0
1      -0.000359   -0.000218    0.000122  ...  0.144709           1               1.0
2      -0.000217   -0.000108   -0.000185  ...  0.154511           1               1.0
3      -0.000043    0.000114   -0.000130  ...  0.156451           1               1.0
4       0.000156   -0.000230   -0.000183  ...  0.156528           1               1.0
...          ...         ...         ...  ...       ...         ...               ...
4599    0.000466    0.000440    0.000399  ...  0.016769           1               1.0
4600    0.000347    0.000412    0.000548  ...  0.015906           1               1.0
4601    0.000390    0.000494    0.000243  ...  0.018034           1               1.0
4602    0.000716    0.000763    0.000085  ...  0.025150           1               1.0
4603    0.000392    0.000486    0.000498  ...  0.017940           1               1.0

[4604 rows x 6005 columns]

Test accuracy: 0.99
Precision: 0.88, Recall: 0.51, F1-score: 0.64

Testing hyperparameters logged for tensorboard at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\custom_test\ammf\acc\set_E1\iswp_1.3\IF\[ammf_(acc+E1)]-IF_fdet_48\custom_test_2

---------------------------------------------------------------------------

<<<<<<<<<<<< CONFUSION MATRIX SIMPLE>>>>>>>>>>>>

> Creating confusion matrix for [ammf_(acc+E1)]-IF_fdet_48 / custom_test_2...

Confusion matrix logged at C:\AFD\fault_detection\logs\asml\NXE\full_wafer\custom_test\ammf\acc\set_E1\iswp_1.3\IF\[ammf_(acc+E1)]-IF_fdet_48\custom_test_2


===========================================================================

Custom_test of anomaly detector '[ammf_(acc+E1)]-IF_fdet_48/custom_test_2' completed.


=== EXECUTION COMPLETED ===
Log saved at: 2025-09-21 23:34:38
